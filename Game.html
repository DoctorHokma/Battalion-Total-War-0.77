<!DOCTYPE html>
<html>
<head>
<title> Battalion: Total War v0.77 HOPE</title>
<link rel="icon" href="Icon.ico">
</head>

<body id="BODY" style="overflow:hidden; scale:80%; position:absolute; left:0px; cursor: url('Assets/Miscellaneous/DarkCursor.png') 0 0, auto" oncontextmenu="return false" onload="if(document.getElementById('Disclaimer').style.visibility=='visible'){Disclaimer= new Audio('Assets/SFX/Disclaimer.wav'); Disclaimer.play()}">



<div id="Main Menu" style='position:absolute; visibility:visible; top:10px; left:325px; height:70px; width:70px; z-index: 5; margin:auto'>
	<img id="Main Menu Picture" style="position:absolute; width:700px; height:600px; left:-8px" src="Assets/Miscellaneous/Backdrop ETHA.JPG"/>

	<img style="position:absolute; visibility: hidden; scale:80%; left:-100px; top:0px; filter:hue-rotate(250deg) saturate(100%) brightness(100%)" src="TEMP/AsekaraUnsplit.PNG"/>
	<div style="position:absolute; visibility: hidden; scale:80%; left:-100px; top:100px">
	<img style="position:absolute; visibility: inherit; left:0px; top:0px; filter:hue-rotate(250deg) saturate(100%) brightness(100%)" src="TEMP/AsekaraFilling.PNG"/>
	<img style="position:absolute; visibility: inherit; left:0px; top:0px" src="TEMP/AsekaraMeshOpaque.PNG"/>
	</div>

	<div style="position:absolute; width:126px; height: 71px; z-index:1; top:500px; left:280px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('Main Menu').style.visibility='hidden';document.getElementById('CampaignSelectionScreen').style.visibility='visible'; let ElamFlagVariant=1; for(let j=1;j<5;j++){if(Campaigns[4][j-1][4].Finished??false){ElamFlagVariant=j+1}}; if(!MystSettChoice){ElamFlagVariant=1};document.getElementById('Elam Flag').src='Assets/Flags/FlagELM'+ElamFlagVariant+'.PNG'" onmouseover="document.getElementById('CampaignButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('CampaignButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('CampaignButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" oncontextmenu="Tooltip(1)">
	<img id="CampaignButton" style="position:absolute;" src="Assets/Miscellaneous/GenericButton.PNG"/>
		<p id='CampaignButtonP' style="position:relative; text-align: center; margin-top:19%">Campaign</p>
	</div>

	<div style="position:absolute; width:126px; height: 71px; z-index:1; top:500px; left:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="alert('Work in progress')" 
	onmouseover="" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'" oncontextmenu="Tooltip(3)">
	<img id="ContinueButton" style="position:absolute;" src="Assets/Miscellaneous/NonButton.PNG"/>
		<p id='ContinueButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Continue</p>
	</div>

	<div style="position:absolute; width:126px; height: 71px; z-index:1; top:500px; left:420px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=0;document.getElementById('Main Menu').style.visibility='hidden'; document.getElementById('Tutorial Levels').style.visibility='visible'" onmouseover="document.getElementById('BootCampButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('BootCampButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('BootCampButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" oncontextmenu="Tooltip(2)">
	<img id="BootCampButton" style="position:absolute;" src="Assets/Miscellaneous/GenericButton.PNG" />
		<p id='BootCampButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Boot Camp</p>
	</div>

	<div style="position:absolute; width:126px; height: 71px; z-index:1; top:500px; left:0px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('Credits').style.visibility='visible'" onclick="document.getElementById('Credits').style.visibility='visible'" onmouseover="document.getElementById('CreditsButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('CreditsButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('CreditsButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" oncontextmenu="Tooltip(5)" >
	<img id="CreditsButton" style="position:absolute;" src="Assets/Miscellaneous/GenericButton.PNG"
	onclick="document.getElementById('Credits').style.visibility='visible'"/>
		<p id='CreditsButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Credits</p>
		</div>

	<div style="position:absolute; width:126px; height: 71px; z-index:1; top:500px; left:560px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('Options').style.visibility='visible'" onmouseover="document.getElementById('OptionsButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('OptionsButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('OptionsButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" oncontextmenu="Tooltip(4)">
	<img id="OptionsButton" style="position:absolute;" src="Assets/Miscellaneous/GenericButton.PNG"/>
		<p id='OptionsButtonP' style="position:relative; text-align: center; margin-top:19%; color:black" onclick="document.getElementById('Options').style.visibility='visible'">Options</p>
		</div>







	<div style="position:absolute; z-index:1; top:0px; left:0px; width:126px; height: 71px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('BonusLevelsButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('BonusLevelsButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('BonusLevelsButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" onclick="document.getElementById('Main Menu').style.visibility='hidden'; document.getElementById('Special Levels').style.visibility='visible'; NivelVizat=Samara" oncontextmenu="Tooltip(8)">
	<img id="BonusLevelsButton" style="position: absolute;" src="Assets/Miscellaneous/GenericButton.PNG" />
		<p id='BonusLevelsButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Bonus Maps</p>
	</div>

	<div style="position:absolute; z-index:1; top:0px; left:560px; width:126px; height: 71px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('LevelEditorButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('LevelEditorButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('LevelEditorButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" onclick="document.getElementById('MapMold').style.visibility='visible'" oncontextmenu="Tooltip(6)">
	<img id="LevelEditorButton"  style="position: absolute;" src="Assets/Miscellaneous/GenericButton.PNG"/>
		<p id='LevelEditorButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Level Editor</p>
	</div>

	<div style="position: absolute; z-index:1;top:70px; left:0px; width:126px; height: 71px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('ConquestButton').src='Assets/Miscellaneous/NonButton.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('ConquestButton').src='Assets/Miscellaneous/NonButton.PNG'" onmousedown="document.getElementById('ConquestButton').src='Assets/Miscellaneous/NonButton.PNG'" onclick="alert('Work in progress')" oncontextmenu="Tooltip(9)" >
		<img id="ConquestButton" style="position: absolute;" src="Assets/Miscellaneous/NonButton.PNG"/>
		<p id='ConquestButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Conquest</p>
	</div>


	<div style="position: absolute; z-index:1;top:70px; left:560px; width:126px; height: 71px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('CodexButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'; document.getElementById('CodexButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('CodexButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" onclick="document.getElementById('Codex').style.visibility='visible';document.getElementById('Main Menu').style.visibility='hidden'" oncontextmenu="Tooltip(7)" >
		<img id="CodexButton" style="position: absolute;" src="Assets/Miscellaneous/GenericButton.PNG"/>
		<p id='CodexButtonP' style="position:relative; text-align: center; margin-top:19%; color:black">Codex</p>
	</div>

	</div>
<div id="Battlemap" style='position:absolute; visibility:hidden; top:20px; left:400px; height:560px; width:560px; z-index: 0'>

	<div id='DialogueBox' style='position:absolute; display:inline; top:410px; left:0px; height:140px; width:560px; visibility: hidden; z-index: 7; cursor: url("Assets/Miscellaneous/Cursor.png") 0 0, auto'>
		<img id="Textbox" src="Assets/Miscellaneous/Textbox.PNG" style="position:absolute; display:inline; top:0px; left:0px; opacity:1"/>
		<div style="position:absolute; left:-3px; top:19px; width:560px; height:0px; border:1px solid #7e3f32"></div>
		<img id="Portrait" src="" style='position:absolute; display:inline; top:0px; left:0px'/>
		<img src="Assets/Miscellaneous/Demarcator.PNG" style='position:absolute; display:inline; top:-2px; left:0px'/>
		<p id="CharacterName" style='position:absolute; display:inline; top:-23px; left:0px; font-size: 20px; width:560px; text-align:center'></p>
		<p id="DialogueInstance" style='position:absolute; display:inline; top:5px; left:135px'></p>
		<img style="position: absolute; left:500px; top:100px" src="Assets/Miscellaneous/DialogueArrow.GIF"/>

	</div>
	<div id="Illustration" style="position:absolute; left:56px; top:56px; z-index: 10; visibility: hidden; "onclick="this.style.visibility='hidden'">
	<img style="position: absolute; top:-8px; left:-6px; z-index:10" src="Assets/Miscellaneous/IllustrationFrame.PNG"/>
	<img id="MidBattleIllustration" style="position: absolute; z-index:10; width: 448px; height:280px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Gallery/Bianca.PNG" />
	</div>

	<div id="DialogueSkip" style="position:absolute; top:410px; left:0px; visibility:hidden; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('DialogueBox').style.visibility='hidden'; this.style.visibility='hidden';if(Resolution){EndBattle()}">
		<img style="position: absolute; left:414px; top:-37px; z-index:6" src="Assets/Miscellaneous/SkipButton.PNG" />
		<p id="DialogueSkipP" style="position: absolute; width: 100px; height:20px; text-align:center; top: -40px; left: 441px; z-index:6">Skip</p>

	</div>

	<img id="AITurnIndicator" style="position:absolute; left:-160px; top:0px; visibility:hidden;" src="Assets/Miscellaneous/AI Turn.PNG"/>
	

	

	<div id="SidePanel" style="position:absolute; left:560px; z-index:6; text-align:center;">
		<img src="Assets/Miscellaneous/SidePanel.PNG" onmouseover="" />
		<p id="BtnSuperscript" style="position: absolute; z-index:3; top:119px; width:140px; left:14px;">Press C for controls</p>
		<img id="UndoBtn" style="position: absolute; left:35px; top: 168px; z-index:3; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('BtnSuperscript').innerHTML=Language.SystemTerms[49]; this.src='Assets/Miscellaneous/UndoBtnL.PNG' " onmouseout="document.getElementById('BtnSuperscript').innerHTML=''; this.src='Assets/Miscellaneous/UndoBtnS.PNG'" onmousedown="this.src='Assets/Miscellaneous/UndoBtnP.PNG'; UndoMove()" onmouseup="this.src='Assets/Miscellaneous/UndoBtnS.PNG'" src="Assets/Miscellaneous/UndoBtnS.PNG"/>
		<img id="MenuBtn" style="position: absolute; left:70px; top: 168px; z-index:3; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('BtnSuperscript').innerHTML=Language.SystemTerms[50]; this.src='Assets/Miscellaneous/MenuBtnL.PNG' " onmouseout="document.getElementById('BtnSuperscript').innerHTML=''; this.src='Assets/Miscellaneous/MenuBtnS.PNG'" onmousedown="this.src='Assets/Miscellaneous/MenuBtnP.PNG'; document.getElementById('Options').style.visibility='visible'" onmouseup="this.src='Assets/Miscellaneous/MenuBtnS.PNG'" src="Assets/Miscellaneous/MenuBtnS.PNG"/>
		<img id="QuitBtn" style="position: absolute; left:105px; top: 168px; z-index:3; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('BtnSuperscript').innerHTML=Language.SystemTerms[51]; this.src='Assets/Miscellaneous/QuitBtnL.PNG' " onmouseout="document.getElementById('BtnSuperscript').innerHTML=''; this.src='Assets/Miscellaneous/QuitBtnS.PNG'" onmousedown="this.src='Assets/Miscellaneous/QuitBtnP.PNG'; Battle_Lost()" onmouseup="this.src='Assets/Miscellaneous/QuitBtnS.PNG'" src="Assets/Miscellaneous/QuitBtnS.PNG"/>

		<img id="CommanderPortrait" style="position:absolute; top:239px; left:20px; z-index:-1" src="Assets/Portraits/AndersPortrait.PNG"/>
		<div id="CommanderCollider" style="position:absolute; top:239px; left:20px; height:150px; width:130px; z-index:11" onmouseover="ShowCharacterBio()" onmouseout="document.getElementById('CommanderBio').style.visibility='hidden'"></div>
		<div id="CommanderBio" style="position:absolute; visibility:hidden; top:0px; left:-250px; width:280px; height:560px; z-index:10; background-color:gray; border:3px solid brown; text-align:center"/> 
			<p id="CommanderName" style="position:absolute; top:0px; width: 280px; height:10px; z-index:11">Nobody</p>
			<p id="CommanderNickname" style="position:absolute; top:30px; width: 280px; height:10px; z-index:11">Nobody</p>
			<p id="CommanderBiography" style="position:absolute; width: 280px; top:70px; height:10px; z-index:11; font-size:10px; color:beige">Nobody</p>
			<p id="CommanderNickCommentary" style="position:absolute; top:490px; width: 280px; height:10px; z-index:11; font-size:10px; color:orange">Nobody</p>

			</div>

		<div id="FactionDetails" style="position:absolute; visibility: hidden; left:10px; top:140px; z-index:3; background-color:#aaaaaa; width:140px; height:250px; border:2px solid blue">
			<p id="FactionDetailsName" style="position:absolute; left:0px; width:140px; height: 21px; text-align:center; font-size: 10px;">Astartian Continental Reclamation Front</p>
			<p id="FactionDetailsRelation" style="position:absolute; left:0px; top:35px; width:140px; height: 21px; text-align:center; font-size: 10px;">Self</p>
			<p id="FactionDetailsLeader" style="position:absolute; left:0px; top:60px; width:140px; height: 21px; text-align:center; font-size: 10px;">Anders</p>
			<p id="FactionDetailsDao" style="position:absolute; left:0px; top:85px; width:140px; height: 21px; text-align:left; font-size: 10px;">Defensive Dao: +2</p>
			<p id="FactionDetailsFunds" style="position:absolute; left:0px; top:110px; width:140px; height: 21px; text-align:left; font-size: 10px;">Funds: 1000</p>
			<p id="FactionDetailsInfantryAccess" style="position:absolute; top:135px; left:0px; width:140px; height: 21px; text-align:left; font-size: 10px;">SpecInf</p>
			<img id="SpecInf1" style="position:absolute; left:50px; top:143px; z-index:1" src="Assets/Traits/SpecInf1.PNG"/>
			<img id="SpecInf2" style="position:absolute; left:67px; top:143px; z-index:1" src="Assets/Traits/SpecInf2.PNG"/>
			<img id="SpecInf3" style="position:absolute; left:84px; top:143px; z-index:1" src="Assets/Traits/SpecInf3.PNG"/>
			<img id="SpecInf4" style="position:absolute; left:101px; top:143px; z-index:1" src="Assets/Traits/SpecInf4.PNG"/>
			<img id="SpecInf5" style="position:absolute; left:118px; top:143px; z-index:1" src="Assets/Traits/SpecInf5.PNG"/>
			<p id="FactionDetailsArmorAccess" style="position:absolute; top:160px; left:0px; width:140px; height: 21px; text-align:left; font-size: 10px;">SpecTank</p>
			<img id="SpecTank1" style="position:absolute; left:47px; top:170px; z-index:1" src="Assets/Traits/SpecTank1.PNG"/>
			<img id="SpecTank2" style="position:absolute; left:64px; top:170px; z-index:1"  src="Assets/Traits/SpecTank2.PNG"/>
			<img id="SpecTank3" style="position:absolute; left:81px; top:170px; z-index:1"  src="Assets/Traits/SpecTank3.PNG"/>
			<img id="SpecTank4" style="position:absolute; left:98px; top:170px; z-index:1"  src="Assets/Traits/SpecTank4.PNG"/>
			<img id="SpecTank5" style="position:absolute; left:115px; top:170px; z-index:1"  src="Assets/Traits/SpecTank5.PNG"/>






			</div>


		<div id="CharacterBio"/></div>

		<div id="Glassplate1" style="position: absolute; top: 389px; left: 3px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="FactionInformations(1)" onmouseout="document.getElementById('FactionDetails').style.visibility='hidden'">			
			<div id="Glassplatecolor1" style="position:absolute; background: red; width: 140px; height:25px; left:11px; top:0px"></div>
			<img style="position: absolute; z-index:1" src="Assets/Miscellaneous/Glassplate.PNG"/>
			<img id="GlassplateCrest1" style="position:absolute; top:0px; left:0px; z-index:2" src="Assets/Emblems/CrestNON.PNG"/>
			<p id="Glassplatename1" style="position:absolute; top:-2px; width: 140px; left:28px; height:20px; text-align:left; font-size: 10px; z-index:2">Red</p>
		</div>
		<div id="Glassplate2" style="position: absolute; top: 419px; left: 3px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="FactionInformations(2)" onmouseout="document.getElementById('FactionDetails').style.visibility='hidden'">			
			<div id="Glassplatecolor2" style="position:absolute; background: blue; width: 140px; height:25px; left:11px; top:0px"></div>
			<img style="position: absolute; z-index:1" src="Assets/Miscellaneous/Glassplate.PNG"/>
			<img id="GlassplateCrest2" style="position:absolute; top:0px; left:0px; z-index:2" src="Assets/Emblems/CrestNON.PNG"/>
			<p id="Glassplatename2" style="position:absolute; top:-2px; width: 140px; left:28px; height:20px; text-align:left; font-size: 10px; z-index:2">Blue</p>
		</div>
		<div id="Glassplate3" style="position: absolute; top: 449px; left: 3px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="FactionInformations(3)" onmouseout="document.getElementById('FactionDetails').style.visibility='hidden'">			
			<div id="Glassplatecolor3" style="position:absolute; background: green; width: 140px; height:25px; left:11px; top:0px"></div>
			<img style="position: absolute; z-index:1" src="Assets/Miscellaneous/Glassplate.PNG"/>
			<img id="GlassplateCrest3" style="position:absolute; top:0px; left:0px; z-index:2" src="Assets/Emblems/CrestNON.PNG"/>
			<p id="Glassplatename3" style="position:absolute; top:-2px; width: 140px; left:28px; height:20px; text-align:left; font-size: 10px; z-index:2">Green</p>
		</div>
		<div id="Glassplate4" style="position: absolute; top: 479px; left: 3px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="FactionInformations(4)" onmouseout="document.getElementById('FactionDetails').style.visibility='hidden'">			
			<div id="Glassplatecolor4" style="position:absolute; background: yellow; width: 140px; height:25px; left:11px; top:0px"></div>
			<img style="position: absolute; z-index:1" src="Assets/Miscellaneous/Glassplate.PNG"/>
			<img id="GlassplateCrest4" style="position:absolute; top:0px; left:0px; z-index:2" src="Assets/Emblems/CrestNON.PNG"/>
			<p id="Glassplatename4" style="position:absolute; top:-2px; width: 140px; left:28px; height:20px; text-align:left; font-size: 10px; z-index:2">Yellow</p>
		</div>



		<img id="EndTurnButton" src="Assets/Miscellaneous/EndTurnButton.PNG" onmouseover="document.getElementById('EndTurnButton').src='Assets/Miscellaneous/EndTurnButtonHovered.PNG'" onmouseout="document.getElementById('EndTurnButton').src='Assets/Miscellaneous/EndTurnButton.PNG'" onmousedown="document.getElementById('EndTurnButton').src='Assets/Miscellaneous/EndTurnButtonPressed.PNG'" onClick="if(!isAITurn){EndTurn(SubRosters,Map,Constants,Roster)}" style="position: absolute; left: 23px; top:512px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto"/>	


	</div>

	<div id='DetailBar' style="position:absolute; top:560px; left:0px">
		<img id="DetBar" style="position:absolute;top:0px;left:0px" src="Assets/Miscellaneous/PlainDetailBar.PNG"/>
		<img id="Icon" style="position: absolute; visibility:hidden; z-index: 3; top:11px; left:4px; width:28px; height:28px"/>
		<img id="IconMesh" style="position: absolute; visibility:hidden; z-index: 3; top:11px; left:4px; width:28px; height:28px"/>
		<p id="DetBarName" style="position:absolute; left:42px; top:2px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px"></p>
		<p id="DetBarDescription" style="position:absolute; left:42px; top:17px; margin:0px; width:210px; height:21px; overflow-y:hidden ;font-size:10px; color:#ffffff"></p>
		<div style="position: absolute; width:210px; height:5px; left:42px; top:15px" onmouseover="document.getElementById('DetBarDescription').scrollBy(0,-10)"></div>
		<div style="position: absolute; width:210px; height:5px; left:42px; top:35px" onmouseover="document.getElementById('DetBarDescription').scrollBy(0,10)"></div>
		
		<div id="Health" style="visibility:hidden">
			<p id="HPHeader" style="position:absolute; left:273px; top:2px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">Health:</p>
			<img id="ArmorType" style="position:absolute; left:273px; top:21px; margin:0px; clip:rect(0px,20px,20px,0px)" onmouseover="ClassTraitDetail('ArmorType','Details')" onmouseout="hideTraitDetail()" src="Assets/Traits/ArmorTypes.PNG"/>
			<p id="HP" style="position:absolute; left:294px; top:28px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">175/175</p>
			<img id="HPshadow" style="position:absolute; left:294px; top:21px; margin:0px; z-index:1; width:40px" src="Assets/Miscellaneous/HealthBarShadow.PNG"/>
			<img id="HPbar" style="position:absolute; left:294px; top:21px; margin:0px; z-index:2; width:40px; height: 8px" src="Assets/Miscellaneous/HealthBarFiller.PNG" />
			<img id="HPframe" style="position:absolute; left:294px; top:21px; margin:0px; z-index:3; width:40px" src="Assets/Miscellaneous/HealthBarFrame.PNG" />
			</div>
		
		<div id="Damage" style="visibility:hidden">
			<p id="DamageHeader" style="position:absolute; left:350px; top:2px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">Damage:</p>
			<img id="DamageType" style="position:absolute; left:350px; top:21px; margin:0px; clip:rect(0px,20px,20px,0px)" onmouseover="ClassTraitDetail('DamageType','Details')" onmouseout="hideTraitDetail()" src="Assets/Traits/WeaponTypes.PNG"/>
			<p id="DamageValue" style="position:absolute; left:371px; top:28px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">25(2--5)</p>
			</div>

		<div id="Movement" style="visibility:hidden">
			<p id="MovementHeader" style="position:absolute; left:427px; top:2px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">Move:</p>
			<img id="MovementType" style="position:absolute; left:427px; top:21px; margin:0px; clip:rect(0px,20px,20px,0px)" onmouseover="ClassTraitDetail('MovementType','Details')" onmouseout="hideTraitDetail()" src="Assets/Traits/MovementTypes.PNG"/>
			<p id="Speed" style="position:absolute; left:448px; top:28px; margin:0px; width:210px; font-family:'Roboto'; font-size:10px">10</p>
			</div>
		<img id="Biome" style="position: absolute; visibility: hidden; top:21px; left:438px" onmouseover="ClassTraitDetail('Biome','Details')" onmouseout="hideTraitDetail()" src="Assets/Traits/Temperate.PNG"/>
		<img id="Trait1" style="position:absolute; left:477px; top:21px; margin:0px" src="" onmouseover="traitDetail(1,'Details')" onmouseout="hideTraitDetail()"/>
		<img id="Trait2" style="position:absolute; left:498px; top:21px; margin:0px" src="" onmouseover="traitDetail(2,'Details')" onmouseout="hideTraitDetail()"/>
		<img id="Trait3" style="position:absolute; left:519px; top:21px; margin:0px" src="" onmouseover="traitDetail(3,'Details')" onmouseout="hideTraitDetail()"/>
		<img id="Trait4" style="position:absolute; left:540px; top:21px; margin:0px" src="" onmouseover="traitDetail(4,'Details')" onmouseout="hideTraitDetail()"/>

		<div id="TraitTooltip" style="position:absolute; visibility:hidden; left:400px; top: -26px; width:160px; height:42px; margin:0px; z-index:8">
			<img id="TraitTooltipImage" style="position:absolute; left:0px; top: 0px; margin:0px; z-index:2" src="Assets/Miscellaneous/TraitTooltip.PNG"/>
			<p id="TraitName" style="position:relative; text-align: center; top: 0px; margin:0px; z-index:3; font-size: 12px;"></p>
			<p id="TraitDescription" style="position: relative; text-align: center; top:-7px; font-size: 10px; z-index: 4"></p>
		</div>
	</div>

	<div id="Map" style='position: absolute; top:0px; left:0px; height:560px; width:560px'>
		<div id="InterphaseBanner" style="position: absolute; visibility: hidden; z-index:5; width:560px; height:0px; top:50%; margin-left:-5px; margin-top:-70px ;border:5px solid;border-color:white ; ">
			<div id="InterphaseField" style="position: absolute; width:560px; height:0px; top: 50%; background-color:grey; filter: opacity(35%);"></div>
		<p id="InterphaseFaction" style="position: absolute; z-index: 6; left: 50px; top: -25px; color:white; font-size:28px;filter:opacity(100%);">Somertin Federation</p>
		<p id="InterphaseTurn" style="position: absolute; z-index: 6; left: 400px; color:white; font-size:28px;filter:opacity(100%);">Turn 1</p>
		</div>

		</div>



	<div id="UnitMap" style='position: absolute; top:0px; left:0px; height:560px; width:560px; overflow:hidden; scroll-behavior: smooth;'>

		<div id="SpecialActionPanel" style="position:absolute; visibility: hidden; top:0px; left:50px; width:112px; height:77px; border:2px solid black; border-radius: 5px; background-color: white; z-index:6">

		<img id="AirTransportPickup" style="position: absolute; top:3px; left:2px" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£150';if(IsStork){this.src='Assets/Miscellaneous/UnitDisembarkHighlighted.png'}else{this.src='Assets/Miscellaneous/StorkPickupHighlighted.PNG'}" onmouseout="if(IsStork){this.src='Assets/Miscellaneous/UnitDisembark.PNG'}else{this.src='Assets/Miscellaneous/StorkPickup.PNG'}"  src="Assets/Miscellaneous/StorkPickup.PNG" onclick="document.getElementById('SpecialActionPanel').style.visibility='hidden'; StorkPickup(rostermap[UnitIcs][UnitIgrec])"/>
		<img id="AirTransportPickupMask" style="position: absolute; top:3px; left:2px; z-index:6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£150'"  src="Assets/Miscellaneous/StorkPickupMask.PNG"/>
		<img id="NavalTransportPickup" style="position: absolute; top:3px; left:38px" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£100';if(IsConvoy){this.src='Assets/Miscellaneous/UnitDisembarkHighlighted.PNG'}else{this.src='Assets/Miscellaneous/ConvoyPickupHighlighted.PNG'}" onmouseout="if(IsConvoy){this.src='Assets/Miscellaneous/UnitDisembark.PNG'}else{this.src='Assets/Miscellaneous/ConvoyPickup.PNG'}" src="Assets/Miscellaneous/ConvoyPickup.PNG" onclick="document.getElementById('SpecialActionPanel').style.visibility='hidden'; ConvoyPickup(rostermap[UnitIcs][UnitIgrec])"/>
		<img id="NavalTransportPickupMask" style="position: absolute; top:3px; left:38px; z-index:6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£100'" src="Assets/Miscellaneous/ConvoyPickupMask.PNG"/>
		<img id="RepairUnit" style="position: absolute; top:3px; left:74px" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£'+BizzareMoneyPointer;this.src='Assets/Miscellaneous/UnitRepairHighlighted.PNG'" onmouseout="this.src='Assets/Miscellaneous/UnitRepair.PNG'" src="Assets/Miscellaneous/UnitRepair.PNG" onclick="document.getElementById('SpecialActionPanel').style.visibility='hidden'; YourMoney-=Math.round(Units[rostermap[UnitIcs][UnitIgrec].unitType].Cost/2); rostermap[UnitIcs][UnitIgrec].life=Units[rostermap[UnitIcs][UnitIgrec].unitType].HP; document.getElementById('HPbar').style.filter=''; document.getElementById('HPbar').style.width='39px';document.getElementById('HP').innerHTML=Units[rostermap[UnitIcs][UnitIgrec].unitType].HP+'/'+Units[rostermap[UnitIcs][UnitIgrec].unitType].HP"/>
		<img id="RepairUnitMask" style="position: absolute; top:3px; left:74px; z-index:6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML=''" src="Assets/Miscellaneous/UnitRepairMask.PNG"/>
		<img id="BuildStructure" style="position: absolute; top:32px; left:2px" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='';this.src='Assets/Miscellaneous/StructureConstructionHighlighted.PNG'" onmouseout="this.src='Assets/Miscellaneous/StructureConstruction.PNG'" src="Assets/Miscellaneous/StructureConstruction.PNG" onclick="document.getElementById('SpecialActionPanel').style.visibility='hidden'; LaunchConstructorPanel(UnitIcs,UnitIgrec)"/>
		<img id="BuildStructureMask" style="position: absolute; top:32px; left:2px; z-index:6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML=''" src="Assets/Miscellaneous/StructureConstructionMask.PNG"/>

		<img id="SupplyDepot" style="position: absolute; top:32px; left:38px" src="Assets/Miscellaneous/Depot.PNG" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£1300';this.src='Assets/Miscellaneous/DepotHighlighted.PNG'" onmouseout="this.src='Assets/Miscellaneous/Depot.PNG'" />
		<img id="SupplyDepotMask" style="position: absolute; top:32px; left:38px; z-index: 6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£1300'" src="Assets/Miscellaneous/DepotMask.PNG"/>
		<img id="LayMines" style="position: absolute; top:32px; left:74px" src="Assets/Miscellaneous/Minefield.PNG" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£200';this.src='Assets/Miscellaneous/MinefieldHighlighted.PNG'" onmouseout="this.src='Assets/Miscellaneous/Minefield.PNG'" />
		<img id="LayMinesMask" style="position: absolute; top:32px; left:74px; z-index: 6" onmouseover="document.getElementById('SpecialOptionCost').innerHTML='£200'" src="Assets/Miscellaneous/MinefieldMask.PNG"/>

		<p id="SpecialOptionCost" style="position: absolute; top:53px; left:0px; width:112px; height:14px; font-size:10px; text-align:center;"></p>

			</div>

		
		<div id="BuildingConstructionPanel" style="position:absolute; width:280px; height: 280px; left:70px; top:70px; z-index:6; visibility:hidden;">
		<img id="BuildingConstructionFrame"/>
		<img style="position: absolute; left:120px; top:120px" src="Assets/Miscellaneous/SelectionCanceller.PNG" onclick="document.getElementById('BuildingConstructionPanel').style.visibility='hidden'"/>


		<div id="BuildingCell1" style="position:absolute; top:0px; left:98px; height:84px; width:84px" onmouseover="HoverBuilding('on',61)" onmouseout="HoverBuilding('off',61)" onclick="Build(61)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre1" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Barricade3.PNG"/>
			<img id="BuildingMesh1" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/BarricadeMesh3.PNG"/>
			<img id="BuildingFrame1" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice1" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell2" style="position:absolute; top:0px; left:196px; height:84px; width:84px" onmouseover="HoverBuilding('on',62)" onmouseout="HoverBuilding('off',62)" onclick="Build(62)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre2" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Bunker3.PNG"/>
			<img id="BuildingMesh2" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/BunkerMesh3.PNG"/>
			<img id="BuildingFrame2" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice2" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell3" style="position:absolute; top:0px; left:0px; height:84px; width:84px" onmouseover="HoverBuilding('on',63)" onmouseout="HoverBuilding('off',63)" onclick="Build(63)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre3" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Turret3.PNG"/>
			<img id="BuildingMesh3" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/TurretMesh3.PNG"/>
			<img id="BuildingFrame3" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice3" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell4" style="position:absolute; top:98px; left:196px; height:84px; width:84px" onmouseover="HoverBuilding('on',64)" onmouseout="HoverBuilding('off',64)" onclick="Build(64)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre4" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/FlakTower3.PNG"/>
			<img id="BuildingMesh4" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/FlakMesh3.PNG"/>
			<img id="BuildingFrame4" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice4" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell5" style="position:absolute; top:98px; left:0px; height:84px; width:84px" onmouseover="HoverBuilding('on',65)" onmouseout="HoverBuilding('off',65)" onclick="Build(65)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre5" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Coastal3.PNG"/>
			<img id="BuildingMesh5" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/CoastalMesh3.PNG"/>
			<img id="BuildingFrame5" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice5" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell6" style="position:absolute; top:196px; left:196px; height:84px; width:84px" onmouseover="HoverBuilding('on',66)" onmouseout="HoverBuilding('off',66)" onclick="Build(66)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre6" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Radar3.PNG"/>
			<img id="BuildingMesh6" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/RadarMesh3.PNG"/>
			<img id="BuildingFrame6" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice6" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell7" style="position:absolute; top:196px; left:0px; height:84px; width:84px" onmouseover="HoverBuilding('on',67)" onmouseout="HoverBuilding('off',67)" onclick="Build(67)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre7" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Silo3.PNG"/>
			<img id="BuildingMesh7" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/SiloMesh3.PNG"/>
			<img id="BuildingFrame7" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice7" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	

		<div id="BuildingCell8" style="position:absolute; top:196px; left:98px; height:84px; width:84px" onmouseover="HoverBuilding('on',68)" onmouseout="HoverBuilding('off',68)" onclick="Build(68)">
			<div style="position: absolute; width:84px; height: 84px; background-color:grey;"></div>
			<img id="BuildingMontre8" style="position: absolute; left:14px; top:7px" src="Assets/Units/Static/Depot3.PNG"/>
			<img id="BuildingMesh8" style="position: absolute; left:14px; top:7px" src="Assets/Units/StaticMeshes/DepotMesh3.PNG"/>
			<img id="BuildingFrame8" style="position: absolute;" src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"/>
			<p id="BuildingPrice8" style="position: absolute; top:49px; left:0px ;width:84px; height:14px; text-align: center">$1000</p>
			</div>	






		</div>






























	</div>



	<div id="RegionMap" style="position:absolute; visibility: hidden; top:0px; left:0px; height:560px; width:560px; z-index:7; overflow: hidden; overflow-y: hidden; scroll-behavior: smooth;"></div>

	

	<div id="UnitRecruitmentPanel" style="position: absolute; visibility:hidden; top:0px; left:-150px; z-index:7">
	<img id="RecruitmentPanelBackground" style="position: absolute; top:0px; left:0px" src="Assets/Miscellaneous/RecruitmentPanel.PNG"/>

	
	
		<div style="position: absolute; z-index:8; left:860px; text-align:center">
		<img src="Assets/Miscellaneous/MoneyIndicator.PNG"/>
		<p id="MoneyIndicator" style="position:relative; top:-33px; font-size:12px">Fried penis</p>
		</div>

		<img id="CloseUnitMakingButton" style="position: absolute; top: 70px; left: 850px; z-index:8" onmouseover="document.getElementById('CloseUnitMakingButton').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onclick="document.getElementById('CloseUnitMakingButton').src='Assets/Miscellaneous/CloseButtonPressed.PNG'; document.getElementById('UnitRecruitmentPanel').style.visibility='hidden'; for(let x=1;x<=40;x++){document.getElementById('Obturator'+x).style.visibility='hidden';document.getElementById('UnitUnderlayer'+x).style.visibility='hidden';document.getElementById('PriceTag'+x).style.visibility='hidden';document.getElementById('UnitMontre'+x).style.visibility='hidden';document.getElementById('UnitFrame'+x).style.visibility='hidden'}" onmouseout="document.getElementById('CloseUnitMakingButton').src='Assets/Miscellaneous/CloseButton.PNG'" src="Assets/Miscellaneous/CloseButton.PNG"/>







		<div>
			<img id="Speculator" style="position: absolute; z-index:8; top: 0px" src="Assets/Miscellaneous/UnitSpeculatorBar.PNG"/>
			<img id="UnitMontreBkg" style="position: absolute; z-index:7; left:7px; top:10px"/>
			<img id="UnitMontre" style="position: absolute; z-index:9; left:37px; top:42px" src="Assets/Units/Static/Barricade2.PNG"/>
			<img id="UnitMontreMesh" style="position: absolute; z-index:9; left:37px; top:42px" src="Assets/Miscellaneous/Nothing.PNG"/>

			<img id="MontreArmor" style="position:absolute; top:10px; left:140px; z-index:9" src="Assets/Traits/MediumArmor.PNG" onmouseover="ClassTraitDetail('ArmorType','Constructor')" onmouseout="hideTraitDetail()"/>
			<p id="MontreArmorP" style="position: absolute; z-index:9; top:-0px; left:161px;font-size: 10px;">Health</p>
			<p id="MontreArmorText" style="position: absolute; z-index:9; top:10px; left:161px;font-size: 10px;">420/420</p>
			<img id="MontreAttack" style="position:absolute; top:10px; left:210px; z-index:9" src="Assets/Traits/NoneWeapon.PNG" onmouseover="ClassTraitDetail('DamageType','Constructor')" onmouseout="hideTraitDetail()"/>
			<p id="MontreDamageP" style="position: absolute; z-index:9; top:-0px; left:231px;font-size: 10px;">Damage</p>
			<p id="MontreAttackText" style="position: absolute; z-index:9; top:10px; left:231px;font-size: 10px;">69(1-1)</p>
			<img id="MontreLocomotion" style="position:absolute; top:10px; left:280px; z-index:9" src="Assets/Traits/Stationary.PNG" onmouseover="ClassTraitDetail('MovementType','Constructor')" onmouseout="hideTraitDetail()"/>
			<p id="MontreMovementP" style="position: absolute; z-index:9; top:-0px; left:301px;font-size: 10px;">Movement</p>
			<p id="MontreLocomotionText" style="position: absolute; z-index:9; top:10px; left:301px;font-size: 10px;">666</p>
			<img id="MontreTrait1" style="position: absolute;z-index: 9;top:10px;left:350px" src="Assets/Traits/Conqueror.PNG" onmouseover="traitDetail(1,'Constructor')" onmouseout="hideTraitDetail()"/>
			<img id="MontreTrait2" style="position: absolute;z-index: 9;top:10px;left:370px" src="Assets/Traits/Conqueror.PNG" onmouseover="traitDetail(2,'Constructor')" onmouseout="hideTraitDetail()"/>
			<img id="MontreTrait3" style="position: absolute;z-index: 9;top:10px;left:390px" src="Assets/Traits/Conqueror.PNG" onmouseover="traitDetail(3,'Constructor')" onmouseout="hideTraitDetail()"/>
			<img id="MontreTrait4" style="position: absolute;z-index: 9;top:10px;left:410px" src="Assets/Traits/Conqueror.PNG" onmouseover="traitDetail(4,'Constructor')" onmouseout="hideTraitDetail()"/>
			<p id="MontreName" style="position:absolute;z-index: 9; top:112px; left:10px; width:105px;text-align: center; font-size:12px">Placeholder unit</p>
			<p id="MontreDescription" style="position:absolute;z-index: 9; top:20px;left:140px; width:350px;height: 105px;">Lorem ipsum dolor sit amet</p>

				</div>

		<div style="position: absolute; z-index:8; top: 2px; left:567px">
			<img id="Particulator" style="position: absolute; top:0px; left:0px" src="Assets/Miscellaneous/UnitParticulatorBar.PNG"/>
			<input id="ParticularNameBox" style="position: absolute; width:210px; height:20px; top:20px; text-align: center; left:30px; background-color:#3D4C48">
			<img id="MoraleParticulator-2" style="position: absolute; top: 50px; left:80px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale0.PNG" onmouseover="this.src='Assets/Traits/Morale-2.PNG'" onmouseout="if(Speciation!=-2){this.src='Assets/Traits/Morale0.PNG'}" onclick="ExecuteSpeciation(-2)"/>
			<img id="MoraleParticulator-1" style="position: absolute; top: 50px; left:105px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale0.PNG" onmouseover="this.src='Assets/Traits/Morale-1.PNG'" onmouseout="if(Speciation!=-1){this.src='Assets/Traits/Morale0.PNG'}" onclick="ExecuteSpeciation(-1)"/>
			<img id="MoraleParticulator0" style="position: absolute; top: 50px; left:130px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale0.PNG" onmouseover="" onmouseout="" onclick="ExecuteSpeciation(0)"/>
			<img id="MoraleParticulator1" style="position: absolute; top: 50px; left:155px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale0.PNG" onmouseover="this.src='Assets/Traits/Morale1.PNG'" onmouseout="if(Speciation!=1){this.src='Assets/Traits/Morale0.PNG'}" onclick="ExecuteSpeciation(1)"/>
			<img id="MoraleParticulator2" style="position: absolute; top: 50px; left:180px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale0.PNG" onmouseover="this.src='Assets/Traits/Morale2.PNG'" onmouseout="if(Speciation!=2){this.src='Assets/Traits/Morale0.PNG'}" onclick="ExecuteSpeciation(2)"/>
			</div>
			

			<img id="UnitTypeBar1" style="position:absolute; z-index:9; top: 140px" src="Assets/Miscellaneous/UnitTypeBar.PNG"/>
			<img id="UnitTypeBar2" style="position:absolute; z-index:9; top: 270px" src="Assets/Miscellaneous/UnitTypeBar.PNG"/>
			<img id="UnitTypeBar3" style="position:absolute; z-index:9; top: 400px" src="Assets/Miscellaneous/UnitTypeBar.PNG"/>
			<img id="UnitTypeBar4" style="position:absolute; z-index:9; top: 530px" src="Assets/Miscellaneous/UnitTypeBar.PNG"/>

			<div style="position:absolute; z-index:10; top: 143px;left:423px;width: 140px; height:31px">
			<p id="UnitType1" style="text-align: center; margin-top:7px">Infantry Units</p></div>
			<div style="position:absolute; z-index:10; top: 273px;left:423px;width: 140px; height:31px">
			<p id="UnitType2" style="text-align: center; margin-top:7px">Motorized Units</p></div>
			<div style="position:absolute; z-index:10; top: 403px;left:423px;width: 140px; height:31px">
			<p id="UnitType3" style="text-align: center; margin-top:7px">Armored Units</p></div>
			<div style="position:absolute; z-index:10; top: 533px;left:423px;width: 140px; height:31px">
			<p id="UnitType4" style="text-align: center; margin-top:7px">Artillery Units</p></div>






			<img id="UnitFrame1" style="position: absolute; top:175px; left: 5px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre1').src='Assets/Units/Move/'+Units[MontreIndexBasis+1].shortname+'Movement3.GIF'; MontreUnit(1+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre1').src='Assets/Units/Static/'+Units[MontreIndexBasis+1].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(1+MontreIndexBasis)"/>
			<img id="UnitFrame2" style="position: absolute; top:175px; left: 105px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre2').src='Assets/Units/Move/'+Units[MontreIndexBasis+2].shortname+'Movement3.GIF'; MontreUnit(2+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre2').src='Assets/Units/Static/'+Units[MontreIndexBasis+2].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(2+MontreIndexBasis)"/>
			<img id="UnitFrame3" style="position: absolute; top:175px; left: 205px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre3').src='Assets/Units/Move/'+Units[MontreIndexBasis+3].shortname+'Movement3.GIF'; MontreUnit(3+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre3').src='Assets/Units/Static/'+Units[MontreIndexBasis+3].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(3+MontreIndexBasis)"/>
			<img id="UnitFrame4" style="position: absolute; top:175px; left: 305px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre4').src='Assets/Units/Move/'+Units[MontreIndexBasis+4].shortname+'Movement3.GIF'; MontreUnit(4+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre4').src='Assets/Units/Static/'+Units[MontreIndexBasis+4].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(4+MontreIndexBasis)"/>
			<img id="UnitFrame5" style="position: absolute; top:175px; left: 405px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre5').src='Assets/Units/Move/'+Units[MontreIndexBasis+5].shortname+'Movement3.GIF'; MontreUnit(5+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre5').src='Assets/Units/Static/'+Units[MontreIndexBasis+5].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(5+MontreIndexBasis)"/>
			<img id="UnitFrame6" style="position: absolute; top:175px; left: 505px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre6').src='Assets/Units/Move/'+Units[MontreIndexBasis+6].shortname+'Movement3.GIF'; MontreUnit(6+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre6').src='Assets/Units/Static/'+Units[MontreIndexBasis+6].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(6+MontreIndexBasis)"/>
			<img id="UnitFrame7" style="position: absolute; top:175px; left: 605px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre7').src='Assets/Units/Move/'+Units[MontreIndexBasis+7].shortname+'Movement3.GIF'; MontreUnit(7+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre7').src='Assets/Units/Static/'+Units[MontreIndexBasis+7].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(7+MontreIndexBasis)"/>
			<img id="UnitFrame8" style="position: absolute; top:175px; left: 705px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre8').src='Assets/Units/Move/'+Units[MontreIndexBasis+8].shortname+'Movement3.GIF'; MontreUnit(8+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre8').src='Assets/Units/Static/'+Units[MontreIndexBasis+8].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(8+MontreIndexBasis)"/>
			<img id="UnitFrame9" style="position: absolute; top:175px; left: 805px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre9').src='Assets/Units/Move/'+Units[MontreIndexBasis+9].shortname+'Movement3.GIF'; MontreUnit(9+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre9').src='Assets/Units/Static/'+Units[MontreIndexBasis+9].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(9+MontreIndexBasis)"/>
			<img id="UnitFrame10" style="position: absolute; top:175px; left: 905px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre10').src='Assets/Units/Move/'+Units[MontreIndexBasis+10].shortname+'Movement3.GIF'; MontreUnit(10+MontreIndexBasis) " onmouseout="document.getElementById('UnitMontre10').src='Assets/Units/Static/'+Units[MontreIndexBasis+10].shortname+'3.PNG' " src="Assets/Units/Static/LightInf3.PNG" onclick="RecruitUnit(10+MontreIndexBasis)"/>
			<div style="position: absolute; top:249px; left:11px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag1" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:111px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag2" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:211px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag3" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:311px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag4" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:411px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag5" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:511px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag6" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:611px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag7" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:711px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag8" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:811px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag9" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:249px; left:911px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag10" style="margin-top:auto">₱75</p>
			</div>

			<img id="UnitUnderlayer1" style="position: absolute; top:175px; left: 5px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer2" style="position: absolute; top:175px; left: 105px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer3" style="position: absolute; top:175px; left: 205px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer4" style="position: absolute; top:175px; left: 305px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer5" style="position: absolute; top:175px; left: 405px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer6" style="position: absolute; top:175px; left: 505px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer7" style="position: absolute; top:175px; left: 605px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer8" style="position: absolute; top:175px; left: 705px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer9" style="position: absolute; top:175px; left: 805px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer10" style="position: absolute; top:175px; left: 905px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>

			<img id="UnitMontre1" style="position: absolute; top:195px; left: 23px; z-index:7;"/>
			<img id="UnitMontre1Mesh" style="position: absolute; top:195px; left: 23px; z-index:7;" src="Assets/Units/StaticMeshes/LightInfMesh3.PNG"/>
			<img id="UnitMontre2" style="position: absolute; top:195px; left: 123px; z-index:7;"/>
			<img id="UnitMontre2Mesh" style="position: absolute; top:195px; left: 123px; z-index:7;" src="Assets/Units/StaticMeshes/InfantryMesh3.PNG"/>
			<img id="UnitMontre3" style="position: absolute; top:195px; left: 223px; z-index:7;"/>
			<img id="UnitMontre3Mesh" style="position: absolute; top:195px; left: 223px; z-index:7;" src="Assets/Units/StaticMeshes/AssaultInfMesh3.PNG"/>
			<img id="UnitMontre4" style="position: absolute; top:195px; left: 323px; z-index:7;"/>
			<img id="UnitMontre4Mesh" style="position: absolute; top:195px; left: 323px; z-index:7;" src="Assets/Units/StaticMeshes/SnipersMesh3.PNG"/>
			<img id="UnitMontre5" style="position: absolute; top:195px; left: 423px; z-index:7;"/>
			<img id="UnitMontre5Mesh" style="position: absolute; top:195px; left: 423px; z-index:7;" src="Assets/Units/StaticMeshes/MarinesMesh3.PNG"/>
			<img id="UnitMontre6" style="position: absolute; top:195px; left: 523px; z-index:7;"/>
			<img id="UnitMontre6Mesh" style="position: absolute; top:195px; left: 523px; z-index:7;" src="Assets/Units/StaticMeshes/StormtroopersMesh3.PNG"/>
			<img id="UnitMontre7" style="position: absolute; top:195px; left: 623px; z-index:7;"/>
			<img id="UnitMontre7Mesh" style="position: absolute; top:195px; left: 623px; z-index:7;" src="Assets/Units/StaticMeshes/SpecOpsMesh3.PNG"/>
			<img id="UnitMontre8" style="position: absolute; top:195px; left: 723px; z-index:7;"/>
			<img id="UnitMontre8Mesh" style="position: absolute; top:195px; left: 723px; z-index:7;" src="Assets/Units/StaticMeshes/GuardsMesh3.PNG"/>
			<img id="UnitMontre9" style="position: absolute; top:195px; left: 823px; z-index:7;"/>
			<img id="UnitMontre9Mesh" style="position: absolute; top:195px; left: 823px; z-index:7;" src="Assets/Units/StaticMeshes/SuicideMesh3.PNG"/>
			<img id="UnitMontre10" style="position: absolute; top:195px; left: 923px; z-index:7;"/>
			<img id="UnitMontre10Mesh" style="position: absolute; top:195px; left: 923px; z-index:7;" src="Assets/Units/StaticMeshes/PaladinMesh3.PNG"/>

			<img id="Obturator1" style="position: absolute; visibility: hidden; top:175px; left: 5px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator2" style="position: absolute; visibility: hidden; top:175px; left: 105px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator3" style="position: absolute; visibility: hidden; top:175px; left: 205px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator4" style="position: absolute; visibility: hidden; top:175px; left: 305px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator5" style="position: absolute; visibility: hidden; top:175px; left: 405px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator6" style="position: absolute; visibility: hidden; top:175px; left: 505px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator7" style="position: absolute; visibility: hidden; top:175px; left: 605px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator8" style="position: absolute; visibility: hidden; top:175px; left: 705px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator9" style="position: absolute; visibility: hidden; top:175px; left: 805px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator10" style="position: absolute; visibility: hidden; top:175px; left: 905px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>








			<img id="UnitFrame11" style="position: absolute; top:305px; left: 5px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre11').src='Assets/Units/Move/'+Units[11].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+11].shortname+'Movement2.GIF'; MontreUnit(11) " onmouseout="document.getElementById('UnitMontre11').src='Assets/Units/Static/'+Units[11].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(11)"/>
			<img id="UnitFrame12" style="position: absolute; top:305px; left: 105px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre12').src='Assets/Units/Move/'+Units[12].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+12].shortname+'Movement2.GIF'; MontreUnit(12) " onmouseout="document.getElementById('UnitMontre12').src='Assets/Units/Static/'+Units[12].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(12)"/>
			<img id="UnitFrame13" style="position: absolute; top:305px; left: 205px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre13').src='Assets/Units/Move/'+Units[13].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+13].shortname+'Movement2.GIF'; MontreUnit(13) " onmouseout="document.getElementById('UnitMontre13').src='Assets/Units/Static/'+Units[13].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(13)"/>
			<img id="UnitFrame14" style="position: absolute; top:305px; left: 305px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre14').src='Assets/Units/Move/'+Units[14].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+14].shortname+'Movement2.GIF'; MontreUnit(14) " onmouseout="document.getElementById('UnitMontre14').src='Assets/Units/Static/'+Units[14].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(14)"/>
			<img id="UnitFrame15" style="position: absolute; top:305px; left: 405px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre15').src='Assets/Units/Move/'+Units[15].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+15].shortname+'Movement2.GIF'; MontreUnit(15) " onmouseout="document.getElementById('UnitMontre15').src='Assets/Units/Static/'+Units[15].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(15)"/>
			<img id="UnitFrame16" style="position: absolute; top:305px; left: 505px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre16').src='Assets/Units/Move/'+Units[16].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+16].shortname+'Movement2.GIF'; MontreUnit(16) " onmouseout="document.getElementById('UnitMontre16').src='Assets/Units/Static/'+Units[16].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(16)"/>
			<img id="UnitFrame17" style="position: absolute; top:305px; left: 605px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre17').src='Assets/Units/Move/'+Units[17].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+17].shortname+'Movement2.GIF'; MontreUnit(17) " onmouseout="document.getElementById('UnitMontre17').src='Assets/Units/Static/'+Units[17].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(17)"/>
			<img id="UnitFrame18" style="position: absolute; top:305px; left: 705px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre18').src='Assets/Units/Move/'+Units[18].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+18].shortname+'Movement2.GIF'; MontreUnit(18) " onmouseout="document.getElementById('UnitMontre18').src='Assets/Units/Static/'+Units[18].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(18)"/>
			<img id="UnitFrame19" style="position: absolute; top:305px; left: 805px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre19').src='Assets/Units/Move/'+Units[19].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+19].shortname+'Movement2.GIF'; MontreUnit(19) " onmouseout="document.getElementById('UnitMontre19').src='Assets/Units/Static/'+Units[19].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(19)"/>
			<img id="UnitFrame20" style="position: absolute; top:305px; left: 905px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre20').src='Assets/Units/Move/'+Units[20].shortname+'Movement3.GIF'; document.getElementById('UnitMontre').src='Assets/Units/Move/'+Units[MontreIndexBasis+20].shortname+'Movement2.GIF'; MontreUnit(20) " onmouseout="document.getElementById('UnitMontre20').src='Assets/Units/Static/'+Units[20].shortname+'3.PNG' " src="Assets/Units/Static/MotorInf3.PNG" onclick="RecruitUnit(20)"/>	


			<div style="position: absolute; top:379px; left:11px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag11" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:111px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag12" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:211px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag13" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:311px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag14" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:411px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag15" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:511px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag16" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:611px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag17" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:711px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag18" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:811px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag19" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:379px; left:911px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag20" style="margin-top:auto">₱75</p>
			</div>

			<img id="UnitUnderlayer11" style="position: absolute; top:305px; left: 5px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer12" style="position: absolute; top:305px; left: 105px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer13" style="position: absolute; top:305px; left: 205px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer14" style="position: absolute; top:305px; left: 305px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer15" style="position: absolute; top:305px; left: 405px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer16" style="position: absolute; top:305px; left: 505px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer17" style="position: absolute; top:305px; left: 605px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer18" style="position: absolute; top:305px; left: 705px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer19" style="position: absolute; top:305px; left: 805px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer20" style="position: absolute; top:305px; left: 905px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>	

			<img id="UnitMontre11" style="position: absolute; top:325px; left: 23px; z-index:7;"/>
			<img id="UnitMontre11Mesh" style="position: absolute; top:325px; left: 23px; z-index:7;" src="Assets/Units/StaticMeshes/CavalryMesh3.PNG"/>
			<img id="UnitMontre12" style="position: absolute; top:325px; left: 123px; z-index:7;"/>
			<img id="UnitMontre12Mesh" style="position: absolute; top:325px; left: 123px; z-index:7;" src="Assets/Units/StaticMeshes/MotorInfMesh3.PNG"/>
			<img id="UnitMontre13" style="position: absolute; top:325px; left: 223px; z-index:7;"/>
			<img id="UnitMontre13Mesh" style="position: absolute; top:325px; left: 223px; z-index:7;" src="Assets/Units/StaticMeshes/SupplyMesh3.PNG"/>
			<img id="UnitMontre14" style="position: absolute; top:325px; left: 323px; z-index:7;"/>
			<img id="UnitMontre14Mesh" style="position: absolute; top:325px; left: 323px; z-index:7;" src="Assets/Units/StaticMeshes/FlakMesh3.PNG"/>
			<img id="UnitMontre15" style="position: absolute; top:325px; left: 423px; z-index:7;"/>
			<img id="UnitMontre15Mesh" style="position: absolute; top:325px; left: 423px; z-index:7;" src="Assets/Units/StaticMeshes/CrabMesh3.PNG"/>
			<img id="UnitMontre16" style="position: absolute; top:325px; left: 523px; z-index:7;"/>
			<img id="UnitMontre16Mesh" style="position: absolute; top:325px; left: 523px; z-index:7;" src="Assets/Units/StaticMeshes/SCADPMesh3.PNG"/>
			<img id="UnitMontre17" style="position: absolute; top:325px; left: 623px; z-index:7;"/>
			<img id="UnitMontre17Mesh" style="position: absolute; top:325px; left: 623px; z-index:7;" src="Assets/Units/StaticMeshes/WarmachineMesh3.PNG"/>
			<img id="UnitMontre18" style="position: absolute; top:325px; left: 723px; z-index:7;"/>
			<img id="UnitMontre18Mesh" style="position: absolute; top:325px; left: 723px; z-index:7;" src="Assets/Units/StaticMeshes/SisuMesh3.PNG"/>
			<img id="UnitMontre19" style="position: absolute; top:325px; left: 823px; z-index:7;"/>
			<img id="UnitMontre19Mesh" style="position: absolute; top:325px; left: 823px; z-index:7;" src="Assets/Units/StaticMeshes/MegacockterMesh3.PNG"/>
			<img id="UnitMontre20" style="position: absolute; top:325px; left: 923px; z-index:7;"/>
			<img id="UnitMontre20Mesh" style="position: absolute; top:325px; left: 923px; z-index:7;" src="Assets/Units/StaticMeshes/AYINMesh3.PNG"/>

			<img id="Obturator11" style="position: absolute; visibility: hidden; top:305px; left: 5px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator12" style="position: absolute; visibility: hidden; top:305px; left: 105px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator13" style="position: absolute; visibility: hidden; top:305px; left: 205px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator14" style="position: absolute; visibility: hidden; top:305px; left: 305px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator15" style="position: absolute; visibility: hidden; top:305px; left: 405px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator16" style="position: absolute; visibility: hidden; top:305px; left: 505px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator17" style="position: absolute; visibility: hidden; top:305px; left: 605px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator18" style="position: absolute; visibility: hidden; top:305px; left: 705px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator19" style="position: absolute; visibility: hidden; top:305px; left: 805px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator20" style="position: absolute; visibility: hidden; top:305px; left: 905px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>













			<img id="UnitFrame21" style="position: absolute; top:435px; left: 5px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre21').src='Assets/Units/Move/'+Units[21].shortname+'Movement3.GIF' ; MontreUnit(21)" src="Assets/Units/Static/Cockroach3.PNG" onmouseout="UnmontreUnit(21)" src="Assets/Units/Static/Cockroach3.PNG" onclick="RecruitUnit(21)"/>
			<img id="UnitFrame22" style="position: absolute; top:435px; left: 105px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre22').src='Assets/Units/Move/'+Units[22].shortname+'Movement3.GIF' ; MontreUnit(22)" src="Assets/Units/Static/Bolt3.PNG" onmouseout="UnmontreUnit(22)" src="Assets/Units/Static/Bolt3.PNG" onclick="RecruitUnit(22)"/>
			<img id="UnitFrame23" style="position: absolute; top:435px; left: 205px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre23').src='Assets/Units/Move/'+Units[23].shortname+'Movement3.GIF' ; MontreUnit(23)" src="Assets/Units/Static/Asekara3.PNG" onmouseout="UnmontreUnit(23)" onclick="RecruitUnit(23)"/>
			<img id="UnitFrame24" style="position: absolute; top:435px; left: 305px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre24').src='Assets/Units/Move/'+Units[24].shortname+'Movement3.GIF' ; MontreUnit(24)" src="Assets/Units/Static/Gorlitz3.PNG" onmouseout="UnmontreUnit(24)" src="Assets/Units/Static/Gorlitz3.PNG" onclick="RecruitUnit(24)"/>
			<img id="UnitFrame25" style="position: absolute; top:435px; left: 405px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre25').src='Assets/Units/Move/'+Units[25].shortname+'Movement3.GIF' ; MontreUnit(25)" src="Assets/Units/Static/Hunter3.PNG" onmouseout="UnmontreUnit(25)" src="Assets/Units/Static/Hunter3.PNG" onclick="RecruitUnit(25)"/>
			<img id="UnitFrame26" style="position: absolute; top:435px; left: 505px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre26').src='Assets/Units/Move/'+Units[26].shortname+'Movement3.GIF' ; MontreUnit(26)" src="Assets/Units/Static/AMPAC3.PNG" onmouseout="UnmontreUnit(26)" src="Assets/Units/Static/AMPAC3.PNG" onclick="RecruitUnit(26)"/>
			<img id="UnitFrame27" style="position: absolute; top:435px; left: 605px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre27').src='Assets/Units/Move/'+Units[27].shortname+'Movement3.GIF' ; MontreUnit(27)" src="Assets/Units/Static/Koschei3.PNG" onmouseout="UnmontreUnit(27)" src="Assets/Units/Static/Koschei3.PNG" onclick="RecruitUnit(27)"/>
			<img id="UnitFrame28" style="position: absolute; top:435px; left: 705px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre28').src='Assets/Units/Move/'+Units[28].shortname+'Movement3.GIF' ; MontreUnit(28) " src="Assets/Units/Static/Imperterritus3.PNG" onmouseout="UnmontreUnit(28)" src="Assets/Units/Static/Imperterritus3.PNG" onclick="RecruitUnit(28)"/>
			<img id="UnitFrame29" style="position: absolute; top:435px; left: 805px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre29').src='Assets/Units/Move/'+Units[29].shortname+'Movement3.GIF' ; MontreUnit(29)" src="Assets/Units/Static/Entwicklung3.PNG" onmouseout="UnmontreUnit(29)" src="Assets/Units/Static/Cockroach3.PNG" onclick="RecruitUnit(29)"/>
			<img id="UnitFrame30" style="position: absolute; top:435px; left: 905px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre30').src='Assets/Units/Move/'+Units[30].shortname+'Movement3.GIF' ; MontreUnit(30)" src="Assets/Units/Static/Roland3.PNG" onmouseout="UnmontreUnit(30)" src="Assets/Units/Static/Cockroach3.PNG" onclick="RecruitUnit(30)"/>


			<div style="position: absolute; top:509px; left:11px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag21" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:111px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag22" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:211px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag23" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:311px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag24" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:411px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag25" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:511px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag26" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:611px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag27" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:711px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag28" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:811px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag29" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:509px; left:911px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag30" style="margin-top:auto">₱75</p>
			</div>

			<img id="UnitUnderlayer21" style="position: absolute; top:435px; left: 5px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer22" style="position: absolute; top:435px; left: 105px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer23" style="position: absolute; top:435px; left: 205px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer24" style="position: absolute; top:435px; left: 305px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer25" style="position: absolute; top:435px; left: 405px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer26" style="position: absolute; top:435px; left: 505px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer27" style="position: absolute; top:435px; left: 605px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer28" style="position: absolute; top:435px; left: 705px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer29" style="position: absolute; top:435px; left: 805px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer30" style="position: absolute; top:435px; left: 905px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>

			<img id="UnitMontre21" style="position: absolute; top:455px; left: 23px; z-index:7;"/>
			<img id="UnitMontre21Mesh" style="position: absolute; top:455px; left: 23px; z-index:7;" src="Assets/Units/StaticMeshes/CockroachMesh3.PNG"/>
			<img id="UnitMontre22" style="position: absolute; top:455px; left: 123px; z-index:7;"/>
			<img id="UnitMontre22Mesh" style="position: absolute; top:455px; left: 123px; z-index:7;" src="Assets/Units/StaticMeshes/BoltMesh3.PNG"/>
			<img id="UnitMontre23" style="position: absolute; top:455px; left: 223px; z-index:7;"/>
			<img id="UnitMontre23Mesh" style="position: absolute; top:455px; left: 223px; z-index:7;" src="Assets/Units/StaticMeshes/AsekaraMesh3.PNG"/>
			<img id="UnitMontre24" style="position: absolute; top:455px; left: 323px; z-index:7;"/>
			<img id="UnitMontre24Mesh" style="position: absolute; top:455px; left: 323px; z-index:7;" src="Assets/Units/StaticMeshes/GorlitzMesh3.PNG"/>
			<img id="UnitMontre25" style="position: absolute; top:455px; left: 423px; z-index:7;"/>
			<img id="UnitMontre25Mesh" style="position: absolute; top:455px; left: 423px; z-index:7;" src="Assets/Units/StaticMeshes/HunterMesh3.PNG"/>
			<img id="UnitMontre26" style="position: absolute; top:455px; left: 520px; z-index:7;"/>
			<img id="UnitMontre26Mesh" style="position: absolute; top:455px; left: 520px; z-index:7;" src="Assets/Units/StaticMeshes/AMPACMesh3.PNG"/>
			<img id="UnitMontre27" style="position: absolute; top:455px; left: 623px; z-index:7;"/>
			<img id="UnitMontre27Mesh" style="position: absolute; top:455px; left: 623px; z-index:7;" src="Assets/Units/StaticMeshes/KoscheiMesh3.PNG"/>
			<img id="UnitMontre28" style="position: absolute; top:450px; left: 701px; z-index:7;"/>
			<img id="UnitMontre28Mesh" style="position: absolute; top:455px; left: 701px; z-index:7;" src="Assets/Units/StaticMeshes/ImperterritusMesh3.PNG"/>
			<img id="UnitMontre29" style="position: absolute; top:455px; left: 823px; z-index:7;"/>
			<img id="UnitMontre29Mesh" style="position: absolute; top:455px; left: 823px; z-index:7;" src="Assets/Units/StaticMeshes/EntwiklungMesh3.PNG"/>
			<img id="UnitMontre30" style="position: absolute; top:455px; left: 923px; z-index:7;"/>
			<img id="UnitMontre30Mesh" style="position: absolute; top:455px; left: 923px; z-index:7;" src="Assets/Units/StaticMeshes/RolandMesh3.PNG"/>

			<img id="Obturator21" style="position: absolute; visibility: hidden; top:435px; left: 5px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator22" style="position: absolute; visibility: hidden; top:435px; left: 105px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator23" style="position: absolute; visibility: hidden; top:435px; left: 205px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator24" style="position: absolute; visibility: hidden; top:435px; left: 305px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator25" style="position: absolute; visibility: hidden; top:435px; left: 405px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator26" style="position: absolute; visibility: hidden; top:435px; left: 505px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator27" style="position: absolute; visibility: hidden; top:435px; left: 605px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator28" style="position: absolute; visibility: hidden; top:435px; left: 705px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator29" style="position: absolute; visibility: hidden; top:435px; left: 805px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator30" style="position: absolute; visibility: hidden; top:435px; left: 905px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>












			<img id="UnitFrame31" style="position: absolute; top:565px; left: 5px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre31').src='Assets/Units/Move/'+Units[31].shortname+'Movement3.GIF'; MontreUnit(31)" onmouseout="document.getElementById('UnitMontre31').src='Assets/Units/Static/'+Units[31].shortname+'3.PNG' " src="Assets/Units/Static/Howitzer3.PNG" onclick="RecruitUnit(31)"/>
			<img id="UnitFrame32" style="position: absolute; top:565px; left: 105px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre32').src='Assets/Units/Move/'+Units[32].shortname+'Movement3.GIF'; MontreUnit(32)" onmouseout="document.getElementById('UnitMontre32').src='Assets/Units/Static/'+Units[32].shortname+'3.PNG' " src="Assets/Units/Static/Trablek3.PNG" onclick="RecruitUnit(32)"/>
			<img id="UnitFrame33" style="position: absolute; top:565px; left: 205px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre33').src='Assets/Units/Move/'+Units[33].shortname+'Movement3.GIF'; MontreUnit(33)" onmouseout="document.getElementById('UnitMontre33').src='Assets/Units/Static/'+Units[33].shortname+'3.PNG' " src="Assets/Units/Static/Hellstorm3.PNG" onclick="RecruitUnit(33)"/>
			<img id="UnitFrame34" style="position: absolute; top:565px; left: 305px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre34').src='Assets/Units/Move/'+Units[34].shortname+'Movement3.GIF'; MontreUnit(34)" onmouseout="document.getElementById('UnitMontre34').src='Assets/Units/Static/'+Units[34].shortname+'3.PNG' " src="Assets/Units/Static/SPAB3.PNG" onclick="RecruitUnit(34)"/>
			<img id="UnitFrame35" style="position: absolute; top:565px; left: 405px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre35').src='Assets/Units/Move/'+Units[35].shortname+'Movement3.GIF'; MontreUnit(35)" onmouseout="document.getElementById('UnitMontre35').src='Assets/Units/Static/'+Units[35].shortname+'3.PNG' " src="Assets/Units/Static/Bertha3.PNG" onclick="RecruitUnit(35)"/>
			<img id="UnitFrame36" style="position: absolute; top:565px; left: 505px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre36').src='Assets/Units/Move/'+Units[36].shortname+'Movement3.GIF'; MontreUnit(36)" onmouseout="document.getElementById('UnitMontre36').src='Assets/Units/Static/'+Units[36].shortname+'3.PNG' " src="Assets/Units/Static/Pula3.PNG" onclick="RecruitUnit(36)"/>
			<img id="UnitFrame37" style="position: absolute; top:565px; left: 605px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre37').src='Assets/Units/Move/'+Units[37].shortname+'Movement3.GIF'; MontreUnit(37)" onmouseout="document.getElementById('UnitMontre37').src='Assets/Units/Static/'+Units[37].shortname+'3.PNG' " src="Assets/Units/Static/AYIN3.PNG" onclick="RecruitUnit(37)"/>
			<img id="UnitFrame38" style="position: absolute; top:565px; left: 705px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre38').src='Assets/Units/Move/'+Units[38].shortname+'Movement3.GIF'; MontreUnit(38)" onmouseout="document.getElementById('UnitMontre38').src='Assets/Units/Static/'+Units[38].shortname+'3.PNG' " src="Assets/Units/Static/Howitzer3.PNG" onclick="RecruitUnit(38)"/>
			<img id="UnitFrame39" style="position: absolute; top:565px; left: 805px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre39').src='Assets/Units/Move/'+Units[39].shortname+'Movement3.GIF'; MontreUnit(39)" onmouseout="document.getElementById('UnitMontre39').src='Assets/Units/Static/'+Units[39].shortname+'3.PNG' " src="Assets/Units/Static/Howitzer3.PNG" onclick="RecruitUnit(39)"/>
			<img id="UnitFrame40" style="position: absolute; top:565px; left: 905px; z-index:8" src="Assets/Miscellaneous/UnitAvailableFrame.PNG" onmouseover="document.getElementById('UnitMontre40').src='Assets/Units/Move/'+Units[40].shortname+'Movement3.GIF'; MontreUnit(40)" onmouseout="document.getElementById('UnitMontre40').src='Assets/Units/Static/'+Units[40].shortname+'3.PNG' " src="Assets/Units/Static/Howitzer3.PNG" onclick="RecruitUnit(40)"/>


			<div style="position: absolute; top:639px; left:11px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag31" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:111px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag32" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:211px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag33" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:311px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag34" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:411px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag35" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:511px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag36" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:611px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag37" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:711px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag38" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:811px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag39" style="margin-top:auto">₱75</p>
			</div>
			<div style="position: absolute; top:639px; left:911px; z-index:8; width:80px; height:20px; text-align:center">
				<p id="PriceTag40" style="margin-top:auto">₱75</p>
			</div>

			<img id="UnitUnderlayer31" style="position: absolute; top:565px; left: 5px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer32" style="position: absolute; top:565px; left: 105px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer33" style="position: absolute; top:565px; left: 205px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer34" style="position: absolute; top:565px; left: 305px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer35" style="position: absolute; top:565px; left: 405px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer36" style="position: absolute; top:565px; left: 505px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer37" style="position: absolute; top:565px; left: 605px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer38" style="position: absolute; top:565px; left: 705px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer39" style="position: absolute; top:565px; left: 805px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>
			<img id="UnitUnderlayer40" style="position: absolute; top:565px; left: 905px; z-index:7,5" src="Assets/Miscellaneous/UnitUnderlayerFrame.PNG"/>

			<img id="UnitMontre31" style="position: absolute; top:585px; left: 23px; z-index:7;"/>
			<img id="UnitMontre31Mesh" style="position: absolute; top:585px; left: 23px; z-index:7;" src="Assets/Units/StaticMeshes/HowitzerMesh3.PNG"/>
			<img id="UnitMontre32" style="position: absolute; top:585px; left: 123px; z-index:7;"/>
			<img id="UnitMontre32Mesh" style="position: absolute; top:585px; left: 123px; z-index:7;" src="Assets/Units/StaticMeshes/AAMesh3.PNG"/>
			<img id="UnitMontre33" style="position: absolute; top:585px; left: 223px; z-index:7;"/>
			<img id="UnitMontre33Mesh" style="position: absolute; top:585px; left: 223px; z-index:7;" src="Assets/Units/StaticMeshes/ATMesh3.PNG"/>
			<img id="UnitMontre34" style="position: absolute; top:585px; left: 323px; z-index:7;"/>
			<img id="UnitMontre34Mesh" style="position: absolute; top:585px; left: 323px; z-index:7;" src="Assets/Units/StaticMeshes/MoldanMesh3.PNG"/>
			<img id="UnitMontre35" style="position: absolute; top:585px; left: 423px; z-index:7;"/>
			<img id="UnitMontre35Mesh" style="position: absolute; top:585px; left: 423px; z-index:7;" src="Assets/Units/StaticMeshes/SPABMesh3.PNG"/>
			<img id="UnitMontre36" style="position: absolute; top:585px; left: 523px; z-index:7;"/>
			<img id="UnitMontre36Mesh" style="position: absolute; top:585px; left: 523px; z-index:7;" src="Assets/Units/StaticMeshes/RocketankMesh3.PNG"/>
			<img id="UnitMontre37" style="position: absolute; top:585px; left: 623px; z-index:7;"/>
			<img id="UnitMontre37Mesh" style="position: absolute; top:585px; left: 623px; z-index:7;" src="Assets/Units/StaticMeshes/BerthaMesh3.PNG"/>
			<img id="UnitMontre38" style="position: absolute; top:585px; left: 723px; z-index:7;"/>
			<img id="UnitMontre38Mesh" style="position: absolute; top:585px; left: 723px; z-index:7;" src="Assets/Units/StaticMeshes/PulaMesh3.PNG"/>
			<img id="UnitMontre39" style="position: absolute; top:585px; left: 823px; z-index:7;"/>
			<img id="UnitMontre39Mesh" style="position: absolute; top:585px; left: 823px; z-index:7;" src="Assets/Units/StaticMeshes/TugarinMesh3.PNG"/>
			<img id="UnitMontre40" style="position: absolute; top:585px; left: 923px; z-index:7;"/>
			<img id="UnitMontre40Mesh" style="position: absolute; top:585px; left: 923px; z-index:7;" src="Assets/Units/StaticMeshes/BrimstoneMesh3.PNG"/>

			<img id="Obturator31" style="position: absolute; visibility: hidden; top:565px; left: 5px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator32" style="position: absolute; visibility: hidden; top:565px; left: 105px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator33" style="position: absolute; visibility: hidden; top:565px; left: 205px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator34" style="position: absolute; visibility: hidden; top:565px; left: 305px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator35" style="position: absolute; visibility: hidden; top:565px; left: 405px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator36" style="position: absolute; visibility: hidden; top:565px; left: 505px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator37" style="position: absolute; visibility: hidden; top:565px; left: 605px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator38" style="position: absolute; visibility: hidden; top:565px; left: 705px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator39" style="position: absolute; visibility: hidden; top:565px; left: 805px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>
			<img id="Obturator40" style="position: absolute; visibility: hidden; top:565px; left: 905px; z-index:9" src="Assets/Miscellaneous/UnitLockedFrame.PNG"/>

	


		</div>



	<img id="RightScrollBar" style="position: absolute; width: 25px; height: 558px; top:1px; left:535px; z-index: 5" onmouseover="if(Map[0].length>10){this.src='Assets/Miscellaneous/ScrollBarRight.PNG'}else{this.src='Assets/Miscellaneous/Nothing.PNG'}" onmouseout="document.getElementById('RightScrollBar').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMap(2); document.getElementById('LeftScrollBar').style.visibility='inherit'; if(document.getElementById('UnitMap').scrollLeft>=Map.length*56-560){this.style.visibility='hidden'}">

	<img id="LeftScrollBar" style="position: absolute; width: 25px; height: 558px; top:1px; left:0px; z-index: 5" onmouseover="if(Map[0].length>10){document.getElementById('LeftScrollBar').src='Assets/Miscellaneous/ScrollBarLeft.PNG'}" onmouseout="document.getElementById('LeftScrollBar').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMap(4); document.getElementById('RightScrollBar').style.visibility='inherit'; if(document.getElementById('UnitMap').scrollLeft==0){this.style.visibility='hidden'}"/>

	<img id="TopScrollBar" style="position: absolute; width: 558px; height: 25px; top:0px; left:1px; z-index: 5" onmouseover="if(Map.length>10){document.getElementById('TopScrollBar').src='Assets/Miscellaneous/ScrollBarTop.PNG'}" onmouseout="document.getElementById('TopScrollBar').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMap(1); document.getElementById('BottomScrollBar').style.visibility='inherit'; if(document.getElementById('UnitMap').scrollTop==0){this.style.visibility='hidden'}"/>

	<img id="BottomScrollBar" style="position: absolute; width: 558px; height: 25px; top:535px; left:1px; z-index: 5" onmouseover="if(Map.length>10){document.getElementById('BottomScrollBar').src='Assets/Miscellaneous/ScrollBarBottom.PNG'}" onmouseout="document.getElementById('BottomScrollBar').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMap(3); document.getElementById('TopScrollBar').style.visibility='inherit'; if(document.getElementById('UnitMap').scrollTop>=Map[0].length*56-560){this.style.visibility='hidden'}"/>
	</div>
<div id="EditorMap" style='position:absolute; visibility:hidden; top:10px; left:350px'>

	<div id="TileContainer" style="position:absolute; top:0px; left:0px; overflow:hidden; scroll-behavior: smooth;"></div>
	<img style="position: absolute; top: 595px; left: 588px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG'" onclick="document.getElementById('EditorMap').style.visibility='hidden'; document.getElementById('Main Menu').style.visibility='visible'" />

	<div id="Tilelist" style="position: absolute; left: -91px; top: -10px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" oncontextmenu="Tooltip(18)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';">
		<img src="Assets/Miscellaneous/EditorPanel.PNG"/>
		<img id="EditorTile1" style="position:absolute; top:10px; left:7px" src="Assets/Tiles/Plains.PNG" onclick="ChosenTerrain=TerrainLedger[0];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[0])" />
		<img id="EditorTile2" style="position:absolute; top:10px; left:7px" src="Assets/Tiles/Forest.PNG" onclick="ChosenTerrain=TerrainLedger[1];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[1])"/>
		<img id="EditorTile3" style="position:absolute; top:10px; left:7px" src="Assets/Tiles/Hills.PNG" onclick="ChosenTerrain=TerrainLedger[2];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[2])"/>
		<img id="EditorTile4" style="position:absolute; top:1px; left:7px" src="Assets/Tiles/Mountain.PNG" onclick="ChosenTerrain=TerrainLedger[3];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[3])"/>
		<img id="EditorTile5" style="position:absolute; top:47px; left:7px" src="Assets/Tiles/Megamountains.PNG" onclick="ChosenTerrain=TerrainLedger[4];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[4])"/>
		<img id="EditorTile6" style="position:absolute; top:68px; left:7px" src="Assets/Tiles/Road.PNG" onclick="ChosenTerrain=TerrainLedger[5];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[5])"/>
		<img id="EditorTile7" style="position:absolute; top:54px; left:7px" src="Assets/Tiles/Ruins.PNG" onclick="ChosenTerrain=TerrainLedger[6];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[6])"/>
		<img id="EditorTile8" style="position:absolute; top:54px; left:7px" src="Assets/Tiles/Urban District.PNG" onclick="ChosenTerrain=TerrainLedger[7];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[7])"/>
		<img id="EditorTile9" style="position:absolute; top:116px; left:7px" src="Assets/Tiles/Industrial District.PNG" onclick="ChosenTerrain=TerrainLedger[8];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[8])"/>
		<img id="EditorTile10" style="position:absolute; top:118px; left:7px" src="Assets/Tiles/Military-Industrial Complex.PNG" onclick="ChosenTerrain=TerrainLedger[9];EditationToggle='Tile'" oncontextmenu="FillMapEditor(TerrainLedger[9])"/>

		<img src="Assets/Miscellaneous/VertiPlaqueBIO.PNG" style="position: absolute; top: 2px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(1)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueLFT.PNG" style="position: absolute; top: 92px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(2)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueURB.PNG" style="position: absolute; top: 182px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(3)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueWFT.PNG" style="position: absolute; top: 272px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(4)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueCON.PNG" style="position: absolute; top: 362px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(5)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueBUI.PNG" style="position: absolute; top: 452px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(6)"/>
		<img src="Assets/Miscellaneous/VertiPlaqueOTH.PNG" style="position: absolute; top: 542px; left:-31px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ToggleTileBlock(7)"/>



		<img style="position:absolute; visibility: hidden; top:112px; left:140px" src="Assets/Tiles/Aviation Industrial Facility.PNG" onclick="ChosenTerrain=11;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:112px; left:203px" src="Assets/Tiles/Shipbuilding Facility.PNG" onclick="ChosenTerrain=12;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:184px; left:14px" src="Assets/Tiles/Headquarters.PNG" onclick="ChosenTerrain=13;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:166px; left:77px" src="Assets/Tiles/Command Center.PNG" onclick="ChosenTerrain=14;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:184px; left:140px" src="Assets/Tiles/Taiga.PNG" onclick="ChosenTerrain=15;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:184px; left:203px" src="Assets/Tiles/Desert.PNG" onclick="ChosenTerrain=16;EditationToggle='Tile'" oncontextmenu="FillMapEditor(16)"/>
		<img style="position:absolute; visibility: hidden; top:242px; left:14px" src="Assets/Tiles/Tundra.PNG" onclick="ChosenTerrain=17;EditationToggle='Tile'" oncontextmenu="FillMapEditor(17)"/>
		<img style="position:absolute; visibility: hidden; top:242px; left:77px" src="Assets/Tiles/Extreme Desert.PNG" onclick="ChosenTerrain=18;EditationToggle='Tile'" oncontextmenu="FillMapEditor(18)"/>
		<img style="position:absolute; visibility: hidden; top:242px; left:140px" src="Assets/Tiles/Arctic Hellhole.PNG" onclick="ChosenTerrain=19;EditationToggle='Tile'" oncontextmenu="FillMapEditor(19)"/>
		<img style="position:absolute; visibility: hidden; top:242px; left:203px" src="Assets/Tiles/Bridge.PNG" onclick="ChosenTerrain=20;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:300px; left:14px" src="Assets/Tiles/High Bridge.PNG" onclick="ChosenTerrain=21;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:300px; left:77px" src="Assets/Tiles/River.PNG" onclick="ChosenTerrain=22;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:300px; left:140px" src="Assets/Tiles/Sea.PNG" onclick="ChosenTerrain=23;EditationToggle='Tile'" oncontextmenu="FillMapEditor(23)"/>
		<img style="position:absolute; visibility: hidden; top:300px; left:203px" src="Assets/Tiles/Reef.PNG" onclick="ChosenTerrain=24;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:358px; left:14px" src="Assets/Tiles/Floes.PNG" onclick="ChosenTerrain=25;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:358px; left:77px" src="Assets/Tiles/Archipelago.PNG" onclick="ChosenTerrain=26;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:358px; left:140px" src="Assets/Tiles/Rock Formation.PNG" onclick="ChosenTerrain=27;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:358px; left:203px" src="Assets/Tiles/Icebergs.PNG" onclick="ChosenTerrain=28;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:416px; left:14px" src="Assets/Tiles/Shore.PNG" onclick="ChosenTerrain=29;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:407px; left:77px" src="Assets/Tiles/Oil Rig.PNG" onclick="ChosenTerrain=30;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:416px; left:140px" src="Assets/Tiles/Marsh.PNG" onclick="ChosenTerrain=31;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:408px; left:203px" src="Assets/Tiles/Volcano.PNG" onclick="ChosenTerrain=32;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:474px; left:14px" src="Assets/Tiles/Moon.PNG" onclick="ChosenTerrain=33;EditationToggle='Tile'" oncontextmenu="FillMapEditor(33)"/>
		<img style="position:absolute; visibility: hidden; top:474px; left:77px" src="Assets/Tiles/Mars.PNG" onclick="ChosenTerrain=34;EditationToggle='Tile'" oncontextmenu="FillMapEditor(34)"/>
		<img style="position:absolute; visibility: hidden; top:242px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:300px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:358px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:416px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:474px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		<img style="position:absolute; visibility: hidden; top:532px; left:203px" src="Assets/Tiles/Nothing.PNG" onclick="ChosenTerrain=1;EditationToggle='Tile'"/>
		</div>
		<p style="position: absolute; top:602px; left:-119px; z-index:3">↔</p>
		<p id="EditorWiPointer" style="position: absolute; top:602px; left:-98px; z-index:3">10</p>
		<p style="position: absolute; top:601px; left:-49px; z-index:3">↕</p>
		<p id="EditorHePointer" style="position: absolute; top:602px; left:-35px; z-index:3">10</p>

	<div id="regionMap" style="position:absolute; visibility: hidden; top:0px; left:0px; height:560px; width:560px; overflow:hidden; overflow-y:hidden;" oncontextmenu="Tooltip(23); document.getElementById('Backpanel').style.visibility='inherit'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';"></div>
	<div id="Backpanel" style="position: absolute; visibility: hidden; top:56px; left:560px; height:210px; z-index: 6; width:350px; border:5px solid black; background-color:grey">
		<input id="RegionNodeOwner" style="position: absolute; top:15px; left:110px">
		<input id="RegionNodeCapitol" style="position: absolute; top:50px; left:110px">
		<input id="RegionNodeName" style="position: absolute; top:85px; left:110px">
		<input id="RegionNodeX" style="position: absolute; top:120px; left:20px; width: 50px">
		<input id="RegionNodeY" style="position: absolute; top:155px; left:20px; width: 50px">
		<p id="RegionNodeOwnerP">Owner</p>
		<p id="RegionNodeCapitolP">Capitol Name</p>
		<p id="RegionNodeNameP">Region Name</p>
		<p>X</p>
		<p>Y</p>
		<button style="position: absolute; top:0px; left:330px; height: 20px; width:20px" onclick="document.getElementById('Backpanel').style.visibility='hidden'">X</button>
		<button id="RegionApplyP" style="position:absolute; top:140px; left:100px; width: 150px;" onclick="AddRegionalNode()">Add Regional Node</button>

		</div>

	<div id="EditorDetailPanel" style="position: absolute; visibility: hidden; top:56px; left:560px; height:280px; z-index: 6; width:350px; border:5px solid black; background-color:grey" oncontextmenu="Tooltip(22)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';">
		
		<input id="EditorNameDenominator" style="position: absolute; top:15px; left:110px" onkeyup="if(document.getElementById('EditorNameDenominator').value[0]=='#' && document.getElementById('EditorNameDenominator').value.length>1){let index=document.getElementById('EditorNameDenominator').value.slice(1); document.getElementById('MetadataNameI').innerHTML=Language.UnitSpecialNames[index]}else{document.getElementById('MetadataNameI').innerHTML=''}">
		<input id="EditorDescDenominator" style="position: absolute; top:70px; left:10px; width:210px; height:105px" onkeyup="if(document.getElementById('EditorDescDenominator').value[0]=='#' && document.getElementById('EditorDescDenominator').value.length>1){let index=document.getElementById('EditorDescDenominator').value.slice(1); document.getElementById('MetadataDescI').innerHTML=Language.UnitSpecialDesc[index]}else{document.getElementById('MetadataDescI').innerHTML=''}">
		<input id="EditorLifeDenominator" style="position: absolute; top:185px; left:110px">
		<input id="EditorMoraleDenominator" style="position: absolute; top:225px; left:110px">
		<p id="MetadataNameP">Name</p>
		<p id="MetadataDescP">Description</p>
		<p id="MetadataHealthP" style="position: absolute; top:170px">Health Index</p>
		<p id="MetadataMoraleP" style="position: absolute; top:210px">Morale Index</p>
		<p id="MetadataNameI" style="position: absolute; top:13px; left:175px; color:blue; font-size:8px">Test</p>
		<p id="MetadataDescI" style="position: absolute; top:113px; left:70px; color:blue; font-size:8px">Test</p>

		<button style="position: absolute; left:330px; top:0px; width:20px; height:20px" onclick="document.getElementById('EditorDetailPanel').style.visibility='hidden'">X</button>
		<button id="MetadataApplyP" style="position: absolute; left:140px; top:250px" onclick="CustomizeTile()">Apply</button>

	</div>
	
	<div id="Unitlist" style="position: absolute; left: 581px; top: -10px" oncontextmenu="Tooltip(19)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';">
		<img src="Assets/Miscellaneous/EditorPanelAlter.PNG"/>
		<img id="EditorUnitShowcase1" style="position:absolute; top:10px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/LightInf2.PNG" onclick="ChosenUnit=1;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase2" style="position:absolute; top:68px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Infantry2.PNG" onclick="ChosenUnit=2;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase3" style="position:absolute; top:126px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/AssaultInf2.PNG" onclick="ChosenUnit=3;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase4" style="position:absolute; top:184px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Snipers2.PNG" onclick="ChosenUnit=4;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase5" style="position:absolute; top:242px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Marines2.PNG" onclick="ChosenUnit=5;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase6" style="position:absolute; top:300px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Stormtroopers2.PNG" onclick="ChosenUnit=6;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase7" style="position:absolute; top:358px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/SpecOps2.PNG" onclick="ChosenUnit=7;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase8" style="position:absolute; top:416px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Guards2.PNG" onclick="ChosenUnit=8;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase9" style="position:absolute; top:474px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Suicide2.PNG" onclick="ChosenUnit=9;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase10" style="position:absolute; top:532px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Units/Static/Paladin2.PNG" onclick="ChosenUnit=10;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh1" style="position:absolute; top:10px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=1;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh2" style="position:absolute; top:68px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=2;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh3" style="position:absolute; top:126px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=3;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh4" style="position:absolute; top:184px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=4;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh5" style="position:absolute; top:242px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=5;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh6" style="position:absolute; top:300px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=6;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh7" style="position:absolute; top:358px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=7;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh8" style="position:absolute; top:416px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=8;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh9" style="position:absolute; top:474px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=9;EditationToggle='Unit'"/>
		<img id="EditorUnitMesh10" style="position:absolute; top:532px; left:14px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/Nothing.PNG" onclick="ChosenUnit=10;EditationToggle='Unit'"/>
		<!--
		<img id="EditorUnitShowcase11" style="position:absolute; top:126px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Gorlitz2.PNG" onclick="ChosenUnit=11;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase12" style="position:absolute; top:126px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Flak2.PNG" onclick="ChosenUnit=12;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase13" style="position:absolute; top:184px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Hunter2.PNG" onclick="ChosenUnit=13;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase14" style="position:absolute; top:184px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Imperterritus2.PNG" onclick="ChosenUnit=14;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase15" style="position:absolute; top:184px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Koschei2.PNG" onclick="ChosenUnit=15;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase16" style="position:absolute; top:184px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Thunder2.PNG" onclick="ChosenUnit=16;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase17" style="position:absolute; top:242px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Crab2.PNG" onclick="ChosenUnit=17;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase18" style="position:absolute; top:242px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/AMPAC2.PNG" onclick="ChosenUnit=18;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase19" style="position:absolute; top:242px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Howitzer2.PNG" onclick="ChosenUnit=19;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase20" style="position:absolute; top:242px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Hellstorm2.PNG" onclick="ChosenUnit=20;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase21" style="position:absolute; top:300px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/SCADP2.PNG" onclick="ChosenUnit=21;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase22" style="position:absolute; top:300px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Raptor2.PNG" onclick="ChosenUnit=22;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase23" style="position:absolute; top:300px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Eagle2.PNG" onclick="ChosenUnit=23;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase24" style="position:absolute; top:300px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Condor2.PNG" onclick="ChosenUnit=24;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase25" style="position:absolute; top:358px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Torpedor2.PNG" onclick="ChosenUnit=25;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase26" style="position:absolute; top:358px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Zeus2.PNG" onclick="ChosenUnit=26;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase27" style="position:absolute; top:358px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Intrepid2.PNG" onclick="ChosenUnit=27;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase28" style="position:absolute; top:358px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Submersible2.PNG" onclick="ChosenUnit=28;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase29" style="position:absolute; top:416px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Destroyer2.PNG" onclick="ChosenUnit=29;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase30" style="position:absolute; top:416px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/CruiserL2.PNG" onclick="ChosenUnit=30;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase31" style="position:absolute; top:416px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/CruiserH2.PNG" onclick="ChosenUnit=31;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase32" style="position:absolute; top:416px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Battleship2.PNG" onclick="ChosenUnit=32;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase33" style="position:absolute; top:474px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Carrier2.PNG" onclick="ChosenUnit=33;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase34" style="position:absolute; top:474px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Barricade.PNG" onclick="ChosenUnit=34;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase35" style="position:absolute; top:474px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Bunker2.PNG" onclick="ChosenUnit=35;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase36" style="position:absolute; top:474px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Turret2.PNG" onclick="ChosenUnit=36;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase37" style="position:absolute; top:532px; left:14px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/FlakTower2.PNG" onclick="ChosenUnit=37;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase38" style="position:absolute; top:532px; left:77px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Coastal.PNG" onclick="ChosenUnit=38;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase39" style="position:absolute; top:532px; left:140px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Radar2.PNG" onclick="ChosenUnit=39;EditationToggle='Unit'"/>
		<img id="EditorUnitShowcase40" style="position:absolute; top:532px; left:203px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Units/Static/Silo2.PNG" onclick="ChosenUnit=40;EditationToggle='Unit'"/>	
		-->					
		</div>
	<img src="Assets/Miscellaneous/VertiPlaqueINF.PNG" style="position: absolute; top: -7px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(1)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueMOT.PNG" style="position: absolute; top: 83px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(2)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueARM.PNG" style="position: absolute; top: 173px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(3)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueART.PNG" style="position: absolute; top: 263px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(4)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueAVI.PNG" style="position: absolute; top: 353px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(5)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueNAV.PNG" style="position: absolute; top: 443px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(6)"/>
	<img src="Assets/Miscellaneous/VertiPlaqueSTR.PNG" style="position: absolute; top: 533px; left:721px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ShowcaseUnitCategory(7)"/>



	<div style="position: absolute; visibility: hidden; top:-610px; z-index: 2;">
	<button id="EditorP1" style="position:absolute;top:560px;left:0px; width:140px; height:21px" onclick="RetrieveMapCode()" oncontextmenu="EditorMap=REPOZITORIUL1.Map;RefreshMapEditor()">Fetch Grid Data</button>
	<button id="EditorP2" style="position:absolute;top:560px;left:140px; width:140px; height:21px" onclick="RetrieveControlCode()" oncontextmenu="EditorControlMap=REPOZITORIUL1.ControlMap;RefreshMapEditor()">Fetch Building Data</button>
	<button id="EditorP3" style="position:absolute;top:560px;left:280px; width:140px; height:21px" onclick="RetrieveRosterCode()" oncontextmenu="for(let a=0;a<EditorMap.length;a++){for(let b=0;b<EditorMap[0].length;b++){EditorEntityMap[a][b]=0}};for(let c=1;c<REPOZITORIUL1.Roster.length;c++){EditorEntityMap[REPOZITORIUL1.Roster[c].x][REPOZITORIUL1.Roster[c].y]=REPOZITORIUL1.Roster[c]};RefreshMapEditor()">Fetch Roster</button>
	<button id="EditorP4" style="position:absolute;top:560px;left:420px; width:140px; height:21px" onclick="RetrieveRegionCode()" oncontextmenu="for(let a=0;a<REPOZITORIUL1.NodeMap.length;a++){CapitolNodeRegistry[REPOZITORIUL1.NodeMap[a].CapitolX][REPOZITORIUL1.NodeMap[a].CapitolY]=REPOZITORIUL1.NodeMap[a]};EditorRegionMap=REPOZITORIUL1.RegionMap;RefreshMapEditor()">Fetch Region Data</button>
	<button id="EditorP5" style="position:absolute;top:581px;left:0px; width:140px; height:21px" onclick="RetrieveLocalization()" oncontextmenu="Localization=REPOZITORIUL1.Localization">Fetch Localisation</button>
	<button id="EditorP6" style="position:absolute;top:581px;left:140px; width:140px; height:21px" onclick="alert('Not finished but who cares')">Fetch Constants</button>
	<button id="EditorP7" style="position:absolute;top:581px;left:280px; width:140px; height:21px" onclick="alert('Nope, not ready')">Edit Dialogue</button>
	<button id="EditorP8" style="position:absolute;top:581px;left:420px; width:140px; height:21px" onclick="alert('All level data dumped in console. WIP to turn this into a level saver'); RetrieveAllMapData()">Fetch Level Data</button>
	</div>

	<div style="position:absolute; top:-40px">
	<img id="EditorColorPicker1" style="position: absolute; top:602px;left: 0px; width:56px;height: 56px; filter:hue-rotate(175deg) saturate(0%) brightness(300%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+1; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='0px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker2" style="position: absolute; top:602px;left: 56px; width:56px;height: 56px; filter:hue-rotate(0deg) saturate(0%) brightness(70%) contrast(125%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+2; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='56px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker3" style="position: absolute; top:602px;left: 112px; width:56px;height: 56px; filter:hue-rotate(175deg) saturate(0%) brightness(100%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+3; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='112px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker4" style="position: absolute; top:602px;left: 168px; width:56px;height: 56px; filter:hue-rotate(250deg) saturate(150%) brightness(50%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+4; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='168px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker5" style="position: absolute; top:602px;left: 224px; width:56px;height: 56px; filter:hue-rotate(150deg) saturate(100%) brightness(100%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+5; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='224px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker6" style="position: absolute; top:602px;left: 280px; width:56px;height: 56px; filter:hue-rotate(175deg) saturate(0%) brightness(70%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+6; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='280px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker7" style="position: absolute; top:602px;left: 336px; width:56px;height: 56px; filter:hue-rotate(100deg) saturate(140%) brightness(250%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+7; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='336px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker8" style="position: absolute; top:602px;left: 392px; width:56px;height: 56px; filter:hue-rotate(50deg) saturate(100%) brightness(100%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+8; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='392px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker9" style="position: absolute; top:602px;left: 448px; width:56px;height: 56px; filter:hue-rotate(0deg) saturate(100%) brightness(100%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+9; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='448px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="EditorColorPicker10" style="position: absolute; top:602px;left: 504px; width:56px;height: 56px; filter:hue-rotate(250deg) saturate(100%) brightness(140%); cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('FactionChosenIndicator').style.visibility='inherit'; EditationColor=EditorNationBatch*10+10; for(let k=1;k<=10;k++){document.getElementById('EditorUnitShowcase'+k).style.filter=Factions[EditationColor].ChromaCode}; document.getElementById('FactionChosenIndicator').style.left='504px'" src="Assets/Miscellaneous/NationColor.PNG" oncontextmenu="document.getElementById('FactionChosenIndicator').style.visibility='hidden'; EditationColor=0"/>
	<img id="FactionChosenIndicator" style="position: absolute; top:602px; left:0px" src="Assets/Miscellaneous/Marker.PNG"/>
	<button style="position: absolute; visibility: hidden; z-index: 5; width:70px; top:658px; left:210px" onclick="if((EditorNationBatch+1)*10<=Factions.length){EditorNationBatch++; for(let a=1;a<=10;a++){document.getElementById('EditorColorPicker'+a).style.filter=Factions[EditorNationBatch*10+a].ChromaCode??'hue-rotate(175deg) saturate(0%) brightness(100%)'}}">></button>
	<button style="position: absolute; visibility: hidden; z-index: 5; width:70px; top:658px; left:280px" onclick="if((EditorNationBatch+1)*10>=10){EditorNationBatch--; for(let a=1;a<=10;a++){document.getElementById('EditorColorPicker'+a).style.filter=Factions[EditorNationBatch*10+a].ChromaCode??'hue-rotate(175deg) saturate(0%) brightness(100%)'}}"><</button>

	<div onClick="TestMap()" style="position: absolute; width:126px; height:71px; left:0px; top:0px" onmouseover="document.getElementById('TestMapButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('TestMapButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('TestMapButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'">
	<img id="TestMapButton" style="position:absolute; top:665px; left:0px" src="Assets/Miscellaneous/GenericButton.PNG"/>
	<p id="TestMapP" style="position: absolute;top:673px; left:25px; width:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto">TEST MAP</p>
		</div>

	<div onClick="document.getElementById('ConditionsPanel').style.visibility='inherit'" style="position: absolute; width:126px; height:71px; left:217px; left:0px; top:0px" onmouseover="document.getElementById('ConditionsButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('ConditionsButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('ConditionsButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'">
	<img id="ConditionsButton" style="position:absolute; top:665px; left:217px" src="Assets/Miscellaneous/GenericButton.PNG"/>
	<p id="ConditionsP" style="position: absolute;top:673px; left:242px; width:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto">Conditions</p>
		</div>

	<div onClick="document.getElementById('MapSavePanel').style.visibility='hidden'; alert('Work in progress')" style="position: absolute; width:126px; height:71px; left:434px; left:0px; top:0px" onmouseover="document.getElementById('SaveMapButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('SaveMapButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('SaveMapButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'">
	<img id="SaveMapButton" style="position:absolute; top:665px; left:434px" src="Assets/Miscellaneous/GenericButton.PNG"/>
	<p id="SaveMapP" style="position: absolute;top:673px; left:459px; width:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto">Save Map</p>
		</div>

	</div>


	<div id="MapSavePanel" style="position: absolute; top:140px; left:70px; z-index: 3; visibility: hidden;">
		<img src="Assets/Miscellaneous/SavePanel.PNG"/>
		<img style="position: absolute; top: 260px; left: 147px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG'" onclick="document.getElementById('MapSavePanel').style.visibility='hidden'"/>

		<img id="SaveSlot1" style="position: absolute;top: 0px;left: 0px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot2" style="position: absolute;top: 0px;left: 140px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot3" style="position: absolute;top: 0px;left: 280px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot4" style="position: absolute;top: 140px;left: 0px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot5" style="position: absolute;top: 140px;left: 140px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot6" style="position: absolute;top: 140px;left: 280px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot7" style="position: absolute;top: 280px;left: 0px" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot8" style="position: absolute;top: 280px;left: 140px; visibility:hidden;" src="Assets/Miscellaneous/SaveSlot.PNG">
		<img id="SaveSlot9" style="position: absolute;top: 280px;left: 280px" src="Assets/Miscellaneous/SaveSlot.PNG">


		</div>

	<div id="ConditionsPanel" style="position: absolute; visibility: hidden; width: 550px; height:70px; top:560px; left:0px; z-index:5; background-color:gray; border: 5px solid orange">
		<button onclick="document.getElementById('ConditionsPanel').style.visibility='hidden'">X</button>

		<input type="text" id="SurviveInput" name="testinput" value="9999" style="position:absolute; top:10px; left:110px; width:50px; height:10px">
		<p id="SurviveInputP" style="position:absolute; top:-8px; left:20px; width:50px; height:10px">Survive:</p>
		<input type="text" id="TimeLimitInput" name="testinput" value="9999" style="position:absolute; top:30px; left:110px; width:50px; height:10px">
		<p id="TimeLimitInputP" style="position:absolute; top:12px; left:20px; width:80px; height:10px">Time Limit:</p>

		<button id="InputDefendTile" style="position: absolute; width:100px; height:20px; left: 445px; top: 15px" onclick="alert('Work in progress')">Defend Tile</button>
		<button id="InputCaptureTile" style="position: absolute; width:100px; height:20px; left: 445px; top: 35px" onclick="alert('Work in progress')">Capture Tile</button>
		<button id="InputDestroyUnit" style="position: absolute; width:100px; height:20px; left: 345px; top: 15px" onclick="alert('Work in progress')">Destroy Unit</button>
		<button id="InputProtectUnit" style="position: absolute; width:100px; height:20px; left: 345px; top: 35px" onclick="alert('Work in progress')">Protect Unit</button>


		</div>



	<img id="EditorScrollBarRight" style="position: absolute; width:25px; height:558px; top:1px; left:535px; z-index: 4; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('EditorScrollBarRight').src='Assets/Miscellaneous/ScrollBarRight.PNG'" onmouseout="document.getElementById('EditorScrollBarRight').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMapEditor(2)" />
	<img id="EditorScrollBarLeft" style="position: absolute; width:25px; height:558px; top:1px; left:0px; z-index: 4; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('EditorScrollBarLeft').src='Assets/Miscellaneous/ScrollBarLeft.PNG'" onmouseout="document.getElementById('EditorScrollBarLeft').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMapEditor(4)"/>
	<img id="EditorScrollBarTop" style="position: absolute; width:558px; height:25px; top:0px; left:1px; z-index: 4; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('EditorScrollBarTop').src='Assets/Miscellaneous/ScrollBarTop.PNG'" onmouseout="document.getElementById('EditorScrollBarTop').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMapEditor(1)"/>
	<img id="EditorScrollBarBottom" style="position: absolute; width:558px; height:25px; top:535px; left:1px; z-index: 4; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('EditorScrollBarBottom').src='Assets/Miscellaneous/ScrollBarBottom.PNG'" onmouseout="document.getElementById('EditorScrollBarBottom').src='Assets/Miscellaneous/Nothing.PNG'" src="Assets/Miscellaneous/Nothing.PNG" onclick="RollMapEditor(3)"/>
		
	</div>
<div id="MapMold" style="position: absolute; visibility:hidden; width:420px; height: 280px; left: 455px; top: 140px; z-index:5">
	<img src="Assets/Miscellaneous/MoldMap.PNG"/>
	<img style="position: absolute; top: 0px; left: 147px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG'" onclick="document.getElementById('MapMold').style.visibility='hidden'" />
	<p style="position: absolute; top:105px; left:112px">↔</p>
	<p style="position: absolute; top:123px; left:116px">↕</p>
	<input type="text" id="widthinput" name="testinput" value="10" style="position:absolute; top:119px; left:133px">
	<input type="text" id="heigthinput" name="testinput" value="10" style="position:absolute; top:140px; left:133px">
	<button id="GenerateEditorMap" onClick="FieldMode='MapEditor'; for(let i=1;i<=10;i++){for(let j=1;j<=10;j++){
			key=document.getElementById('Slot '+i+' X '+j)??0;if(key!=0){key.remove()};
		}}; castMapMaker(); if(MusicChoice){MainTheme.pause()}" style="position:absolute; top:161px; left:145px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto">Generate Blank Map</button>
	</div>
<div id="Options" style="position:relative; visibility:hidden; left:448px;top:140px;z-index:7">
	<img style="position:absolute" src="Assets/Miscellaneous/OptionsPanel.PNG"/>
	<img id="CloseOptionsButton" style="position:absolute; left:158px; top:7px" src="Assets/Miscellaneous/CloseButton.PNG" onclick="document.getElementById('Options').style.visibility='hidden'" onmouseover="document.getElementById('CloseOptionsButton').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="document.getElementById('CloseOptionsButton').src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="document.getElementById('CloseOptionsButton').src='Assets/Miscellaneous/CloseButtonPressed.PNG'"/>
	
	<div style="position:absolute; z-index:8; left:10px; top:10px; width:105px; height:58px; text-align:center" onmouseover="this.style.filter='brightness(125%)'" onmouseout="this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; document.getElementById('LanguageSelectionPanel').style.visibility='visible'">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/LanguageButton.PNG"/>
	</div>

	<div style="position:absolute; z-index:8; left:10px; top:70px; width:105px; height:58px; text-align:center" oncontextmenu="Tooltip(25);" onmouseover="this.style.filter='brightness(125%)'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; ToggleOption('Sound')">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img id="ToggleSound" style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/SoundOn.PNG"/>
	</div>

	<div style="position:absolute; z-index:8; left:115px; top:70px; width:105px; height:58px; text-align:center" oncontextmenu="Tooltip(24);" onmouseover="this.style.filter='brightness(125%)'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; ToggleOption('Music')">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img id="ToggleMusic" style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/MusicOn.PNG"/>
	</div>

	<div style="position:absolute; z-index:8; left:224px; top:70px; width:105px; height:58px; text-align:center" oncontextmenu="Tooltip(26);" onmouseover="this.style.filter='brightness(125%)'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; ToggleOption('Dialogue')">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img id="ToggleDialogue" style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/DialogueOn.PNG"/>
	</div>

	<div style="position:absolute; z-index:8; left:329px; top:70px; width:105px; height:58px; text-align:center" oncontextmenu="Tooltip(27);" onmouseover="this.style.filter='brightness(125%)'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; ToggleOption('IdleAnim')">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img id="ToggleIdleAnimations" style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/IdleAnimOn.PNG"/>
	</div>

	<div style="position:absolute; z-index:8; left:329px; top:10px; width:105px; height:58px; text-align:center" oncontextmenu="Tooltip(28);" onmouseover="this.style.filter='brightness(125%)'" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.filter='brightness(100%)'" onclick="this.style.filter='brightness(75%)'; ToggleOption('MystSett')">
	<img style="position:absolute; top:0px; left:1px" src="Assets/Miscellaneous/SmallButton.PNG"/>
	<img id="ToggleMysteriousSetting" style="position:absolute; top: 7px;left: 28px" src="Assets/Miscellaneous/MysteriousSettingOff.PNG"/>
	</div>

	<div style="position:absolute; visibility: hidden; z-index:7 ;left:7px; top: 154px; width:210px; height:58px">
	<img style="position:absolute; z-index:8" src="Assets/Miscellaneous/Button.PNG"/>	
	<p style="position:relative; z-index:9; text-align: center; font-size:20px">Help</p>
	</div>
	
	<div style="position:absolute; visibility: hidden; z-index:7 ;left:7px; top: 215px; width:210px; height:58px">
	<img style="position:absolute; z-index:8" src="Assets/Miscellaneous/Button.PNG"/>
	<p style="position:relative; z-index:9; text-align: center; font-size:20px">Safe Mode</p>
	</div>
	
	<div style="position:absolute; visibility: hidden; z-index:7 ;left:231px; top: 154px; width:210px; height:58px">
	<img style="position:absolute; z-index:8" src="Assets/Miscellaneous/Button.PNG"/>	
	<p style="position:relative; z-index:9; text-align: center; font-size:20px">Save Progress</p>	
	</div>
	
	<div style="position:absolute; visibility: hidden; z-index:7 ;left:231px; top: 215px; width:210px; height:58px">
	<img style="position:absolute; z-index:8" src="Assets/Miscellaneous/Button.PNG"/>
	<p style="position:relative; z-index:9; text-align: center; font-size:20px">Quit</p>
	</div>

	<div id="LanguageSelectionPanel" style="position:absolute; visibility:hidden; z-index:10;left:-95px; width:630px;height: 280px;">
	<p style="position: absolute; z-index:11; width:630px; top:-10px;left:auto;text-align:center" id="LanguageCommentary">None except English work for now</p>
	<img style="position: absolute; z-index:10" src="Assets/Miscellaneous/LanguageSelectPanel.PNG"/>
	<img src="Assets/Miscellaneous/CloseButton.PNG" onclick="document.getElementById('LanguageSelectionPanel').style.visibility='hidden'" style="position: absolute; z-index:11; top:210px;left:250px">
	<img style="position: absolute; z-index: 11;width:150px; height:100px; top:25px; left:7px" onclick="Language=ROM; document.getElementById('LanguageCommentary').innerHTML=Language.LanguageComment" src="Assets/Languages/FlagROM.PNG"/>	
	<img style="position: absolute; z-index: 11;width:150px; height:100px; top:25px; left:162px" onclick="Language=ENG; document.getElementById('LanguageCommentary').innerHTML=Language.LanguageComment" src="Assets/Languages/FlagENG.PNG"/>	
	<img style="position: absolute; z-index: 11;width:150px; height:100px; top:25px; left:317px" onclick="Language=ESP; document.getElementById('LanguageCommentary').innerHTML=Language.LanguageComment" src="Assets/Languages/FlagESP.PNG"/>	
	<img style="position: absolute; z-index: 11;width:150px; height:100px; top:25px; left:472px;visibility: hidden" onclick="Language=POR; document.getElementById('LanguageCommentary').innerHTML=Language.LanguageComment" src="Assets/Languages/FlagPOR.PNG"/>	

	</div>
	
	
	
	
	

	</div>
<div id="Credits" style="position:absolute; visibility:hidden; width:420px;height:270px;z-index:7; left:455px; top:140px; overflow-y:hidden;">
	<img style="position: fixed; left:452px" src="Assets/Miscellaneous/CreditsPanel.PNG"/>
	
	<img id="CloseCreditsButton" style="position: fixed; z-index:8; left:602px; top:385px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onclick="document.getElementById('Credits').style.visibility='hidden'" onmouseover="document.getElementById('CloseCreditsButton').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="document.getElementById('CloseCreditsButton').src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="document.getElementById('CloseCreditsButton').src='Assets/Miscellaneous/CloseButtonPressed.PNG'"/>
	<p style="position: relative; text-align:center;margin-bottom:0px;">Made by Task Force Tucker</p>
	<p style="position: relative; text-align:center;margin-bottom:0px;">Coordination: Doctor Aircraft Carrier</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:0px;">Programming: Doctor Aircraft Carrier</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Unit Art:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:0px;">SpearDavid(Our MVP and first teammate), Nadivaz(thank you for all your help mate), Bomba(for making several high quality static assets) and Doctor Aircraft Carrier(if there's a unit with shitty graphics, it was certainly drawn by DAC; but if it's well-animated it's likely also DAC)</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Portrait Art:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:0px;">DAC, Machow8(who extracted some of the source material we used to derive a few sprites from)</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Music:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:0px;">AlanAztec, White Bat Audio, Kevin MacLeod and many others</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Writing:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:0px;">Doctor Aircraft Carrier</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Testing:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">RLG Mapper(Relampago), Inventorarus Rex, Csix66 and many, many more</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">ESP Translation:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Silvestre(our absolute MVP, thanks a lot bro!), Atamarado, Prometheus, Margygr</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">POR Translation:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">RLG Mapper(Relampago), Vythus, Aurum, Gabiel br and I feel like I'm forgetting someone</p>
		<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">TUR Translation:</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Tiffozi(bravely fighting this difficult ordeal by himself)</p>
		<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Special Thanks</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Albert Epstein, for creating Manstein and Womanstein</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">ThopTeam(Machow8 and WMAB) for mining the Battalion Arena avatar assets</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">Vikingen, for helping with art(improving city tiles and the megamountains)</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">John Titor, who helped us get this project finished much faster</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">...that certain someone who (at the very least) left us with a great disclaimer</p>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:5px;">And you, the player, who's been with us for so long. You're a real bro</p>
	<br/>
	<p style="position: relative; text-align:center;margin-bottom:0px; margin-top:10px; color: red;">If you steal anything from this game, I am going to find your ass and fuck it as violently as if you were Jeffrey Epstein's corpse</p>
	<br/>
	<div style="position: fixed; top:140px; left:455px; width:415px; height: 35px" onmouseover="ScrollUp=setInterval(ScrollEndScreenUp,10); function ScrollEndScreenUp(){document.getElementById('Credits').scrollBy(0,-1)}" onmouseout="clearInterval(ScrollUp)"></div>
	<div style="position: fixed; top:385px; left:455px; width:415px; height: 35px" onmouseover="ScrollDown=setInterval(ScrollEndScreenDown,10); function ScrollEndScreenDown(){document.getElementById('Credits').scrollBy(0,1)}" onmouseout="clearInterval(ScrollDown)"></div>

	</div>
<div id="Boot Camp"></div>
<div id="Special Levels" style="position:absolute; visibility:hidden; left:210px">

	<div style="position: absolute;">
		<img id="Special Bloc Panel" src="Assets/Miscellaneous/Special Bloc Panel.PNG"/>
	
	<img style="position: absolute; left:7.5px; top:10px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP1" style="position: absolute; width:126px; height:31px; top:0px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(PlotExpansion)" >Plot Expansion</p>

	<img style="position: absolute; left:7.5px; top:45px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP2" style="position: absolute; width:126px; height:31px; top:35px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(Skirmishes)">Skirmishes</p>

	<img style="position: absolute; left:7.5px; top:80px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP3" style="position: absolute; width:126px; height:31px; top:70px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(CuteLevels)">Cute Levels</p>

	<img style="position: absolute; left:7.5px; top:115px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP4" style="position: absolute; width:126px; height:31px; top:105px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(HistoricalBattles)">Historical Battles</p>

		<img style="position: absolute; left:7.5px; top:150px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP5" style="position: absolute; width:126px; height:31px; top:140px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(InHonourOf)">Tribute Levels</p>

		<img style="position: absolute; left:7.5px; top:185px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP6" style="position: absolute; width:126px; height:31px; top:175px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(Challenges)">Challenges</p>

		<img style="position: absolute; left:7.5px; top:220px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP7" style="position: absolute; width:126px; height:31px; top:210px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(MemeLevels)">Meme Levels</p>

		<img style="position: absolute; left:7.5px; top:255px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id="BonusP8" style="position: absolute; width:126px; height:31px; top:245px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="OpenSpecialBloc(GrandMaps)">GIGAMAPS</p>

	</div>

	<div style="position: absolute; left:140px">
	<img id="Special Level Panel" src="Assets/Miscellaneous/Special Level Panel.PNG"/>
	<img id="Special Level 1" style="position: absolute; top: 35px; left: 35px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[0])" />
	<img id="Special Level 2" style="position: absolute; top: 35px; left: 210px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[1])" />
	<img id="Special Level 3" style="position: absolute; top: 35px; left: 385px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[2])" />
	<img id="Special Level 4" style="position: absolute; top: 210px; left: 35px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[3])" />
	<img id="Special Level 5" style="position: absolute; top: 210px; left: 210px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[4])" />
	<img id="Special Level 6" style="position: absolute; top: 210px; left: 385px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[5])" />
	<img id="Special Level 7" style="position: absolute; top: 385px; left: 35px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[6])" />
	<img id="Special Level 8" style="position: absolute; top: 385px; left: 210px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[7])" />
	<img id="Special Level 9" style="position: absolute; top: 385px; left: 385px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/SpecialLevels/.PNG" onclick="SelectSpecialLevel(BlocVizat[8])" />

	<p id="Special Level Name" style="position: absolute; top:546px; width:560px; height:10px; text-align: center;">Name</p>
	<p id="Special Level Description" style="position: absolute; top:574px; width:560px; height:100px; text-align: center;">Long ago in a galaxy far away, jedi something lorem ipsum dolor sit amet</p>
	</div>

	<div style="position: absolute; left:700px">
	<img id="Special Level Aux Panel" src="Assets/Miscellaneous/Special Aux Panel.PNG"/>
	<img id="PlaySpecialLevel" style="position: absolute; top:50px; left:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/GenericButton.PNG" onmouseover="this.src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/GenericButton.PNG'" onclick="this.src='Assets/Miscellaneous/GenericButtonPressed.PNG' ;document.getElementById('Special Levels').style.visibility='hidden';initializeSpecialBattle(NivelVizat);" />
	<p id="PlayBonusP" style="position:absolute; top:56px; left:122px; height:35px; width: 82px; text-align: center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButton.PNG'" onclick="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButtonPressed.PNG' ;document.getElementById('Special Levels').style.visibility='hidden';initializeSpecialBattle(NivelVizat);" >Play</p>
	<img style="position: absolute; top:140px; left:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onclick="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG' ;document.getElementById('Special Levels').style.visibility='hidden'; document.getElementById('Main Menu').style.visibility='visible';OpenSpecialBloc({})" />
		<div style="position:absolute; top:350px; left:0px">
			<p id="NatOpP" style="position: absolute; visibility: hidden; top:-35px; width:350px; left:0px; text-align:center;">Nation</p>
			<img id="NatOp1" style="position: absolute; visibility: hidden; top:7px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=1;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[1])" />
			<img id="NatOp2" style="position: absolute; visibility: hidden; top:7px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=2;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[2])"/>
			<img id="NatOp3" style="position: absolute; visibility: hidden; top:7px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=3;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[3])"/>
			<img id="NatOp4" style="position: absolute; visibility: hidden; top:7px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=4;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[4])"/>
			<img id="NatOp5" style="position: absolute; visibility: hidden; top:7px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=5;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[5])"/>
			<img id="NatOp6" style="position: absolute; visibility: hidden; top:7px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=6;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[6])"/>
			<img id="NatOp7" style="position: absolute; visibility: hidden; top:7px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=7;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[7])"/>

			<img id="NatOp8" style="position: absolute; visibility: hidden; top:57px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=8;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[8]"/>
			<img id="NatOp9" style="position: absolute; visibility: hidden; top:57px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=9;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[9]"/>
			<img id="NatOp10" style="position: absolute; visibility: hidden; top:57px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=10;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[10]"/>
			<img id="NatOp11" style="position: absolute; visibility: hidden; top:57px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=11;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[11]"/>
			<img id="NatOp12" style="position: absolute; visibility: hidden; top:57px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=12;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[12]"/>
			<img id="NatOp13" style="position: absolute; visibility: hidden; top:57px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=13;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[13]"/>
			<img id="NatOp14" style="position: absolute; visibility: hidden; top:57px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=14;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[14]"/>

			<img id="NatOp15" style="position: absolute; visibility: hidden; top:107px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=15;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[15]"/>
			<img id="NatOp16" style="position: absolute; visibility: hidden; top:107px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=16;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[16]"/>
			<img id="NatOp17" style="position: absolute; visibility: hidden; top:107px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=17;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[17]"/>
			<img id="NatOp18" style="position: absolute; visibility: hidden; top:107px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=18;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[18]"/>
			<img id="NatOp19" style="position: absolute; visibility: hidden; top:107px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=19;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[19]"/>
			<img id="NatOp20" style="position: absolute; visibility: hidden; top:107px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=20;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[20]"/>
			<img id="NatOp21" style="position: absolute; visibility: hidden; top:107px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=21;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[21]"/>

			<img id="NatOp22" style="position: absolute; visibility: hidden; top:157px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=22;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[22]"/>
			<img id="NatOp23" style="position: absolute; visibility: hidden; top:157px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=23;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[23]"/>
			<img id="NatOp24" style="position: absolute; visibility: hidden; top:157px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=24;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[24]"/>
			<img id="NatOp25" style="position: absolute; visibility: hidden; top:157px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=25;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[25]"/>
			<img id="NatOp26" style="position: absolute; visibility: hidden; top:157px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=26;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[26]"/>
			<img id="NatOp27" style="position: absolute; visibility: hidden; top:157px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=27;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[27]"/>
			<img id="NatOp28" style="position: absolute; visibility: hidden; top:157px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=28;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[28]"/>

			<img id="NatOp29" style="position: absolute; visibility: hidden; top:207px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=29;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[29]"/>
			<img id="NatOp30" style="position: absolute; visibility: hidden; top:207px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=30;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[30]"/>
			<img id="NatOp31" style="position: absolute; visibility: hidden; top:207px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=31;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[31]"/>
			<img id="NatOp32" style="position: absolute; visibility: hidden; top:207px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=32;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[32]"/>
			<img id="NatOp33" style="position: absolute; visibility: hidden; top:207px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=33;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[33]"/>
			<img id="NatOp34" style="position: absolute; visibility: hidden; top:207px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=34;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[34]"/>
			<img id="NatOp35" style="position: absolute; visibility: hidden; top:207px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=35;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[35]"/>

			<img id="NatOp36" style="position: absolute; visibility: hidden; top:257px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=36;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[36]"/>
			<img id="NatOp37" style="position: absolute; visibility: hidden; top:257px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=37;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[37]"/>
			<img id="NatOp38" style="position: absolute; visibility: hidden; top:257px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=38;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[38]"/>
			<img id="NatOp39" style="position: absolute; visibility: hidden; top:257px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=39;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[39]"/>
			<img id="NatOp40" style="position: absolute; visibility: hidden; top:257px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=40;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[40]"/>
			<img id="NatOp41" style="position: absolute; visibility: hidden; top:257px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=41;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[41]"/>
			<img id="NatOp42" style="position: absolute; visibility: hidden; top:257px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=42;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[42]"/>

			<img id="NatOp43" style="position: absolute; visibility: hidden; top:307px; left:8px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=43;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[43]"/>
			<img id="NatOp44" style="position: absolute; visibility: hidden; top:307px; left:58px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=44;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[44]"/>
			<img id="NatOp45" style="position: absolute; visibility: hidden; top:307px; left:108px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=45;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[45]"/>
			<img id="NatOp46" style="position: absolute; visibility: hidden; top:307px; left:158px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=46;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[46]"/>
			<img id="NatOp47" style="position: absolute; visibility: hidden; top:307px; left:208px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=47;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[47]"/>
			<img id="NatOp48" style="position: absolute; visibility: hidden; top:307px; left:258px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=48;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[48]"/>
			<img id="NatOp49" style="position: absolute; visibility: hidden; top:307px; left:308px; filter:hue-rotate(175deg) saturate(0%) brightness(300%)" src="Assets/Miscellaneous/NationOption.PNG" onclick="NivelElectiv=49;document.getElementById('NatOpP').innerHTML=NivelVizat.Factions[NivelVizat.Constants.Commanders[NivelElectiv].Allegiance].name" oncontextmenu="alert(NivelVizat.FactionCommentary[49]"/>


		</div>
		</div>

		</div>
<div id="Codex" style="position:absolute; visibility:hidden; z-index:6; width:700px; height:560px; left:280px; top:10px">
	<div style="position: absolute; top:0px; left:0px; height: 665px; width:210px; overflow-y:scroll;">
		<img style="position: fixed;" src="Assets/Miscellaneous/LoreSelectionPanel.PNG"/>

		<div style="position: absolute; top:35px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Jokes)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">Jokes</p>
		</div>

		<div style="position: absolute; top:70px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Special_Units)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">Special Infantry</p>
		</div>

		<div style="position: absolute; top:105px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Special_Armor)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">Special Tanks</p>
		</div>

		<div style="position: absolute; top:140px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Special_Aircraft)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">Special Planes?</p>
		</div>

		<div style="position: absolute; top:175px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Special_Ships)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">Special Ships?</p>
		</div>

		<div style="position: absolute; top:210px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(This_World)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">This World</p>
		</div>

		<div style="position: absolute; top:245px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(It_Happened)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8">It Happened</p>
		</div>

		<div style="position: absolute; top:280px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:315px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:350px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:385px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:420px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:455px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:490px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:525px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>
		<div style="position: absolute; top:560px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:595px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>

		<div style="position: absolute; top:630px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>


		<div style="position: absolute; top:665px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>


		<div style="position: absolute; top:700px; left:45px; z-index:7; text-align:center;" onclick="">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; cursor:default;"></p>
		</div>


		<div style="position: absolute; top:735px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_TZIMTZUM)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation TZIMTZUM</p>
		</div>


		<div style="position: absolute; top:770px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_GOLCHAB)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation GOLCHAB</p>
		</div>


		<div style="position: absolute; top:805px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_GHAAG_SHEBLAH)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation GHAAG SHEBLAH</p>
		</div>

		<div style="position: absolute; top:840px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_OHR_EIN_ZOF)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation OHR EIN ZOF</p>
		</div>

		<div style="position: absolute; top:875px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_SAMSON)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation SAMSON</p>
		</div>

		<div style="position: absolute; top:910px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(Operation_THAUMIEL)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 28px;">Operation THAUMIEL</p>
		</div>

		<div style="position: absolute; top:945px; left:45px; z-index:7; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="DisplayLore(War_Plan_ARMAGEDDON)">
		<img src="Assets/Miscellaneous/LongPlaque.PNG" />
		<p style="position:absolute; top: -10px; width:126px; height: 35px; z-index:8; font-size:12px; line-height: 14px;">War Plan ARMAGEDDON</p>
		</div>

	</div>

	<div style="position: absolute; left:210px; width:560px; height: 700px">

	<img style="position: absolute" src="Assets/Miscellaneous/LorePanel.PNG">
	<p id="LorePanel" style="position: absolute; top: 105px; left:7px; width:525px; height:420px; color:#ccff99; text-align:center; overflow-y:scroll;"></p>

	<div style="position:absolute; text-align:center; width:560px; left:0px">
	<p id="LoreName" style="position:absolute; top:546px; width:560px; height:21px">Name</p>
	<p id="LoreDesc" style="position:absolute; top:574px; width:525px; height:210px; left:15px">Description</p>
	</div>
	
	<div style="position:absolute; left: 385px; top: 35px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('CodexCloseButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('CodexCloseButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('CodexCloseButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'" onclick="document.getElementById('Codex').style.visibility='hidden'; document.getElementById('Main Menu').style.visibility='visible'">
	<img id="CodexCloseButton" src="Assets/Miscellaneous/GenericButton.PNG"/>
	<p style="position: absolute; width:80px; height:35px; top:7px; left:23px">Close</p>
	</div>

	<p id="LoreLength" style="position:absolute; top:-4px; left: 4px; width:350px; text-align:center;">Document</p>
	<img id="LoreLengthIcon1" src="Assets/Miscellaneous/DocShadow.PNG" style="position:absolute; top:35px; left:14px" oncontextmenu="Tooltip(29)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'"/>
	<img id="LoreLengthIcon2" src="Assets/Miscellaneous/DocShadow.PNG" style="position:absolute; top:35px; left:84px" oncontextmenu="Tooltip(29)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'"/>
	<img id="LoreLengthIcon3" src="Assets/Miscellaneous/DocShadow.PNG" style="position:absolute; top:35px; left:154px" oncontextmenu="Tooltip(29)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'"/>
	<img id="LoreLengthIcon4" src="Assets/Miscellaneous/DocShadow.PNG" style="position:absolute; top:35px; left:224px" oncontextmenu="Tooltip(29)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'"/>
	<img id="LoreLengthIcon5" src="Assets/Miscellaneous/DocShadow.PNG" style="position:absolute; top:35px; left:294px" oncontextmenu="Tooltip(29)" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden'"/>


	</div>

	</div>
<div id="Scenario"></div>
<div id="Conquest"></div>
<div id="GeneralTooltip" style="position: absolute; border:5px solid; background-color:beige; width: 350px; height: 50px; text-align: center; left: 490px; top: 50px; z-index:10; visibility:hidden;">
	<p id="GeneralTooltipText" style="position: absolute; top:-10px; height: 40px; width:350px"></p>
	</div>

<div id="Disclaimer2" style="position:absolute; visibility:hidden; width:700px; height:700px; left:317px; top:0px; z-index:5; background-color: darkslategray; text-align: center;">
	<p></p>
	<img id="AphorismIllustration" style="position:absolute; top:0px; left:0px; width:700px; height:500px" src="Assets/MainMenuScreens/West Taiwan.jpg" onclick="document.getElementById('Disclaimer2').style.visibility='hidden'; GeneralInitializer()"/>
	<img style="position:absolute; top:500px; left:0px" src="Assets/Miscellaneous/AphorismPlate.PNG" onclick="document.getElementById('Disclaimer2').style.visibility='hidden'; GeneralInitializer()"/>
	
	<img style="position: absolute; top: 500px; left:0px; z-index:2" src="Assets/Miscellaneous/PreloaderContainer.PNG"/>
	<div id="PreloaderBar" style="position: absolute; top: 500px; left:0px; width:700px; height: 20px; z-index:1; background-color:pink;"></div>
	<p id="PreloaderSplash" style="position:absolute; top:491px; z-index:1; text-align:center; width: 700px; height:20px; font-size:12px">Leaving secret messages for the player ;)</p>


	<p id="AphorismText" style="position:absolute; top:520px; z-index:1; text-align:center; width: 700px; height:20px; font-size:12px">Leaving secret messages for the player ;)</p>
	<p id="AphorismAuthor" style="position:relative; top:100px"></p>
	<div id="LanguagePreselector" style="position: absolute; left:210px; top:0px; width:280px; height:56px">
		<img src="Assets/Miscellaneous/LanguageMiniPanel.PNG"/>
		<p id="LanguagePrecommentor" style="position:absolute; width:140px; height:140px; left:14px; text-align: center; top:0px; z-index:5; visibility:hidden;"></p>

		<img style="position: absolute; top:3px; left:49px; width:28px; height:21px" src="Assets/Languages/FlagENG.PNG" onclick="Language=ENG; GeneralInitializer(); document.getElementById('LanguagePrecommentor').innerHTML=Language.LanguageComment" />
		<img style="position: absolute; top:3px; left:84px; width:28px; height:21px" src="Assets/Languages/FlagESP.PNG" onclick="Language=ESP; GeneralInitializer(); document.getElementById('LanguagePrecommentor').innerHTML=Language.LanguageComment"/>
		<img style="position: absolute; top:3px; left:119px; width:28px; height:21px; visibility:hidden" src="Assets/Languages/FlagPOR.PNG" onclick="Language=POR; GeneralInitializer(); document.getElementById('LanguagePrecommentor').innerHTML=Language.LanguageComment"/>
		<img style="position: absolute; top:3px; left:119px; width:28px; height:21px" src="Assets/Languages/FlagROM.PNG" onclick="Language=ROM; GeneralInitializer(); document.getElementById('LanguagePrecommentor').innerHTML='Made by yours truly(Partial translation)'"/>
		<img style="position: absolute; top:3px; left:189px; width:28px; height:21px; visibility:hidden" src="Assets/Languages/FlagTUR.PNG" onclick="Language=TUR; document.getElementById('LanguagePrecommentor').innerHTML='Thank you, Tiffozi(Partial translation)'"/>
		<img style="position: absolute; top:0px; left:14px; width:28px; height:21px; visibility:hidden" src="Assets/Languages/FlagFRA.PNG" onclick="document.getElementById('LanguagePrecommentor').innerHTML='French translation unavailable'"/>



		</div>
	
	<p style="position:absolute; top:400px; color: yellow"></p>
	</div>
<div id="Disclaimer" style="position:absolute; visibility:hidden; width:700px; height:602px; left:317px; top:10px; z-index:5; background-color: red; text-align: center;">
	<p>Made by Task Force Tucker</p>
	<p style="position:relative; top:100px">Warning</p>
	<p style="position:relative; top:100px">This game contains bullying, kidnapping, torture, murder, suicide, violence, war crimes, atrocities, Goring's fat ass, Titans, genocidal rampages, freedom, racism, fascism, communism, fascism and communism's ugly-ass baby, paedophilic manchild Sultans, pedophilic psychopaths, traitors, a glass of juice, implied rape, written rape, graphic rape, other types of rape, ethnoreligious genocide, chemical warfare, humanism, Taboritsky's funny clock, drug abuse, sexual perversions, spoilers(a fuckton of them), satire, double satire, dark humour, toilet humour, humour in general, a REALLY thin fourth wall, lampshades, gamer time, special operations, penises, Skoatia, Twitter, Reddit, dystopia, cockroaches, and worst of all... BUREAUCRACY(I'm so sorry guys)

	</p>
	<p style="position:relative; top:100px">But seriously, this game gets pretty hardcore. If you're a bitch, don't play it</p>
	
	<p style="position:absolute; top:400px; color: yellow"> Any attempt to sell this game is idiotic, this game is free. 0$. Nada. Niente. Only Task Force Tucker and those authorized are allowed to share this game, the others will be hunted. Do not test my patience if you don't want your ass to be fucked.</p>
	<button style="position:absolute; left:140px; top:500px" onclick="Disclaimer.pause(); document.getElementById('Disclaimer').style.visibility='hidden'; CallPreloader()">I promise not to steal, otherwise my butt is ready for surprise sex</button>
	</div>


<div id="Tutorial Levels" style="position:absolute; visibility:hidden; left:210px">
	
	<div style="position: absolute;">
		<img id="Tutorial Bloc Panel" src="Assets/Miscellaneous/Special Bloc Panel.PNG"/>
	
	<img style="position: absolute; left:7.5px; top:10px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial1P' style="position: absolute; width:126px; height:31px; top:0px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel1; document.getElementById('Tutorial').src='Assets/SpecialLevels/The Basics of Tactical Command.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel1.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel1.Desc" >Mission 1</p>

	<img style="position: absolute; left:7.5px; top:45px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial2P' style="position: absolute; width:126px; height:31px; top:35px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel2; document.getElementById('Tutorial').src='Assets/SpecialLevels/Tactical Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel2.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel2.Desc">Mission 2</p>

	<img style="position: absolute; left:7.5px; top:80px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial3P' style="position: absolute; width:126px; height:31px; top:70px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel3; document.getElementById('Tutorial').src='Assets/SpecialLevels/Terrain Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel3.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel3.Desc">Mission 3</p>

	<img style="position: absolute; left:7.5px; top:115px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial4P' style="position: absolute; width:126px; height:31px; top:105px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel4; document.getElementById('Tutorial').src='Assets/SpecialLevels/Logistical Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel4.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel4.Desc">Mission 4</p>

	<img style="position: absolute; left:7.5px; top:150px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial5P' style="position: absolute; width:126px; height:31px; top:140px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel5; document.getElementById('Tutorial').src='Assets/SpecialLevels/Industrial Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel5.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel5.Desc">Mission 5</p>

	<img style="position: absolute; left:7.5px; top:185px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial6P' style="position: absolute; width:126px; height:31px; top:175px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel6; document.getElementById('Tutorial').src='Assets/SpecialLevels/Transport Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel6.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel6.Desc">Mission 6</p>

	<img style="position: absolute; left:7.5px; top:220px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial7P' style="position: absolute; width:126px; height:31px; top:210px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel7; document.getElementById('Tutorial').src='Assets/SpecialLevels/Mixed Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel7.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel7.Desc">Mission 7</p>

	<img style="position: absolute; left:7.5px; top:255px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial8P' style="position: absolute; width:126px; height:31px; top:245px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel8; document.getElementById('Tutorial').src='Assets/SpecialLevels/Cooperation Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel8.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel8.Desc">Mission 8</p>

	<img style="position: absolute; left:7.5px; top:290px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial9P' style="position: absolute; width:126px; height:31px; top:280px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel9; document.getElementById('Tutorial').src='Assets/SpecialLevels/Combined Arms Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel9.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel9.Desc">Mission 9</p>

	<img style="position: absolute; left:7.5px; top:325px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/LongPlaque.PNG"/>
	<p id='Tutorial10P' style="position: absolute; width:126px; height:31px; top:315px; left:7px; text-align:center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="TutorialLevel=TutorialLevel10; document.getElementById('Tutorial').src='Assets/SpecialLevels/Final Exercise.PNG'; document.getElementById('Tutorial Level Name').innerHTML=TutorialLevel10.Name; document.getElementById('Tutorial Level Description').innerHTML=TutorialLevel10.Desc">Mission 10</p>

	</div>



	<div style="position: absolute; left:140px">
	<img id="Tutorial Level Panel" src="Assets/Miscellaneous/Special Level Panel.PNG"/>
	<img id="Tutorial" style="position: absolute; top: 14px; left: 14px; width:532px; height:532px" src="Assets/SpecialLevels/.PNG" onclick=""/>


	<p id="Tutorial Level Name" style="position: absolute; top:546px; width:560px; height:10px; text-align: center;">Name</p>
	<p id="Tutorial Level Description" style="position: absolute; top:574px; width:560px; height:100px; text-align: center;">Long ago in a galaxy far away, jedi something lorem ipsum dolor sit amet</p>
	</div>


		<div style="position: absolute; left:700px">
	<img id="Tutorial Level Aux Panel" src="Assets/Miscellaneous/Special Aux Panel.PNG"/>
	<img id="PlaySpecialLevel" style="position: absolute; top:50px; left:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/GenericButton.PNG" onmouseover="this.src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/GenericButton.PNG'" onclick="this.src='Assets/Miscellaneous/GenericButtonPressed.PNG' ;if(TutorialLevel!=0){document.getElementById('Tutorial Levels').style.visibility='hidden';initializeSpecialBattle(TutorialLevel);TutorialLevel=0};" />
	<p id='PlayTutorialP' style="position:absolute; top:56px; left:122px; height:35px; width: 82px; text-align: center; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onmouseover="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButton.PNG'" onclick="document.getElementById('PlaySpecialLevel').src='Assets/Miscellaneous/GenericButtonPressed.PNG' ;if(TutorialLevel!=0){document.getElementById('Tutorial Levels').style.visibility='hidden';initializeSpecialBattle(TutorialLevel);TutorialLevel=0};" >Play</p>
	<img style="position: absolute; top:140px; left:100px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onclick="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG' ;document.getElementById('Tutorial Levels').style.visibility='hidden'; document.getElementById('Main Menu').style.visibility='visible';document.getElementById('Tutorial').src='Assets/Miscellaneous/Nothing.PNG' " />
	</div>


	</div>
<div id="CampaignSelectionScreen" style="position: absolute; visibility:hidden; width:1000px; height:640px; z-index:7; left: 182px; top: 0px; background-color:#404040">	

	<img id="CampaignSelectorCloseButton" src="Assets/Miscellaneous/CloseButton.PNG" style="position: absolute ;top:84px; left:437px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('Main Menu').style.visibility='visible';
	document.getElementById('CampaignSelectionScreen').style.visibility='hidden'" onmouseover="document.getElementById('CampaignSelectorCloseButton').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="document.getElementById('CampaignSelectorCloseButton').src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="document.getElementById('CampaignSelectorCloseButton').src='Assets/Miscellaneous/CloseButtonPressed.PNG'"/>

	<img id="Somertin Flag" style="position: absolute; z-index:10; top:0px; left:0px; width:350px; height:200px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(1)" src="Assets/Flags/FlagSOM.PNG"/>
	<img id="Kargit Flag" style="position: absolute; z-index:10; top:0px; left:650px; width:350px; height:200px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(2)" src="Assets/Flags/FlagKar.PNG"/>
	<img id="Transkal Flag" style="position: absolute; z-index:10; top:250px; left:0px; width:300px; height:200px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(3)" src="Assets/Flags/FlagTRK.PNG"/>
	<img id="Polasie Flag" style="position: absolute; z-index:10; top:250px; left:350px; width:300px; height:200px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(4)" src="Assets/Flags/FlagPOE.PNG"/>
	<img id="Elam Flag" style="position: absolute; z-index:10; top:250px; left:700px; width:300px; height:200px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(5)" src="Assets/Flags/FlagELM.PNG"/>
	<img id="Cohort Flag" style="position: absolute; z-index:10; top:500px; left:0px; width:200px; height:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(6)" src="Assets/Flags/NoFlag.PNG"/>
	<img id="Slave Flag" style="position: absolute; z-index:10; top:500px; left:200px; width:200px; height:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(7)" src="Assets/Flags/NoFlag.PNG"/>
	<img id="Structuralist Flag" style="position: absolute; z-index:10; top:500px; left:400px; width:200px; height:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(8)" src="Assets/Flags/NoFlag.PNG"/>
	<img id="Syndicalist Flag" style="position: absolute; z-index:10; top:500px; left:600px; width:200px; height:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(9)" src="Assets/Flags/NoFlag.PNG"/>
	<img id="Mutasarif Flag" style="position: absolute; z-index:10; top:500px; left:800px; width:200px; height:140px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="NationDetails(10)" src="Assets/Flags/NoFlag.PNG"/>
	<img id="Sample Flag" style="position: absolute; z-index:10; top:0px; left:400px; width:200px; height:200px; visibility: hidden;" onclick="NationDetails(0)" src="Assets/Flags/NoFlag.PNG"/>
<div id="NationDetails" style="visibility: hidden; position:absolute; left:150px; top:75px; z-index: 10; color:#ccff99">
	<img style="position: absolute;" src="Assets/Miscellaneous/NationPanel.PNG"/>
	<img id="NationDetailsClose" onclick="document.getElementById('NationDetails').style.visibility='hidden'" style="position: absolute; left: 281px; top: -35px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="document.getElementById('NationDetailsClose').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="document.getElementById('NationDetailsClose').src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="document.getElementById('NationDetailsClose').src='Assets/Miscellaneous/CloseButtonPressed.PNG'"/>
	<p id="NationName" style="position:absolute; left: 10px; z-index:11">Nation:</p>
	<p id="FactionName" style="position:absolute; z-index:11; left:10px; top:28px">Alliance:</p>
	<p id="NationStatusName" style="position:absolute; z-index:11; left:10px; top:56px">Status:</p>
	<p id="NationSynopsis" style="position:absolute; z-index:11; left:10px; top: 98px">Synopsis:</p>
	<p id="NationNameSpecific" style="position:absolute; z-index:11; width: 350px; left: 65px">Somertin Federatio</p>
	<p id="FactionNameSpecific" style="position:absolute; z-index:11; width: 350px; left: 77px; top:28px">Global Security League</p>
	<p id="NationStatus" style="position:absolute; z-index:11; width: 350px; left: 77px; top:56px">Great Power</p>
	<p id="NationSynopsisSpecific" style="position:absolute; z-index:11; width: 690px; height:350px; left:10px; top: 126px; font-size:12px">Lorem ipsum dolor sit amet. What do I mean? What the hell are you doing here in the first place? If you see this text it means you fucked around with the game. Get out! Shoo!</p>
	<img id="NationColor" style="position:absolute;z-index: 11; top:10px;left:620px" src="Assets/Miscellaneous/NationColor.PNG">
	
	<div style="position: absolute; text-align:center; top: 425px; left: 150px; width:391px; height:100px" onclick="CallCampaignScreen()">
	<img id="CampaignSelectedButton" style="position: absolute; z-index:11; left: 135px; top: -10px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/GenericButton.PNG" onmouseover="document.getElementById('CampaignSelectedButton').src='Assets/Miscellaneous/GenericButtonHovered.PNG'" onmouseout="document.getElementById('CampaignSelectedButton').src='Assets/Miscellaneous/GenericButton.PNG'" onmousedown="document.getElementById('CampaignSelectedButton').src='Assets/Miscellaneous/GenericButtonPressed.PNG'"/>
	<p id="CampaignSelectedText" style="position: absolute; z-index:11; top: 0px; width:391px; color:black; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto"></p>
	</div>
	</div>
<div id="CampaignScreen" style="visibility: hidden; position:absolute; width: 1000px; height: 700px; background-color:#202020; text-align:center">

	<img id="ChapterIllustration" style="position: absolute; width:1000px; height:700px; top:0px; left:0px" src="Assets/Paralogues/1-1.jpg"/>

	<div style="position: absolute; width: 100px; height:250px; top:105px; left:100px" oncontextmenu="Tooltip(13);this.style.opacity=0.35" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.opacity=1">
		<img style="position:absolute; left:0px" src="Assets/Miscellaneous/ChapterPanel.PNG"/>
		<img id="ChapterPanelPointer" style="position: absolute; left:-40px; top:-6px" src="Assets/Miscellaneous/ArrowPointer.PNG"/>

		<div id="Chapter 1" style="position:absolute; left:10px; top:10px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(1)">
		<img id="Chp1plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp1text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 1</p>
		</div>
		<div id="Chapter 2" style="position:absolute; left:10px; top:44px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(2)">
		<img id="Chp2plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp2text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 2</p>
		</div>
		<div id="Chapter 3" style="position:absolute; left:10px; top:77px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(3)">
		<img id="Chp3plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp3text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 3</p>
		</div>
		<div id="Chapter 4" style="position:absolute; left:10px; top:110px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(4)">
		<img id="Chp4plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp4text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 4</p>
		</div>
		<div id="Chapter 5" style="position:absolute; left:10px; top:143px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(5)">
		<img id="Chp5plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp5text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 5</p>
		</div>
		<div id="Chapter 6" style="position:absolute; left:10px; top:176px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(6)">
		<img id="Chp6plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp6text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 6</p>
		</div>
		<div id="Chapter 7" style="position:absolute; left:10px; top:210px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="ChooseChapter(7)">
		<img id="Chp7plaque" src="Assets/Miscellaneous/NonPlaque.PNG"/>
		<p id="Chp7text" style="position: absolute; top:6px; width:80px; height:31px; text-align: center; z-index: 1; margin:0">Chapter 7</p>
		</div>

	</div>

	<div style="position: absolute; top:357px; left: 95px; width: 100px; height: 130px" oncontextmenu="Tooltip(16);this.style.opacity=0.35" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.opacity=1">
		<img style="position:absolute; left:0px" src="Assets/Miscellaneous/HotseatPanel.PNG"/>
		<p style="position:relative; top:0px; left:5px; z-index:1">Hotseat Settings</p>
		<p style="position:relative; top:0px; left:5px; z-index:1">Work in Progress</p>


	</div>

	<div style="position: absolute; top: 490px; left: 95px" oncontextmenu="Tooltip(15);this.style.opacity=0.35" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.opacity=1">
	<img src="Assets/Miscellaneous/DifficultyPanel.png"/>
	<img style="position: absolute; top: 50px; left: 15px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/DifficultyBarEasy.PNG" onclick="Difficulty=1; document.getElementById('DifficultyPanelPointer').style.top='35px'"/>
	<img style="position: absolute; top: 87px; left: 15px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/DifficultyBarMedium.PNG" onclick="Difficulty=2; document.getElementById('DifficultyPanelPointer').style.top='72px'"/>
	<img style="position: absolute; top: 124px; left: 15px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/DifficultyBarHard.PNG" onclick="Difficulty=2; document.getElementById('DifficultyPanelPointer').style.top='72px'; alert('HALT! You are not ready to face such difficulty yet!(nor was it implemented)')"/>
	<img style="position: absolute; top: 57px; left: 30px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale1.PNG" onclick="Difficulty=1; document.getElementById('DifficultyPanelPointer').style.top='35px'"/>
	<img style="position: absolute; top: 93px; left: 30px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale2.PNG" onclick="Difficulty=2; document.getElementById('DifficultyPanelPointer').style.top='72px'"/>
	<img style="position: absolute; top: 130px; left: 30px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Traits/Morale3.PNG" onclick="Difficulty=2; document.getElementById('DifficultyPanelPointer').style.top='72px'; alert('HALT! You are not ready to face such difficulty yet!(nor was it implemented)')"/>
	<img id="DifficultyPanelPointer" style="position:absolute; top: 35px; left: -40px" src="Assets/Miscellaneous/ArrowPointer.PNG"/>
	<p id="CampaignDifficultyP" style="position: absolute; text-align:center; width: 96px; left: 8px; height: 20px; top: 5px">Difficulty</p>
	<p id="Diff1Text" style="position: absolute; width:70px; left: 40px; top: 41px">Justin Bieber</p>
	<p id="Diff2Text" style="position: absolute; width:70px; left: 40px; top: 78px">Keanu Reeves</p>
	<p id="Diff3Text" style="position: absolute; width:70px; left: 40px; top: 115px">Chuck Norris</p>	
	</div>

	<img style="position: absolute; top:-50px; left:325px" src="Assets/Miscellaneous/TitlePanel.PNG" onmouseover="this.style.opacity=0.35" onmouseout="this.style.opacity=1"/>
	<p id="CampaignName" style="position: relative; z-index:7">This is Chapter Black</p>

	<div style="position:absolute; left:280px; top: 100px; width:500px; height:70px" oncontextmenu="Tooltip(14);this.style.opacity=0.35" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.opacity=1">
		<img id="EmblemSlot" style="position:absolute; top:-16px; left:0px; z-index:1" id="EmblemHighlighter" src="Assets/Miscellaneous/EmblemSlot.PNG"/>
		<img id="Emblem1" style="position: absolute; left:15px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Emblems/EmblemSOM.PNG" onclick="ChooseMission(1)" />
		<img id="Emblem2" style="position: absolute; left:100px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Emblems/NONEmblemSOM.PNG" onclick="ChooseMission(2)" />
		<img id="Emblem3" style="position: absolute; left:185px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Emblems/NONEmblemSOM.PNG" onclick="ChooseMission(3)" />
		<img id="Emblem4" style="position: absolute; left:270px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Emblems/NONEmblemSOM.PNG" onclick="ChooseMission(4)" />
		<img id="Emblem5" style="position: absolute; left:355px; z-index:2; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Emblems/NONEmblemSOM.PNG" onclick="ChooseMission(5)" />
	</div>

	<div style="position: absolute; left:800px; top:105px" oncontextmenu="Tooltip(17);this.style.opacity=0.35" onmouseout="document.getElementById('GeneralTooltip').style.visibility='hidden';this.style.opacity=1">
		<img src="Assets/Miscellaneous/SpecificationsPanel.PNG"/>
		<p id="SpecificationText" style="position:absolute; text-align: center; width:168px; top:0px; left:0px; font-size:12px">Specifications</p>
		<img id="CampaignSpecification1" style="position: absolute; left:49px; top: 35px" src="Assets/Miscellaneous/MoneySpecification.PNG" onmouseover="AnalyzeSpecification(1)" />
		<img id="CampaignSpecification2" style="position: absolute; left:49px; top: 105px" src="Assets/Miscellaneous/SurvivalSpecification.PNG" onmouseover="AnalyzeSpecification(2)"/>
		<img id="CampaignSpecification3" style="position: absolute; left:49px; top: 160px" src="Assets/Miscellaneous/TimeLimitSpecification.PNG" onmouseover="AnalyzeSpecification(3)"/>
		<img id="CampaignSpecification4" style="position: absolute; left:49px; top: 215px" src="Assets/Miscellaneous/DefendSpecification.PNG" onmouseover="AnalyzeSpecification(4)"/>
		<img id="CampaignSpecification5" style="position: absolute; left:49px; top: 280px" src="Assets/Miscellaneous/CaptureSpecification.PNG" onmouseover="AnalyzeSpecification(5)"/>
		<img id="CampaignSpecification6" style="position: absolute; left:56px; top: 350px" src="Assets/Miscellaneous/ProtectSpecification.PNG" onmouseover="AnalyzeSpecification(6)"/>
		<img id="CampaignSpecification7" style="position: absolute; left:49px; top: 420px" src="Assets/Miscellaneous/AssassinateSpecification.PNG" onmouseover="AnalyzeSpecification(7)"/>

		</div>

	<div style="position: absolute; width:490px; height:350px; left: 250px; top: 175px; text-align:center" oncontextmenu="this.style.opacity=0.35" onmouseout="this.style.opacity=1">
		<img src="Assets/Miscellaneous/MissionPanel.PNG"/>
		<p id="MissionName" style="position: relative;z-index: 12; top:-350px"></p>
		<p id="MissionDescription" style="position: relative;z-index: 12; top:-350px; left:5px"></p>
	</div>
	
	<div style="position: absolute; width: 391px; height: 101px; text-align:center; left:305px; top:470px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('CampaignScreen').style.visibility='hidden';initializeBattle(ChosenNation,ChosenChapter,ChosenMission);" onmouseover="document.getElementById('LevelStartButon').src='Assets/Miscellaneous/StartButtonL.PNG'" onmouseout="document.getElementById('LevelStartButon').src='Assets/Miscellaneous/StartButton.PNG'">
		<img id="LevelStartButon" src="Assets/Miscellaneous/StartButton.PNG"/>
		<p id="LevelStartButton" style="position:relative; top: -80px">This thing is a thing</p>
	</div>

	<img id="CampaignCloseButton" src="Assets/Miscellaneous/CloseButton.PNG" style="position: absolute ;top:595px; left:820px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('Main Menu').style.visibility='visible';
	document.getElementById('CampaignScreen').style.visibility='hidden'" onmouseover="document.getElementById('CampaignCloseButton').src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="document.getElementById('CampaignCloseButton').src='Assets/Miscellaneous/CloseButton.PNG'" onmousedown="document.getElementById('CampaignCloseButton').src='Assets/Miscellaneous/CloseButtonPressed.PNG'"/>


	</div>
<div id="InterlogueScreen" style="position: absolute;visibility: hidden; left:-14px; top:0px">
	<img style="width:1000px;height:700px" src="Assets/Paralogues/ParalogueBackScreen.PNG"/>
	<img style="z-index:1; position:absolute; top:400px;left:0px; width:400px; height:300px" id="InterlogueImage" src="Assets/Paralogues/1X1.JPG"/>	
	<p style="position: absolute;z-index:1;color: white; width: 500px; height:700px; left:500px; top:0px; font-size:12px" id="InterlogueText">Lorem Ipsum</p>
	<img style="position: absolute; z-index: 1; left:650px; top:630px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" onclick="document.getElementById('InterlogueScreen').style.visibility='hidden';document.getElementById('Main Menu').style.visibility='visible'" src="Assets/Miscellaneous/CloseButton.PNG"/>
	</div>
<div id="EndBattleScreen" style="position:absolute; visibility: hidden; width:1000px; height:700px; top:0px; left:-15px; background-color:darkslategray; z-index: 2; overflow-y: hidden;">
	<p id="EndBattleTitle" style="position: absolute; width: 140px; height:35px; font-size:35px; left:420px; top: -35px; color:white; text-align:center; z-index: 3;">Victory</p>
	<p id="EndBattleQuote" style="position: absolute; width: 350px; height:35px; font-size:16px; left:315px; top: 35px; color:white; text-align:center; z-index: 3;"></p>
	<img id="EndBattleImage" style="position:fixed; background-attachment: local; top:0px; left:167px; width:1001px; height:700px" />
	<div style="position:fixed; width:980px; height:70px; top:510px; left:282px; scroll-behavior:smooth;" onmouseover="ScrollDown=setInterval(ScrollEndScreenDown,5); function ScrollEndScreenDown(){document.getElementById('EndBattleScreen').scrollBy(0,1)}" onmouseout="clearInterval(ScrollDown)"></div>
	<div style="position:fixed; width:980px; height:70px; top:20px; left:282px; scroll-behavior:smooth;" onmouseover="ScrollUp=setInterval(ScrollEndScreenUp,5); function ScrollEndScreenUp(){document.getElementById('EndBattleScreen').scrollBy(0,-1)}" onmouseout="clearInterval(ScrollUp)"></div>
	<img style="position:fixed; top: 630px; left: 617px; cursor: url('Assets/Miscellaneous/Cursor.png') 0 0, auto" src="Assets/Miscellaneous/CloseButton.PNG" onmouseover="this.src='Assets/Miscellaneous/CloseButtonHovered.PNG'" onmouseout="this.src='Assets/Miscellaneous/CloseButton.PNG'" onclick="this.src='Assets/Miscellaneous/CloseButtonPressed.PNG';for(let a=1; a<Constants.Commanders.length; a++){let elem=document.getElementById('AnalysisBlock'+Factions[Constants.Commanders[a].Allegiance].Preffix); elem.remove()}; for(let b=0; b<Coallitions.length; b++){let elem=document.getElementById('CoallitionTitle'+Coallitions[b]); elem.remove()}; Factions=CampaignFactions; document.getElementById('EndBattleScreen').style.visibility='hidden';
	if(ChosenMission==5 && Victory){CallInterlogue()}else{document.getElementById('Main Menu').style.visibility='visible'};"/>

	</div>


<button id='Attack Button' onClick="AttackingAnimation(3)" style='visibility: hidden ;position:absolute; top:20px; left:100px; height:70px; width:70px'>Attack</button>
<button id='Scroll Button' onClick="document.getElementById('UnitMap').scroll(50,50)" style='visibility: hidden ;position:absolute; top:90px; left:105px; height:70px; width:70px'>Scroll Test</button>
<button id='Battlewon Button' onClick="Battle_Won()" style='visibility: hidden ;position:absolute; top:20px; left:1050px; height:70px; width:70px'>Battle Win Test</button>
<button id='MoveTest' onClick="BLARG=[{X:1,Y:1}];MoveUnit(13,[0,7])" style='visibility: hidden ;position:absolute; top:90px; left:1100px; height:70px; width:70px'>Move Test</button>
<button id='FocalTest' onClick="EditorMap[1][1]=6;FocalEditorRefresh(2,2)" style='visibility: hidden ;position:absolute; top:160px; left:100px; height:70px; width:70px'>Focal Test</button>
<button id='ScrollbarTest' onClick="alert(document.getElementById('LorePanel').scrollTop);document.getElementById('LorePanel').scrollTop=0" style='visibility: hidden ;position:absolute; top:160px; left:1100px; height:70px; width:70px'>Scroll Offset</button>
<button id='Secret Settings Button' onClick="" style='visibility: hidden ;position:absolute; top:55px; left:830px; height:70px; width:70px'>Special Commands</button>



<script src="Extensions/Translations.js"></script>
<script src="Extensions/ROM.js"></script>
<script src="Extensions/ESP.js"></script>
<script src="Extensions/POR.js"></script>
<script src="Extensions/TUR.js"></script>

<script src="Extensions/Characters.js"></script>
<script src="Extensions/Codex.js"></script>
<script src="Extensions/Intraevents.js"></script>
<script src="Extensions/Maps.js"></script>
<script src="Extensions/GenericData.js"></script>
<script src="Extensions/SpecialLevels.js"></script>

<script type="text/javascript">

MainTheme=null;

ResolutionXFactor=1;
ResolutionYFactor=1;
BattleEnd=false;
ChosenNation=1;
ChosenChapter=1;
ChosenMission=1;
TutorialLevel=0;
StandardX=0;
StandardY=0;
ChosenMap=0;
GlobalDelayerConstant=0;
LastMove={ID:0, X:0, Y:0, HP:0, MOR:0, EID:0, EX:0, EY:0, EHP:0, EMOR:0, GRV:0};
FlagsToggled=false;
BadgesToggled=false;
BarsToggled=false;
CargoToggled=false;
RegionsToggled=false;
//UnlockedLevels=[true,false,false,false,false];

FieldMode="Null";

ChosenTerrain=1;
EditorUnitClass=1;
ChosenUnit={definite:false};
EditationToggle='Tile';
EditationColor=1;
EditationDirection=1;
SelectedNode=0;
EditorStandardX=0;
EditorStandardY=0;
EditorNationBatch=0;
RegionalToggle=false;
NivelElectiv=0;
MemoryX=1;
MemoryY=1;


Language=ENG;
LevelMap=Palawan;
LevelRoster=PalawanRoster;
Panel=0;
Difficulty=2;
Playlists=[];
InterlogueBST=[[],[],[],[],[],[],[],[],[],[],[]];


Campaigns=[
	[	[{Map:Presus,Roster:PresusRoster,Constants:PresusConstants,Finished:true,Localization:PresusLocalization},{Map:RockyMountainsCentra,Roster:RockyMountainsCentraRoster,Constants:RockyMountainsCentraConstants,Finished:true},{Map:Moh,Roster:MohRoster,ControlMap:MohControl,Constants:MohConstants,Finished:true},{Map:Patna,Roster:PatnaRoster,ControlMap:PatnaControl,Constants:PatnaConstants,Finished:true,Funds:[0,500,500]},{Map:Kaula,Roster:KaulaRoster,ControlMap:KaulaControl,Constants:KaulaConstants,Finished:true}],
		[{Map:Interriverana,Roster:InterriveranaRoster,Constants:InterriveranaConstants,ControlMap:InterriveranaControl,Finished:true},{Map:SouthMolda,Roster:SouthMoldaRoster,Constants:SouthMoldaConstants,Finished:true},{Map:HevanSea,Constants:HevanSeaConstants,Roster:HevanSeaRoster,Finished:true},{Map:WestMazowia,Roster:WestMazowiaRoster,Constants:WestMazowiaConstants,Finished:true},{Map:Patna,Roster:PatnaRoster2,ControlMap:PatnaControl2,Constants:PatnaConstants2,Finished:true}],
		[{Map:Kielbasa.Map,Roster:KielbasaRoster,Constants:KielbasaConstants,Finished:true},{Map:ValeriaIsland,Roster:ValeriaIslandRoster,Constants:ValeriaIslandConstants,Finished:true},{Map:NorthCoast,Roster:NorthCoastRoster2,Constants:NorthCoastConstants2,Finished:true},{Map:Holelandia,Roster:HolelandiaRoster,Constants:HolelandiaConstants,ControlMap:HolelandiaControl,Finished:true},{Map:Ursa,Roster:UrsaRoster,Constants:UrsaConstants,Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Map:RockyMountainsCentra,Roster:RockyMountainsCentraRoster,Constants:RockyMountainsCentraConstantsReverse,Finished:true},{Map:Presus,Roster:PresusRoster,Constants:PresusConstantsReverse,Finished:true},{Map:Panere,Roster:PanereRoster,Constants:PanereConstants,Finished:true},{Map:Mica,Roster:MicaRoster2,Constants:MicaConstants2,Finished:true},{Map:Patna,Roster:PatnaRoster,ControlMap:PatnaControl,Constants:PatnaConstantsAlter,Finished:true}],
		[{Map:Patna,Roster:PatnaRosterPara,ControlMap:PatnaControlPara,Constants:PatnaConstantsPara,Finished:true},{Map:Posun,Roster:PosunRoster,Constants:PosunConstants,Finished:true},{Map:Posun,Roster:PosunRoster2,Constants:PosunConstants2,Finished:true},{Map:WestMazowia,Roster:WestMazowiaRoster,Constants:WestMazowiaConstants2,Finished:true},{Map:Kaula,Roster:KaulaRoster,ControlMap:KaulaControl,Constants:KaulaConstantsAlter,Finished:true}],
		[{Map:Dambova,Roster:DambovaRoster,Constants:DambovaConstants,Finished:true},{Map:Kaula,Roster:KaulaRosterAlter,Constants:KaulaConstantsAlter2,ControlMap:KaulaControlAlter,Finished:true},{Map:SomertinNE,Roster:SomertinNERoster,Constants:SomertinNEConstants,ControlMap:SomertinNEControl,Finished:true},{Map:InterriveranaAir,Roster:InterriveranaAirRoster,Constants:InterriveranaAirConstants,Finished:true},{Map:SomertinSE,Roster:SomertinSERoster,Constants:SomertinSEConstants,ControlMap:SomertinSEControl,Finished:false},],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Map:SvelgeCoast, Roster: SvelgeCoastRoster, Constants:SvelgeCoastConstants, BiomeMap:BorealMap10X10, Finished:true},{Map:JyllaCoast, Roster:JyllaCoastRoster, Constants:JyllaCoastConstants, BiomeMap:BorealMap10X10, Finished:true},{Map:SvelgeCoast, Roster: SvelgeCoastRoster2, Constants:SvelgeCoastConstants2, BiomeMap:BorealMap10X10, Finished:true},{Map:JyllaCoast, Roster:JyllaCoastRoster2, Constants:JyllaCoastConstants2, BiomeMap:BorealMap10X10, Finished:true},{Map:Palace,Roster:PalaceRoster,ControlMap:PalaceControl,Constants:PalaceConstants, BiomeMap:BorealMap10X10,Finished:true}],
		[{Map:SWBurluk,Constants:SWBurlukConstants,Roster:SWBurlukRoster,Finished:true},{Map:SouthMolda,Constants:SouthMoldaConstantsPara,Roster:SouthMoldaRoster,Finished:true},{Map:ElamGulf,Constants:ElamGulfConstants,Roster:ElamGulfRoster,Finished:true},{Map:Kaula,Constants:KaulaConstantsPara,Roster:KaulaRoster,ControlMap:KaulaControl,Finished:true},{Map:KaulaPocket,Constants:KaulaPocketConstants,Roster:KaulaPocketRoster,Finished:true}],
		[{Map:Kcirokaster,Roster:KcirokasterRoster,Constants:KcirokasterConstants,Finished:true},{Map:AirExercise,Roster:AirExerciseRoster,Constants:AirExerciseConstants,Finished:true},{Map:Patna,Roster:PatnaRosterAntistasi,Constants:PatnaConstantsAntistasi,ControlMap:PatnaControlAntistasi,Finished:true},{Map:BlachiaSouth,Roster:BlachiaSouthRoster,Constants:BlachiaSouthConstants,Finished:true},{Map:SouthReginate,Roster:SouthReginateRoster,Constants:SouthReginateConstants,Localization:SouthReginateLocalization, BiomeMap:BorealMap10X10,Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Map:ToraToraTora,Roster:ToraToraToraRoster,Constants:ToraToraToraConstants,Finished:true},{Map:NorthCoast,Roster:NorthCoastRoster,Constants:NorthCoastConstants,Finished:true},{Map:Moh,Roster:MohRoster,ControlMap:MohControl,Constants:MohConstants2,Finished:true},{Map:Moh2,Roster:Moh2Roster,ControlMap:Moh2Control,Constants:Moh2Constants,Finished:true},{Map:Golubuju,Roster:GolubujuRoster,Constants:GolubujuConstants,Finished:true}],
		[{Map:SvelgianSea,Roster:SvelgianSeaRoster,Constants:SvelgianSeaConstants,Finished:true},{Map:SvelgeCoast,Roster:SvelgeCoastRoster,Constants:SvelgeCoastConstantsAlter, BiomeMap:BorealMap10X10,Finished:true},{Map:JarviCoast,Roster:JarviCoastRoster,Constants:JarviCoastConstants, BiomeMap:JarviBiomeMap,Finished:true},{Map:SvelgeInlands,Roster:SvelgeInlandsRoster,Constants:SvelgeInlandsConstants,ControlMap:SvelgeInlandsControl, BiomeMap:BorealMap10X10,Finished:true},{Map:SvelgeInlands,Roster:SvelgeInlandsRoster2,Constants:SvelgeInlandsConstants2,ControlMap:SvelgeInlandsControl2, BiomeMap:BorealMap10X10,Finished:true}],
		[{Map:Moh2,ControlMap:Moh2Control2,Constants:Moh2ConstantsAir,Roster:Moh2RosterAir,Finished:true},{Map:Moh2,ControlMap:Moh2Control2,Constants:Moh2Constants2,Roster:Moh2Roster2,Finished:true},{Map:HevanSea,Constants:HevanSeaConstants2,Roster:HevanSeaRoster2,Finished:true},{Map:SvelgeCoast,Constants:SvelgeCoastConstants3,Roster:SvelgeCoastRoster3, BiomeMap:BorealMap10X10,Finished:true},{Map:NorthCoast,Roster:NorthCoastRoster2,Constants:NorthCoastConstants2Para,Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Map:Mica,Roster:MicaRoster,Constants:MicaConstants,Finished:true},{Map:Kandahar,Roster:KandaharRoster,Constants:KandaharConstants,Finished:true},{Map:Shahar,Roster:ShaharRoster,Constants:ShaharConstants,Finished:true},{Map:Sassafras,Roster:SassafrasRoster,Constants:SassafrasConstants,Finished:true},{Map:Mica2,Roster:Mica2Roster,Constants:Mica2Constants,Finished:true}],
		[{Map:Mica2,Roster:Mica2Roster2,Constants:Mica2Constants,Finished:true},{Map:JyllaCoast,Roster:JyllaCoastRoster,Constants:JyllaCoastConstantsPara, BiomeMap:BorealMap10X10,Finished:true},{Map:SouthDacia,Roster:SouthDaciaRoster,Constants:SouthDaciaConstants,Finished:true},{Map:JyllaCoast,Roster:JyllaCoastRoster3,Constants:JyllaCoastConstants3, BiomeMap:BorealMap10X10,Finished:true},{Map:JyllaCoast,Roster:JyllaCoastRoster4,Constants:JyllaCoastConstants4, BiomeMap:BorealMap10X10,Finished:true},],
		[{Map:SouthDacia,Roster:SouthDaciaRoster2,Constants:SouthDaciaConstants2,Finished:true},{Map:Kandahar,Roster:KandaharRoster2,Constants:KandaharConstants2,Finished:true},{Map:JyllaCoast,Roster:JyllaCoastRoster5,Constants:JyllaCoastConstants5, BiomeMap:BorealMap10X10,Finished:true},{Map:ElamGulf,Constants:ElamGulfConstantsAlter,Roster:ElamGulfRoster,Finished:true},{Map:ShaharExtended,Roster:ShaharExtendedRoster,Constants:ShaharExtendedConstants,Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	
	[	[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[	[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}],
		[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	[[{Finished:false},{Finished:false},{Finished:false},{Finished:false},{Finished:false}]],
	];
//obsolete registries, will mess up game
Terrain=[
	{name: "", passThrough: true, flyThrough: true, sailThrough: false, src:"", traverseFactor:1, protectionFactor:1}, 

	//1-5

	{name: "Plains", WalkThrough: 1, DriveThrough: 1.2, RollThrough: 1.2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:1, protectionFactor:1,Urbanistics:0,tag1:"Uneven",tag2:"",tag3:"",tag4:""},
	{name: "Forest", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.8,Urbanistics:0,tag1:"Rugged",tag2:"Concealment",tag3:"",tag4:""},
	{name: "Hills", WalkThrough: 1.5, DriveThrough: 1.5, RollThrough: 1.5, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:1.5, protectionFactor:0.8,Urbanistics:0,tag1:"Rugged",tag2:"Concealment",tag3:"Vantage",tag4:""},
	{name: "Mountain", WalkThrough: 2, DriveThrough: 3, RollThrough: 5, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:5, protectionFactor:0.6,Urbanistics:0,tag1:"Precipitous",tag2:"Bunker",tag3:"Vantage",tag4:""},	
	{name: "Volcano", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 100, SailThrough: 100, DeepSailThrough:100, WadeThrough:100, protectionFactor:10000000,Urbanistics:0,tag1:"Impassable",tag2:"",tag3:"",tag4:""},

	//6-14

	{name: "Road", WalkThrough: 1, DriveThrough: 1, RollThrough: 1, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:1, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Ruins", WalkThrough: 2, DriveThrough: 3, RollThrough: 3, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.8,Urbanistics:1,tag1:"Rugged",tag2:"",tag3:"",tag4:""},
	{name: "Urban District", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.8,Urbanistics:1,tag1:"Rugged",tag2:"",tag3:"",tag4:""},
	{name: "Industrial District", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Military-Industrial Complex", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Aviation Industrial Facility", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Shipbuilding Facility", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Headquarters", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.5,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Command Center", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.5,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},

	//15-19

	{name: "Taiga", WalkThrough: 1.5, DriveThrough: 2, RollThrough: 2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:2, protectionFactor:0.8,Urbanistics:0,tag1:"Rugged",tag2:"Concealment",tag3:"",tag4:""},
	{name: "Desert", WalkThrough: 1, DriveThrough: 1.2, RollThrough: 1.2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:1, protectionFactor:1,Urbanistics:0,tag1:"Uneven",tag2:"",tag3:"",tag4:""},
	{name: "Tundra", WalkThrough: 1, DriveThrough: 1.2, RollThrough: 1.2, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:1, protectionFactor:0.8,Urbanistics:0,tag1:"Uneven",tag2:"",tag3:"",tag4:""},
	{name: "Extreme Desert", WalkThrough: 2, DriveThrough: 5, RollThrough: 3, FlyThrough: 1, SailThrough: 100, DeepSailThrough:100, WadeThrough:5, protectionFactor:1,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Frozen Hellhole", WalkThrough: 2, DriveThrough: 5, RollThrough: 3, FlyThrough: 2, SailThrough: 100, DeepSailThrough:100, WadeThrough:5, protectionFactor:1,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},

	//20-21


	{name: "Bridge", WalkThrough: 1, DriveThrough: 1, RollThrough: 1, FlyThrough: 1, SailThrough: 50, DeepSailThrough:50, WadeThrough:1, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "High Bridge", WalkThrough: 1, DriveThrough: 1, RollThrough: 1, FlyThrough: 1, SailThrough: 1, DeepSailThrough:2, WadeThrough:1, protectionFactor:1,Urbanistics:1,tag1:"",tag2:"",tag3:"",tag4:""},

	//22-30

	{name: "River", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1, DeepSailThrough:100, WadeThrough:3, protectionFactor:1.4,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Sea", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1, DeepSailThrough:1, WadeThrough:100, protectionFactor:1,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},
	{name: "Reef", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1.2, DeepSailThrough:2, WadeThrough:100, protectionFactor:0.8,Urbanistics:0,tag1:"Tricky Waters",tag2:"Naval Concealment",tag3:"",tag4:""},
	{name: "Floes", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 2, DeepSailThrough:1.25, WadeThrough:100, protectionFactor:0.8,Urbanistics:0,tag1:"Tricky Waters",tag2:"Naval Concealment",tag3:"",tag4:""},
	{name: "Archipelago", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1.5, DeepSailThrough:2, WadeThrough:100, protectionFactor:0.6,Urbanistics:0,tag1:"Tricky Waters",tag2:"Naval Concealment",tag3:"",tag4:""},
	{name: "Rock Formation", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1.5, DeepSailThrough:2, WadeThrough:100, protectionFactor:0.6,Urbanistics:0,tag1:"Bunker",tag2:"Tricky Waters",tag3:"Dangerous",tag4:""},
	{name: "Icebergs", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1.5, DeepSailThrough:2, WadeThrough:100, protectionFactor:0.6,Urbanistics:0,tag1:"Bunker",tag2:"Tricky Waters",tag3:"Dangerous",tag4:""},
	{name: "Shore", WalkThrough: 1, DriveThrough: 1.2, RollThrough: 1.2, FlyThrough: 1, SailThrough: 1, DeepSailThrough:100, WadeThrough:1, protectionFactor:1.2,Urbanistics:0,tag1:"Shallow",tag2:"Uneven",tag3:"",tag4:""},
	{name: "Oil Rig", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1, DeepSailThrough:1, WadeThrough:100, protectionFactor:1,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},

	{name: "RiverSource", WalkThrough: 100, DriveThrough: 100, RollThrough: 100, FlyThrough: 1, SailThrough: 1, DeepSailThrough:100, WadeThrough:2, protectionFactor:100,Urbanistics:0,tag1:"",tag2:"",tag3:"",tag4:""},
	];
Units=[
	{name: "null", HP:0, Armor: "Medium", Attack: 0, Weapon: "Medium", Speed:0, Movement: "Foot", MinRange:1, MaxRange:1, Cost:0 ,tag1:"", tag2:"", tag3:"", tag4:"",StaticOffsetX:[0,0,0,0,0],StaticOffsetY:[0,0,0,0,0],MovementBoxX:0,MovementBoxY:0,MovementOffsetX:[0,0,0,0,0],MovementOffsetY:[0,0,0,0,0],AttackOffsetX:[0,0,0,0,0],AttackOffsetY:[0,0,0,0,0],IdleOffsetX:[0,0,0,0,0],IdleOffsetY:[0,0,0,0,0]},
	{name: "Light Infantry", HP:50, shortname: "LightInf", Armor: "Light", Attack: 20, Weapon: "Light", Speed:4, Movement: "Foot", MinRange:1, MaxRange:1, Cost:50, tag1:"Conqueror", tag2:"Streamlined", tag3:"", tag4:""},
	{name: "Infantry", HP:70, shortname: "Infantry", Armor: "Light", Attack: 25, Weapon: "Light", Speed:3, Movement: "Foot", MinRange:1, MaxRange:1, Cost:100, tag1:"Conqueror", tag2:"", tag3:"", tag4:"" ,AttackOffsetX:[0,0,9,0,-9]},
	{name: "Motorized Infantry", shortname: "Motorinf", HP:70, Armor: "Light", Attack: 25, Weapon: "Medium", Speed:6, Movement: "Wheeled", MinRange:1, MaxRange:1, Cost:200, tag1:"Conqueror", tag2:"", tag3:"", tag4:""},
	{name: "White Guards", shortname: "Guards", HP:105, Armor: "Light", Attack: 35, Weapon: "Medium", Speed:3, Movement: "Foot", MinRange:1, MaxRange:1, Cost:250, tag1:"Conqueror", tag2:"Heroic", tag3:"", tag4:"", AttackOffsetX:[0,0,8,0,-8]},
	{name: "Spec-Ops", shortname: "SpecOps", HP:50, Armor: "Light", Attack: 20, Weapon: "Heavy", Speed:4, Movement: "Foot", MinRange:1, MaxRange:1, Cost:250, tag1:"Conqueror", tag2:"Anti-Structure", tag3:"Stealth", tag4:"",AttackOffsetX:[0,0,13,0,-13]},
	{name: "Transkalite Snipers", shortname: "Snipers", HP:70, Armor: "Light", Attack: 30, Weapon: "Light", Speed:4, Movement: "Foot", MinRange:1, MaxRange:1, Cost:250, tag1:"Conqueror", tag2:"Commando", tag3:"", tag4:"",AttackOffsetX:[0,-2,8,-2,-12]},
	{name: "Polesian Marines", shortname: "Marines", HP:70, Armor: "Light", Attack: 30, Weapon: "Light", Speed:3, Movement: "Amphibious", MinRange:1, MaxRange:1, Cost:250, tag1:"Conqueror", tag2:"Crab", tag3:"", tag4:"",AttackOffsetX:[0,0,13,0,-13]},
	{name: "Stormtroopers", shortname: "Stormtroopers", HP:70, Armor: "Light", Attack: 30, Weapon: "Medium", Speed:3, Movement: "Foot", MinRange:1, MaxRange:3, Cost:250, tag1:"Conqueror", tag2:"", tag3:"", tag4:""},
	{name: "Bolt Tank Battalion", shortname: "Bolt", HP:55, Armor: "Light", Attack: 25, Weapon: "Light", Speed:6, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:235, tag1:"Schwerpunkt", tag2:"", tag3:"", tag4:""},
	{name: "Asekara Tank Battalion", shortname: "Asekara", HP:70, Armor: "Medium", Attack: 35, Weapon: "Medium", Speed:5, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:340, tag1:"Streamlined", tag2:"Schwerpunkt", tag3:"", tag4:"", AttackOffsetX:[0,-15,-15,-15,-15], AttackOffsetY:[0,-17,-13,-17,-13]},
	{name: "Gorlitz Tank Battalion", shortname: "Gorlitz", HP:105, Armor: "Heavy", Attack: 50, Weapon: "Heavy", Speed:4, Movement: "Tracked", MinRange:1, MaxRange:1,  Cost:550, tag1:"", tag2:"", tag3:"", tag4:""},
	{name: "Flak Tank", shortname: "Flak", HP:55, Armor: "Light", Attack: 20, Weapon: "Light", Speed:5, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:285, tag1:"Skysweeper", tag2:"Anti-Air", tag3:"", tag4:"",AttackOffsetX:[0,0,-10,-21,-40],AttackOffsetY:[0,-28,-44,-21,-44]},
	{name: "Tank-Hunter", shortname: "Hunter", HP:60, Armor: "Medium", Attack: 35, Weapon: "Medium", Speed:5, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:315, tag1:"Anti-Tank", tag2:"", tag3:"", tag4:"",AttackOffsetX:[0,8,-10,7,-49],AttackOffsetY:[0,-40,-44,0,-2]},
	{name: "Imperterritus Tank Battalion", shortname: "Imperterritus", HP:175, Armor: "Heavy", Attack: 55, Weapon: "Heavy", Speed:3, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:1050 ,tag1:"Anti-Tank", tag2:"Cemented Steel Armor", tag3:"", tag4:"", StaticOffsetX:[0,-22,0,-23,-44], StaticOffsetY:[0,-20,0,-2,0], AttackOffsetX:[0,-32,0,-32,-63], AttackOffsetY:[0,-25,-12,0,-12] ,MovementBoxX:100, MovementBoxY:70,MovementOffsetX:[0,-20,0,0,0],MovementOffsetY:[0,-20,0,-20,-44]},
	{name: "Koschei Tank Battalion", shortname: "Koschei", HP:100, Armor: "Heavy", Attack: 55, Weapon: "Medium", Speed:4, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:760 ,tag1:"Schwerpunkt", tag2:"Bewegungskrieg", tag3:"", tag4:"", AttackOffsetX:[0,-19,-10,-19,-23], AttackOffsetY:[0,-23,-13,0,-13]},
	{name: "500mm Big Bertha Battery", shortname: "Thunder", HP:100, Armor: "Medium", Attack: 55, Weapon: "Heavy", Speed:3, Movement: "Tracked", MinRange:3, MaxRange:7, Cost:845 ,tag1:"Anti-Structure", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "Crab Tank Battalion", shortname: "Crab", HP:50, Armor: "Light", Attack: 55, Weapon: "Medium", Speed:5, Movement: "Amphibious", MinRange:1, MaxRange:1, Cost:325 ,tag1:"Crab", tag2:"", tag3:"", tag4:""},
	{name: "AMPAC", shortname: "AMPAC", HP:75, Armor: "Medium", Attack: 55, Weapon: "Medium", Speed:5, Movement: "Tracked", MinRange:1, MaxRange:1, Cost:425 ,tag1:"Anti-Tank", tag2:"Commando", tag3:"Streamlined", tag4:""},
	{name: "Howitzer Battery", shortname: "Howitzer", HP:40, Armor: "Light", Attack: 30, Weapon: "Heavy", Speed:3, Movement: "Tracked", MinRange:3, MaxRange:5, Cost:375, tag1:"Anti-Structure", tag2:"", tag3:"", tag4:"",AttackOffsetX:[0,-9,0,-9,-7], AttackOffsetY:[0,-14,-7,-14,-14]},
	{name: "Hellstorm Battery", shortname: "Hellstorm", HP:40, Armor: "Light", Attack: 40, Weapon: "Medium", Speed:6, Movement: "Wheeled", MinRange:2, MaxRange:4,  Cost:550, tag1:"Mobile Battery", tag2:"", tag3:"", tag4:""},
	{name: "SCADP", shortname: "SCADP", HP:40, Armor: "Light", Attack: 20, Weapon: "Light", Speed:6, Movement: "Wheeled", MinRange:2, MaxRange:4,  Cost:940, tag1:"Anti-Infantry", tag2:"Dispersion", tag3:"", tag4:""},
	{name: "Raptor Fighter Squadron", shortname: "Raptor", HP:50, Armor: "Light", Attack: 25, Weapon: "Light", Speed:8, Movement: "Flight", MinRange:1, MaxRange:1,  Cost:400, tag1:"Skysweeper", tag2:"", tag3:"", tag4:""},
	{name: "Eagle Striker Squadron", shortname: "Eagle", HP:50, Armor: "Light", Attack: 30, Weapon: "Medium", Speed:7, Movement: "Flight", MinRange:1, MaxRange:1,  Cost:450, tag1:"", tag2:"", tag3:"", tag4:"",AttackOffsetX:[0,-2,0,-2,0]},
	{name: "Condor Bomber Squadron", shortname: "Condor", HP:50, Armor: "Light", Attack: 35, Weapon: "Heavy", Speed:6, Movement: "Flight", MinRange:1, MaxRange:1,  Cost:550, tag1:"", tag2:"", tag3:"", tag4:""},
	{name: "Akontio Torpedor Squadron", shortname: "Akontio", HP:50, Armor: "Light", Attack: 50, Weapon: "Medium", Speed:6, Movement: "Flight", MinRange:1, MaxRange:1,  Cost:500, tag1:"", tag2:"", tag3:"", tag4:""},
	{name: "Zeus Stormlord", shortname: "Zeus", HP:70, Armor: "Light", Attack: 35, Weapon: "Medium", Speed:10, Movement: "Flight", MinRange:1, MaxRange:1,  Cost:750, tag1:"", tag2:"", tag3:"", tag4:"",AttackOffsetX:[0,-2,0,-2,0]},
	{name: "Intrepid", shortname: "Intrepid", HP:50, Armor: "Light", Attack: 15, Weapon: "Light", Speed:6, Movement: "Rudder", MinRange:1, MaxRange:1, Cost:170 ,tag1:"Conqueror", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "Submersible", shortname: "Submersible", HP:25, Armor: "Light", Attack: 50, Weapon: "Medium", Speed:3, Movement: "Heavy Rudder", MinRange:1, MaxRange:1, Cost:400 ,tag1:"Submarine", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "Destroyer", shortname: "Destroyer", HP:50, Armor: "Medium", Attack: 25, Weapon: "Medium", Speed:5, Movement: "Rudder", MinRange:1, MaxRange:2, Cost:300 ,tag1:"Depth Strike", tag2:"Skysweeper", tag3:"Sonar", tag4:"Steer", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "Light Cruiser", shortname: "CruiserL", HP:70, Armor: "Medium", Attack: 30, Weapon: "Medium", Speed:5, Movement: "Rudder", MinRange:1, MaxRange:3, Cost:500 ,tag1:"Depth Strike", tag2:"Sonar", tag3:"Skysweeper", tag4:"Anti-Air", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "Heavy Cruiser", shortname: "CruiserH", HP:105, Armor: "Heavy", Attack: 40, Weapon: "Heavy", Speed:4, Movement: "Rudder", MinRange:2, MaxRange:5, Cost:700 ,tag1:"Skysweeper", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackOffsetX:[0,10,-10,10,-43],AttackOffsetY:[0,-25,-42,-3,-42]},
	{name: "Capital Ship", shortname: "Battleship", HP:175, Armor: "Heavy", Attack: 50, Weapon: "Heavy", Speed:4, Movement: "Heavy Rudder", MinRange:3, MaxRange:7, Cost:1400 ,tag1:"Skysweeper", tag2:"", tag3:"", tag4:"", AttackOffsetX:[0,-44,-54,-44,-44], AttackOffsetY:[0,-37,-35,-35,-35]},
	{name: "Aircraft Carrier", shortname: "Carrier", HP:175, Armor: "Heavy", Attack: 35, Weapon: "Medium", Speed:4, Movement: "Heavy Rudder", MinRange:3, MaxRange:10, Cost:1750 ,tag1:"Skysweeper", tag2:"Anti-Ship", tag3:"", tag4:"", StaticOffsetX:[0,-10,-20,-10,-31], StaticOffsetY:[0,-20,-20,-20,-20],MovementOffsetX:[0,-20,-20,-10,-20],MovementOffsetY:[0,-10,0,-10,-15], AttackOffsetX:[0,-10,-17,-10,-31], AttackOffsetY:[0,-20,-20,-20,-20]},
	{name: "Barricade", shortname:"Barricade", HP:100, Armor:"Medium", Attack:0, Weapon:"None", Speed:0, Movement:"Stationary", MinRange:1, MaxRange:1, Cost:200, tag1:"Delay 1", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name:"Bunker", shortname:"Bunker",HP:100,Armor:"Medium",Attack:25,Weapon:"Light",Speed:0,Movement:"Stationary",MinRange:1,MaxRange:1,Cost:250, tag1:"Delay 1", tag2:"", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackOffsetX:[0,-44,-44,-44,-44],AttackOffsetY:[0,-44,-44,-44,-44]},
	{name:"Turret", shortname:"Turret",HP:140,Armor:"Medium",Attack:35,Weapon:"Medium",Speed:0,Movement:"Stationary",MinRange:2,MaxRange:5,Cost:350, tag1:"Delay 2", tag2:"Skysweeper", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name:"Flak Tower", shortname:"FlakTower",HP:70,Armor:"Medium",Attack:20,Weapon:"Light",Speed:0,Movement:"Stationary",MinRange:2,MaxRange:5,Cost:350, tag1:"Delay 2", tag2:"Skysweeper", tag3:"Anti-Air", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name:"Coastal Battery", shortname:"Coastal",HP:175,Armor:"Heavy",Attack:70,Weapon:"Heavy",Speed:0,Movement:"Stationary",MinRange:3,MaxRange:7,Cost:500, tag1:"Delay 2", tag2:"Coastal", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name:"Radar/Sonar Station", shortname:"Radar",HP:70,Armor:"Medium",Attack:0,Weapon:"None",Speed:0,Movement:"Stationary",MinRange:1,MaxRange:1,Cost:350, tag1:"Delay 2", tag2:"Radar", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name:"Missile Silo", shortname:"Silo",HP:25,Armor:"Medium",Attack:50,Weapon:"Medium",Speed:0,Movement:"Stationary",MinRange:3,MaxRange:10,Cost:500, tag1:"Delay 3", tag2:"Dispersion", tag3:"Self-Destruct", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]},
	{name: "SAMSON", shortname: "Samson", HP:50, Armor: "Light", Attack: 500, Weapon: "Heavy", Speed:10, Movement: "Flight", MinRange:1, MaxRange:1, Cost:1000 ,tag1:"JUDGEMENT", tag2:"Heroic", tag3:"", tag4:"", SpriteOffset:[0,0,0,0,0], AttackSpriteOffset:[0,0,0,0,0]}

	];
Units=CampaignUnits;
Factions=CampaignFactions;
Terrain=CampaignTerrain;
TNOFactions=[
	{name:"Null", faction:"Idk, man. Neutrals maybe?", color:"ShitBrown"},
	{name:"West Russian Revolutionary Front", faction:"SocIntern", color:"Red", ChromaCode:""},
	{name:"Russian Liberation Army", faction:"Vlasovtsy", color:"Dark Grey", ChromaCode:""},
	{name:"Principality of Vyatka", faction:"Kirilovtsy", color:"Yellow", ChromaCode:""},
	{name:"Trans-Ural Confederation", faction:"Neutral", color:"Silver", ChromaCode:""},
	{name:"Ural Military District", faction:"Democratic League", color:"Blue", ChromaCode:""},
	{name:"Russian National Reclamation Front", faction:"Black League", color:"Black", ChromaCode:""},
	{name:"Republic of Tomsk", faction:"Yuvachovtsy", color:"Purple", ChromaCode:""},
	{name:"Republic of Novosibirsk", faction:"Democratic League", color:"Green", ChromaCode:""},
	{name:"Siberian Black Army", faction:"Anarkhia Mama", color:"Brown", ChromaCode:""},
	{name:"Sablin", faction:"SocIntern", color:"Orange", ChromaCode:""},
	{name:"Russian Republic of Magadan", faction:"Matkovtsy", color:"Grey", ChromaCode:""},
	{name:"Divine Mandate of Siberia", faction:"DEUS VULT!", color:"White", ChromaCode:""},
	{name:"Kazembek's Secret Lair in Yurlinsky", faction:"HARDCORE", color:"Dark Blue", ChromaCode:""}];

	//Fuck Dragnea
MemeFactions=[];

window.addEventListener('keydown',(event) => {
	if(event.key=="f" && FieldMode!="MapEditor"){ToggleBattleflags()};
	//if(event.key=="g" && FieldMode!="MapEditor"){ToggleMoraleBadges()};
	//if(event.key=="h" && FieldMode!="MapEditor"){ToggleHealthBars()};
	if(event.key=="|"){DisplayRegions()};
	if(event.key=="="){document.getElementById("TileContainer").style.scale="10%";document.getElementById("TileContainer").style.overflow="visible";document.getElementById("TileContainer").style.top="-250px";document.getElementById("TileContainer").style.left="-700px";document.getElementById("TileContainer").style.zIndex="10"};
	//if(event.key=="l"){alert(LastMove.X+" "+LastMove.Y)};
	//if(event.key=="c"){alert('Press F to see which tiles need to be captured, which enemies assassinated and so on and so forth. Press F again to cancel');
	//alert('You can also press tab to see the region map mode, but that does not do much at the moment; it will glitch the entire level. Except Samara, it works for that map ')};
	if(event.key=="Shift" && FieldMode=="MapEditor"){TrackFillSwitch=true};

	/*
	if(event.key=="ArrowUp" || event.key=="w" || event.key=="W"){if(FieldMode=="MapEditor"){RollMapEditor(1)}else{RollMap(1);if(FlagsToggled){ToggleBattleflags();ToggleBattleflags()};if(BadgesToggled){ToggleMoraleBadges();ToggleMoraleBadges()};if(BarsToggled){ToggleHealthBars();ToggleHealthBars()};if(RegionsToggled){DisplayRegions();DisplayRegions()}}};
	if(event.key=="ArrowRight" || event.key=="d" || event.key=="D"){if(FieldMode=="MapEditor"){RollMapEditor(2)}else{RollMap(2);if(FlagsToggled){ToggleBattleflags();ToggleBattleflags()};if(BadgesToggled){ToggleMoraleBadges();ToggleMoraleBadges()};if(BarsToggled){ToggleHealthBars();ToggleHealthBars()};if(RegionsToggled){DisplayRegions();DisplayRegions()}}};
	if(event.key=="ArrowDown" || event.key=="s" || event.key=="S"){if(FieldMode=="MapEditor"){RollMapEditor(3)}else{RollMap(3);if(FlagsToggled){ToggleBattleflags();ToggleBattleflags()};if(BadgesToggled){ToggleMoraleBadges();ToggleMoraleBadges()};if(BarsToggled){ToggleHealthBars();ToggleHealthBars()};if(RegionsToggled){DisplayRegions();DisplayRegions()}}};
	if(event.key=="ArrowLeft" || event.key=="a" || event.key=="A"){if(FieldMode=="MapEditor"){RollMapEditor(4)}else{RollMap(4);if(FlagsToggled){ToggleBattleflags();ToggleBattleflags()};if(BadgesToggled){ToggleMoraleBadges();ToggleMoraleBadges()};if(BarsToggled){ToggleHealthBars();ToggleHealthBars()};if(RegionsToggled){DisplayRegions();DisplayRegions()}}};
	*/

	let keyArray=[false,false,false,false];
	/*
	//This code block is considered obsolete, replaced by a code block that is equally useless
	if(event.key=="ArrowUp" || event.key=="w" || event.key=="W"){document.getElementById('RegionMap').scrollBy(0,-280);document.getElementById('regionMap').scrollBy(0,-280);if(FieldMode=="MapEditor"){RollMapEditor(1)}else{document.getElementById('TopScrollBar').click()}};
	if(event.key=="ArrowRight" || event.key=="d" || event.key=="D"){document.getElementById('RegionMap').scrollBy(280,0);document.getElementById('regionMap').scrollBy(280,0);if(FieldMode=="MapEditor"){RollMapEditor(2)}else{document.getElementById('RightScrollBar').click()}};
	if(event.key=="ArrowDown" || event.key=="s" || event.key=="S"){document.getElementById('RegionMap').scrollBy(0,280);document.getElementById('regionMap').scrollBy(0,280);if(FieldMode=="MapEditor"){RollMapEditor(3)}else{document.getElementById('BottomScrollBar').click()}};
	if(event.key=="ArrowLeft" || event.key=="a" || event.key=="A"){document.getElementById('RegionMap').scrollBy(-280,0);document.getElementById('regionMap').scrollBy(-280,0);if(FieldMode=="MapEditor"){RollMapEditor(4)}else{document.getElementById('LeftScrollBar').click()}};*/


	if(event.key=="ArrowUp" || event.key=="w" || event.key=="W"){keyArray[0]=true};
	if(event.key=="ArrowRight" || event.key=="d" || event.key=="D"){keyArray[1]=true};
	if(event.key=="ArrowDown" || event.key=="s" || event.key=="S"){keyArray[2]=true};
	if(event.key=="ArrowLeft" || event.key=="a" || event.key=="A"){keyArray[3]=true};
	//console.log(keyArray);
	//if(keyArray[1]&&keyArray[2]){document.getElementById('RegionMap').scrollBy(280,280);document.getElementById('regionMap').scrollBy(280,280);if(FieldMode=="MapEditor"){RollMapEditor(2)}else{document.getElementById('RightScrollBar').click();document.getElementById('BottomScrollBar').click()}};
	if(keyArray[0]){document.getElementById('RegionMap').scrollBy(0,-280);document.getElementById('regionMap').scrollBy(0,-280);if(FieldMode=="MapEditor"){RollMapEditor(1)}else{document.getElementById('TopScrollBar').click()}};
	if(keyArray[1]){document.getElementById('RegionMap').scrollBy(280,0);document.getElementById('regionMap').scrollBy(280,0);if(FieldMode=="MapEditor"){RollMapEditor(2)}else{document.getElementById('RightScrollBar').click()}};
	if(keyArray[2]){document.getElementById('RegionMap').scrollBy(0,280);document.getElementById('regionMap').scrollBy(0,280);if(FieldMode=="MapEditor"){RollMapEditor(3)}else{document.getElementById('BottomScrollBar').click()}};
	if(keyArray[3]){document.getElementById('RegionMap').scrollBy(-280,0);document.getElementById('regionMap').scrollBy(-280,0);if(FieldMode=="MapEditor"){RollMapEditor(4)}else{document.getElementById('LeftScrollBar').click()}};

	});
window.addEventListener('keyup',(event) => {

	if(event.key=="Shift" && FieldMode=="MapEditor"){TrackFillSwitch=false};
	});


//Useful note:
//Z-Index 0 is for divs with no specific priority
//Z-Index 1 is for the tile slots
//Z-Index 2 is for the tile aspects themselves
//Z-Index 2.5 is for edges/accessories
//Z-Index 3 is for units
//Z-index 4 is for blep/ctep
//Z-index 5 is for spep

//EDIT: Fuck the note, I didn't follow it anyways :P
//EDIT to EDIT: Fuck me, there was an annoying bug because I didn't follow it.
//Note to self: Wine really helps write more code 8)

function AddRegionalNode(){
	let X=parseInt(document.getElementById("RegionNodeX").value);
	let Y=parseInt(document.getElementById("RegionNodeY").value);
	let Owner=document.getElementById("RegionNodeOwner").value;
	let Capitol=document.getElementById("RegionNodeCapitol").value;
	let Region=document.getElementById("RegionNodeName").value;
	//document.getElementById("regional Tile "+X+" "+Y).style.background=Factions[Owner].color;
	document.getElementById("regional Color "+X+" "+Y).style.background=Factions[Owner].color;
	document.getElementById("regional Nexus "+X+" "+Y).style.visibility='inherit';
	document.getElementById("regional Name "+X+" "+Y).innerHTML=Region;
	document.getElementById("regional Name "+X+" "+Y).style.visibility='inherit';
	document.getElementById("regional Capital "+X+" "+Y).innerHTML=Capitol;
	document.getElementById("regional Capital "+X+" "+Y).style.visibility='inherit';
	//alert((Y+EditorStandardX)+" "+(X+EditorStandardY));
	let adr=EditorMap[Y+EditorStandardX][X+EditorStandardY];
	if(adr==13 || adr==14 || adr==30){CapitolNodeRegistry[Y+EditorStandardX][X+EditorStandardY]={Owner:Owner,Capitol:Capitol,CapitolX:X+EditorStandardY,CapitolY:Y+EditorStandardX,Name:Region};};};
function AI_Act(i){
	let InternalDelayerFactor=0;
	ActionRegister={Movement:0,Attack:0,Counter:0,Liquidate:0};
	//console.log(i);

	//let Funds=Constants.Funds[];
	//alert(Funds);
	

	//console.log(GlobalDelayerConstant);
	
	//console.log(i+"|"+MAXI);
	if(i<MAXI){
		//alert(Units[ActiveRoster[i].unitType].Cost/2);
		
			//alert(Constants.Funds[AttackOrder[(Turn-1)%SubRosters.length]]);
		if(Funds>Units[ActiveRoster[i].unitType].Cost/2 && ActiveRoster[i].life/Units[ActiveRoster[i].unitType].HP<0.2*Difficulty){let randomizer=Math.ceil(Math.random()*10);
			if(randomizer<=Difficulty*3+1){ActiveRoster[i].life=Units[ActiveRoster[i].unitType].HP;Funds-=Math.round(Units[ActiveRoster[i].unitType].Cost/2);
			Constants.Funds[AttackOrder[(Turn-1)%SubRosters.length]]=Funds};
			};
		//setTimeout(AI_Scouter, 100*i, ActiveRoster[i], Map);
		AI_Scouter(ActiveRoster[i], Map);
		//function RemainingAct(){
		InternalDelayerFactor+=200;
		if(ActionRegister.Movement!=0){setTimeout(MoveUnit,InternalDelayerFactor,ActiveRoster[i].index,ActionRegister.Movement);InternalDelayerFactor+=800};
		if(ActionRegister.Attack!=0 && ActionRegister.Movement==0){setTimeout(Attack,InternalDelayerFactor,ActiveRoster[i].index,ActionRegister.Attack);
			InternalDelayerFactor+=400;
			AttackEstimate(ActiveRoster[i].index,ActionRegister.Attack)};
		if(ActionRegister.Attack!=0 && ActionRegister.Movement!=0){setTimeout(Attack,InternalDelayerFactor+400,ActiveRoster[i].index,ActionRegister.Attack);
			InternalDelayerFactor+=400;
			AttackEstimate(ActiveRoster[i].index,ActionRegister.Attack)};

		if(ActionRegister.Counter!=0 || ActionRegister.Liquidate!=0){InternalDelayerFactor+=1000};
		
		//setTimeout(RemainingAct,0);

		//console.log(InternalDelayerFactor);
		GlobalDelayerConstant=InternalDelayerFactor;

		setTimeout(AI_Act,InternalDelayerFactor+100,i+1)};
	if(i==MAXI){
		//console.log(i+"|"+MAXI);
		//console.log(Turn+"|"+SubRosters.length);
		setTimeout(EndTurn,GlobalDelayerConstant,SubRosters,Map,Constants,Roster);
		if((Turn)%SubRosters.length==1){
			function DeactivateAIMarker(){document.getElementById('AITurnIndicator').style.visibility='hidden'; isAITurn=false;};
			setTimeout(DeactivateAIMarker,GlobalDelayerConstant);
			//setTimeout(EndTurn,GlobalDelayerConstant,SubRosters,Map,Constants,Roster);
			//DeactvateAIMarker();
		}};
	};
function AI_Scouter(Unit,Map){
	//Prerequisites
	var Speed=Unit.speed;
	var Type=Unit.movementType;
	var Faction=Unit.faction;
	var Coallition=Unit.coallition;
	var Lat=Unit.x;
	var Long=Unit.y;
	var SPD=Unit.speed;
	var X=Lat;
	var Y=Long;
	let unitIndex=Unit.index;
	Path=[1];
	Pizdamatii=[];
	MapClone=JSON.parse(JSON.stringify(Map));
	//alert(Map[0][0]);
	let mapWidth=Map[0].length;
	let mapHeight=Map.length;
	var Stepmap=JSON.parse(JSON.stringify(Map));
	var Targetmap=JSON.parse(JSON.stringify(Map));

	//Here it pans the camera
	PanX=Math.min(Math.max(X-5,0),Map.length)*56;
	PanY=Math.min(Math.max(Y-5,0),Map[0].length)*56;
	//console.log(PanX+" "+PanY);
	//console.log(document.getElementById("UnitMap").style.overflowX+" "+document.getElementById("UnitMap").style.overflowY);
	//let cmx=document.getElementById("UnitMap").scrollX;
	//let cmy=document.getElementById("UnitMap").style.offsetY;
	//alert(cmx);
	//document.getElementById("UnitMap").scrollBy(-Map.length*56,-Map[0].length*56+PanX);
	//document.getElementById("UnitMap").scrollBy(PanY,PanX);
	document.getElementById("UnitMap").scroll(PanY,PanX);
	

	
	//Here lies the switch to get the stepmap.	
	switch(Type){
		case "Foot":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].WalkThrough;}};
		break;

		case "Wheeled":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].DriveThrough}};
		break;

		case "Tracked":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].RollThrough}};
		break;

		case "Amphibious":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].WadeThrough}};
		break;

		case "Flight":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].FlyThrough}};
		break;

		case "Rudder":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].SailThrough}};
		break;

		case "Heavy Rudder":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].DeepSailThrough}};
		break;

		};
		

	//Standard-Issue Pathing Loop
	while(Path.length>0){
			CollisionCheck=false;
			let x=(Path[Path.length-1]-2)*(Path[Path.length-1])%2;
			let y=(3-Path[Path.length-1])*(Path[Path.length-1]-1)%2;

		if(X+x<0 || Y+y<0){Path[Path.length-1]+=1};
		if(X+x>=Map.length || Y+y>=Map[0].length){Path[Path.length-1]++;};
		if(X+x<Map.length && X+x>=0 && Y+y<Map[0].length && Y+y>=0){
		if(rostermap[X+x][Y+y].coallition!=Coallition && rostermap[X+x][Y+y]!=0){CollisionCheck=true};};

	//The block that checks whether advancing is possible and advances


		if(SPD>0 && Path[Path.length-1]<5 && X+x<Map.length && Y+y<Map[0].length){
			let x=(Path[Path.length-1]-2)*(Path[Path.length-1])%2;
			let y=(3-Path[Path.length-1])*(Path[Path.length-1]-1)%2;

			//alert(Stepmap[X][Y]);
			if(SPD>=Stepmap[X+x][Y+y] && CollisionCheck==false){
			X=X+x;
			Y=Y+y;
			//alert(Path);
			Pizdamatii[Pizdamatii.length]={x:X,y:Y,z:[],F:0};
			Path[Path.length]=1;
			for(let p=0;p<Path.length;p++){
				Pizdamatii[Pizdamatii.length-1].z[p]=Path[p];
				if(p>0){if(Path[p]%2==Path[p-1]%2 && Path[p]!=Path[p-1]){Pizdamatii[Pizdamatii.length-1].F-=10}};
				//MedianUnit as defined here shall be purged once a proper equation has been established from the outside
				//MedianUnit={X:0,Y:0}; 
				//if(MedianUnit??0==0){MedianUnit={X:0,Y:0}};	
				};
				let XDev=Math.min(MedianUnit.X-X, X-MedianUnit.X);
				let YDev=Math.min(MedianUnit.Y-Y, Y-MedianUnit.Y);
				Pizdamatii[Pizdamatii.length-1].F+=XDev;
				Pizdamatii[Pizdamatii.length-1].F+=YDev;
				if(Difficulty>1 && TileFlagMap[Pizdamatii[Pizdamatii.length-1].x][Pizdamatii[Pizdamatii.length-1].y]>1){Pizdamatii[Pizdamatii.length-1].F+=100};
				Pizdamatii[Pizdamatii.length-1].F+=5*Pizdamatii[Pizdamatii.length-1].z.length;
			//Pizdamatii[Pizdamatii.length-1].z=Path;
			
			SPD=SPD-Stepmap[X][Y];}else{Path[Path.length-1]+=1;};
			}
	//The block that checks if backtracking is needed and does so

		else if(SPD==0 || Path[Path.length-1]>=5){
			//alert(Path[Path.length-1]);
			if(Path.length>=2){reverse=Path[Path.length-2];}else{break;};
			SPD=SPD+Stepmap[X][Y];

			X=X-(reverse-2)*(reverse%2);
			Y=Y-(3-reverse)*(reverse-1)%2;

			

			Path.length-=1;
			Path[Path.length-1]+=1;

			
			}
			//else if(Path[Path.length-1]>=5){alert("Please don't fuck up the script")};
		//alert("Path length: "+Path.length+ "; SPD= "+SPD+ "; X= "+X+"; Y= "+Y+"; direction: "+Path[Path.length-1]+" Path: "+Path+ "CollChek: "+ CollisionCheck);
		
		};
	AddressMap=[];
	AddressMapLine=[];
	for(let i=0;i<Map[0].length;i++){AddressMapLine[AddressMapLine.length]=0};
	for(let j=0;j<Map.length;j++){AddressMap[AddressMap.length]=AddressMapLine};
	Thing=JSON.parse(JSON.stringify(AddressMap));
	//AddressMap=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];
	
	TargetList=[];


	//This does the ctep pathing

	//alert(Pizdamatii[Pizdamatii.length-1].x);

	for(let h=0;h<Pizdamatii.length;h++){
		
		Thing[Pizdamatii[h].x][Pizdamatii[h].y]=0;
		
		if(Thing[Pizdamatii[h].x][Pizdamatii[h].y]==1000){
			pathway=Pizdamatii[h].z.pop;
			alt=AddressMap[Pizdamatii[h].x][Pizdamatii[h].y];
			if(alt!=0 && alt.length<pathway.length){pathway=alt;};
			AddressMap[Pizdamatii[h].x][Pizdamatii[h].y]=pathway;


			//if(Pizdamatii[h].x>0){if(rostermap[Pizdamatii[h].x-1][Pizdamatii[h].y]!=0){TargetList[TargetList.length]=pathway}};
			//if(Pizdamatii[h].x<Map.length-1){if(rostermap[Pizdamatii[h].x+1][Pizdamatii[h].y]!=0){TargetList[TargetList.length]=pathway}};
			//if(Pizdamatii[h].y>0){if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y-1]!=0){TargetList[TargetList.length]=pathway}};
			//if(Pizdamatii[h].y<Map.length[0]-1){if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y+1]!=0){TargetList[TargetList.length]=pathway}};
		//if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y]!=0){TargetList[TargetList.length]=pathway};

		};};
		//alert(TargetList[0]);
		//alert(X+" "+Y);

		if(Units[Unit.unitType].MaxRange==1){attackType="Contact"}else{attackType="Ranged"};
		//alert(attackType);



	if(attackType=="Contact"){


		for(let h=0;h<Pizdamatii.length;h++){
			let pathway=Pizdamatii[h].z;
			pathway.pop();
			let valableTarget=false;

			if(Pizdamatii[h].x>0){if(rostermap[Pizdamatii[h].x-1][Pizdamatii[h].y]!=0){//TargetList[TargetList.length]=pathway;
				//alert(rostermap[Pizdamatii[h].x-1][Pizdamatii[h].y].x + " " + rostermap[Pizdamatii[h].x-1][Pizdamatii[h].y].y + " " + pathway);
				if(rostermap[Pizdamatii[h].x-1][Pizdamatii[h].y].coallition!=Coallition){valableTarget=true;};
			}};
			if(Pizdamatii[h].x<Map.length-1){if(rostermap[Pizdamatii[h].x+1][Pizdamatii[h].y]!=0){//TargetList[TargetList.length]=pathway;
				if(rostermap[Pizdamatii[h].x+1][Pizdamatii[h].y].coallition!=Coallition){valableTarget=true;};
			}};
			if(Pizdamatii[h].y>0){if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y-1]!=0){//TargetList[TargetList.length]=pathway;
				if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y-1].coallition!=Coallition){valableTarget=true;};
			}};
			if(Pizdamatii[h].y<Map.length[0]-1){if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y+1]!=0){//TargetList[TargetList.length]=pathway;
				if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y+1].coallition!=Coallition){valableTarget=true;};
			}};

			//alert(X + " " + Y);
			if(Pizdamatii[h].x == X && Pizdamatii[h].y == Y){valableTarget=false;};
			//if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y]!=0){
				//alert(Pizdamatii[h].x +" "+Pizdamatii[h].y);
			//};
			if(valableTarget){TargetList[TargetList.length]=pathway;};


		};
		//alert(TargetList[0]);

		ContactTargetList=[];



		for(let mu=0;mu<TargetList.length;mu++){
		let OX=X;
		let OY=Y;
		let ics=JSON.parse(JSON.stringify(X));
		let igrec=JSON.parse(JSON.stringify(Y));
		//alert(ics+" "+igrec);
			for(let nu=0;nu<TargetList[mu].length;nu++){
		if(TargetList[mu][nu]==1){ics-=1};
		if(TargetList[mu][nu]==2){igrec+=1};
		if(TargetList[mu][nu]==3){ics+=1};
		if(TargetList[mu][nu]==4){igrec-=1};
		//alert(MapClone[ics][igrec]);
		//if(MapClone[ics][igrec]>SPD){alert("River")};
		//alert(ics+" "+igrec);
		};

		
		if(ics>0){if(rostermap[ics-1][igrec].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:TargetList[mu],X:ics,Y:igrec,TX:-1,TY:0,F:0};}};
		if(ics<Map.length-1){if(rostermap[ics+1][igrec].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:TargetList[mu],X:ics,Y:igrec,TX:1,TY:0,F:0};}};
		if(igrec>0){if(rostermap[ics][igrec-1].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:TargetList[mu],X:ics,Y:igrec,TX:0,TY:-1,F:0};}};
		if(igrec<Map[0].length-1){if(rostermap[ics][igrec+1].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:TargetList[mu],X:ics,Y:igrec,TX:0,TY:1,F:0};}};
		//while((ContactTargetList[ContactTargetList.length-1].X+ContactTargetList[ContactTargetList.length-1].TX == OX) && (ContactTargetList[ContactTargetList.length-1].Y+ContactTargetList[ContactTargetList.length-1].TY == OY)){ContactTargetList.pop()};

		};

		if(X>0){if(rostermap[X-1][Y]!=0){if(rostermap[X-1][Y].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:[],X:X,Y:Y,TX:-1,TY:0,F:0}}}};
		if(X<Map.length-1){if(rostermap[X+1][Y]!=0){if(rostermap[X+1][Y].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:[],X:X,Y:Y,TX:1,TY:0,F:0}}}};
		if(Y>0){if(rostermap[X][Y-1]!=0){if(rostermap[X][Y-1].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:[],X:X,Y:Y,TX:0,TY:-1,F:0}}}};
		if(Y<Map[0].length-1){if(rostermap[X][Y+1]!=0){if(rostermap[X][Y+1].coallition!=Coallition){ContactTargetList[ContactTargetList.length]={path:[],X:X,Y:Y,TX:0,TY:1,F:0}}}};

		BackupTargetList=[];
		//if(X>0){if(rostermap[X-1][Y]!=0 && rostermap[X-1][Y].coallition!=Coallition){BackupTargetList[BackupTargetList.length]={path:[],X:X,Y:Y,TX:-1,TY:0}}};
		//if(X<Map.length-1){if(rostermap[X+1][Y]!=0 && rostermap[X+1][Y].coallition!=Coallition){BackupTargetList[BackupTargetList.length]={path:[],X:X,Y:Y,TX:1,TY:0}}};
		//if(Y>0){if(rostermap[X][Y-1]!=0 && rostermap[X][Y-1].coallition!=Coallition){BackupTargetList[BackupTargetList.length]={path:[],X:X,Y:Y,TX:0,TY:-1}}};
		//if(Y<Map[0].length-1){if(rostermap[X][Y+1]!=0 && rostermap[X][Y+1].coallition!=Coallition){BackupTargetList[BackupTargetList.length]={path:[],X:X,Y:Y,TX:0,TY:1}}};



		for(let h=0;h<ContactTargetList.length;h++){
			//alert(ContactTargetList[h].path);
			let CUS=ContactTargetList[h];
			let CanAttack=true;
			let TargetChecker=rostermap[CUS.X+CUS.TX][CUS.Y+CUS.TY];
			//alert(hasCertainTrait(Unit.unitType,"Skysweeper"));
			//alert(TargetChecker);
			//if(hasCertainTrait(Unit.unitType,"Seabound") && TargetChecker.movementType!="Rudder" && TargetChecker.movementType!="Heavy Rudder"){CanAttack=false};
			if(!hasCertainTrait(Unit.unitType,"Skysweeper") && TargetChecker.movementType=="Flight"){CanAttack=false};
			if(!hasCertainTrait(Unit.unitType,"Depth Strike") && hasCertainTrait(TargetChecker.unitType??1,"Submerged")){CanAttack=false};
			//alert(CanAttack);
			//alert(TargetChecker+" "+CanAttack);
			/*
			let ix=Lat; let iy=Long;
			for(let i=0; i<CUS.path.length-1;i++){let crk=CUS.path[i];
				if(crk==1){iy-=1};
				if(crk==2){ix+=1};
				if(crk==3){iy+=1};
				if(crk==4){ix-=1};
				//if(rostermap[iy][ix]!=0){CanAttack=false};
				};*/




			//This is where we calculate attack priority indices
			//ContactTargetList[h].F=0;
			//let Atk=rostermap[ContactTargetList[h].X][ContactTargetList[h].Y];
			let Atk=rostermap[Unit.x][Unit.y];
			//console.log(ContactTargetList[h].X+" "+ContactTargetList[h].Y + " "+rostermap[2][9]+Atk);
			//console.log(ContactTargetList[h].X+"|"+ContactTargetList[h].Y);
			//if(ContactTargetList[h].X==6 && ContactTargetList[h].Y==7){console.log("null")};
			let Def=rostermap[ContactTargetList[h].X+ContactTargetList[h].TX][ContactTargetList[h].Y+ContactTargetList[h].TY];
				//console.log(Atk+" "+Def);

			if(Atk!=0 && Def!=0 && Difficulty>1){
				//console.log(Atk+" "+Def);

				let Riposte=true;
				let Intercept=false;
				let Dmg=Atk.damage;
				let TargetTerrain=Map[ContactTargetList[h].X+ContactTargetList[h].TX][ContactTargetList[h].Y+ContactTargetList[h].TY];
				Dmg*=Terrain[TargetTerrain].protectionFactor;
				if(Terrain[TargetTerrain].protectionFactor<1 && hasCertainTrait(Atk.unitType,"Commando")){Dmg*=1.25};
				Dmg*=BiomeRegistry[BiomeMap[ContactTargetList[h].X][ContactTargetList[h].Y]].LogisticIndex;
				if(!hasCertainTrait(Atk.unitType,"Indomitable")){Dmg*=Atk.life/Units[Atk.unitType].HP};
				if(Atk.damageType==Def.armor && Atk.damageType!="Medium"){Dmg*=1.5};
				if(Atk.damageType=="Light"&&Def.armor=="Heavy"){Dmg*=0.5};
				if(Atk.damageType=="Heavy"&&Def.armor=="Light"){Dmg*=0.5};
				if(Def.movementType=="Foot"&&hasCertainTrait(Atk.unitType,"Anti-Infantry")){Dmg*=3};
				if((Def.movementType=="Foot" || Def.unitType<12)&&hasCertainTrait(Atk.unitType,"Schwerpunkt")){Dmg*=1.4};
				if(Def.movementType=="Flight"&&hasCertainTrait(Atk.unitType,"Anti-Air")){Dmg*=3};
				if(Def.movementType=="Rudder"&&hasCertainTrait(Atk.unitType,"Anti-Ship")){Dmg*=3};
				if(Def.movementType=="Heavy Rudder"&&hasCertainTrait(Atk.unitType,"Anti-Ship")){Dmg*=3};
				if(Def.movementType=="Static"&&hasCertainTrait(Atk.unitType,"Anti-Structure")){Dmg*=2};
				if(Def.movementType=="Tracked"&&hasCertainTrait(Atk.unitType,"Anti-Tank")&&!hasCertainTrait(Def.unitType,"Anti-Tank")&&!hasCertainTrait(Atk.unitType,"Tank-Hunter")){Riposte=false};
				if(hasCertainTrait(Atk.unitType,"Mobile Battery")&&Def.maxR>1&&!hasCertainTrait(Def.unitType,"Mobile Battery")){Riposte=false};
				if(hasCertainTrait(Atk.unitType,"Submerged")&&!hasCertainTrait(Def.unitType,"Depth Charge")){Riposte=false};
				if(Atk.movementType=="Flight"&&!hasCertainTrait(Def.unitType,"Skysweeper")){Riposte=false};
				if(hasCertainTrait(Def.unitType,"Seabound")&&Atk.movementType!="Rudder"&&Atk.movementType!="Heavy Rudder"){Riposte=false};
				if(hasCertainTrait(Def.unitType,"Steer")&&(Atk.movementType=="Rudder" || Atk.movementType=="Heavy Rudder")){Dmg*=Math.min(1,Math.max(0.4,Atk.speed-Atk.speed))};
				if(hasCertainTrait(Def.unitType,"Tank-Hunter")&&!hasCertainTrait(Atk.unitType,"Tank-Hunter")&&Atk.movementType=="Tracked"){Intercept=true};
				if(hasCertainTrait(Atk.unitType,"Submerged")&&hasCertainTrait(Def.unitType,"Sonar")){Intercept=true};
				if(hasCertainTrait(Atk.unitType,"Stealth")){Dmg*=2};
				if(hasCertainTrait(Atk.unitType,"Supply Distribution")){Dmg*=-1};
				if(hasCertainTrait(Atk.unitType,"Bewegungskrieg")){Dmg*=1};//Bewegungskrieg not yet considered
				Dmg*=Math.min(2,Math.max(0.2,1+Atk.morale/5));
				if(hasCertainTrait(Def.unitType,"Cemented Steel Armor")&&!hasCertainTrait(Atk.unitType,"Cavitation Explosion")){Dmg=Math.max(0,Dmg-20)};
				if(Dmg>Def.life){Riposte=false};

				if(Riposte){let Ctk=Def.damage;
				if(!hasCertainTrait(Def.unitType,"Indomitable")){Ctk*=Def.life/Units[Def.unitType].HP};
					Ctk*=Terrain[(Map[X][Y]??1)].protectionFactor??1;
					//console.log(X);
					Ctk*=BiomeRegistry[(BiomeMap[Math.max(0,X)][Math.max(0,Y)]??1)].logisticIndex??1;
					if(Terrain[Map[X][Y]].protectionFactor<1 && hasCertainTrait(Def.unitType,"Commando")){Ctk*=1.25};
					if(hasCertainTrait(Atk.unitType,"Cemented Steel Armor") && !hasCertainTrait(Def.unitType,"Cavitation Explosion")){Ctk-=20};
					if(Atk.damageType==Atk.armor && Def.damageType!="Medium"){Ctk*=1.5};
					if(Atk.damageType=="Light"&&Def.armor=="Heavy"){Ctk*=0.5};
					if(Atk.damageType=="Heavy"&&Def.armor=="Light"){Ctk*=0.5};

					if(Atk.movementType=="Foot"&&hasCertainTrait(Def.unitType,"Anti-Infantry")){Ctk*=3};
					if(Atk.movementType=="Foot"&&hasCertainTrait(Def.unitType,"Schwerpunkt")){Ctk*=1.4};
					if(Atk.movementType=="Flight"&&hasCertainTrait(Def.unitType,"Anti-Air")){Ctk*=3};
					if(Atk.movementType=="Rudder"&&hasCertainTrait(Def.unitType,"Anti-Ship")){Ctk*=3};
					if(Atk.movementType=="Heavy Rudder"&&hasCertainTrait(Def.unitType,"Anti-Ship")){Ctk*=3};
					if(Atk.movementType=="Static"&&hasCertainTrait(Def.unitType,"Anti-Structure")){Ctk*=2};
					if(hasCertainTrait(Atk.unitType,"Steer")&&(Def.movementType=="Rudder" || Def.movementType=="Heavy Rudder")){Ctk*=Math.min(1,Math.max(0.4,Def.speed-Def.speed))};
					Ctk*=Math.min(2,Math.max(0.2,1+Def.morale/5));


				//console.log(Dmg+" "+Ctk/2);
				Dmg-=Ctk/2};


				//if(ContactTargetList[h].X==6 && ContactTargetList[h].Y==7){console.log("fuck")};


				ContactTargetList[h].F+=Dmg;
				//console.log(ContactTargetList[h].F);
				
				//console.log(ContactTargetList[h].X+"|"+ContactTargetList[h].Y+" "+ContactTargetList[h].TX+"|"+ContactTargetList[h].TY+" "+ContactTargetList[h].F);
				};

			
			//console.log(ContactTargetList[h].F);
			if(TargetChecker!=0 && CanAttack){BackupTargetList[BackupTargetList.length]=ContactTargetList[h]};
			};
			ContactTargetList=BackupTargetList;


			//if((ContactTargetList[h].X+ContactTargetList[h].TX != X) || (ContactTargetList[h].Y+ContactTargetList[h].TY != Y)){BackupTargetList[BackupTargetList.length]=ContactTargetList[h];}
	//alert(ContactTargetList[0]);
		//for(let h=0;h<ContactTargetList.length;h++){alert((ContactTargetList[h].X+ContactTargetList[h].TX)+" "+(ContactTargetList[h].Y+ContactTargetList[h].TY))};

			};	



	if(attackType=="Ranged"){
		//alert("Chuchu!");
		RangedTargetList=[];
		let OX=Math.max(X-10,0);
		let OY=Math.max(Y-10,0);
		let FX=Math.min(10,X+10);
		let FY=Math.min(10,Y+10);
		let RealRange=Units[Unit.unitType].MaxRange;
		let TerrainChecker=Terrain[Map[X][Y]];
		if(TerrainChecker.tag1=="Vantage" || TerrainChecker.tag2=="Vantage" || TerrainChecker.tag3=="Vantage" || TerrainChecker.tag4=="Vantage"){RealRange+=1};

		for(let ics=OX;ics<FX;ics++){for(let igrec=OY;igrec<FY;igrec++){
			CanAttack=true;
			distance=Math.sqrt((X-ics)*(X-ics)+(Y-igrec)*(Y-igrec));
			if(distance<=RealRange && distance>=Units[Unit.unitType].MinRange){
				//alert(ics+" "+igrec);
				let TargetChecker=rostermap[ics][igrec];
				//alert(TargetChecker.movementType);
			if(hasCertainTrait(Unit.unitType,"Seabound") && TargetChecker.movementType!="Rudder" && TargetChecker.movementType!="Heavy Rudder"){CanAttack=false};
			if(!hasCertainTrait(Unit.unitType,"Skysweeper") && TargetChecker.movementType=="Flight"){CanAttack=false};
			if(!hasCertainTrait(Unit.unitType,"Depth Strike") && hasCertainTrait(TargetChecker.unitType??1,"Submerged")){CanAttack=false};
				if(rostermap[ics][igrec]!=0 && rostermap[ics][igrec].coallition!=Coallition && CanAttack){
					//alert(rostermap[ics][igrec]);
					//alert(ics+" "+igrec);
					let Riposte=true;
					let Intercept=false;
					let Atk=rostermap[X][Y];
					let Def=rostermap[ics][igrec];
					let DMG=Atk.damage;
					DMG*=Terrain[Map[ics][igrec]].protectionFactor??1;
					DMG*=Terrain[Map[X][Y]].logisticFactor??1;
					if(Terrain[Map[ics][igrec]].protectionFactor<1 && hasCertainTrait(Atk.unitType,"Commando")){DMG*=1.25};
					if(!hasCertainTrait(Atk.unitType,"Indomitable")){DMG*=Atk.life/Units[Atk.unitType].HP};
					if(hasCertainTrait(Def.unitType,"Cemented Steel Armor") && !hasCertainTrait(Atk.unitType,"Cavitation Explosion")){DMG-=20};
					if(Atk.damageType==Def.armor && Atk.damageType!="Medium"){DMG*=1.5};
					if(Atk.damageType=="Light"&&Def.armor=="Heavy"){DMG*=0.5};
					if(Atk.damageType=="Heavy"&&Def.armor=="Light"){DMG*=0.5};

					if(Def.movementType=="Foot"&&hasCertainTrait(Atk.unitType,"Anti-Infantry")){DMG*=3};
					if(Def.movementType=="Foot"&&hasCertainTrait(Atk.unitType,"Schwerpunkt")){DMG*=1.4};
					if(Def.movementType=="Flight"&&hasCertainTrait(Atk.unitType,"Anti-Air")){DMG*=3};
					if(Def.movementType=="Rudder"&&hasCertainTrait(Atk.unitType,"Anti-Ship")){DMG*=3};
					if(Def.movementType=="Heavy Rudder"&&hasCertainTrait(Atk.unitType,"Anti-Ship")){DMG*=3};
					if(Def.movementType=="Static"&&hasCertainTrait(Atk.unitType,"Anti-Structure")){DMG*=2};
					if(Def.movementType=="Tracked"&&hasCertainTrait(Atk.unitType,"Anti-Tank")&&!hasCertainTrait(Def.unitType,"Anti-Tank")&&!hasCertainTrait(Atk.unitType,"Tank-Hunter")){Riposte=false};
				if(hasCertainTrait(Atk.unitType,"Mobile Battery")&&Def.maxR>1&&!hasCertainTrait(Def.unitType,"Mobile Battery")){Riposte=false};
				if(hasCertainTrait(Atk.unitType,"Submerged")&&!hasCertainTrait(Def.unitType,"Depth Charge")){Riposte=false};
				if(Atk.movementType=="Flight"&&!hasCertainTrait(Def.unitType,"Skysweeper")){Riposte=false};
				if(hasCertainTrait(Def.unitType,"Seabound")&&Atk.movementType!="Rudder"&&Atk.movementType!="Heavy Rudder"){Riposte=false};
				if(hasCertainTrait(Def.unitType,"Steer")&&(Atk.movementType=="Rudder" || Atk.movementType=="Heavy Rudder")){DMG*=Math.min(1,Math.max(0.4,Atk.speed-Atk.speed))};
				if(hasCertainTrait(Def.unitType,"Tank-Hunter")&&!hasCertainTrait(Atk.unitType,"Tank-Hunter")&&Atk.movementType=="Tracked"){Intercept=true};
				if(hasCertainTrait(Atk.unitType,"Submerged")&&hasCertainTrait(Def.unitType,"Sonar")){Intercept=true};
				if(hasCertainTrait(Atk.unitType,"Stealth")){DMG*=2};
				if(hasCertainTrait(Atk.unitType,"Supply Distribution")){DMG*=-1};
				if(hasCertainTrait(Def.unitType,"Supply Distribution")){Riposte=false};
				if(hasCertainTrait(Atk.unitType,"Bewegungskrieg")){DMG*=1};//Bewegungskrieg not yet considered
				DMG*=Math.min(2,Math.max(0.2,1+Atk.morale/5));
				if(hasCertainTrait(Atk.unitType,"Dispersion")){
					let targets=0;
					for(let x=Math.max(0,ics-2); x<Math.min(Map.length,ics+2);x++){for(let y=Math.max(0,igrec-2); y<Math.min(Map[0].length,igrec+2);y++){
						if((ics-x)*(ics-x)<=4 && (igrec-y)*(igrec-y)<=4 && rostermap[x][y]!=0){targets++};

						}};
						DMG*=targets;

					};
				//Do the same as Dispersion for Judgement, but with larger range

					
				if(DMG>Def.life){Riposte=false};

				if(Riposte){let Ctk=Def.damage;
				if(!hasCertainTrait(Def.unitType,"Indomitable")){Ctk*=Def.life/Units[Def.unitType].HP};
					Ctk*=Terrain[Map[X][Y]].protectionFactor??1;
					Ctk*=Terrain[Map[ics][igrec]].logisticFactor??1;
					if(Terrain[Map[X][Y]].protectionFactor<1 && hasCertainTrait(Def.unitType,"Commando")){Ctk*=1.25};
					if(hasCertainTrait(Atk.unitType,"Cemented Steel Armor") && !hasCertainTrait(Def.unitType,"Cavitation Explosion")){Ctk-=20};
					if(Atk.damageType==Atk.armor && Def.damageType!="Medium"){Ctk*=1.5};
					if(Atk.damageType=="Light"&&Def.armor=="Heavy"){Ctk*=0.5};
					if(Atk.damageType=="Heavy"&&Def.armor=="Light"){Ctk*=0.5};

					if(Atk.movementType=="Foot"&&hasCertainTrait(Def.unitType,"Anti-Infantry")){Ctk*=3};
					if(Atk.movementType=="Foot"&&hasCertainTrait(Def.unitType,"Schwerpunkt")){Ctk*=1.4};
					if(Atk.movementType=="Flight"&&hasCertainTrait(Def.unitType,"Anti-Air")){Ctk*=3};
					if(Atk.movementType=="Rudder"&&hasCertainTrait(Def.unitType,"Anti-Ship")){Ctk*=3};
					if(Atk.movementType=="Heavy Rudder"&&hasCertainTrait(Def.unitType,"Anti-Ship")){Ctk*=3};
					if(Atk.movementType=="Static"&&hasCertainTrait(Def.unitType,"Anti-Structure")){Ctk*=2};
					if(hasCertainTrait(Atk.unitType,"Steer")&&(Def.movementType=="Rudder" || Def.movementType=="Heavy Rudder")){Ctk*=Math.min(1,Math.max(0.4,Def.speed-Def.speed))};
					Ctk*=Math.min(2,Math.max(0.2,1+Def.morale/5));


				DMG-=Ctk/2};

				//console.log(DMG);
				RangedTargetList[RangedTargetList.length]={x:ics,y:igrec,F:DMG};
				//RangedTargetList[RangedTargetList.length-1].F+=DMG
				};
			};


		}};



		};

	if(attackType=="Contact"){
		//console.log(ContactTargetList.length);
		let cekA=true;
		if(ContactTargetList.length==0){cekA=false};
		if(cekA){
			
			if(Difficulty==1){DefaultAttack=ContactTargetList[Math.floor(Math.random()*ContactTargetList.length)]};
			if(Difficulty>1){

			let MAX=0;
			for(let jd=0; jd<ContactTargetList.length; jd++){if(ContactTargetList[jd].F>ContactTargetList[MAX].F){MAX=jd}};
			//console.log(ContactTargetList[MAX].F+" "+ContactTargetList.length);
			DefaultAttack=ContactTargetList[MAX];
			};
			//console.log(DefaultAttack);
			//alert(DefaultAttack.path);
			//alert(DefaultAttack);
			//alert(DefaultAttack.path);
			
			
			let ics=DefaultAttack.X;
			let igrec=DefaultAttack.Y;

			for(let w=0;w<DefaultAttack.path.length;w++){
				let v=DefaultAttack.path[w];
				if(v==1){ics-=1};
				if(v==2){igrec+=1};
				if(v==3){ics+=1};
				if(v==4){igrec-=1};
			};


			let canAttack=true;

			//if((rostermap[ics][igrec] ?? 0)!=0){};
			if((rostermap[DefaultAttack.X][DefaultAttack.Y] ?? 0)!=0){if(DefaultAttack.X!=X || DefaultAttack.Y!=Y){canAttack=false}};
			//alert(canAttack);
			if(DefaultAttack.path.length>0 && rostermap[DefaultAttack.X][DefaultAttack.Y]==0){
				ActionRegister.Movement=DefaultAttack.path;
				//MoveUnit(unitIndex,DefaultAttack.path);
				};

			//alert(DefaultAttack.X+" "+DefaultAttack.Y);
			//if(hasCertainTrait(Unit.unitType,"Seabound") && TargetChecker.movementType!="Rudder" && TargetChecker.movementType!="Heavy Rudder"){CanAttack=false};
			//if(!hasCertainTrait(Unit.unitType,"Skysweeper") && TargetChecker.movementType=="Flight"){CanAttack=false};
			//if(!hasCertainTrait(Unit.unitType,"Depth Strike") && hasCertainTrait(TargetChecker.unitType??1,"Submerged")){CanAttack=false};

			//alert((ics+DefaultAttack.TX)+" "+(igrec+DefaultAttack.TY)+"             "+ics+" "+igrec);
			//alert(rostermap[DefaultAttack.TX][DefaultAttack.TY]);
			//alert(rostermap[ics+DefaultAttack.TX][igrec+DefaultAttack.TY].index);
			if(canAttack){ActionRegister.Attack=rostermap[DefaultAttack.X+DefaultAttack.TX][DefaultAttack.Y+DefaultAttack.TY].index;
				//setTimeout(Attack,700,unitIndex,rostermap[DefaultAttack.X+DefaultAttack.TX][DefaultAttack.Y+DefaultAttack.TY].index);
				};
			//Attack(unitIndex,rostermap[ics+DefaultAttack.TX][igrec+DefaultAttack.TY].index);

		};

		if(!cekA){
			//console.log(Pizdamatii.length);
			let DefaultMovement=[];
			if(Difficulty==1 && Pizdamatii.length>0){DefaultMovement=Pizdamatii[Math.ceil(Math.random()*Pizdamatii.length)-1].z};
			if(Difficulty>1 && Pizdamatii.length>0){let MAX=0;
			for(let a=0; a<Pizdamatii.length; a++){if(Pizdamatii[a].F>Pizdamatii[MAX].F){MAX=a}};
			DefaultMovement=Pizdamatii[MAX].z};
		//DefaultMovement.pop();
		let DestinationValability=true;
		let ics=Lat;
		let igrec=Long;


		//console.log(DefaultMovement);
		for(let w=0;w<DefaultMovement.length;w++){ics+=(DefaultMovement[w]-2)*(DefaultMovement[w]%2);
		igrec+=(3-DefaultMovement[w])*((DefaultMovement[w]-1)%2);
		if(rostermap[ics][igrec]!=0){DestinationValability=false};}
		//alert(rostermap[ics][igrec]);
	
		if(DestinationValability){
			MoveUnit(unitIndex,DefaultMovement);
			};};

	};
	if(attackType=="Ranged"){
		let cekA=true;
		if(RangedTargetList.length==0){cekA=false};
		if(cekA){
			if(Difficulty==1){DefaultAttack=RangedTargetList[Math.floor(Math.random()*RangedTargetList.length)]};
			if(Difficulty>1){let MAX=0;
			for(let jd=0; jd<RangedTargetList.length; jd++){if(RangedTargetList[jd].F>RangedTargetList[MAX].F){MAX=jd}};
			//console.log(ContactTargetList[MAX].F+" "+ContactTargetList.length);
			DefaultAttack=RangedTargetList[MAX];
			};
			Target=rostermap[DefaultAttack.x][DefaultAttack.y].index;
			let Attacker=rostermap[X][Y].index;
			ActionRegister.Attack=Target;
			//Attack(Attacker,Target);
			//alert(Attacker);
		};
		if(!cekA){
			let DefaultMovement=[];
			if(Difficulty==1 && Pizdamatii.length>0){DefaultMovement=Pizdamatii[Math.ceil(Math.random()*Pizdamatii.length)-1].z};
			if(Difficulty>1 && Pizdamatii.length>0){let MAX=0;
			for(let a=0; a<Pizdamatii.length; a++){if(Pizdamatii[a].F>Pizdamatii[MAX].F){MAX=a}};
			DefaultMovement=Pizdamatii[MAX].z};
		//DefaultMovement.pop();
		let DestinationValability=true;
		let ics=Lat;
		let igrec=Long;

		for(let w=0;w<DefaultMovement.length;w++){ics+=(DefaultMovement[w]-2)*(DefaultMovement[w]%2);
		igrec+=(3-DefaultMovement[w])*((DefaultMovement[w]-1)%2);};
		if(rostermap[ics][igrec]!=0){DestinationValability=false};
	
		if(DestinationValability){
			ActionRegister.Movement=DefaultMovement;
			MoveUnit(unitIndex,DefaultMovement);
			};


			};};
			//console.log(DefaultMovement);
			};
function AITurn(Roster,Map,Constants){
	//Map=Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map;
	if(!Resolution){document.getElementById("AITurnIndicator").style.visibility="visible"};
	isAITurn=true;
	//alert(document.getElementById("AITurnIndicator").style.visibility);
	//This one does not disable the markers for long enough
	for(let x=1;x<=10;x++){for(let y=1;y<=10;y++){if(document.getElementById("Marker "+x+"X"+y)??0!=0){document.getElementById("Marker "+x+"X"+y).style.visibility="hidden";}};};

	//Money=Constants.Funds[(Turn-1)%SubRosters.length+1];
	//alert(SubRosters.length);

	AIFaction=AttackOrder[(Turn-1)%SubRosters.length];
	Funds=Constants.Funds[AIFaction];
	if(Constants.Commanders??false){Commander=Constants.Commanders[(Turn-1)%SubRosters.length+1]};

	/*
	setTimeout(function(){
			//alert(Roster[0].faction);
		for(let a=1; a<=GlassPanels; a++){
			let dudeIndex=AttackOrder[(Turn+a-2)%AttackOrder.length];
			//let dudeIndex=Roster[0].faction;
			//alert(dudeIndex);
			document.getElementById("Glassplatecolor"+a).style.background=Factions[dudeIndex].color;
			document.getElementById("Glassplatename"+a).innerHTML=Factions[dudeIndex].name;
			if(document.getElementById("Glassplatecolor"+a).style.background!='black'){document.getElementById("Glassplatename"+a).style.color='black'}else{document.getElementById("Glassplatename"+a).style.color='indigo'};};
		},GlobalDelayerConstant);
		*/

	//alert(Constants.Funds[(Turn-1)%SubRosters.length+1]);
	//alert(AIFaction);


	//while(true){let x=};
	let MedianUnitSelector=SubRosters[0];
	let MUSS=0;
	//DO NOT USE A WHILE TRUE BEFORE ROSTER LISTING IS FIXED OR IT'LL FUCK UP THE WHOLE SCRIPT
	//while(true){};
	for(let t=0; t<MedianUnitSelector.length; t++){if(MedianUnitSelector[t].life>0){MUSS=t}};
		MedianUnit={X:MedianUnitSelector[MUSS].x,Y:MedianUnitSelector[MUSS].y};
	//console.log(MedianUnit.X+" "+MedianUnit.Y);


	for(let x=0;x<Map.length;x++){for(y=0;y<Map[0].length;y++){
		if( (ControlMap??0) !=0 && ControlMap[x][y]==AIFaction){Constants.Funds[(Turn-1)%SubRosters.length+1]+=GenerateRevenue(Terrain[Map[x][y]].revenue??0,x,y)};
		if(hasCertainTrait(rostermap[x][y].unitType??0,"Financial Center")&&rostermap[x][y].faction==AIFaction){Constants.Funds[(Turn-1)%SubRosters.length+1]+=GenerateRevenue(100,x,y)};

		}};




	ActiveRoster=[];
	for(let x=0;x<Roster.length;x++){if(Roster[x].life>0 && !hasCertainTrait(Roster[x].unitType,"Inertial")){ActiveRoster[ActiveRoster.length]=Roster[x]}};
		//alert(ActiveRoster.length);
	
	//alert(GlobalDelayerConstant);


		//Here is the code block that ensures dead factions are flushed out of the system. Or at least it was supposed to, until we found out just how freaking buggy it was
		let FactionIsAlive=true;
	if(ActiveRoster.length==0){let TurnRefactorer=(TurnIndex-1)%AttackOrder.length;
		//TurnIndex=0; 
		//AttackOrder.splice(AIFaction,1); 
		FactionIsAlive=false;
			};



			

	if(FactionIsAlive){setTimeout(InterphaseBanner,GlobalDelayerConstant,AttackOrder[CurrentTurn],Turn)};
	
	
		InternalDelayerFactor=0;

	MAXI=ActiveRoster.length;
	//console.log(MAXI);
	for(let i=0;i<ActiveRoster.length;i++){



		let Stealth=false;
		if(hasCertainTrait(Roster[i].unitType,"Stealth")){Stealth=true};


		if(Roster[i].x>0){
			if(Factions[rostermap[Roster[i].x-1][Roster[i].y].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x-1][Roster[i].y].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		if(Roster[i].x<Map.length-1){
			if(Factions[rostermap[Roster[i].x+1][Roster[i].y].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x+1][Roster[i].y].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};

		if(Roster[i].y>0){
			if(Factions[rostermap[Roster[i].x][Roster[i].y-1].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x][Roster[i].y-1].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		if(Roster[i].y<Map[0].length-1){
			if(Factions[rostermap[Roster[i].x][Roster[i].y+1].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x][Roster[i].y+1].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		

		if(Stealth){rostermap[Roster[i].x][Roster[i].y].isCloaked=Stealth};
		/*	
		if(Roster[i].x>=StandardX && Roster[i].y>=StandardY && Roster[i].x<StandardX+10 && Roster[i].y<StandardY+10){document.getElementById("Entity "+(Roster[i].x+StandardX+1)+"X"+(Roster[i].y+StandardY+1)).style.filter+=" opacity(50%)"};};*/
		refreshMap();

		if(i==0){setTimeout(AI_Act,0,i)};

			//This block makes a list of production units;
			//alert(ActiveRoster[0].faction);
	let Industry=[];

	if((ControlMap??0)!=0){
		//alert("plm");
		for(let a=0; a<Map.length; a++){for(b=0; b<Map[0].length; b++){
			if(ControlMap[a][b]==AIFaction && Map[a][b]==10 && rostermap[a][b]==0){Industry[Industry.length]={X:a,Y:b,T:1}};
			if(ControlMap[a][b]==AIFaction && Map[a][b]==11 && rostermap[a][b]==0){Industry[Industry.length]={X:a,Y:b,T:2}};
			if(ControlMap[a][b]==AIFaction && Map[a][b]==12 && rostermap[a][b]==0){Industry[Industry.length]={X:a,Y:b,T:3}};
			}};
		

	//This block constructs units in (hopefully) every production unit

			
	for(let I=0; I<Industry.length; I++){
		let UnitOptions=[];
		let UnitChoice=0;

		if(Industry[I].T==1){
			for(let c=1; c<=40; c++){if(Units[c].Cost<=Funds && (Units[c].FactionSpecificity??AIFaction)==AIFaction){UnitOptions[UnitOptions.length]={K:c,V:(Units[c].HP+Units[c].Attack)/1}}};
			};
		if(Industry[I].T==2){
			for(let c=42; c<=50; c++){if(Units[c].Cost<=Funds && (Units[c].FactionSpecificity??AIFaction)==AIFaction){UnitOptions[UnitOptions.length]={K:c,V:(Units[c].HP+Units[c].Attack)/1}}};
			};
		if(Industry[I].T==3){
			for(let c=52; c<=60; c++){if(Units[c].Cost<=Funds && (Units[c].FactionSpecificity??AIFaction)==AIFaction){UnitOptions[UnitOptions.length]={K:c,V:(Units[c].HP+Units[c].Attack)/1}}};
			};

		if(UnitOptions.length>0 && Difficulty==1){UnitChoice=UnitOptions[Math.floor(Math.random()*UnitOptions.length)]};
		if(UnitOptions.length>0 && Difficulty>1){let BestYet=0; for(let p=0; p<UnitOptions.length; p++){if(UnitOptions[p].V>UnitOptions[BestYet].V){BestYet=p}}; UnitChoice=UnitOptions[BestYet]};

		//This almost works, but not yet
		if(UnitChoice!=0){DeployUnit(Industry[I].X+1,Industry[I].Y+1,UnitChoice.K,AIFaction,1); let AssBackwardsRefund=Units[UnitChoice.K].Cost; YourMoney+=AssBackwardsRefund; Constants.Funds[AIFaction]-=AssBackwardsRefund};
		};

		};

		//Aaaaand here is the block for AI building turrets. Or rather will be

		if(Difficulty>2){};
		//alert(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map);
			//alert(InternalDelayerFactor);
			//setTimeout(AI_Scouter,InternalDelayerFactor,ActiveRoster[i],Map);
			//alert(ActiveRoster[i].index);
			

			//console.log(ActionRegister);
			//AI_Scouter(Roster[x],Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map)
			//if(x==ActiveRoster.length-1){document.getElementById("AITurnIndicator").style.visibility="hidden";};








		
		};
		
		
		function DeactivateAIMarker(){document.getElementById('AITurnIndicator').style.visibility='hidden'; isAITurn=false;};
		let time=ActiveRoster.length*1400;
		GlobalDelayerConstant+=1400*ActiveRoster.length;


				

		


		//alert(SubRosters.length);
		//alert((Turn+1)%SubRosters.length);
		if((Turn+1)%SubRosters.length==1){setTimeout(DeactivateAIMarker,1400*ActiveRoster.length);}
		};
function Attack(Attacker,Defender){
	//alert(Defender);
	let Interceptor=Defender;
	let Atk=MapRoster[Attacker];
	let Def=MapRoster[Defender];
	//Map=Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map;
	Map=Map;
	let AttackerTile=Terrain[Map[Atk.x][Atk.y]];
	let DefenderTile=Terrain[Map[Def.x][Def.y]];
	//if(Atk.direction<2.5){direction=Atk.direction+2}else{direction=Atk.direction-2};
	let DirSeed=Atk.direction;
	if(Atk.x>Def.x){direction=1};
	if(Atk.x<Def.x){direction=3};
	if(Atk.y<Def.y){direction=2};
	if(Atk.y>Def.y){direction=4};
	Atk.direction=direction;
	//if(Atk.x>=StandardX&&Atk.x<StandardX+10&&Atk.y>=StandardY&&Atk.y<StandardY+10){AttackingAnimation(Attacker)};
	
	let DamageModifier=1;
	let dist =((Atk.x-Def.x)*(Atk.x-Def.x)+(Atk.y-Def.y)*(Atk.y-Def.y));
	//alert(DamageModifier);
	if(hasCertainTrait(Atk.unitType,"Indomitable")){DamageModifier=1;};
	let LogisticFactor=BiomeRegistry[BiomeMap[Atk.x][Atk.y]].LogisticIndex;
	DamageModifier*=LogisticFactor;

	if(Atk.damageType==Def.armor&&Atk.damageType!="Medium"){DamageModifier=DamageModifier*1.5;};
	if(Atk.damageType=="Light"&&Def.armor=="Heavy"){DamageModifier=DamageModifier*0.5;};
	if(Atk.damageType=="Heavy"&&Def.armor=="Light"){DamageModifier=DamageModifier*0.5;};
	//alert(Atk.willAmbush);
	if(hasCertainTrait(Atk.unitType,"Stealth")){if(Atk.willAmbush??false){DamageModifier*=2; Atk.willAmbush=false}};
	//if(Atk.damageType=="Medium"){DamageModifier=1;};

	//alert(DamageModifier);
	DamageModifier=DamageModifier*DefenderTile.protectionFactor;
	if(hasCertainTrait(Atk.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=1.25};
	if(hasCertainTrait(Def.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=0.8};
	//if(ChosenUnit.isCloaked){DamageModifier*=2};
	DamageModifier*=(5+Atk.morale)/5;
	let canCounterattack=true;
	let isIntercepted=false;

	if(hasCertainTrait(Def.unitType,"Sonar") && hasCertainTrait(Atk.unitType,"Submerged")){isIntercepted=true};

	if(MapRoster[Attacker].movementType=="Flight"){
		InterceptorList=[];
		for(let a=Math.max(Atk.x-3,0); a<Math.min(Atk.x+3,Map.length); a++){for(let b=Math.max(Atk.y-3,0); b<Math.min(Atk.y+3,Map[0].length); b++){
			//alert(a+" "+b);
			let canIntercept=true;
			if(rostermap[a][b]==0){canIntercept=false}else{if(!hasCertainTrait(rostermap[a][b].unitType,"Anti-Air")){canIntercept=false;}};

			if((a-Atk.x)*(a-Atk.x)+(b-Atk.y)*(b-Atk.y)<=9 && canIntercept==true){InterceptorList[InterceptorList.length]={x:a,y:b}};
			}};
		OpportuneInterceptor=InterceptorList[Math.floor(Math.random()*InterceptorList.length)];
		if(InterceptorList.length>0){isIntercepted=true; Interceptor=rostermap[OpportuneInterceptor.x][OpportuneInterceptor.y].index};
		};
	if(hasCertainTrait(Atk.unitType,"Submerged") && !isIntercepted){
		InterceptorList=[];
		for(let a=Math.max(Atk.x-3,0); a<Math.min(Atk.x+3,Map.length); a++){for(let b=Math.max(Atk.y-3,0); b<Math.min(Atk.y+3,Map[0].length); b++){
			//alert(a+" "+b);
			let canIntercept=true;
			if(rostermap[a][b]==0){canIntercept=false}else{if(!hasCertainTrait(rostermap[a][b].unitType,"Sonar")){canIntercept=false;}};

			if((a-Atk.x)*(a-Atk.x)+(b-Atk.y)*(b-Atk.y)<=9 && canIntercept==true){InterceptorList[InterceptorList.length]={x:a,y:b}};
			}};
		OpportuneInterceptor=InterceptorList[Math.floor(Math.random()*InterceptorList.length)];
		if(InterceptorList.length>0){isIntercepted=true; Interceptor=rostermap[OpportuneInterceptor.x][OpportuneInterceptor.y].index};





		};


	if(MapRoster[Defender].unitType<12 && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Infantry")){DamageModifier*=3};
	if(MapRoster[Defender].unitType<12 && hasCertainTrait(MapRoster[Attacker].unitType,"Schwerpunkt")){DamageModifier*=1.4};
	if(MapRoster[Defender].movementType=="Tracked" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Tank") && !hasCertainTrait(MapRoster[Defender].unitType,"Anti-Tank")){canCounterattack=false};
	if(MapRoster[Defender].movementType=="Flight" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){DamageModifier*=2};
		//alert(Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder");
	if(hasCertainTrait(Atk.unitType,"Anti-Ship") && (Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=3};
	//if(hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Ship")){if(MapRoster[Defender].movementType!="Rudder" && MapRoster[Defender].movementType!="Heavy Rudder"){DamageModifier*=0;}};
	if(MapRoster[Defender].movementType=="Stationary" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Structure")){DamageModifier*=2};

	if(hasCertainTrait(Def.unitType,"Steer")&&(Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=1+(Math.max(Math.min(Atk.speed-Def.speed,0),-4)*0.15)};

	if(hasCertainTrait(Def.unitType,"Tank-Hunter") && MapRoster[Attacker].movementType=="Tracked"){isIntercepted=true};
	if(hasCertainTrait(Atk.unitType,"Tank-Hunter")){isIntercepted=false};
	if(hasCertainTrait(Def.unitType,"Self-Destruct")){isIntercepted=false};
	
	//alert(dist);
	//alert(Def.unitType);
	if(dist>(Units[Def.unitType].MaxRange*Units[Def.unitType].MaxRange)){canCounterattack=false; isIntercepted=false};
	if(Atk.movementType=="Flight" && !hasCertainTrait(Def.unitType,"Skysweeper")){canCounterattack=false};
	if(hasCertainTrait(Atk.unitType,"Submerged") && !hasCertainTrait(Def.unitType,"Depth Strike")){canCounterattack=false};
	if(hasCertainTrait(Def.unitType,"Seabound") && Units[Atk.unitType].Movement!="Rudder" && Units[Atk.unitType].Movement!="Heavy Rudder"){canCounterattack=false};
	//alert(Units[Def.unitType].MaxRange*Units[Def.unitType].MaxRange);
	

	if(isIntercepted){GhostAttack(Attacker,0,0,25,"Standard")};

	DamageModifier*=Atk.life/Units[Atk.unitType].HP

	let Damage=Math.ceil(Atk.damage*DamageModifier);
	//if(hasCertainTrait(Atk.unitType,"Tank-Hunter") && Def.armor!="Heavy"){Damage-=25};
	if(hasCertainTrait(Def.unitType,"Cemented Steel Armor") && !hasCertainTrait(Atk.unitType,"Supply Distribution") && !hasCertainTrait(Atk.unitType,"Cavitation Explosion")){Damage-=20};
	Damage=Math.max(Damage,0);
	if(MapRoster[Defender].movementType=="Flight" && !hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){if(Damage>25){Damage=25}};
	if(hasCertainTrait(MapRoster[Attacker].unitType,"Supply Distribution")){Damage*=-1; canCounterattack=false;};

	//Interceptor="UMF";
	/*
	if(MapRoster[Attacker].faction==PlayerChoiceFaction){
			LastMove.ID=Attacker;
			LastMove.X=Atk.x;
			LastMove.Y=Atk.y;
			LastMove.HP=Atk.life;
			};*/

	if(hasCertainTrait(Atk.unitType,"Terrifying")){if(Units[Def.unitType].Cost<1000&&Def.morale>-3){Def.morale-=1}};
	if(hasCertainTrait(Atk.unitType,"Inflaming")){if(Def.morale<3){Def.morale+=1}};

	





	if(Atk.life>0){
	MarkerMap[Atk.x][Atk.y]=0;
	document.getElementById("Marker "+(Atk.x+1-StandardX)+"X"+(Atk.y+1-StandardY)).style.visibility="hidden";
	let HitAnimStyle="Standard";
	if(hasCertainTrait(Atk.unitType,"Supply Distribution")){HitAnimStyle="Supply"};
	if(hasCertainTrait(Atk.unitType,"Dispersion")){HitAnimStyle="Gaswave"};
	if(hasCertainTrait(Atk.unitType,"Streamblast")){HitAnimStyle="Neutron Wave"};
	if(Atk.x>=StandardX&&Atk.x<StandardX+Map.length&&Atk.y>=StandardY&&Atk.y<StandardY+Map[0].length){if(!isIntercepted){AttackingAnimation(Attacker)}else{setTimeout(AttackingAnimation, 800, Attacker)}};
	if(Def.x>=StandardX&&Def.x<StandardX+Map.length&&Def.y>=StandardY&&Def.y<StandardY+Map[0].length){if(!isIntercepted){HitAnimation(Defender,HitAnimStyle)}else{setTimeout(HitAnimation, 800, Defender, HitAnimStyle)}};

	//alert(Damage);
	//alert(Atk.x+" "+Atk.y);
	if(!hasCertainTrait(Atk.unitType,"Dispersion") && !hasCertainTrait(Atk.unitType,"JUDGEMENT") && ((LastMove.ID??0)==0 || hasCertainTrait(Atk.unitType,"Bewegungskrieg") || (LastMove.hasEngaged??false))){

		LastMove.ID=Attacker;
		if((LastMove.DIR??0)==0){LastMove.DIR=DirSeed};
		//alert(LastMove.DIR);
		if((LastMove.X??0)==0){LastMove.X=Atk.x};
		if((LastMove.Y??0)==0){LastMove.Y=Atk.y}; 
		LastMove.HP=Atk.life;
		//LastMove.cloak=MapRoster[Attacker].isCloaked??false;
		if(MapRoster[Attacker].canEncore){LastMove.encore=MapRoster[Attacker].canEncore??false};

		if((LastMove.EID??0)==0){LastMove.EID=Defender; LastMove.EHP=Def.life; LastMove.EX=Def.x; LastMove.EY=Def.y; LastMove.GRV=Def}else{LastMove.E2ID=Defender; LastMove.E2HP=Def.life; LastMove.E2X=Def.x; LastMove.E2Y=Def.y; LastMove.GRV2=Def};

		}else if((LastMove.ID??0)!=0){
			//if((LastMove.DIR??0)==0){LastMove.DIR=DirSeed};
			//if((LastMove.X??0)==0){LastMove.X=Atk.x};
			//if((LastMove.Y??0)==0){LastMove.Y=Atk.y};
			//LastMove.HP=Atk.life;
		}else{LastMove.ID=0};

	//console.log(LastMove.X+" "+LastMove.Y);
	if(!hasCertainTrait(Atk.unitType,"Dispersion") && !hasCertainTrait(Atk.unitType,"JUDGEMENT") && Units[Atk.unitType].MaxRange>1){

		LastMove.ID=Attacker;
		LastMove.X=Atk.x;
		LastMove.Y=Atk.y;
		LastMove.HP=Atk.life;
		LastMove.DIR=DirSeed;
		LastMove.cloak=MapRoster[Attacker].isCloaked??false;
		if(MapRoster[Attacker].canEncore){LastMove.encore=MapRoster[Attacker].canEncore??false};
		if((LastMove.EID??0)==0){LastMove.EID=Defender; LastMove.EHP=Def.life; LastMove.EX=Def.x; LastMove.EY=Def.y; LastMove.GRV=Def}else{LastMove.E2ID=Defender; LastMove.E2HP=Def.life; LastMove.E2X=Def.x; LastMove.E2Y=Def.y; LastMove.GRV2=Def}
		};





	if(HitAnimStyle=="Standard" || HitAnimStyle=="Supply"){Def.life-=Damage;
	}else if(HitAnimStyle=="Gaswave"){
		for(let x=Math.max(0,Def.x-1); x<=Math.min(Map.length-1,Def.x+1);x++){for(let y=Math.max(0,Def.y-1); y<=Math.min(Map[0].length-1,Def.y+1); y++){
			SplashAttack(Atk,x,y);
		}};


	}else if(HitAnimStyle=="Neutron Wave"){
		LaserVar=0;
		if(Def.x<Atk.x){LaserVar=1;LaserConstX=-1;LaserConstY=0};
		if(Def.x>Atk.x){LaserVar=3;LaserConstX=1;LaserConstY=0};
		if(Def.y>Atk.y){LaserVar=2;LaserConstX=0;LaserConstY=1};
		if(Def.y<Atk.y){LaserVar=4;LaserConstX=0;LaserConstY=-1};

		//for(let l=1; l<=Units[Atk.unitType].MaxRange; l++){
			//SplashAttack(Atk,Atk.x+l*(1+1),Atk.y+l*(1+1))};

		//if(LaserVar%2!=0){LaserCap=Map.length; LaserMin=Math.max(Def.x-7,0); LaserMax=Math.min(Def.x,LaserCap-7)};
		//if(LaserVar%2==0){LaserCap=Map[0].length; LaserMin=Math.max(Def.y-7,0); LaserMax=Math.min(Def.y,LaserCap-7)};

		//let r=Units[Atk.unitType].MaxRange;
		for(let l=1; l<=7; l++){
			//SplashAttack(Atk,Atk.x+l*LaserConstX,Atk.y+l*LaserConstY);
			if(Atk.x+l*LaserConstX<Map.length && Atk.y+l*LaserConstY<Map[0].length && Atk.x+l*LaserConstX>=0 && Atk.y+l*LaserConstY>=0){SplashAttack(Atk,Atk.x+l*LaserConstX,Atk.y+l*LaserConstY)};
		};
			//if(Atk.x-7>=0);



	}else if(HitAnimStyle=="Antimatter"){};

		ScoutVicinity(Atk.x,Atk.y);
		LastMove.Uncloaked=AdjacentCloakers;
		if(!rostermap[Atk.x][Atk.y].isCloaked){document.getElementById("EntityCore "+(Atk.x+1)+"X"+(Atk.y+1)).style.filter=Factions[Atk.faction].ChromaCode;};
		for(let c=0;c<AdjacentCloakers.length;c++){
		if(AdjacentCloakers[c]==1){document.getElementById("EntityCore "+(Atk.x)+"X"+(Atk.y+1)).style.filter=Factions[rostermap[Atk.x-1][Atk.y].faction].ChromaCode};
		if(AdjacentCloakers[c]==2){document.getElementById("EntityCore "+(Atk.x+1)+"X"+(Atk.y+2)).style.filter=Factions[rostermap[Atk.x][Atk.y+1].faction].ChromaCode};		
		if(AdjacentCloakers[c]==3){document.getElementById("EntityCore "+(Atk.x+2)+"X"+(Atk.y+1)).style.filter=Factions[rostermap[Atk.x+1][Atk.y].faction].ChromaCode};
		if(AdjacentCloakers[c]==4){document.getElementById("EntityCore "+(Atk.x+1)+"X"+(Atk.y)).style.filter=Factions[rostermap[Atk.x][Atk.y-1].faction].ChromaCode};
			};

	//alert(Damage);

	if(hasCertainTrait(Atk.unitType,"Absorber")){let HealIndex=Math.min(Damage,Math.abs(Def.life),Units[Atk.unitType].HP-Atk.life); Atk.life+=HealIndex};
	if(Def.life>Units[Def.unitType].HP){Def.life=Units[Def.unitType].HP};
	};

	if(hasCertainTrait(Atk.unitType,"Self-Destruct")){Atk.life=0;canCounterattack=false};
	if(Atk.life<=0){setTimeout(UnitLost,700,Attacker);};
	
	if(Def.life<=0){
		KillingUnit=true;
		let canEncore=false;
		setTimeout(UnitLost,700,Defender);
		if(hasCertainTrait(Atk.unitType,"Bewegungskrieg")&&Atk.canEncore){canEncore=true;Atk.canEncore=false};
		//alert(Atk.x+" "+Atk.y);
		if(canEncore){MarkerMap[Atk.x][Atk.y]=true;
		document.getElementById("Marker "+(Atk.x+1-StandardX)+"X"+(Atk.y+1-StandardY)).style.visibility="visible";}
	}else{
		//Counterattack(Defender,Attacker)
		if(dist<Def.minR*Def.minR){canCounterattack=false};
		if(dist>Def.maxR*Def.maxR){canCounterattack=false};
		//alert(Atk.MaxRange);
		if(hasCertainTrait(Atk.unitType,"Mobile Battery") && Units[Atk.unitType].MaxRange>1 && !hasCertainTrait(Def.unitType,"Mobile Battery")){canCounterattack=false};
		if(hasCertainTrait(Def.unitType,"Self-Destruct")){canCounterattack=false};
		if(hasCertainTrait(Def.unitType,"Dispersion")){canCounterattack=false};
		if(hasCertainTrait(Def.unitType,"JUDGEMENT")){canCounterattack=false};
		if(Def.damageType=="None"){canCounterattack=false};
		if(isIntercepted){canCounterattack=false};
		//if(false){canCounterattack=false};
		if(canCounterattack){
		setTimeout(Counterattack, 800, Defender, Attacker);};

	};

	EvaluateDynamicEvent('Action','null');
	
	if(Atk.isVized){let ShouldProbablyCheck=false;
		for(let l=0; l<Constants.Defeat.length; l++){if(Constants.Defeat[l]==Defender && Def.life<=0){ShouldProbablyCheck=true}};
		for(let l=0; l<Constants.Protect.length; l++){if(Constants.Protect[l]==Attacker && Atk.life<=0){ShouldProbablyCheck=true}};
		if(Map.length*Map[0].length<=1000){ShouldProbablyCheck=true};
		if(ShouldProbablyCheck){Inspection(Turn,Constants,Roster);Atk.isVized=false}}};
function AttackEstimate(Attacker,Defender){
	let Interceptor=Defender;
	let Atk=MapRoster[Attacker];
	let Def=MapRoster[Defender];
	Map=Map;
	let AttackerTile=Terrain[Map[Atk.x][Atk.y]];
	let DefenderTile=Terrain[Map[Def.x][Def.y]];
	let DirSeed=Atk.direction;
	if(Atk.x>Def.x){direction=1};
	if(Atk.x<Def.x){direction=3};
	if(Atk.y<Def.y){direction=2};
	if(Atk.y>Def.y){direction=4};
	//Atk.direction=direction;
	let HypoLifeA=JSON.parse(JSON.stringify(Atk.life));
	let HypoLifeE=JSON.parse(JSON.stringify(Atk.life));
	
	let DamageModifier=1;
	let dist =((Atk.x-Def.x)*(Atk.x-Def.x)+(Atk.y-Def.y)*(Atk.y-Def.y));
	if(hasCertainTrait(Atk.unitType,"Indomitable")){DamageModifier=1;};
	DamageModifier*=(AttackerTile.logisticFactor??1);

	if(Atk.damageType==Def.armor&&Atk.damageType!="Medium"){DamageModifier=DamageModifier*1.5;};
	if(Atk.damageType=="Light"&&Def.armor=="Heavy"){DamageModifier=DamageModifier*0.5;};
	if(Atk.damageType=="Heavy"&&Def.armor=="Light"){DamageModifier=DamageModifier*0.5;};
	if(hasCertainTrait(Atk.unitType,"Stealth")){if(Atk.willAmbush??false){DamageModifier*=2; Atk.willAmbush=false}};

	DamageModifier=DamageModifier*DefenderTile.protectionFactor;
	if(hasCertainTrait(Atk.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=1.25};
	if(hasCertainTrait(Def.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=0.8};
	DamageModifier*=(5+Atk.morale)/5;
	let canCounterattack=true;
	let isIntercepted=false;

	if(hasCertainTrait(Def.unitType,"Sonar") && hasCertainTrait(Atk.unitType,"Submerged")){isIntercepted=true};

	if(MapRoster[Attacker].movementType=="Flight"){
		InterceptorList=[];
		for(let a=Math.max(Atk.x-3,0); a<Math.min(Atk.x+3,Map.length); a++){for(let b=Math.max(Atk.y-3,0); b<Math.min(Atk.y+3,Map[0].length); b++){
			let canIntercept=true;
			if(rostermap[a][b]==0){canIntercept=false}else{if(!hasCertainTrait(rostermap[a][b].unitType,"Skysweeper")){canIntercept=false;}};

			if((a-Atk.x)*(a-Atk.x)+(b-Atk.y)*(b-Atk.y)<=9 && canIntercept==true){InterceptorList[InterceptorList.length]={x:a,y:b}};
			}};
		OpportuneInterceptor=InterceptorList[Math.floor(Math.random()*InterceptorList.length)];
		if(InterceptorList.length>0){isIntercepted=true; Interceptor=rostermap[OpportuneInterceptor.x][OpportuneInterceptor.y].index};
		};
	if(hasCertainTrait(Atk.unitType,"Submerged") && !isIntercepted){
		InterceptorList=[];
		for(let a=Math.max(Atk.x-3,0); a<Math.min(Atk.x+3,Map.length); a++){for(let b=Math.max(Atk.y-3,0); b<Math.min(Atk.y+3,Map[0].length); b++){
			let canIntercept=true;
			if(rostermap[a][b]==0){canIntercept=false}else{if(!hasCertainTrait(rostermap[a][b].unitType,"Sonar")){canIntercept=false;}};

			if((a-Atk.x)*(a-Atk.x)+(b-Atk.y)*(b-Atk.y)<=9 && canIntercept==true){InterceptorList[InterceptorList.length]={x:a,y:b}};
			}};
		OpportuneInterceptor=InterceptorList[Math.floor(Math.random()*InterceptorList.length)];
		if(InterceptorList.length>0){isIntercepted=true; Interceptor=rostermap[OpportuneInterceptor.x][OpportuneInterceptor.y].index};





		};


	if(MapRoster[Defender].unitType<12 && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Infantry")){DamageModifier*=3};
	if(MapRoster[Defender].unitType<12 && hasCertainTrait(MapRoster[Attacker].unitType,"Schwerpunkt")){DamageModifier*=1.4};
	if(MapRoster[Defender].movementType=="Tracked" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Tank") && !hasCertainTrait(MapRoster[Defender].unitType,"Anti-Tank")){canCounterattack=false};
	if(MapRoster[Defender].movementType=="Flight" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){DamageModifier*=2};
	if(hasCertainTrait(Atk.unitType,"Anti-Ship") && (Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=3};
	if(MapRoster[Defender].movementType=="Stationary" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Structure")){DamageModifier*=2};

	if(hasCertainTrait(Def.unitType,"Steer")&&(Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=1+(Math.max(Math.min(Atk.speed-Def.speed,0),-4)*0.15)};

	if(hasCertainTrait(Def.unitType,"Tank-Hunter") && MapRoster[Attacker].movementType=="Tracked"){isIntercepted=true};
	if(hasCertainTrait(Atk.unitType,"Tank-Hunter")){isIntercepted=false};
	if(hasCertainTrait(Def.unitType,"Self-Destruct")){isIntercepted=false};
	
	if(dist>(Units[Def.unitType].MaxRange*Units[Def.unitType].MaxRange)){canCounterattack=false; isIntercepted=false};
	if(Atk.movementType=="Flight" && !hasCertainTrait(Def.unitType,"Skysweeper")){canCounterattack=false};
	if(hasCertainTrait(Atk.unitType,"Submerged") && !hasCertainTrait(Def.unitType,"Depth Strike")){canCounterattack=false};
	if(hasCertainTrait(Def.unitType,"Seabound") && Units[Atk.unitType].Movement!="Rudder" && Units[Atk.unitType].Movement!="Heavy Rudder"){canCounterattack=false};

	if(isIntercepted){HypoLifeA-=25};

	DamageModifier*=Atk.life/Units[Atk.unitType].HP

	let Damage=Math.ceil(Atk.damage*DamageModifier);
	if(hasCertainTrait(Def.unitType,"Cemented Steel Armor") && !hasCertainTrait(Atk.unitType,"Supply Distribution") && !hasCertainTrait(Atk.unitType,"Cavitation Explosion")){Damage-=20};
	Damage=Math.max(Damage,0);
	if(MapRoster[Defender].movementType=="Flight" && !hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){if(Damage>25){Damage=25}};
	if(hasCertainTrait(MapRoster[Attacker].unitType,"Supply Distribution")){Damage*=-1; canCounterattack=false;};

	if(hasCertainTrait(Atk.unitType,"Terrifying")){if(Units[Def.unitType].Cost<1000&&Def.morale>-3){Def.morale-=1}};
	if(hasCertainTrait(Atk.unitType,"Inflaming")){if(Def.morale<3){Def.morale+=1}};



	if(HypoLifeA>0){
	MarkerMap[Atk.x][Atk.y]=0;
	document.getElementById("Marker "+(Atk.x+1-StandardX)+"X"+(Atk.y+1-StandardY)).style.visibility="hidden";
	HitAnimStyle="Standard";
	if(hasCertainTrait(Atk.unitType,"Supply Distribution")){HitAnimStyle="Supply"};
	if(hasCertainTrait(Atk.unitType,"Dispersion")){HitAnimStyle="Gaswave"};
	if(hasCertainTrait(Atk.unitType,"Streamblast")){HitAnimStyle="Neutron Wave"};
	//if(Atk.x>=StandardX&&Atk.x<StandardX+Map.length&&Atk.y>=StandardY&&Atk.y<StandardY+Map[0].length){if(!isIntercepted){AttackingAnimation(Attacker)}else{setTimeout(AttackingAnimation, 800, Attacker)}};
	//if(Def.x>=StandardX&&Def.x<StandardX+Map.length&&Def.y>=StandardY&&Def.y<StandardY+Map[0].length){if(!isIntercepted){HitAnimation(Defender,HitAnimStyle)}else{setTimeout(HitAnimation, 800, Defender, HitAnimStyle)}};

	if(HitAnimStyle=="Standard" || HitAnimStyle=="Supply"){HypoLifeE-=Damage;
	}else if(HitAnimStyle=="Gaswave"){
		for(let x=Math.max(0,Def.x-1); x<=Math.min(Map.length-1,Def.x+1);x++){for(let y=Math.max(0,Def.y-1); y<=Math.min(Map[0].length-1,Def.y+1); y++){
			//SplashAttack(Atk,x,y);
		}};

	}else if(HitAnimStyle=="Neutron Wave"){
		LaserVar=0;
		if(Def.x<Atk.x){LaserVar=1;LaserConstX=-1;LaserConstY=0};
		if(Def.x>Atk.x){LaserVar=3;LaserConstX=1;LaserConstY=0};
		if(Def.y>Atk.y){LaserVar=2;LaserConstX=0;LaserConstY=1};
		if(Def.y<Atk.y){LaserVar=4;LaserConstX=0;LaserConstY=-1};
		for(let l=1; l<=7; l++){
			if(Atk.x+l*LaserConstX<Map.length && Atk.y+l*LaserConstY<Map[0].length && Atk.x+l*LaserConstX>=0 && Atk.y+l*LaserConstY>=0){//SplashAttack(Atk,Atk.x+l*LaserConstX,Atk.y+l*LaserConstY)
		};
		};

	}else if(HitAnimStyle=="Antimatter"){};

		//ScoutVicinity(Atk.x,Atk.y);
		/*LastMove.Uncloaked=AdjacentCloakers;
		if(!rostermap[Atk.x][Atk.y].isCloaked){document.getElementById("Entity "+(Atk.x+1)+"X"+(Atk.y+1)).style.filter=Factions[Atk.faction].ChromaCode;};
		for(let c=0;c<AdjacentCloakers.length;c++){
		if(AdjacentCloakers[c]==1){document.getElementById("Entity "+(Atk.x)+"X"+(Atk.y+1)).style.filter=Factions[rostermap[Atk.x-1][Atk.y].faction].ChromaCode};
		if(AdjacentCloakers[c]==2){document.getElementById("Entity "+(Atk.x+1)+"X"+(Atk.y+2)).style.filter=Factions[rostermap[Atk.x][Atk.y+1].faction].ChromaCode};		
		if(AdjacentCloakers[c]==3){document.getElementById("Entity "+(Atk.x+2)+"X"+(Atk.y+1)).style.filter=Factions[rostermap[Atk.x+1][Atk.y].faction].ChromaCode};
		if(AdjacentCloakers[c]==4){document.getElementById("Entity "+(Atk.x+1)+"X"+(Atk.y)).style.filter=Factions[rostermap[Atk.x][Atk.y-1].faction].ChromaCode};
			};*/

	//if(hasCertainTrait(Atk.unitType,"Absorber")){let HealIndex=Math.min(Damage,Math.abs(Def.life),Units[Atk.unitType].HP-Atk.life); Atk.life+=HealIndex};
	if(Def.life>Units[Def.unitType].HP){Def.life=Units[Def.unitType].HP};
	};

	if(hasCertainTrait(Atk.unitType,"Self-Destruct")){Atk.life=0;canCounterattack=false};
	if(HypoLifeA<=0){ActionRegister.Liquidate=Atk};
	
	if(HypoLifeE<=0){
		//let canEncore=false;
		ActionRegister.Liquidate=Def;
		//if(hasCertainTrait(Atk.unitType,"Bewegungskrieg")&&Atk.canEncore){canEncore=true;Atk.canEncore=false};
		//alert(Atk.x+" "+Atk.y);
		//if(canEncore){MarkerMap[Atk.x][Atk.y]=true;
		//document.getElementById("Marker "+(Atk.x+1-StandardX)+"X"+(Atk.y+1-StandardY)).style.visibility="visible";}
	}else{
		//Counterattack(Defender,Attacker)
		if(dist<Def.minR*Def.minR){canCounterattack=false};
		if(dist>Def.maxR*Def.maxR){canCounterattack=false};
		//alert(Atk.MaxRange);
		if(hasCertainTrait(Atk.unitType,"Mobile Battery") && Units[Atk.unitType].MaxRange>1 && !hasCertainTrait(Def.unitType,"Mobile Battery")){canCounterattack=false};
		if(hasCertainTrait(Def.unitType,"Self-Destruct")){canCounterattack=false};
		if(Def.damageType=="None"){canCounterattack=false};
		if(isIntercepted){canCounterattack=false};
		//if(false){canCounterattack=false};
		if(canCounterattack){
			ActionRegister.Counter=Def;
		//setTimeout(Counterattack, 800, Defender, Attacker);};

	}};

	//EvaluateDynamicEvent('Action','null');
	
	if(Atk.isVized){let ShouldProbablyCheck=false;
		for(let l=0; l<Constants.Defeat.length; l++){if(Constants.Defeat[l]==Defender && Def.life<=0){ShouldProbablyCheck=true}};
		for(let l=0; l<Constants.Protect.length; l++){if(Constants.Protect[l]==Attacker && Atk.life<=0){ShouldProbablyCheck=true}};
		if(Map.length*Map[0].length<=1000){ShouldProbablyCheck=true};
		ShouldProbablyCheck=false;
		if(ShouldProbablyCheck){Inspection(Turn,Constants,Roster);Atk.isVized=false}}



	};
function AnalyseSquare(entityType,X,Y){
	
	//index=23;
	if(entityType=="Tile"){
		index=Map[X][Y];
		//if(index>9 && index<13){ActiveIndustrialNode={X:X,Y:Y};LaunchRecruitmentPanel(index-9);};
		HighlightedEntity=Terrain[index];
		LocalBiome=BiomeMap[X][Y];
		if(LocalizationMap[X][Y]==0){document.getElementById("DetBarName").innerHTML=Language.TerrainName[index];document.getElementById("DetBarDescription").innerHTML=Language.TerrainDesc[index];}
		else{document.getElementById("DetBarName").innerHTML=LocalizationMap[X][Y].name;document.getElementById("DetBarDescription").innerHTML=LocalizationMap[X][Y].description;};
		document.getElementById("DetBar").src="Assets/Miscellaneous/TerrainDetailBar.PNG";
		document.getElementById("DetBarDescription").style.width="350px";
		document.getElementById("Icon").style.visibility="inherit";
		document.getElementById("IconMesh").style.visibility="hidden";
		document.getElementById("Icon").src="Assets/Tiles/"+Terrain[index].name+".PNG";
		document.getElementById("Icon").style.filter="hue-rotate(0deg) saturate(100%) brightness(100%)";
		if(Terrain[index].Urbanistics>=2){document.getElementById("Icon").style.filter=Factions[ControlMap[X][Y]].ChromaCode};
		document.getElementById("Health").style.visibility="hidden";
		document.getElementById("Damage").style.visibility="hidden";
		document.getElementById("Movement").style.visibility="hidden";
		document.getElementById("Biome").style.visibility="inherit";
		document.getElementById("Biome").src="Assets/Traits/"+BiomeRegistry[LocalBiome].Nominator+".PNG";
		if(LocalBiome==1){document.getElementById("Biome").src="Assets/Traits/Temperate.PNG"};
		if(Terrain[index].tag1==""){document.getElementById("Trait1").src=""}else{document.getElementById("Trait1").src="Assets/Traits/"+Terrain[index].tag1+".PNG";};
		if(Terrain[index].tag2==""){document.getElementById("Trait2").src=""}else{document.getElementById("Trait2").src="Assets/Traits/"+Terrain[index].tag2+".PNG";};		
		if(Terrain[index].tag3==""){document.getElementById("Trait3").src=""}else{document.getElementById("Trait3").src="Assets/Traits/"+Terrain[index].tag3+".PNG";};
		if(Terrain[index].tag4==""){document.getElementById("Trait4").src=""}else{document.getElementById("Trait4").src="Assets/Traits/"+Terrain[index].tag4+".PNG";};
		
	};

	if(entityType=="Unit"){
		//alert(X+" "+Y);
		index=rostermap[X][Y];
		var unit=index;
		HighlightedEntity=Units[unit.unitType];
		var armorindex=0;
		if(unit.armor=="Light"){armorindex=1}else if(unit.armor=="Medium"){armorindex=2}else if(unit.armor=="Heavy"){armorindex=3};
		var weaponindex=0;
		if(unit.damageType=="Light"){weaponindex=1;}else if(unit.damageType=="Medium"){weaponindex=2;}else if(unit.damageType=="Heavy"){weaponindex=3;}else{weaponindex=4;};
		var movementindex=0;
		if(unit.movementType=="Stationary"){movementindex=1;}else if(unit.movementType=="Foot"){movementindex=2;}else if(unit.movementType=="Wheeled"){movementindex=3;}else if(unit.movementType=="Tracked"){movementindex=4;}else if(unit.movementType=="Flight"){movementindex=5;}else if(unit.movementType=="Rudder"){movementindex=6;}else if(unit.movementType=="Heavy Rudder"){movementindex=7;}else if(unit.movementType=="Amphibious"){movementindex=8;};
		
		//alert(movementindex);
		document.getElementById("Icon").style.visibility="inherit";
		document.getElementById("IconMesh").style.visibility="inherit";
		document.getElementById("Icon").src="Assets/Units/Static/"+Units[unit.unitType].shortname+"2.PNG";
		document.getElementById("Icon").style.filter=Factions[unit.faction].ChromaCode;
		if(!Units[unit.unitType].MLPR??false){document.getElementById("IconMesh").src="Assets/Units/StaticMeshes/"+Units[unit.unitType].shortname+"Mesh2.PNG"}else{document.getElementById("IconMesh").src="Assets/Miscellaneous/Nothing.PNG"};

		document.getElementById("HPHeader").innerHTML=Language.SystemTerms[44];
		document.getElementById("DamageHeader").innerHTML=Language.SystemTerms[45];
		document.getElementById("MovementHeader").innerHTML=Language.SystemTerms[46];

		//document.getElementById("DetBarName").innerHTML=Units[unit.unitType].name;
		//alert(Language.LanguageComment);
		let Name=Language.UnitNames[unit.unitType];
		if(unit.hasSpecialName??0!=0){Name=Language.UnitSpecialNames[unit.hasSpecialName]};
		if(unit.hasCustomName??0!=0){Name=unit.hasCustomName};
		Name=rostermap[X][Y].name;
		//alert(Name);
		let Desc=Language.UnitDesc[unit.unitType];
		if(unit.hasSpecialDesc??0!=0){Desc=Language.UnitSpecialDesc[unit.hasSpecialDesc]};
		if(unit.hasCustomDesc??0!=0){Desc=unit.hasCustomDesc};
		Desc=rostermap[X][Y].description;
		document.getElementById("DetBarName").innerHTML=Name;
		document.getElementById("DetBarDescription").style.width="210px";
		document.getElementById("DetBarDescription").innerHTML=Desc;
		document.getElementById("DetBar").src="Assets/Miscellaneous/UnitDetailBar.PNG";

		document.getElementById("Health").style.visibility="inherit";
		document.getElementById("ArmorType").style.left=273-20*(armorindex-1)+"px";
		document.getElementById("ArmorType").style.clip="rect(0px,"+armorindex*20+"px,20px,"+(armorindex-1)*20+"px)";
		document.getElementById("HP").innerHTML=unit.life+"/"+Units[unit.unitType].HP;
		document.getElementById("HPbar").style.width=(40*unit.life/Units[unit.unitType].HP)+"px";
		document.getElementById("HPbar").style.filter="brightness("+(unit.life/Units[unit.unitType].HP)+")";
		ArmorShowcase=unit.armor;

		document.getElementById("Damage").style.visibility="inherit";
		document.getElementById("DamageType").style.left=350-20*(weaponindex-1)+"px";
		document.getElementById("DamageType").style.clip="rect(0px,"+weaponindex*20+"px,20px,"+(weaponindex-1)*20+"px)";
		document.getElementById("DamageValue").innerHTML=unit.damage+"("+Units[unit.unitType].MinRange+"-"+Units[unit.unitType].MaxRange+")";
		WeaponShowcase=unit.damageType;

		document.getElementById("Movement").style.visibility="inherit";
		document.getElementById("MovementType").style.left=427-20*(movementindex-1)+"px";
		document.getElementById("MovementType").style.clip="rect(0px,"+movementindex*20+"px,20px,"+(movementindex-1)*20+"px)";
		document.getElementById("Speed").innerHTML=unit.speed+"";
		MovementShowcase=unit.movementType;

		document.getElementById("Biome").style.visibility="hidden";
		
		if(Units[unit.unitType].tag1==""){document.getElementById("Trait1").src=""}else{document.getElementById("Trait1").src="Assets/Traits/"+Units[unit.unitType].tag1+".PNG";};
		if(Units[unit.unitType].tag2==""){document.getElementById("Trait2").src=""}else{document.getElementById("Trait2").src="Assets/Traits/"+Units[unit.unitType].tag2+".PNG";};		
		if(Units[unit.unitType].tag3==""){document.getElementById("Trait3").src=""}else{document.getElementById("Trait3").src="Assets/Traits/"+Units[unit.unitType].tag3+".PNG";};
		if(Units[unit.unitType].tag4==""){document.getElementById("Trait4").src=""}else{document.getElementById("Trait4").src="Assets/Traits/"+Units[unit.unitType].tag4+".PNG";};


	};

	if(entityType=="Structure"){};};
function AnalyzeSpecification(Index) {
		document.getElementById("SpecificationText").innerHTML=Language.SystemTerms[83+Index];
	if(Index==1){document.getElementById("SpecificationText").innerHTML+=((Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Funds??[0,0])[1]+" "+Language.SystemTerms[92])};
	if(Index==2){document.getElementById("SpecificationText").innerHTML+=(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Survival+" "+Language.SystemTerms[93])};
	if(Index==3){document.getElementById("SpecificationText").innerHTML+=(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.TimeLimit+" "+Language.SystemTerms[93])};};
function AttackAnimation(Unit){
	
	let unit=MapRoster[Unit];
	//alert(unit.unitType);
	//alert(unit.direction);
	AttackSFX="Assets/SFX/"+Units[unit.unitType].shortname+"Attack.MP3";
	var AttackSound = new Audio(AttackSFX);
	AttackSound.play();
	let cellX=Units[unit.unitType].AttackBoxX ?? 56;
	let cellY=Units[unit.unitType].AttackBoxY ?? 56;
	//alert(cellX + " " + cellY);
	let lat=unit.x;
	let long=unit.y;
	let direction=unit.direction;
	//alert(direction);
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).src="Assets/Units/Static/"+Units[unit.unitType].shortname+direction+".PNG";
	castTime=setInterval(Act,100);
	frame=0;

	function Act(){
	frame++;
		
	for(var candy=1; candy<=8; candy++){
	
	var top=(frame-2)*cellY+"px";
	var right=(direction)*cellX+"px";
	var bottom=(frame-1)*cellY+"px";
	var left=(direction-1)*cellX+"px";
	var offsetlat=-cellY*(frame-2)+"px";
	var offsetlong=(direction-1)*-cellX+(Units[unit.unitType].AttackOffsetX ?? [0,0,0,0,0])[direction]+"px";
	//alert(Units[unit.unitType].AttackSpriteOffset[direction] ?? 0);
	coord="rect("+top+","+right+","+bottom+","+left+")";

	//dynamic unit registry needed, else the function crashes
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).src="Assets/Units/Attack/"+Units[unit.unitType].shortname+"Attack.PNG";
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.clip=coord;
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.top=offsetlat;
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.left=offsetlong;
	

	};

	if(frame==9){clearInterval(castTime);
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).src="Assets/Units/Static/"+Units[unit.unitType].shortname+direction+".PNG";
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.top=0+"px";	
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.left=0+"px";
	document.getElementById("Entity "+(unit.x+1-StandardX)+"X"+(unit.y+1-StandardY)).style.clip="auto";

	};
	};};
function AttackingAnimation(Unit){
	let unit=MapRoster[Unit];
	let direction=unit.direction;

	AttackSFX="Assets/SFX/"+Units[unit.unitType].shortname+"Attack.MP3";
	var AttackSound = new Audio(AttackSFX);
	if(SoundChoice){AttackSound.play();};
	//console.log(unit.faction);
	document.getElementById("EntityCore "+(unit.x+1)+"X"+(unit.y+1)).src="Assets/Units/Attack/"+Units[unit.unitType].shortname+"Attack"+direction+".GIF";
	if(!Units[unit.unitType].MLPR??false){document.getElementById("EntityMesh "+(unit.x+1)+"X"+(unit.y+1)).src="Assets/Units/AttackMeshes/"+Units[unit.unitType].shortname+"Attack"+"Mesh"+direction+".GIF";}else{document.getElementById("EntityMesh "+(unit.x+1)+"X"+(unit.y+1)).style.visibility="hidden"};
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.left=(Units[unit.unitType].AttackOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.top=(Units[unit.unitType].AttackOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.zIndex=5;

	let castTime=setInterval(Act,35);
	let frame=0;

	function Act(){
	frame++;

	if(frame==17){clearInterval(castTime);
	document.getElementById("EntityCore "+(unit.x+1)+"X"+(unit.y+1)).src="Assets/Units/Static/"+Units[unit.unitType].shortname+direction+".PNG";
	if(!Units[unit.unitType].MLPR??false){document.getElementById("EntityMesh "+(unit.x+1)+"X"+(unit.y+1)).src="Assets/Units/StaticMeshes/"+Units[unit.unitType].shortname+"Mesh"+direction+".PNG";}else{document.getElementById("EntityMesh "+(unit.x+1)+"X"+(unit.y+1)).style.visibility="hidden"};
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.left=(Units[unit.unitType].StaticOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.top=(Units[unit.unitType].StaticOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
	document.getElementById("Entity "+(unit.x+1)+"X"+(unit.y+1)).style.zIndex=4;
		};

	};};
function Battle_Lost(){
	//BattleEnd=true;
	Resolution=true;
	Victory=false;
	//alert(Language.DefeatInterjections[3].length);
	if(BattleEnd){if(DialogueChoice){launchDialogueBloc(Interjection,0);}else{setTimeout(EndBattle,1000)};};
	BattleEnd=false;

	document.getElementById("EndBattleTitle").innerHTML=Language.SystemTerms[124];	};
function Battle_Won(){
	//BattleEnd=true;
	Resolution=true;
	Victory=true;
	
	if(BattleEnd){if(DialogueChoice){launchDialogueBloc(Postlogue,0);}else{setTimeout(EndBattle,1000)};};
	BattleEnd=false;

	document.getElementById("EndBattleTitle").innerHTML=Language.SystemTerms[123];};
function Build(Structure){
	//alert(hasCertainTrait(Structure,"Seabound"));
	if(YourMoney<Units[Structure].Cost || (!CanBuildCoastal&&hasCertainTrait(Structure,"Seabound"))){alert("Cannot build");
	}else{
		YourMoney-=Units[Structure].Cost;
		document.getElementById('BuildingConstructionPanel').style.visibility="hidden";
		let Thud=new Audio("Assets/SFX/Thud.mp3");
		Thud.play();
		let X=UnitIcs;
		let Y=UnitIgrec;
		let Santier={
			name: Units[0].name,
			description: Language.UnitDesc[0],
			ID:"Unit "+MapRoster.length,
			index:MapRoster.length-1,
			x:X, 
			y:Y, 
			unitType:0,
			faction:PlayerChoiceFaction,
			coallition:Factions[PlayerChoiceFaction].faction,
			damage:Units[0].Attack, 
			damageType:Units[0].Weapon,
			minR:Units[0].MinRange,
			maxR:Units[0].MaxRange, 
			life:Units[0].HP, 
			armor:Units[0].Armor, 
			speed:Units[0].Speed, 
			movementType:Units[0].Movement, 
			morale:0,
			direction:3,
			building:Structure,
			constructionTime:Units[Structure].Timer
			};

			MapRoster[MapRoster.length]=Santier;
			rostermap[X][Y]=Santier;
			document.getElementById('Entity '+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible";
			document.getElementById('EntityCore '+(X+1-StandardX)+"X"+(Y+1-StandardY)).src="Assets/Units/Static/Skele3.PNG";

	}};
function BuildingComplete(Index){
	let type=MapRoster[Index].building;
	let Building={
			name: Units[type].name,
			description: Language.UnitDesc[type],
			ID:"Unit "+MapRoster.length,
			index:Index,
			x:MapRoster[Index].x, 
			y:MapRoster[Index].y, 
			unitType:type,
			faction:PlayerChoiceFaction,
			coallition:Factions[PlayerChoiceFaction].faction,
			damage:Units[type].Attack, 
			damageType:Units[type].Weapon,
			minR:Units[type].MinRange,
			maxR:Units[type].MaxRange, 
			life:Units[type].HP, 
			armor:Units[type].Armor, 
			speed:Units[type].Speed, 
			movementType:Units[type].Movement, 
			morale:0,
			direction:3
		};
		//alert(Building.x+" "+Building.y);
		MapRoster[Index]=Building;
		rostermap[Building.x][Building.y]=Building;

		if(Building.x>=StandardX && Building.x<StandardX+10 && Building.y>=StandardY && Building.y<StandardY+10){document.getElementById("EntityCore "+(Building.x+2-StandardX)+"X"+(Building.y+2-StandardY)).src="Assets/Units/Static/"+Units[Building.unitType].shortname+"3.PNG";
			document.getElementById("EntityCore "+(Building.x+2-StandardX)+"X"+(Building.y+2-StandardY)).style.filter=Factions[PlayerChoiceFaction].ChromaCode;

	};

	SubRosters[0][SubRosters[0].length]=Building;};
function Buttsecks(){document.getElementById('Disclaimer').style.visibility='hidden';};
function CallCampaignScreen(){

	Emblem="Assets/Emblems/Emblem"+Factions[ChosenNation].Preffix+".PNG";
	NonEmblem="Assets/Emblems/NONEmblem"+Factions[ChosenNation].Preffix+".PNG";
	ChosenMission=1;
	ChooseChapter(1);
	let UnlockedLevels=[true,false,false,false,false];
	for(let j=0;j<=3;j++){let littledicky= Campaigns[ChosenNation-1][ChosenChapter-1][j].Finished??false;
	UnlockedLevels[j+2]=littledicky;
	if(littledicky){document.getElementById("Emblem"+(j+2)).src=Emblem;
	//document.getElementById("Emblem"+(j+2)).onClick="alert('Hooray!')";
	}else{document.getElementById("Emblem"+(j+2)).src=NonEmblem;};};
	document.getElementById("EmblemSlot").style.left="0px";
	document.getElementById("ChapterPanelPointer").style.top="-6px";
	document.getElementById("CampaignSelectionScreen").style.visibility="hidden";
	document.getElementById("NationDetails").style.visibility="hidden";
	document.getElementById("CampaignScreen").style.visibility="visible";
	document.getElementById('CampaignName').innerHTML=Language.ChapterName[ChosenNation-1][0];
	document.getElementById("Chp1plaque").src="Assets/Miscellaneous/Plaque.PNG";
	document.getElementById("Emblem1").src=Emblem;
	document.getElementById('MissionDescription').innerHTML=Language.MissionDesc[ChosenNation][ChosenChapter-1][0];
	document.getElementById('MissionName').innerHTML=Language.MissionName[ChosenNation-1][ChosenChapter-1][0];
	document.getElementById("LevelStartButton").innerHTML=Language.StartButtonTexts[ChosenNation-1];
	for(let i=1; i<8; i++){
	document.getElementById("Chapter "+i).style.visibility="hidden";
	if(i<=Campaigns[ChosenNation-1].length){document.getElementById("Chapter "+i).style.visibility="inherit";
		//if(i>1){document.getElementById("Chapter "+i).src="Assets/Miscellaneous/NonPlaque.PNG"};
		if(Campaigns[ChosenNation-1][i-1][4].Finished==true && i<7){
			document.getElementById("Chp"+(i+1)+"plaque").src="Assets/Miscellaneous/Plaque.PNG";}
			else if(i<Campaigns[ChosenNation-1].length){document.getElementById("Chp"+(i+1)+"plaque").src="Assets/Miscellaneous/NonPlaque.PNG";};
		};
	};


	document.getElementById("SpecificationText").innerHTML=Language.SystemTerms[91];
	if((Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Funds??[0,0])[1]>0){document.getElementById("CampaignSpecification1").style.visibility="inherit"}else{document.getElementById("CampaignSpecification1").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Survival<77777){document.getElementById("CampaignSpecification2").style.visibility="inherit"}else{document.getElementById("CampaignSpecification2").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.TimeLimit<77777){document.getElementById("CampaignSpecification3").style.visibility="inherit"}else{document.getElementById("CampaignSpecification3").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Defend.length>0){document.getElementById("CampaignSpecification4").style.visibility="inherit"}else{document.getElementById("CampaignSpecification4").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Capture.length>0){document.getElementById("CampaignSpecification5").style.visibility="inherit"}else{document.getElementById("CampaignSpecification5").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Protect.length>0){document.getElementById("CampaignSpecification6").style.visibility="inherit"}else{document.getElementById("CampaignSpecification6").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Constants.Defeat.length>0){document.getElementById("CampaignSpecification7").style.visibility="inherit"}else{document.getElementById("CampaignSpecification7").style.visibility="hidden"};};
function CallInterlogue(){
	document.getElementById("InterlogueScreen").style.visibility="visible";
	document.getElementById("InterlogueText").innerHTML=Language.Interlogues[ChosenNation-1][ChosenChapter-1];
	document.getElementById("InterlogueImage").src="Assets/Paralogues/"+ChosenNation+"X"+ChosenChapter+".JPG";};
function CallPreloader(){
	document.getElementById("Disclaimer2").style.visibility="visible";

	MainTheme=new Audio("Assets/BGM/RiversOfSteel.MP3");
	if(MusicChoice){MainTheme.play();};

	Aphorism=Math.ceil(21*Math.random());
	//Aphorism=14;
	document.getElementById("AphorismIllustration").src="Assets/Aphorisms/Aphorism"+Aphorism+".PNG";
	document.getElementById("AphorismText").innerHTML='"'+Language.InitializerAphorisms[Aphorism*2]+'"'+"<br><br>"+Language.InitializerAphorisms[Aphorism*2+1];
	document.getElementById("PreloaderSplash").innerHTML=Language.LoaderSoundbites[Math.floor(Math.random()*Language.LoaderSoundbites.length)];

	let PreloaderFrame=0;
	let Loader=window.setInterval(Preload,50);

	function Preload(){if(PreloaderFrame<35){PreloaderFrame++};
	if(PreloaderFrame%7==0){document.getElementById("PreloaderSplash").innerHTML=Language.LoaderSoundbites[Math.floor(Math.random()*Language.LoaderSoundbites.length)]};
	document.getElementById("PreloaderBar").style.width=PreloaderFrame*20+"px";

	if(PreloaderFrame==35){clearInterval(Loader)}};};
function castMap(){
	//CallPreloader();
	for(let i=1;i<=Map.length;i++){
		for(let j=1;j<=Map[0].length;j++){
			var Slot=document.createElement("div");
			var Tile=document.createElement("img");
			var Entity=document.createElement("div");
			var EntityCore=document.createElement("img");
			var EntityMesh=document.createElement("img");
			var Structure=document.createElement("img");
			var Marker=document.createElement("img");
			var Canceler=document.createElement("img");
			var Flag=document.createElement("img");
			var Badge=document.createElement("img");
			var Cargo=document.createElement("img");
			var HealthBar=document.createElement("img");
			var HealthBarContainer=document.createElement("img");
			var EdgeA=document.createElement("img");
			var EdgeB=document.createElement("img");
			var EdgeC=document.createElement("img");
			var EdgeD=document.createElement("img");
			var BLARG=document.createElement("img");

			Slot.id="Slot "+i+"X"+j;
			Tile.id="Tile "+i+"X"+j;
			Entity.id="Entity "+i+"X"+j;
			EntityCore.id="EntityCore "+i+"X"+j;
			EntityMesh.id="EntityMesh "+i+"X"+j;
			Structure.id="Structure "+i+"X"+j;
			Marker.id="Marker "+i+"X"+j;
			Canceler.id="Canceler "+i+"X"+j;
			Flag.id="Flag "+i+"X"+j;
			Badge.id="Badge "+i+"X"+j;
			Cargo.id="Cargo "+i+"X"+j;
			HealthBar.id="HPBar "+i+"X"+j;
			HealthBarContainer.id="HPContainer "+i+"X"+j;
			EdgeA.id="A "+i+"X"+j;
			EdgeB.id="B "+i+"X"+j;
			EdgeC.id="C "+i+"X"+j;
			EdgeD.id="D "+i+"X"+j;
			BLARG.id="BLARG "+i+"X"+j;
			Slot.style.position="absolute";
			Slot.style.top=(i-1)*56+"px";
			Slot.style.left=(j-1)*56+"px";
			Slot.style.width="56px";
			Slot.style.height="56px";
			Slot.style.cursor="url('Assets/Miscellaneous/Cursor.png') 0 0, auto";
			//Slot.style.zIndex=1;
			Tile.style.zIndex=3;
			Entity.style.zIndex=5;
			EntityCore.style.zIndex=3;
			EntityMesh.style.zIndex=3;
			Structure.style.zIndex=4;
			Marker.style.zIndex=5;
			Canceler.style.zIndex=5;
			Flag.style.zIndex=3;
			Badge.style.zIndex=5;
			Cargo.style.zIndex=5;
			HealthBar.style.zIndex=5;
			HealthBarContainer.style.zIndex=5;
			EdgeA.style.zIndex=3;
			EdgeB.style.zIndex=3;
			EdgeC.style.zIndex=3;
			EdgeD.style.zIndex=3;
			BLARG.style.zIndex=5;
			Tile.style.position="absolute";
			Entity.style.position="absolute";
			EntityCore.style.position="absolute";
			EntityMesh.style.position="absolute";
			Structure.style.position="absolute";
			Marker.style.position="absolute";
			Canceler.style.position="absolute";
			Flag.style.position="absolute";
			Badge.style.position="absolute";
			Cargo.style.position="absolute";
			HealthBar.style.position="absolute";
			HealthBarContainer.style.position="absolute";
			EdgeA.style.position="absolute";
			EdgeB.style.position="absolute";
			EdgeC.style.position="absolute";
			EdgeD.style.position="absolute";
			BLARG.style.position="absolute";
			Entity.style.visibility="hidden";
			EntityCore.style.visibility="inherit";
			EntityMesh.style.visibility="inherit";
			Marker.style.visibility="hidden";
			Canceler.style.visibility="hidden";
			Badge.style.visibility="hidden";
			Cargo.style.visibility="hidden";
			HealthBar.style.visibility="hidden";
			HealthBarContainer.style.visibility="hidden";
			EdgeA.style.visibility="hidden";
			EdgeB.style.visibility="hidden";
			EdgeC.style.visibility="hidden";
			EdgeD.style.visibility="hidden";
			Badge.src="Assets/Traits/Morale0.PNG";
			HealthBar.src="Assets/Miscellaneous/HealthBarFiller.png";
			HealthBarContainer.src="Assets/Miscellaneous/HealthBarFrame.png";
			EdgeA.src="Assets/Tiles/EdgeA.PNG";
			EdgeB.src="Assets/Tiles/EdgeB.PNG";
			EdgeC.src="Assets/Tiles/EdgeC.PNG";
			EdgeD.src="Assets/Tiles/EdgeD.PNG";
			Entity.style.left="0px";
			EntityCore.style.left="0px";
			EntityMesh.style.left="0px";
			Entity.style.filter="opacity(100%)";
			Structure.style.left="0px";
			Canceler.style.left="8px";
			Flag.style.left="0px";
			Badge.style.left="18px";
			Cargo.style.left="14px";
			HealthBar.style.left="8px";
			HealthBarContainer.style.left="8px";
			EdgeA.style.left="0px";
			EdgeB.style.left="39px";
			EdgeC.style.left="0px";
			EdgeD.style.left="42px";
			Entity.style.top="0px";
			EntityCore.style.top="0px";
			EntityMesh.style.top="0px";
			Structure.style.top="0px";
			Canceler.style.top="8px";
			Flag.style.top="0px";
			Badge.style.top="-10px";
			Cargo.style.top="14px";
			Cargo.style.width="28px";
			Cargo.style.height="28px";
			HealthBar.style.top="42px";
			HealthBarContainer.style.top="42px";
			EdgeA.style.top="0px";
			EdgeB.style.top="0px";
			EdgeC.style.top="49px";
			EdgeD.style.top="51px";
			Marker.src="Assets/Miscellaneous/Marker.PNG";
			Canceler.src="Assets/Miscellaneous/SelectionCanceller.PNG";

			Slot.addEventListener("click", function(){
				document.getElementById("SpecialActionPanel").style.visibility="hidden";

			});

			Slot.addEventListener("contextmenu", function(){
				let index=Map[i-1][j-1];
				let owner=0;
				
				//alert(ControlMap);
				if(ControlMap!=0){owner=ControlMap[i-1][j-1];}else{owner=0};
				
				let entity=rostermap[i-1][j-1];
				let isWarmachine=false;
				if(entity!=0){BizzareMoneyPointer=Math.round(Units[rostermap[i-1][j-1].unitType].Cost/2)};
				if(entity.faction==PlayerChoiceFaction && hasCertainTrait(entity.unitType,"Tank Pooper")){isWarmachine=true;index=10};

				if((index<10 || index>12 || owner!=PlayerChoiceFaction)&&!isWarmachine){LaunchSpecialOptionPanel(i-1,j-1)}else{ActiveIndustrialNode={X:i-1,Y:j-1};
				LaunchRecruitmentPanel(index-9);};
				
			});

			Tile.addEventListener("click", function(){
				//alert("{id:2, faction:5, direction:1, x:"+(i-1) + ", y:" + (j-1)+", morale:0, hpModifier:0},");
								AnalyseSquare('Tile',i-1,j-1)});

			Entity.addEventListener("mouseover", function(){ToggleHealthBar(i,j); ToggleMoraleBadge(i,j)});
			Entity.addEventListener("mouseout", function(){document.getElementById("HPContainer "+i+"X"+j).style.visibility="hidden";document.getElementById("HPBar "+i+"X"+j).style.visibility="hidden";document.getElementById("Badge "+i+"X"+j).style.visibility='hidden'; document.getElementById("Cargo "+i+"X"+j).style.visibility='hidden';});			
			Entity.addEventListener("click", function(){AnalyseSquare('Unit',i-1,j-1)});
			Structure.addEventListener("click", function(){AnalyseSquare('Tile',i-1,j-1)});
			Marker.addEventListener("click", function(){if(!isAITurn){

				if(ChosenUnit.definite){RemoveKebabIMeanBlep();
				document.getElementById("Marker "+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="visible";
				document.getElementById("Canceler "+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="hidden";
				};
				
				AnalyseSquare('Unit',i-1,j-1);
				//alert((i+StandardX-1)+" "+(j+StandardY-1));
				document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
				document.getElementById("Canceler "+i+"X"+j).style.visibility="visible";
				ChosenUnit={ics:i,igrec:j,definite:true};
				if(rostermap[i-1+StandardX][j-1+StandardY].isCloaked??false){ChosenUnit.isCloaked=true}else{ChosenUnit.isCloaked=false};
				PI_Scouter(rostermap[i+StandardX-1][j+StandardY-1],Map);
			}});
			Marker.addEventListener("mouseover", function(){ToggleHealthBar(i,j); ToggleMoraleBadge(i,j)});
			Marker.addEventListener("mouseout", function(){document.getElementById("HPContainer "+i+"X"+j).style.visibility="hidden";document.getElementById("HPBar "+i+"X"+j).style.visibility="hidden";document.getElementById("Badge "+i+"X"+j).style.visibility='hidden'; document.getElementById("Cargo "+i+"X"+j).style.visibility='hidden'});
			Canceler.addEventListener("click", function(){
			document.getElementById("Marker "+i+"X"+j).style.visibility="visible";
			document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
			RemoveKebabIMeanBlep();
			});


			Flag.addEventListener("click", function(){AnalyseSquare("Tile",i-1,j-1)});


			BLARG.addEventListener("mouseover",function(){
				let Blargcheck=true;
				//if(false){Blargcheck=false}
				if(Blargcheck){WBLARG(i,j)};

			});

			BLARG.addEventListener("click",function (){
				ChosenUnit.definite=false;

				document.getElementById('Canceler '+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="hidden";
				//console.log(BLARG.length);
				let canAttack=false;
				if(rostermap[i+StandardX-1][j+StandardY-1]!=0){canAttack=true;
				if(Factions[rostermap[i+StandardX-1][j+StandardY-1].faction].faction==Factions[PlayerChoiceFaction].faction){canAttack=false};};
				

				MoveUnit(rostermap[ChosenUnit.ics-1+StandardX][ChosenUnit.igrec-1+StandardY].index , [i,j]);
				if(canAttack){document.getElementById("Ctep-"+(i-1)+"-"+(j-1)).click()};


				RemoveKebabIMeanBlep();
				//alert(rostermap[i+StandardX-1][j+StandardY-1].life);
				//if(rostermap[i+StandardX-1][j+StandardY-1]!=0){alert(i+" X "+j)};
			})

			document.getElementById("UnitMap").appendChild(Slot);
			document.getElementById(Slot.id).appendChild(Tile);
			document.getElementById(Slot.id).appendChild(Structure);
			document.getElementById(Slot.id).appendChild(Entity);
			document.getElementById(Entity.id).appendChild(EntityCore);
			document.getElementById(Entity.id).appendChild(EntityMesh);
			document.getElementById(Slot.id).appendChild(Marker);
			document.getElementById(Slot.id).appendChild(Canceler)
			document.getElementById(Slot.id).appendChild(Flag);
			document.getElementById(Slot.id).appendChild(Badge);
			document.getElementById(Slot.id).appendChild(Cargo);
			document.getElementById(Slot.id).appendChild(HealthBar);
			document.getElementById(Slot.id).appendChild(HealthBarContainer);
			document.getElementById(Slot.id).appendChild(EdgeA);
			document.getElementById(Slot.id).appendChild(EdgeB);
			document.getElementById(Slot.id).appendChild(EdgeC);
			document.getElementById(Slot.id).appendChild(EdgeD);
			document.getElementById(Slot.id).appendChild(BLARG);


			var RegionTile=document.createElement("div");
			var RegionColor=document.createElement("div");
			var RegionNexus=document.createElement("img");
			var RegionName=document.createElement("p");
			var RegionCapital=document.createElement("p");
			var BorderN=document.createElement("img");
			var BorderE=document.createElement("img");
			var BorderS=document.createElement("img");
			var BorderW=document.createElement("img");

			RegionTile.id="Regional Tile "+j+" "+i;
			RegionTile.style.position="absolute";
			RegionTile.style.zIndex=7;
			RegionTile.style.left=j*56-56+"px";
			RegionTile.style.top=i*56-56+"px";
			RegionTile.style.height="56px";
			RegionTile.style.width="56px";
			RegionTile.style.textAlign="center";

			RegionColor.id="Regional Color "+j+" "+i;
			RegionColor.style.position="absolute";
			RegionColor.style.height="56px";
			RegionColor.style.width="56px";
			RegionColor.style.top="0px";
			RegionColor.style.filter="opacity(35%)";

			RegionNexus.id="Regional Nexus "+j+" "+i;
			RegionNexus.style.position="absolute";
			RegionNexus.src="Assets/Miscellaneous/Region.PNG";
			RegionNexus.style.left="-4px";
			RegionNexus.style.top="-7px";
			RegionNexus.style.visibility="hidden";

			RegionName.id="Regional Name "+j+" "+i;
			RegionName.style.position="absolute";
			RegionName.style.visibility="hidden";
			RegionName.style.fontSize="10px";
			RegionName.style.color="red";
			RegionName.style.width="56px";
			RegionName.style.top="5px";
			RegionName.innerHTML="Name";

			RegionCapital.id="Regional Capital "+j+" "+i;
			RegionCapital.style.position="absolute";
			RegionCapital.style.visibility="hidden";
			RegionCapital.style.fontSize="10px";
			RegionCapital.style.color="red";
			RegionCapital.style.width="56px";
			RegionCapital.style.top="20px";
			RegionCapital.innerHTML="Capital";
			

			BorderN.src="Assets/Miscellaneous/RegionBorderN.PNG";
			BorderE.src="Assets/Miscellaneous/RegionBorderE.PNG";
			BorderS.src="Assets/Miscellaneous/RegionBorderS.PNG";
			BorderW.src="Assets/Miscellaneous/RegionBorderW.PNG";

			BorderN.id="NBorder "+j+"X"+i;
			BorderE.id="EBorder "+j+"X"+i;
			BorderS.id="SBorder "+j+"X"+i;
			BorderW.id="WBorder "+j+"X"+i;

			BorderN.style.position="absolute";
			BorderE.style.position="absolute";
			BorderS.style.position="absolute";
			BorderW.style.position="absolute";

			BorderN.style.left="0px";
			BorderE.style.left="0px";
			BorderS.style.left="0px";
			BorderW.style.left="0px";

			document.getElementById("RegionMap").appendChild(RegionTile);
			document.getElementById(RegionTile.id).appendChild(RegionColor);
			document.getElementById(RegionTile.id).appendChild(RegionNexus);
			document.getElementById(RegionTile.id).appendChild(RegionName);
			document.getElementById(RegionTile.id).appendChild(RegionCapital);
			document.getElementById(RegionTile.id).appendChild(BorderN);
			document.getElementById(RegionTile.id).appendChild(BorderE);
			document.getElementById(RegionTile.id).appendChild(BorderS);
			document.getElementById(RegionTile.id).appendChild(BorderW);








			};};};
function castMapMaker(){
	Factions=GenericFactions;
	document.getElementById("EditorMap").style.visibility="visible";
	document.getElementById("MapMold").style.visibility="hidden";
	document.getElementById("Main Menu").style.visibility="hidden";
	x=parseInt(document.getElementById("heigthinput").value);
	if(x>100){x=100};
	y=parseInt(document.getElementById("widthinput").value);
	if(y>100){y=100};
	x=Math.max(x,10);
	y=Math.max(y,10);

	document.getElementById("EditorWiPointer").innerHTML=y;
	document.getElementById("EditorHePointer").innerHTML=x;
	document.getElementById("TileContainer").style.height="560px";
	document.getElementById("TileContainer").style.width="560px";

	TerrainLedger=0;
	TerrainLedger_Biomes=[];
	TerrainLedger_LandFeatures=[];
	TerrainLedger_UrbanFeatures=[];
	TerrainLedger_WaterFeatures=[];
	TerrainLedger_Structures=[];
	TerrainLedger_Connectors=[];
	TerrainLedger_Other=[];

	for(let t=1; t<Terrain.length; t++){
		if(Terrain[t].BiomeIndex??false){TerrainLedger_Biomes[TerrainLedger_Biomes.length]=t};
		if(Terrain[t].Class=="LF" && Terrain[t].Urbanistics==0 && !(Terrain[t].BiomeIndex??false)){TerrainLedger_LandFeatures[TerrainLedger_LandFeatures.length]=t};
		if(Terrain[t].Urbanistics>0 && Terrain[t].Class!="S" && Terrain[t].Class!="MC" && Terrain[t].Class!="LA" && Terrain[t].Class!="WS"){TerrainLedger_UrbanFeatures[TerrainLedger_UrbanFeatures.length]=t};
		if(Terrain[t].Class=="WF" || Terrain[t].Class=="WE"){TerrainLedger_WaterFeatures[TerrainLedger_WaterFeatures.length]=t};
		if(Terrain[t].Class=="S" || Terrain[t].Class=="WS"){TerrainLedger_Structures[TerrainLedger_Structures.length]=t};
		if(Terrain[t].Class=="LA" || Terrain[t].Class=="B" || Terrain[t].Class=="WA" || Terrain[t].Class=="MC"){TerrainLedger_Connectors[TerrainLedger_Connectors.length]=t}
		};

	ToggleTileBlock(1);
		//alert(TerrainLedger)

	//EditorMapHandler
	EditorMap=[];
	EditorEntityMap=[];
	EditorBiomeMap=[];
	EditorControlMap=[];
	EditorRegionMap=[];
	Localization=[];

	TrackFillSwitch=false;

	for(let h=1;h<=10;h++){document.getElementById("EditorColorPicker"+h).style.filter=Factions[h].ChromaCode};

	for(let k=0; k<x; k++){
		for(j=0; j<y; j++){
		if(j==0){EditorMap[k]=[];
			EditorEntityMap[k]=[];
			EditorControlMap[k]=[];
			EditorRegionMap[k]=[]};
		EditorMap[k][j]=1;
		EditorEntityMap[k][j]=0;
		EditorControlMap[k][j]=0
		EditorRegionMap[k][j]=1};};
		//alert(EditorRegionMap);
	EditorRegionMap=JSON.parse(JSON.stringify(EditorRegionMap));
	CapitolNodeRegistry=JSON.parse(JSON.stringify(EditorRegionMap));

	EditorBiomeMap=JSON.parse(JSON.stringify(EditorMap));



	for(let i=0;i<x;i++){
		for(let j=0;j<y;j++){
			//MapMold[i][j]=ChosenTerrain;
			let Slot=document.createElement("div");
			let Tile=document.createElement("img");
			let Entity=document.createElement("div");
			let EntityCore=document.createElement("img");
			let EntityMesh=document.createElement("img");
			let Structure=document.createElement("img");
			let A=document.createElement("img");
			let B=document.createElement("img");
			let C=document.createElement("img");
			let D=document.createElement("img");
			Slot.id="Slot "+(i+1)+" X "+(j+1);
			Tile.id="Tile "+(i+1)+" X "+(j+1);
			Entity.id="Entity "+(i+1)+" X "+(j+1);
			EntityCore.id="EntityCore "+(i+1)+" X "+(j+1);
			EntityMesh.id="EntityMesh "+(i+1)+" X "+(j+1);
			Structure.id="Structure "+(i+1)+" X "+(j+1);
			A.id="a "+(i+1)+" X "+(j+1);
			B.id="b "+(i+1)+" X "+(j+1);
			C.id="c "+(i+1)+" X "+(j+1);
			D.id="d "+(i+1)+" X "+(j+1);
			Slot.style.position="absolute";
			Slot.style.top=i*56+"px";
			Slot.style.left=j*56+"px";
			//Slot.style.zIndex=1;
			Tile.src="Assets/Tiles/Plains.PNG";
			Tile.style.position="absolute";
			Tile.style.zIndex=2;
			//Tile.style.width="56px";
			//Tile.style.height="56px";
			Entity.style.position="absolute";
			Entity.style.zIndex=4;
			EntityCore.style.position="absolute";
			EntityMesh.style.position="absolute";
			Structure.style.position="absolute";
			Structure.style.zIndex=3;
			Structure.style.visibility="hidden";
			Slot.addEventListener("mouseover",function(){if(TrackFillSwitch){RefreshTile(i+1,j+1);FocalEditorRefresh(i+1,j+1)}});
			Slot.addEventListener("click", function(){RefreshTile(i+1,j+1);FocalEditorRefresh(i+1,j+1)});
			Slot.addEventListener("contextmenu", function(){document.getElementById('EditorDetailPanel').style.visibility='inherit'; EditorCustoTileX=i+EditorStandardX; EditorCustoTileY=j+EditorStandardY;});
			A.src="Assets/Tiles/EdgeA.PNG";
			B.src="Assets/Tiles/EdgeB.PNG";
			C.src="Assets/Tiles/EdgeC.PNG";
			D.src="Assets/Tiles/EdgeD.PNG";
			A.style.zIndex=2;
			B.style.zIndex=2;
			C.style.zIndex=2;
			D.style.zIndex=2;
			A.style.visibility="hidden";
			B.style.visibility="hidden";
			C.style.visibility="hidden";
			D.style.visibility="hidden";
			A.style.position="absolute";
			A.style.top="0px";
			A.style.left="0px";
			B.style.position="absolute";
			B.style.top="0px";
			B.style.left="39px";
			C.style.position="absolute";
			C.style.top="49px";
			C.style.left="0px";
			D.style.position="absolute";
			D.style.top="51px";
			D.style.left="43px";
			document.getElementById("TileContainer").appendChild(Slot);
			document.getElementById(Slot.id).appendChild(Tile);
			document.getElementById(Slot.id).appendChild(Entity);
			document.getElementById(Entity.id).appendChild(EntityCore);
			document.getElementById(Entity.id).appendChild(EntityMesh);
			document.getElementById(Slot.id).appendChild(Structure);
			document.getElementById(Slot.id).appendChild(A);
			document.getElementById(Slot.id).appendChild(B);
			document.getElementById(Slot.id).appendChild(C);
			document.getElementById(Slot.id).appendChild(D);

			var regionTile=document.createElement("div");
			var regionColor=document.createElement("div");
			var regionNexus=document.createElement("img");
			var regionName=document.createElement("p");
			var regionCapital=document.createElement("p");
			var borderN=document.createElement("img");
			var borderE=document.createElement("img");
			var borderS=document.createElement("img");
			var borderW=document.createElement("img");

			regionTile.id="regional Tile "+i+" "+j;
			regionTile.style.position="absolute";
			regionTile.style.zIndex=5;
			regionTile.style.left=i*56+"px";
			regionTile.style.top=j*56+"px";
			regionTile.style.height="56px";
			regionTile.style.width="56px";
			regionTile.addEventListener("click",function(){RegionalizeTile(i,j)});
			regionTile.addEventListener("contextmenu",function(){document.getElementById('Backpanel').style.visibility='inherit';
			document.getElementById('RegionNodeX').value=i;
			document.getElementById('RegionNodeY').value=j;

				});

			regionColor.id="regional Color "+i+" "+j;
			regionColor.style.position="absolute";
			regionColor.style.height="56px";
			regionColor.style.width="56px";
			regionColor.style.top="0px";
			regionColor.style.filter="opacity(35%)";
			regionColor.style.background="grey";

			regionNexus.id="regional Nexus "+i+" "+j;
			regionNexus.style.position="absolute";
			regionNexus.style.visibility="hidden";
			regionNexus.style.left="-3px";
			regionNexus.style.top="-4px";
			regionNexus.src="Assets/Miscellaneous/Region.PNG";

			regionName.id="regional Name "+i+" "+j;
			regionName.style.color="beige";
			regionName.style.fontSize="12px";
			regionName.style.textAlign="center";
			regionName.style.visibility="hidden";
			regionName.style.position="absolute";
			regionName.style.width="56px";
			regionName.style.left="0px";
			regionName.style.top="-13px";
			regionName.innerHTML="Region";

			regionCapital.id="regional Capital "+i+" "+j;
			regionCapital.style.color="beige";
			regionCapital.style.fontSize="12px";
			regionCapital.style.textAlign="center";
			regionCapital.style.visibility="hidden";
			regionCapital.style.position="absolute";
			regionCapital.style.width="56px";
			regionCapital.style.left="0px";
			regionCapital.style.top="28px";
			regionCapital.innerHTML="Center";

			borderN.src="Assets/Miscellaneous/RegionBorderN.PNG";
			borderE.src="Assets/Miscellaneous/RegionBorderE.PNG";
			borderS.src="Assets/Miscellaneous/RegionBorderS.PNG";
			borderW.src="Assets/Miscellaneous/RegionBorderW.PNG";
			borderN.id="Nborder "+i+" "+j;
			borderE.id="Eborder "+i+" "+j;
			borderS.id="Sborder "+i+" "+j;
			borderW.id="Wborder "+i+" "+j;
			borderN.style.position="Absolute";
			borderE.style.position="Absolute";
			borderS.style.position="Absolute";
			borderW.style.position="Absolute";
			borderN.style.visibility="hidden";
			borderE.style.visibility="hidden";
			borderS.style.visibility="hidden";
			borderW.style.visibility="hidden";

			document.getElementById("regionMap").appendChild(regionTile);
			document.getElementById(regionTile.id).appendChild(regionColor);
			document.getElementById(regionTile.id).appendChild(regionNexus);
			document.getElementById(regionTile.id).appendChild(regionName);
			document.getElementById(regionTile.id).appendChild(regionCapital);
			document.getElementById(regionTile.id).appendChild(borderN);
			document.getElementById(regionTile.id).appendChild(borderE);
			document.getElementById(regionTile.id).appendChild(borderS);
			document.getElementById(regionTile.id).appendChild(borderW);




		};};
		RefreshMapEditor();};
function CastEntityMap(Map, Roster){
	map=Map;
	var mapWidth=map[0].length;
	var mapHeight=map.length;
	rostermap=[];
	var line=[];
	var index=Roster.length;
	MapRoster=[0];
	for(i=0;i<mapWidth;i++){line[i]=0;};
		line=JSON.parse(JSON.stringify(line));
	for(j=0;j<mapHeight;j++){rostermap[j]=line};
		rostermap=JSON.parse(JSON.stringify(rostermap));

	//alert(rostermap.length);
	for(var k=1; k<index; k++){
		//alert(Roster[k].hpModifier);
		unit={name: Language.UnitSpecialNames[Roster[k].SpecialName] ?? Language.UnitNames[Roster[k].id],
			description: Language.UnitSpecialDesc[Roster[k].SpecialDescription] ?? Language.UnitDesc[Roster[k].id],
			ID:"Unit "+k,
			index:k,
			x:Roster[k].x, 
			y:Roster[k].y, 
			unitType:Roster[k].id,
			faction:Roster[k].faction,
			coallition:Factions[Roster[k].faction].faction, 
			damage:Units[Roster[k].id].Attack, 	
			damageType:Units[Roster[k].id].Weapon,
			minR:Units[Roster[k].id].MinRange,
			maxR:Units[Roster[k].id].MaxRange, 
			life:Math.round(Units[Roster[k].id].HP*(1+Roster[k].hpModifier)), 
			armor:Units[Roster[k].id].Armor, 
			speed:Units[Roster[k].id].Speed, 
			movementType:Units[Roster[k].id].Movement, 
			morale:Roster[k].morale,
			direction:Roster[k].direction,
			cargo:Roster[k].cargo??0,
			isCloaked:rostermap[Roster[k].x][Roster[k].y].isCloaked??false,
			hasSpecialName:Roster[k].SpecialName??0,
			hasSpecialDesc:Roster[k].SpecialDescription??0,
			hasCustomName:Roster[k].CustomName??0,
			hasCustomDesc:Roster[k].CustomDescription??0
		};
		unit.name=Roster[k].CustomName??unit.name;
		unit.description=Roster[k].CustomDescription??unit.description;
		//alert(unit.faction);
		
	let Stealth=Cloak(Roster[k].x,Roster[k].y,Roster[k].id,Factions[Roster[k].faction].faction);
	unit.isCloaked=Stealth;
	


	rostermap[Roster[k].x][Roster[k].y]=unit;	
	MapRoster[k]=unit;
	let ics=Roster[k].x;
	let igrec=Roster[k].y;
	//if(ics>=StandardX && ics<StandardX+10 && igrec>=StandardY && igrec <StandardY+10){
	if(true){
	document.getElementById("EntityCore "+(ics+1)+"X"+(igrec+1)).style.visibility="inherit";
	document.getElementById("Entity "+(ics+1)+"X"+(igrec+1)).style.top=(Units[MapRoster[k].unitType].StaticOffsetY ?? [0,0,0,0,0])[MapRoster[k].direction] + "px";
	document.getElementById("Entity "+(ics+1)+"X"+(igrec+1)).style.left=(Units[MapRoster[k].unitType].StaticOffsetX ?? [0,0,0,0,0])[MapRoster[k].direction] + "px";
	document.getElementById("EntityCore "+(ics+1)+"X"+(igrec+1)).src="Assets/Units/Static/"+Units[MapRoster[k].unitType].shortname+MapRoster[k].direction+".PNG";

	if(!Units[MapRoster[k].unitType].MLPR??false){
	document.getElementById("EntityMesh "+(ics+1)+"X"+(igrec+1)).style.visibility="inherit";
	document.getElementById("EntityMesh "+(ics+1)+"X"+(igrec+1)).src="Assets/Units/StaticMeshes/"+Units[MapRoster[k].unitType].shortname+"Mesh"+MapRoster[k].direction+".PNG";
	};
	//alert(Factions);
	let Filter=Factions[MapRoster[k].faction].ChromaCode;


	//alert(rostermap[unit.x][unit.y].isCloaked);
	if(rostermap[unit.x][unit.y].isCloaked??false){document.getElementById("Entity "+(ics+1)+"X"+(igrec+1)).style.filter="opacity(0%)"};
	document.getElementById("EntityCore "+(ics+1)+"X"+(igrec+1)).style.filter=Filter;};

	//drawUnit(Map, Roster[k].id, Roster[k].direction, Roster[k].x, Roster[k].y, k, rostermap);
	//alert(MapRoster[k].x+" "+MapRoster[k].y);
	//for(let i=0; i<0+10; i++){for(let j=0; j<0+10; j++){}};
	};};
function CaptureProperty(ControlMap,Faction){
	for(let X=0;X<ControlMap.length;X++){for(let Y=0;Y<ControlMap[0].length;Y++){
		if(rostermap[X][Y]!=0 && rostermap[X][Y].life>0 && hasCertainTrait(rostermap[X][Y].unitType,"Conqueror") && rostermap[X][Y].coallition!=Factions[ControlMap[X][Y]].faction){ControlMap[X][Y]=Faction;FocalTileRefresh(X,Y)};

		//FocalTileRefresh(X,Y);
		}};
	};
function CBLARG(r,t){

					let CLARG=JSON.parse(JSON.stringify(BLARG));
					let NeoPath=[];
					let Differential=Math.abs(BLARG[BLARG.length-1].X-r)+Math.abs(BLARG[BLARG.length-1].Y-t);
					//if(Differential>0){console.log(Differential)};
					//This bloc fixes ctep-ctep disjunctions
					if(Differential==1){NeoPath=AddressMap[BLARG[BLARG.length-1].X][BLARG[BLARG.length-1].Y]};
					if(Differential>1){
					let AdjacArray=[];
					let Paradjac=[];
					let N=document.getElementById("Blep-"+(r-1)+"-"+t)??0;
					//console.log(rostermap[r-1][t]);
					//console.log(AddressMap[r-1][t])
					if((N!=0 && r>0 && rostermap[r-1][t]==0) || (r-1==ChosenUnit.ics-1 && t==ChosenUnit.igrec-1)){AdjacArray[AdjacArray.length]="N";Paradjac[Paradjac.length]=AddressMap[r-1][t].length??0};
					let S=document.getElementById("Blep-"+(r+1)+"-"+t)??0;
					if((S!=0 && r<Map.length-1 && rostermap[r+1][t]==0) || (r+1==ChosenUnit.ics-1 && t==ChosenUnit.igrec-1)){AdjacArray[AdjacArray.length]="S";Paradjac[Paradjac.length]=AddressMap[r+1][t].length??0};
					let E=document.getElementById("Blep-"+r+"-"+(t+1))??0;
					if((E!=0 && r<Map[0].length-1 && rostermap[r][t+1]==0) || (r==ChosenUnit.ics-1 && t+1==ChosenUnit.igrec-1)){AdjacArray[AdjacArray.length]="E";Paradjac[Paradjac.length]=AddressMap[r][t+1].length??0};
					let W=document.getElementById("Blep-"+r+"-"+(t-1))??0;
					if((W!=0 && t>0 && rostermap[r][t-1]==0) || (r==ChosenUnit.ics-1 && t-1==ChosenUnit.igrec-1)){AdjacArray[AdjacArray.length]="W";Paradjac[Paradjac.length]=AddressMap[r][t-1].length??0};
					let BestPath=0;
					let SelectedAdjac=0;
					if(AdjacArray.length>0){
					for(let j=0;j<Paradjac.length;j++){if(Paradjac[j]<Paradjac[BestPath]){BestPath=j}};
					SelectedAdjac=AdjacArray[BestPath]};
					//console.log(SelectedAdjac);
					
					let clac= new Event('mouseover');
					//SelectedAdjac=0;
					//let pip=AddressMap[r-1][t]??[0,0];
					//console.log(r+" "+t+" "+BLARG);

					if(SelectedAdjac=="N"){
						//let container=document.getElementById("Blep-"+(r-1)+"-"+t);
						//let altcontainer=document.getElementById("Ctep-"+r+"-"+t);
						//let paracontainter=document.getElementById("BLARG "+(r-1)+"X"+t);
						//container.dispatchEvent(clac);
						//paracontainter.dispatchEvent(clac);
						NeoPath=AddressMap[r-1][t];
						};
					if(SelectedAdjac=="S"){
						//let container=document.getElementById("Blep-"+(r+1)+"-"+t);
						//let altcontainer=document.getElementById("Ctep-"+r+"-"+t);
						//let paracontainter=document.getElementById("BLARG "+(r+1)+"X"+t);
						//container.dispatchEvent(clac);
						//altcontainer.dispatchEvent(clac);
						//paracontainter.dispatchEvent(clac);
						//BLARG[BLARG.length]={X:r+1,Y:t};
						//BLARG.pop();
						NeoPath=AddressMap[r+1][t];
						};
					if(SelectedAdjac=="E"){
						//let container=document.getElementById("Blep-"+r+"-"+(t+1));
						//let altcontainer=document.getElementById("Ctep-"+r+"-"+t);
						//let paracontainter=document.getElementById("BLARG "+r+"X"+(t+1));
						//container.dispatchEvent(clac);
						//paracontainter.dispatchEvent(clac);
						NeoPath=AddressMap[r][t+1];
						};
						
					if(SelectedAdjac=="W"){
						//let container=document.getElementById("Blep-"+r+"-"+(t-1));
						//let altcontainer=document.getElementById("Ctep-"+r+"-"+t);
						//let paracontainter=document.getElementById("BLARG "+r+"X"+(t-1));
						//container.dispatchEvent(clac);
						//paracontainter.dispatchEvent(clac);
						NeoPath=AddressMap[r][t-1];
					};
					//console.log(SelectedAdjac+" "+r+t);
					//console.log(AdjacArray);
					};

					

					//console.log(BLARG[BLARG.length-1].X+""+BLARG[BLARG.length-1].Y+" "+r+t+" "+dir);


					
					//alert(xdif+" "+ydif);


					
					//if(dir+or==3){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/ElbowB.PNG"};
					//if(dir+or==7){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/ElbowC.PNG"};
					//if(dir+or==5 && (dir-or==1 || or-dir==1)){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/ElbowA.PNG"};
					//if(dir+or==5 && (dir-or==3 || or-dir==3)){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/ElbowD.PNG"};


					//Wipes the BLARG path and repaths the arrow
					let BX=ChosenUnit.ics;
					let BY=ChosenUnit.igrec;
					let ParaPath=[{X:ChosenUnit.ics,Y:ChosenUnit.igrec}];
					for(let B=1; B<BLARG.length; B++){document.getElementById("BLARG "+(BLARG[B].X+1)+"X"+(BLARG[B].Y+1)).src="Assets/Miscellaneous/Nothing.PNG"};

					for(let BL=0; BL<NeoPath.length-1; BL++){

						if(NeoPath[BL]==1){BX--;ParaPath[ParaPath.length]={X:JSON.parse(JSON.stringify(BX)),Y:JSON.parse(JSON.stringify(BY))}};
						if(NeoPath[BL]==2){BY++;ParaPath[ParaPath.length]={X:JSON.parse(JSON.stringify(BX)),Y:JSON.parse(JSON.stringify(BY))}};
						if(NeoPath[BL]==3){BX++;ParaPath[ParaPath.length]={X:JSON.parse(JSON.stringify(BX)),Y:JSON.parse(JSON.stringify(BY))}};
						if(NeoPath[BL]==4){BY--;ParaPath[ParaPath.length]={X:JSON.parse(JSON.stringify(BX)),Y:JSON.parse(JSON.stringify(BY))}};



						//document.getElementById("BLARG "+(ParaPath[BL].X)+"X"+(ParaPath[BL].Y)).src="Assets/Miscellaneous/Nothing.PNG";


						//if(Case==0){document.getElementById('BLARG '+(ParaPath[BL].X)+"X"+(ParaPath[BL].Y)).src="Assets/BLARG/StreakH.PNG";}
						//else{document.getElementById('BLARG '+(ParaPath[BL].X)+"X"+(ParaPath[BL].Y)).src="Assets/BLARG/Elbow"+Case+".PNG"};


							};

						
						

					

					//Builds the new arrow | body section
					if(true){for(let q=1; q<ParaPath.length; q++){

						let or=0;
						let dir=0;
						let Case=0;
						if(q>0){
						if(ParaPath[q].X<ParaPath[q-1].X){or=1};
						if(ParaPath[q].Y<ParaPath[q-1].Y){or=4};
						if(ParaPath[q].X>ParaPath[q-1].X){or=3};
						if(ParaPath[q].Y>ParaPath[q-1].Y){or=2};};
						//if(dir==0){BLARG.pop()};
						//if(q==1){document.getElementById('BLARG '+(ChosenUnit.X+1)+"X"+(ChosenUnit.Y+1)).src="Assets/Emission/"+or+".PNG"};

						if(q<ParaPath.length-1){
						if(ParaPath[q+1].X>ParaPath[q].X){dir=3};
						if(ParaPath[q+1].Y<ParaPath[q].Y){dir=4};
						if(ParaPath[q+1].X<ParaPath[q].X){dir=1};
						if(ParaPath[q+1].Y>ParaPath[q].Y){dir=2};};

						if(q==ParaPath.length-1){
						if(r+1>ParaPath[q].X){dir=3};
						if(t+1<ParaPath[q].Y){dir=4};
						if(r+1<ParaPath[q].X){dir=1};
						if(t+1>ParaPath[q].Y){dir=2};};

						if(or==1&&dir==2){Case="B"};
						if(or==1&&dir==4){Case="C"};
						if(or==2&&dir==1){Case="D"};
						if(or==2&&dir==3){Case="C"};
						if(or==3&&dir==2){Case="A"};
						if(or==3&&dir==4){Case="D"};
						if(or==4&&dir==1){Case="A"};
						if(or==4&&dir==3){Case="B"};

						//let Message="";for(let i=0; i<ParaPath.length;i++){Message+=ParaPath[i].X; Message+="|";Message+=ParaPath[i].Y;Message+=" "};console.log(Message+" "+or+" "+dir+" "+Case);
						//console.log();
						//console.log(ParaPath[q].X+""+ParaPath[q].Y+" "+ParaPath[q-1].X+""+ParaPath[q-1].Y+" "+or);


						if(Case!=0){
							document.getElementById('BLARG '+(ParaPath[q].X)+"X"+(ParaPath[q].Y)).src="Assets/BLARG/Elbow"+Case+".PNG";


						};
						if(Case==0 && or%2==1){document.getElementById('BLARG '+(ParaPath[q].X)+"X"+(ParaPath[q].Y)).src="Assets/BLARG/StreakV.PNG";};
						if(Case==0 && or%2==0){document.getElementById('BLARG '+(ParaPath[q].X)+"X"+(ParaPath[q].Y)).src="Assets/BLARG/StreakH.PNG";};



					}};

					BLARG=[];for(let z=0;z<ParaPath.length;z++){BLARG[BLARG.length]={X:ParaPath[z].X-1,Y:ParaPath[z].Y-1}};

					//Builds the new arrow | head section
					let or=0;
					let dir=0;
					let Case=0;
					if(BLARG[BLARG.length-1].X>r){dir=1};
					if(BLARG[BLARG.length-1].Y<t){dir=2};
					if(BLARG[BLARG.length-1].X<r){dir=3};
					if(BLARG[BLARG.length-1].Y>t){dir=4};
					if(dir==0){BLARG.pop()};

					if(BLARG.length>1){
					if(BLARG[BLARG.length-2].X>BLARG[BLARG.length-1].X){or=1};
					if(BLARG[BLARG.length-2].Y<BLARG[BLARG.length-1].Y){or=2};
					if(BLARG[BLARG.length-2].X<BLARG[BLARG.length-1].X){or=3};
					if(BLARG[BLARG.length-2].Y>BLARG[BLARG.length-1].Y){or=4};};
					
					let canBlarg=false;
					let xdif=Math.abs(r-BLARG[BLARG.length-1].X);
					let ydif=Math.abs(t-BLARG[BLARG.length-1].Y);
					if(xdif+ydif==1){canBlarg=true};
					if(canBlarg){document.getElementById("Ctep-"+r+"-"+t).src="Assets/BLARG/Ctep"+dir+".PNG"};

					//Builds the new arrow | tail section
					//alert("Ctep-"+(ChosenUnit.ics)+"-"+(ChosenUnit.igrec));
					if(BLARG.length>1){
					if(ChosenUnit.ics-1>BLARG[1].X){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission1.PNG"};
					if(ChosenUnit.igrec-1<BLARG[1].Y){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission2.PNG"};
					if(ChosenUnit.ics-1<BLARG[1].X){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission3.PNG"};
					if(ChosenUnit.igrec-1>BLARG[1].Y){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission4.PNG"}};
					if(BLARG.length==1){
					if(ChosenUnit.ics-1>r){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission1.PNG"};
					if(ChosenUnit.igrec-1<t){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission2.PNG"};
					if(ChosenUnit.ics-1<r){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission3.PNG"};
					if(ChosenUnit.igrec-1>t){document.getElementById("BLARG "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).src="Assets/BLARG/Emission4.PNG"}};
					



					//console.log(ChosenUnit.ics+""+ChosenUnit.igrec+" "+BLARG[1].X+BLARG[1].Y);

					//Handles the end-tile and second-last tile
					/*
					if(or==1&&dir==2){Case="B"};
					if(or==1&&dir==4){Case="C"};
					if(or==2&&dir==1){Case="D"};
					if(or==2&&dir==3){Case="C"};
					if(or==3&&dir==2){Case="A"};
					if(or==3&&dir==4){Case="D"};
					if(or==4&&dir==1){Case="A"};
					if(or==4&&dir==3){Case="B"};*/

					//alert(dir+" "+or+"     "+dir%2+" "+or%2);
					//if((dir%2==0)&&(or%2==0)){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/StreakH.PNG"}
					//else if((dir%2==1)&&(or%2==1)){document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/StreakV.PNG"}
					//else{document.getElementById('BLARG '+(BLARG[BLARG.length-1].X)+"X"+(BLARG[BLARG.length-1].Y)).src="Assets/BLARG/Elbow"+Case+".PNG"};


					/*}else{document.getElementById('BLARG '+(BLARG[0].X+1)+"X"+(BLARG[0].Y+1)).src="Assets/BLARG/Emission"+dir+".PNG";
					let Xer=BLARG[0].X;
					let Yer=BLARG[0].Y;
					if(dir==1){Xer-=1};
					if(dir==2){Yer+=1};
					if(dir==3){Xer+=1};
					if(dir==4){Yer-=1};
					document.getElementById('Ctep-'+Xer+"-"+Yer).src="Assets/BLARG/Ctep"+dir+".PNG"};*/





		};
function ChooseChapter(Chapter){
	

	let checker=false;
	if(Chapter==1){checker=true};
	if(Chapter>1&&Campaigns[ChosenNation-1][Chapter-2][4].Finished==true){checker=true};
	if(checker){
		ChosenChapter=Chapter;
	document.getElementById('CampaignName').innerHTML=Language.ChapterName[ChosenNation-1][Chapter-1];
	document.getElementById('MissionName').innerHTML=Language.MissionName[ChosenNation-1][Chapter-1][0];
	document.getElementById('MissionDescription').innerHTML=Language.MissionDesc[ChosenNation][Chapter-1][0];
	document.getElementById("Emblem1").src="Assets/Emblems/Emblem"+Factions[ChosenNation].Preffix+".PNG";
	document.getElementById('EmblemSlot').style.left='0px';
	document.getElementById("ChapterIllustration").src="Assets/Paralogues/"+ChosenNation+"-"+ChosenChapter+".JPG";
	ChooseMission(1);
	document.getElementById("ChapterPanelPointer").style.top=(Chapter-1)*33-6+"px";
	for(let i=0;i<=3;i++){
	if(Campaigns[ChosenNation-1][ChosenChapter-1][i].Finished??false){document.getElementById('Emblem'+ (i+2)).src="Assets/Emblems/Emblem"+Factions[ChosenNation].Preffix+".PNG"}
	else{document.getElementById('Emblem'+ (i+2)).src="Assets/Emblems/NONEmblem"+Factions[ChosenNation].Preffix+".PNG"};
	};
	};};
function ChooseMission(Mission){
	let checker=false;
	if(Mission==1){checker=true};
	if(Mission>1){if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-2].Finished==true ?? false){checker=true};};
	if(checker){
		ChosenMission=Mission;
	document.getElementById('MissionName').innerHTML=Language.MissionName[ChosenNation-1][ChosenChapter-1][Mission-1];
	document.getElementById('MissionDescription').innerHTML=Language.MissionDesc[ChosenNation][ChosenChapter-1][Mission-1];
	document.getElementById('EmblemSlot').style.left=(Mission-1)*85+'px';
	//alert(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Funds[1]);
	document.getElementById("SpecificationText").innerHTML=Language.SystemTerms[91];
	if((Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Funds??[0,0])[1]>0){document.getElementById("CampaignSpecification1").style.visibility="inherit"}else{document.getElementById("CampaignSpecification1").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Survival<77777){document.getElementById("CampaignSpecification2").style.visibility="inherit"}else{document.getElementById("CampaignSpecification2").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.TimeLimit<77777){document.getElementById("CampaignSpecification3").style.visibility="inherit"}else{document.getElementById("CampaignSpecification3").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Defend.length>0){document.getElementById("CampaignSpecification4").style.visibility="inherit"}else{document.getElementById("CampaignSpecification4").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Capture.length>0){document.getElementById("CampaignSpecification5").style.visibility="inherit"}else{document.getElementById("CampaignSpecification5").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Protect.length>0){document.getElementById("CampaignSpecification6").style.visibility="inherit"}else{document.getElementById("CampaignSpecification6").style.visibility="hidden"};
	if(Campaigns[ChosenNation-1][ChosenChapter-1][Mission-1].Constants.Defeat.length>0){document.getElementById("CampaignSpecification7").style.visibility="inherit"}else{document.getElementById("CampaignSpecification7").style.visibility="hidden"};

	};};
function ClassTraitDetail(Slot,UnitCase){
	index=0;
	if(UnitCase=='Details'){
		if(Slot=="ArmorType"){indexer=ArmorShowcase; document.getElementById("TraitTooltip").style.left="200px"; document.getElementById("TraitTooltip").style.top="-35px"};
		if(Slot=="DamageType"){indexer=WeaponShowcase; index=3; document.getElementById("TraitTooltip").style.left="280px"; document.getElementById("TraitTooltip").style.top="-35px"};
		if(Slot=="MovementType"){indexer=MovementShowcase; document.getElementById("TraitTooltip").style.left="357px"; document.getElementById("TraitTooltip").style.top="-35px"};
		if(Slot=="Biome"){indexer=BiomeRegistry[LocalBiome].Nominator;if(LocalBiome==1){indexer="Temperate"};document.getElementById("TraitTooltip").style.left="357px"; document.getElementById("TraitTooltip").style.top="-35px"}
		};
	if(UnitCase=='Constructor'){
		ArmorShowcase=HighlightedEntity.Armor;
		WeaponShowcase=HighlightedEntity.Weapon;
		MovementShowcase=HighlightedEntity.Movement;
		if(Slot=="ArmorType"){indexer=ArmorShowcase; document.getElementById("TraitTooltip").style.left="-70px"; document.getElementById("TraitTooltip").style.top="-525px"};
		if(Slot=="DamageType"){indexer=WeaponShowcase; index=3; document.getElementById("TraitTooltip").style.left="0px"; document.getElementById("TraitTooltip").style.top="-525px"};
		if(Slot=="MovementType"){indexer=MovementShowcase; document.getElementById("TraitTooltip").style.left="70px"; document.getElementById("TraitTooltip").style.top="-525px"}
		};
	//alert(indexer);

	switch(indexer){
		case "Light":
		index+=1;
		break;

		case "Medium":
		index+=2;
		break;

		case "Heavy":
		index+=3;
		break;		

		case "None":
		index+=4;
		break;

		case "Stationary":
		index=8;
		break;

		case "Foot":
		index=9;
		break;

		case "Wheeled":
		index=10;
		break;

		case "Tracked":
		index=11;
		break;

		case "Flight":
		index=12;
		break;

		case "Rudder":
		index=13;
		break;

		case "Heavy Rudder":
		index=14;
		break;

		case "Amphibious":
		index=15;
		break;

		case "Temperate":
		index=16;
		break;

		case "Arid":
		index=17;
		break;

		case "Boreal":
		index=18;
		break;

		case "Barren":
		index=19;
		break;

		case "Arctic":
		index=20;
		break;

		case "Lunar":
		index=21;
		break;

		case "Martian":
		index=22;
		break;

		default:
		index=0;
	};
	document.getElementById("TraitTooltip").style.visibility="visible";
	if(Language.ClassTraitDesc[index].length>65){document.getElementById("TraitTooltipImage").src="Assets/Miscellaneous/TraitTooltipPlus.PNG"}else{document.getElementById("TraitTooltipImage").src="Assets/Miscellaneous/TraitTooltip.PNG"};
	document.getElementById("TraitName").innerHTML=Language.ClassTraitName[index];
	document.getElementById("TraitDescription").innerHTML=Language.ClassTraitDesc[index];};
function Cloak(X,Y,type,faction){
		let Stealth=false;
		if(hasCertainTrait(type,"Stealth")){Stealth=true};

		if(X>1){
			if(Factions[rostermap[Math.max(X-1,0)][Y].faction??0].faction!=faction && Factions[rostermap[Math.max(X-1,0)][Y].faction??0].faction!=Factions[0].faction){Stealth=false};
		};
		if(X<Map.length-1){
 			if(Factions[rostermap[X+1][Y].faction??0].faction!=faction && Factions[rostermap[X+1][Y].faction??0].faction!=Factions[0].faction){Stealth=false};
		};
		if(Y>1){
			if(Factions[rostermap[Math.max(X,0)][Math.max(Y-1,0)].faction??0].faction!=faction && Factions[rostermap[Math.max(X,0)][Math.max(Y-1,0)].faction??0].faction!=Factions[0].faction){Stealth=false};
		};
		if(Y<Map[0].length-1){
			if(Factions[rostermap[Math.max(X,0)][Y+1].faction??0].faction!=faction && Factions[rostermap[Math.max(X,0)][Y+1].faction??0].faction!=Factions[0].faction){Stealth=false};
		};

		//alert(Stealth);
		return Stealth;};
function Counterattack(Attacker,Defender){

	let Atk=MapRoster[Attacker];
	let Def=MapRoster[Defender];
	//Map=Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map;
	Map=Map;
	let AttackerTile=Terrain[Map[Atk.x][Atk.y]];
	let DefenderTile=Terrain[Map[Def.x][Def.y]];
	//alert(Def.direction);
	if(Def.direction<2.5){let Dir=Def.direction+2;Atk.direction=Dir}else{let Dir=Def.direction-2;Atk.direction=Dir};
	//alert(Dir);
	
	//alert(Atk.direction);
	if(true){AttackingAnimation(Attacker);};
	HitAnimStyle="Standard";
	if(true){setTimeout(HitAnimation,200,Defender,HitAnimStyle)};

	DamageModifier=Atk.life/Units[Atk.unitType].HP;
	DamageModifier*=(5+Atk.morale)/5;
	if(hasCertainTrait(Atk.unitType,"Indomitable")){DamageModifier=1;};
	let LogisticFactor=BiomeRegistry[BiomeMap[Atk.x][Atk.y]].LogisticIndex;
	DamageModifier*=LogisticFactor;

	if(Atk.damageType==Def.armor&&Atk.damageType!="Medium"){DamageModifier=DamageModifier*1.5;};
	if(Atk.damageType=="Light"&&Def.armor=="Heavy"){DamageModifier=DamageModifier*0.5;};
	if(Atk.damageType=="Heavy"&&Def.armor=="Light"){DamageModifier=DamageModifier*0.5;};

	if(MapRoster[Defender].unitType<9 && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Infantry")){DamageModifier*=3};
	if(MapRoster[Defender].movementType=="Flight" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){DamageModifier*=2};
	if(hasCertainTrait(Atk.unitType,"Anti-Ship") && (Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=3};
	if(MapRoster[Defender].movementType=="Stationary" && hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Structure")){DamageModifier*=2};

	if(hasCertainTrait(Def.unitType,"Steer")&&(Units[Def.unitType].Movement=="Rudder" || Units[Def.unitType].Movement=="Heavy Rudder")){DamageModifier*=1+(Math.max(Math.min(Atk.speed-Def.speed,0),-4)*0.15)};



	DamageModifier=DamageModifier*DefenderTile.protectionFactor;
	if(hasCertainTrait(Atk.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=1.25};
	if(hasCertainTrait(Def.unitType,"Commando")&&DefenderTile.protectionFactor<1){DamageModifier*=0.8};
	let Damage=Math.ceil(Atk.damage*DamageModifier);
	//if(hasCertainTrait(Atk.unitType,"Tank-Hunter") && Def.armor!="Heavy"){Damage-=25};
	if(hasCertainTrait(Def.unitType,"Cemented Steel Armor") && !hasCertainTrait(Atk.unitType,"Cavitation Explosion")){Damage-=20};
	if(MapRoster[Defender].movementType=="Flight" && !hasCertainTrait(MapRoster[Attacker].unitType,"Anti-Air")){Damage=25};
	if(hasCertainTrait(Atk.unitType,"Terrifying")){if(Units[Def.unitType].Cost<1000&&Def.morale>-3){Def.morale-=1}};
	if(hasCertainTrait(Atk.unitType,"Inflaming")){if(Def.morale<3){Def.morale+=1}};
	Damage=Math.max(Damage,0);
	if(hasCertainTrait(Atk.unitType,"Absorber")){let HealIndex=Math.min(Damage,Math.abs(Def.life),Units[Atk.unitType].HP-Atk.life); Atk.life+=HealIndex};
	Def.life-=Damage;
	if(Def.life<=0){setTimeout(UnitLost,1000,Defender);};
	EvaluateDynamicEvent('Action','null');};
function ConvoyPickup(Unit){
	if(IsConvoy){
		let HPIndex=rostermap[Unit.x][Unit.y].life/100;
		let Cargo=rostermap[Unit.x][Unit.y].cargo;
		MapRoster[Unit.index].id=Cargo;
		rostermap[Unit.x][Unit.y].cargo=0;
		rostermap[Unit.x][Unit.y].unitType=Cargo;
		rostermap[Unit.x][Unit.y].life=Math.round(Units[Cargo].HP*HPIndex);
		rostermap[Unit.x][Unit.y].armor=Units[Cargo].Armor;
		rostermap[Unit.x][Unit.y].damage=Units[Cargo].Attack;
		rostermap[Unit.x][Unit.y].damageType=Units[Cargo].Weapon;
		rostermap[Unit.x][Unit.y].minR=Units[Cargo].MinRange;
		rostermap[Unit.x][Unit.y].maxR=Units[Cargo].MaxRange;
		rostermap[Unit.x][Unit.y].speed=Units[Cargo].Speed;
		rostermap[Unit.x][Unit.y].movementType=Units[Cargo].Movement;
		if((MapRoster[Unit.index].CustomName ?? true) || (MapRoster[Unit.index].SpecialName ?? true)){rostermap[Unit.x][Unit.y].name=Language.UnitNames[Cargo];};
		if((MapRoster[Unit.index].CustomDescription ?? true) || (MapRoster[Unit.index].SpecialDescription ?? true)){rostermap[Unit.x][Unit.y].description=Language.UnitDesc[Cargo];};
		document.getElementById("Entity "+(Unit.x+1)+"X"+(Unit.y+1)).src="Assets/Units/Static/"+Units[Cargo].shortname+rostermap[Unit.x][Unit.y].direction+".PNG";
		document.getElementById("Entity "+(Unit.x+1)+"X"+(Unit.y+1)).style.left=(Units[Cargo].StaticOffsetX??[0,0,0,0,0])[rostermap[Unit.x][Unit.y].direction]+"px";
		document.getElementById("Entity "+(Unit.x+1)+"X"+(Unit.y+1)).style.top=(Units[Cargo].StaticOffsetY??[0,0,0,0,0])[rostermap[Unit.x][Unit.y].direction]+"px";

	}else{
		YourMoney-=100;
		//alert(Unit.index);
		//alert(rostermap[Unit.x][Unit.y].HP);
		//alert(HPIndex);
		let HPIndex=rostermap[Unit.x][Unit.y].life/Units[rostermap[Unit.x][Unit.y].unitType].HP;
		
		MapRoster[Unit.index].id=51;
		rostermap[Unit.x][Unit.y].cargo=rostermap[Unit.x][Unit.y].unitType;
		rostermap[Unit.x][Unit.y].unitType=51;
		rostermap[Unit.x][Unit.y].armor="Medium";
		rostermap[Unit.x][Unit.y].life=Math.round(100*HPIndex);
		rostermap[Unit.x][Unit.y].damage=0;
		rostermap[Unit.x][Unit.y].damageType="None";
		rostermap[Unit.x][Unit.y].minR=1;
		rostermap[Unit.x][Unit.y].maxR=1;
		rostermap[Unit.x][Unit.y].speed=5;
		rostermap[Unit.x][Unit.y].movementType="Rudder";
		if((MapRoster[Unit.index].CustomName ?? true) || (MapRoster[Unit.index].SpecialName ?? true)){rostermap[Unit.x][Unit.y].name=Language.UnitNames[51];};
		if((MapRoster[Unit.index].CustomDescription ?? true) || (MapRoster[Unit.index].SpecialDescription ?? true)){rostermap[Unit.x][Unit.y].description=Language.UnitDesc[51];};
		document.getElementById("Entity "+(Unit.x+1)+"X"+(Unit.y+1)).src="Assets/Units/Static/Convoy"+rostermap[Unit.x][Unit.y].direction+".PNG";





	};};	
function CustomizeTile(){
	//alert(EditorCustoTileX+" "+EditorCustoTileY);
	if(EditorEntityMap[EditorCustoTileX][EditorCustoTileY]==0){Localization[Localization.length]={X:EditorCustoTileX+1,Y:EditorCustoTileY+1, name:document.getElementById('EditorNameDenominator').value, description:document.getElementById('EditorDescDenominator').value}};
	if(EditorEntityMap[EditorCustoTileX][EditorCustoTileY]!=0){
		if(document.getElementById('EditorNameDenominator').value!=""){EditorEntityMap[EditorCustoTileX][EditorCustoTileY].CustomName=document.getElementById('EditorNameDenominator').value};
		if(document.getElementById('EditorDescDenominator').value!=""){EditorEntityMap[EditorCustoTileX][EditorCustoTileY].CustomDescription=document.getElementById('EditorDescDenominator').value};
		if(document.getElementById('EditorLifeDenominator').value!=""){EditorEntityMap[EditorCustoTileX][EditorCustoTileY].HPI=JSON.parse(document.getElementById('EditorLifeDenominator').value); EditorEntityMap[EditorCustoTileX][EditorCustoTileY].hpModifier=JSON.parse(document.getElementById('EditorLifeDenominator').value)};
		if(document.getElementById('EditorMoraleDenominator').value!=""){EditorEntityMap[EditorCustoTileX][EditorCustoTileY].morale=JSON.parse(document.getElementById('EditorMoraleDenominator').value)};
	};};
function DisplayLore(Document){
	
	document.getElementById('LoreName').innerHTML=Document.DocName;
	document.getElementById('LoreDesc').innerHTML=Document.DocDesc;
	document.getElementById('LorePanel').innerHTML="";
	for(ll=0;ll<Document.DocText.length;ll++){document.getElementById('LorePanel').innerHTML+=Document.DocText[ll]+"<br><br>";};
	if(Document.LengthIndex==1){document.getElementById('LoreLength').innerHTML="Very Short Document"}
	else if(Document.LengthIndex==2){document.getElementById('LoreLength').innerHTML="Short Document"}
	else if(Document.LengthIndex==3){document.getElementById('LoreLength').innerHTML="Document"}
	else if(Document.LengthIndex==4){document.getElementById('LoreLength').innerHTML="Long Document"}
	else if(Document.LengthIndex==5){document.getElementById('LoreLength').innerHTML="Very Long Document"};
	for(let cx=1;cx<=5;cx++){if(cx<=Document.LengthIndex){document.getElementById("LoreLengthIcon"+cx).src="Assets/Miscellaneous/DocIcon.PNG"}else{document.getElementById("LoreLengthIcon"+cx).src="Assets/Miscellaneous/DocShadow.PNG"}};};
function DisplayRegions(){
	if(FieldMode!="MapEditor" && RegionMap!=[0]&&NodeMap!=[0]){};
	

	if(FieldMode=="MapEditor"){Map=EditorMap;
	RegionMap=[];
	let RegionCell=[];
	NodeMap=[];
	for(let x=0;x<Map[0].length;x++){RegionCell[RegionCell.length]=0};
		for(let y=0;y<Map.length;y++){RegionMap[RegionMap.length]=RegionCell};
		RegionMap=JSON.parse(JSON.stringify(RegionMap));	
	};
	
	

	if(!RegionsToggled){

		if(FieldMode=="Battle"){document.getElementById("RegionMap").style.visibility="visible"}else{document.getElementById("regionMap").style.visibility="visible"};

		


		if(FieldMode!="MapEditor" && RegionMap!=[0] && NodeMap!=[0]){

			for(let i=1;i<Map[0].length;i++){for(let j=1;j<Map.length;j++){
			document.getElementById("NBorder "+i+"X"+j).style.visibility="hidden";
			document.getElementById("EBorder "+i+"X"+j).style.visibility="hidden";
			document.getElementById("SBorder "+i+"X"+j).style.visibility="hidden";	
			document.getElementById("WBorder "+i+"X"+j).style.visibility="hidden";
			}};




			for(let a=0; a<NodeMap.length; a++){
				document.getElementById("Regional Nexus "+(NodeMap[a].CapitolX+1)+" "+(NodeMap[a].CapitolY+1)).style.visibility="inherit";
				document.getElementById("Regional Name "+(NodeMap[a].CapitolX+1)+" "+(NodeMap[a].CapitolY+1)).style.visibility="inherit";
				document.getElementById("Regional Capital "+(NodeMap[a].CapitolX+1)+" "+(NodeMap[a].CapitolY+1)).style.visibility="inherit";
				document.getElementById("Regional Name "+(NodeMap[a].CapitolX+1)+" "+(NodeMap[a].CapitolY+1)).innerHTML=NodeMap[a].Name;
				document.getElementById("Regional Capital "+(NodeMap[a].CapitolX+1)+" "+(NodeMap[a].CapitolY+1)).innerHTML=NodeMap[a].Capitol;

				};


			for(let i=1;i<=Map.length;i++){for(let j=1;j<=Map[0].length;j++){
				X=0;
				for(let k=0;k<NodeMap.length;k++){if(RegionMap[i-1][j-1]==NodeMap[k].Name){X=NodeMap[k].Owner}};
					//alert(j+" "+i);
				document.getElementById("Regional Color "+j+" "+i).style.background=Factions[X].color;
				//document.getElementById("Regional Nexus "+(j-StandardY)+" "+(i-StandardX)).style.visibility="inherit";
				if( RegionMap[Math.max(0,i-2)][j-1]!=RegionMap[i-1][j-1] ){document.getElementById("NBorder "+(j)+"X"+(i)).style.visibility="inherit"}else{document.getElementById("NBorder "+(j)+"X"+(i)).style.visibility="hidden"};
				if( RegionMap[i-1][Math.min(Map.length-1,j)]!=RegionMap[i-1][j-1] ){document.getElementById("EBorder "+(j)+"X"+(i)).style.visibility="inherit"}else{document.getElementById("EBorder "+(j)+"X"+(i)).style.visibility="hidden"};
				if( RegionMap[Math.min(Map[0].length-2,i)][j-1]!=RegionMap[i-1][j-1] ){document.getElementById("SBorder "+(j)+"X"+(i)).style.visibility="inherit"}else{document.getElementById("SBorder "+(j)+"X"+(i)).style.visibility="hidden"};
				if( RegionMap[i-1][Math.max(0,j-2)]!=RegionMap[i-1][j-1] ){document.getElementById("WBorder "+(j)+"X"+(i)).style.visibility="inherit"}else{document.getElementById("WBorder "+(j)+"X"+(i)).style.visibility="hidden"};


			};};



		}else if(FieldMode=="MapEditor"){
			for(let i=1;i<=EditorMap.length;i++){for(let j=1;j<=EditorMap[0].length;j++){
				X=0;
				for(let k=1;k<=CapitolNodeRegistry.length;k++){for(let l=1;l<=CapitolNodeRegistry[0].length;l++){
					if(EditorRegionMap[i-1][j-1]==CapitolNodeRegistry[k-1][l-1].Name){X=CapitolNodeRegistry[k-1][l-1].Owner};
				}};
				
					//alert(X);
					//document.getElementById("regional Tile "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.background=Factions[X].color;
	
				if( EditorRegionMap[Math.max(0,i-2)][j-1]!=EditorRegionMap[i-1][j-1] ){document.getElementById("Nborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="inherit"}else{document.getElementById("Nborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="hidden"};
				if( EditorRegionMap[i-1][Math.min(9,j)]!=EditorRegionMap[i-1][j-1] ){document.getElementById("Eborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="inherit"}else{document.getElementById("Eborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="hidden"};
				if( EditorRegionMap[Math.min(9,i)][j-1]!=EditorRegionMap[i-1][j-1] ){document.getElementById("Sborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="inherit"}else{document.getElementById("Sborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="hidden"};
				if( EditorRegionMap[i-1][Math.max(0,j-2)]!=EditorRegionMap[i-1][j-1] ){document.getElementById("Wborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="inherit"}else{document.getElementById("Wborder "+(j-EditorStandardY-1)+" "+(i-EditorStandardX-1)).style.visibility="hidden"};
			

			}};

			};

		}


		


		else{
			document.getElementById("RegionMap").style.visibility="hidden";
			document.getElementById("regionMap").style.visibility="hidden";
			
		};
		RegionsToggled=!RegionsToggled;};
function DeployUnit(X,Y,Type,Faction,Direction,LifeIndex,Morale,CustomName,SpecialName,CustomDesc,SpecialDesc){
	//alert(Faction);
	let CostFactor=1;
	if(Speciation==-2){CostFactor=0.8};
	if(Speciation==-1){CostFactor=0.9};
	if(Speciation==1){CostFactor=1.4};
	if(Speciation==2){CostFactor=2};
	YourMoney-=Math.round(Units[Type].Cost*CostFactor);
	CustomName=document.getElementById("ParticularNameBox").value;
	if(CustomName==""){CustomName=null};
	//alert(Math.round(Units[Type].Cost));
	//alert(DaoLedger[PlayerChoiceFaction/2]);
	let MoraleIndex=0;
	MoraleIndex+=Math.min(5,Math.max(-4,DaoLedger[PlayerChoiceFaction]/2));
	MoraleIndex+=Speciation;
	let RosterData={index:MapRoster.length-1, id:Type, faction:Faction, direction:1, x:X-1, y:Y-1, morale:0, hpModifier:0};

	
	MapRoster[MapRoster.length]={index:MapRoster.length-1, id:Type, faction:Faction, direction:1, x:X-1, y:Y-1, morale:MoraleIndex, hpModifier:0};
	//alert((CustomName??SpecialName)??Units[Type].name);
	let UnitData={
			name: (CustomName??SpecialName)??Units[Type].name,
			description: (CustomDesc??SpecialDesc)??Language.UnitDesc[Type],
			ID:"Unit "+MapRoster.length,
			index:MapRoster.length-1,
			x:X-1, 
			y:Y-1, 
			unitType:Type,
			faction:Faction,
			coallition:Factions[Faction].faction, 
			damage:Units[Type].Attack, 
			damageType:Units[Type].Weapon,
			minR:Units[Type].MinRange,
			maxR:Units[Type].MaxRange, 
			life:Math.round(Units[Type].HP*(LifeIndex??1)), 
			armor:Units[Type].Armor, 
			speed:Units[Type].Speed, 
			movementType:Units[Type].Movement, 
			morale:Morale??MoraleIndex,
			direction:Direction??1
	};
	//alert(UnitData.direction??1);
	//alert(UnitData.x+" "+UnitData.y);
	rostermap[X-1][Y-1]=UnitData;
	MapRoster[MapRoster.length-1]=UnitData;
	//alert(UnitData.name);
	//alert(rostermap[UnitData.x][UnitData.y].index);
	let fAcTiOn=0;
	for(let i=0;i<SubRosters.length;i++){if(Faction==SubRosters[i][0].faction){fAcTiOn=i}};
	//alert(fAcTiOn);
		let RecruitmentSFX=0;
		if(Math.ceil(Type/10)==1){RecruitmentSFX="Assets/SFX/InfantryReady.MP3"};
		if(Math.ceil(Type/10)==2){RecruitmentSFX="Assets/SFX/VehicleReady.MP3"};
		if(Math.ceil(Type/10)==3){RecruitmentSFX="Assets/SFX/TankReady.MP3"};
		if(Math.ceil(Type/10)==4){RecruitmentSFX="Assets/SFX/ArtilleryReady.MP3"};
		if(Math.ceil(Type/10)==5){RecruitmentSFX="Assets/SFX/AircraftReady.MP3"};
		if(Math.ceil(Type/10)==6){RecruitmentSFX="Assets/SFX/ShipReady.wav"};
		if(RecruitmentSFX!=0){let RSFX= new Audio(RecruitmentSFX); RSFX.play()}

	SubRosters[fAcTiOn][SubRosters[fAcTiOn].length]=UnitData;
	//console.log(MapRoster);
	//console.log(SubRosters[fAcTiOn]);
	document.getElementById("EntityCore "+X+"X"+Y).src="Assets/Units/Static/"+Units[Type].shortname+UnitData.direction+".PNG";
	document.getElementById("Entity "+X+"X"+Y).style.visibility="visible";
	document.getElementById("Entity "+X+"X"+Y).style.left=(Units[Type].StaticOffsetX??[0,0,0,0,0])[1]+"px";
	document.getElementById("Entity "+X+"X"+Y).style.top=(Units[Type].StaticOffsetY??[0,0,0,0,0])[1]+"px";
	document.getElementById("EntityCore "+X+"X"+Y).style.filter=Factions[Faction].ChromaCode;};
function drawTile(host,image,x,y,terrain){
	var newPic=document.createElement("img");
	newPic.src=image;
	newPic.style.position="absolute";
	newPic.style.top=x+"px";
	newPic.style.left=y+"px";
	newPic.style.zIndex=2;
	newPic.addEventListener("click", function(){AnalyseSquare("Tile", terrain)});
	//if(image=="Blep.png"){newPic.style.zIndex=2;};
	document.getElementById(host).appendChild(newPic);};
function drawEditorTile(){

	//Superfluous

	var newPic=document.createElement("img");
	newPic.src=image;
	newPic.style.position="absolute";
	newPic.style.top=x+"px";
	newPic.style.left=y+"px";
	newPic.style.zIndex=2;
	newPic.addEventListener("click", function(){});
	//if(image=="Blep.png"){newPic.style.zIndex=2;};
	document.getElementById(host).appendChild(newPic);};
function drawUnit(Map, UnitType, direction, x, y, index, rostermap){
	//drawUnit seems to be a residual function
	var newPic=document.createElement("img");
	adjective="Assets/Units/Static/"+Units[UnitType].shortname+direction+".PNG";
	newPic.src=adjective;
	newPic.id=rostermap[x][y].ID;
	newPic.style.position="absolute";
	newPic.style.top=x*56+"px";
	newPic.style.left=y*56+(Units[UnitType].SpriteOffset ?? [0,0,0,0,0])[direction]+"px";
	newPic.style.zIndex=3;
	let Filter=Factions[MapRoster[index].faction].ChromaCode+" opacity(50%)";
	alert(Filter);
	newPic.style.filter=Filter;
	newPic.opacity="0.5";
	//newPic.style.opacity=0.5;
	document.getElementById("UnitMap").appendChild(newPic);
	//document.getElementById(rostermap[x][y].ID).addEventListener("click", function(){selectUnit(Map, unit, x, y);});
	document.getElementById(rostermap[x][y].ID).addEventListener("click", function(){AnalyseSquare('Unit', index)});};
function EndBattle(){
	//alert(Victory);
	//SoundCheck=BattleBGM?false:true;
	if(MusicChoice){BattleBGM.pause();BattleBGM.currentTime=0;BattleBGM.onloadeddata=null;clearTimeout(BGMLoop)};

	
	document.getElementById("AITurnIndicator").style.visibility="hidden";
	RemoveKebabIMeanBlep();
	

	for(let i=1;i<=10;i++){for(let j=1;j<=10;j++){
	document.getElementById("Entity "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Structure "+i+"X"+j).style.visibility="hidden";
	}};

	for(let z=1;z<=4;z++){document.getElementById("Trait"+z).src=""};
	document.getElementById("DetBar").src="Assets/Miscellaneous/PlainDetailBar.PNG";
	document.getElementById("Icon").style.visibility="hidden";
	document.getElementById("DetBarName").innerHTML="";
	document.getElementById("DetBarDescription").innerHTML="";
	document.getElementById("Health").style.visibility="hidden";
	document.getElementById("Damage").style.visibility="hidden";
	document.getElementById("Movement").style.visibility="hidden";
	document.getElementById("Biome").style.visibility="hidden";


		let Preffix=Factions[Constants.Commanders[1].Allegiance].Preffix;
		let Quote=0;
		if(Factions!=CampaignFactions){Preffix="GEN"};
		let jingle=0;
		if(Victory){jingle=new Audio("Assets/SFX/Victory.MP3")}else{jingle=new Audio("Assets/SFX/Defeat.MP3");};
		jingle.play();

		if(Victory){document.getElementById("EndBattleImage").src="Assets/Paralogues/Victory"+Preffix+".PNG";
			Quote=Language.VictoryQuotes}else{
			document.getElementById("EndBattleImage").src="Assets/Paralogues/Defeat"+Preffix+".PNG";
			Quote=Language.DefeatQuotes

		};

		if(Factions!=CampaignFactions){Quote=Quote[0]}else{Quote=Quote[Constants.Commanders[1].Allegiance]};
		Quote=Quote[Math.floor(Math.random()*Quote.length)];
		document.getElementById("EndBattleQuote").innerHTML=Quote;
		document.getElementById("EndBattleQuote").style.color=Factions[Constants.Commanders[1].Allegiance].color;


	if(!Victory && Resolution){
		//alert("It's ok bro, we're not all Chuck Norris");
	Resolution=false;
	document.getElementById("Battlemap").style.visibility="hidden";
	document.getElementById("Main Menu").style.visibility="visible";
	rostermap=0;
	for(let i=1;i<=10;i++){for(let j=1;j<=10;j++){
	document.getElementById("Entity "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Structure "+i+"X"+j).style.visibility="hidden";
	}};
	};


	if(Victory && Resolution){
		//alert("GG bro! You won the level!");
	Victory=false;
	Resolution=false;
	document.getElementById("Battlemap").style.visibility="hidden";
	if(ChosenMission==5){CallInterlogue()};
	for(let i=1;i<=10;i++){for(let j=1;j<=10;j++){
	//alert(document.getElementById("Entity "+i+"X"+j).style.visibility);
	document.getElementById("Entity "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Structure "+i+"X"+j).style.visibility="hidden";
	if(ChosenNation!=0){Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Finished=true};
	}};
	};



	//This bloc calls the endbattle screen

	//wipeMap();
	function endbattlescreen(){document.getElementById('EndBattleScreen').style.visibility='visible'
	document.getElementById("Battlemap").style.visibility="hidden";



	};
	document.getElementById('EndBattleScreen').style.visibility='visible';
	//setTimeout(endbattlescreen,1000);

	let FactionsInvolved=[];
	for(let a=1;a<Constants.Commanders.length;a++){
		FactionsInvolved[a-1]=Factions[Constants.Commanders[a].Allegiance];
		
		};

	Coallitions=[];
	for(let c=0;c<FactionsInvolved.length;c++){
		let CoallitionCheck=true;
		for(let d=0; d<Coallitions.length; d++){if(Coallitions[d]==FactionsInvolved[c].faction){CoallitionCheck=false}};
		if(CoallitionCheck){Coallitions[Coallitions.length]=FactionsInvolved[c].faction};
		};

		//alert(Coallitions.length);

	for(let b=0; b<Coallitions.length; b++){
		let CoalTit=document.createElement("p");
		CoalTit.id='CoallitionTitle'+Coallitions[b];
		CoalTit.innerHTML=Coallitions[b];
		CoalTit.style.position="absolute";
		CoalTit.style.top=70+b*210+"px";
		document.getElementById("EndBattleScreen").appendChild(CoalTit);
		};

	let CoallitionMirror=[]
	for(let e=0;e<Coallitions.length;e++){CoallitionMirror[e]=0;};

	for(let f=0;f<FactionsInvolved.length;f++){

		let AnalBlock=document.createElement("div");
		AnalBlock.id="AnalysisBlock"+FactionsInvolved[f].Preffix;
		//AnalBlock.style.background="#c0c0c0";
		AnalBlock.style.background=FactionsInvolved[f].color;
		AnalBlock.style.position="absolute";
		AnalBlock.style.width="210px";
		AnalBlock.style.height="175px";
		AnalBlock.style.border="3px solid magenta";
		let x=0;
		let y=0;
		for(let g=0; g<=Coallitions.length; g++){
			if(Coallitions[g]!=FactionsInvolved[f].faction){y++}else{CoallitionMirror[g]++; x=CoallitionMirror[g]; g=Coallitions.length};
			};

		AnalBlock.style.top=105+y*210+"px";
		AnalBlock.style.left=-175+x*245+"px";	


		let UnitP=document.createElement("p");
		UnitP.style.position='absolute';
		UnitP.style.top='40px';
		UnitP.style.left='20px';
		//UnitP.innerHTML=Language.SystemTerms[135];
		UnitP.innerHTML='Units Alive:';
		UnitP.style.zIndex=1;
		UnitP.style.color='lime';
		UnitP.id="UnitCounterP"+FactionsInvolved[f].Preffix;

		let Bck=document.createElement('div');
		Bck.style.position="absolute";
		Bck.style.top="35px";
		Bck.style.left="0px";
		Bck.style.width='210px';
		Bck.style.height='140px';
		Bck.style.background='#b0b0b0';

		let Tit=document.createElement("p");
		Tit.style.position='absolute';
		Tit.style.width='200px';
		Tit.style.height='20px';
		Tit.style.top='0px';
		Tit.style.left='10px';
		Tit.style.textAlign='center';
		Tit.id="FactionTitle"+FactionsInvolved[f].Preffix;
		Tit.innerHTML='Chuchu';
		Tit.style.fontSize='12px';



		let StrucP=document.createElement("p");
		StrucP.style.position='absolute';
		StrucP.style.top='60px';
		StrucP.style.left='20px';
		//StrucP.innerHTML=Language.SystemTerms[135];
		StrucP.innerHTML='Structures:';
		StrucP.style.zIndex=1;
		StrucP.style.color='lime';
		StrucP.id="StructureCounterP"+FactionsInvolved[f].Preffix;

		let UnitQ=document.createElement("p");
		UnitQ.style.position='absolute';
		UnitQ.style.top='48px';
		UnitQ.style.left='125px';
		UnitQ.innerHTML='0/0';
		UnitQ.style.zIndex=1;
		UnitQ.style.color='lime';
		UnitQ.id="UnitCounter"+FactionsInvolved[f].Preffix;

		UnitQ.style.fontSize='12px';


		let StrucQ=document.createElement("p");
		StrucQ.style.position='absolute';
		StrucQ.style.top='68px';
		StrucQ.style.left='125px';
		StrucQ.innerHTML='0/0';
		StrucQ.style.zIndex=1;
		StrucQ.style.color='lime';
		StrucQ.id="StructureCounter"+FactionsInvolved[f].Preffix;

		StrucQ.style.fontSize='12px';


		document.getElementById("EndBattleScreen").appendChild(AnalBlock);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(Tit);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(Bck);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(UnitP);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(StrucP);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(UnitQ);
		document.getElementById("AnalysisBlock"+FactionsInvolved[f].Preffix).appendChild(StrucQ);		
		};

		let TotalStructures=0;
		for(let h=0; h<Map.length; h++){for(let i=0; i<Map[0].length; i++){if(Terrain[Map[h][i]].Urbanistics>1){TotalStructures++}}};
		for(let j=0; j<FactionsInvolved.length; j++){
			let OwnStructures=0;


			for(let k=0; k<Map.length; k++){
				for(let l=0; l<Map[0].length; l++){
					if(Terrain[Map[k][l]].Urbanistics>1 && ControlMap[k][l]==Constants.Commanders[j+1].Allegiance){OwnStructures++};
				};
			};

			let Rapport=Math.round(OwnStructures/TotalStructures*10000)/100;
			document.getElementById("StructureCounter"+FactionsInvolved[j].Preffix).innerHTML=(OwnStructures+"/"+TotalStructures+"("+Rapport+"%)");

			let TotalUnits=0;
			let AliveUnits=0;
			//let mapRoster=MapRoster;
			//alert(mapRoster.length);
			for(let m=1; m<MapRoster.length; m++){if(MapRoster[m].faction==Constants.Commanders[j+1].Allegiance){TotalUnits++; if(MapRoster[m].life>0){AliveUnits++} }};
			let UnitRapport=Math.round(AliveUnits/TotalUnits*10000)/100;
			document.getElementById("UnitCounter"+FactionsInvolved[j].Preffix).innerHTML=(AliveUnits+"/"+TotalUnits+"("+UnitRapport+"%)");

			document.getElementById("FactionTitle"+FactionsInvolved[j].Preffix).innerHTML=Factions[Constants.Commanders[j+1].Allegiance].name;
			if(Factions[Constants.Commanders[j+1].Allegiance].color=="Black"){document.getElementById("FactionTitle"+FactionsInvolved[j].Preffix).style.color='indigo'};
			document.getElementById("StructureCounter"+FactionsInvolved[j].Preffix).style.color=FactionsInvolved[j].color;
			document.getElementById("UnitCounter"+FactionsInvolved[j].Preffix).style.color=FactionsInvolved[j].color;
			document.getElementById("StructureCounterP"+FactionsInvolved[j].Preffix).style.color=FactionsInvolved[j].color;
			document.getElementById("UnitCounterP"+FactionsInvolved[j].Preffix).style.color=FactionsInvolved[j].color;
			};

			if(ChosenMission==5){
				if(ChosenChapter==5 && ChosenNation==1){alert("We have forgiven the traitorous Vladov, for he too has suffered greatly. Despite all, he eventually repented and earned his redemption through fire and steel. If you want to, you can put yourself in his shoes and play his campaign")};
				if(ChosenChapter==5 && ChosenNation==2){alert("For so long, the subhuman slaves have refused to bow down and accept their fate. Every second they squirm around in mud trying to subvert our glorious empire in any way they can. If you wish, you can play their campaign now")};
				if(ChosenChapter==3 && ChosenNation==3){alert("And so, Shmelev cast down his mask. He will fight to preserve matriarchy, and his own personal interests while at that. If you wish to observe his antics you may now play Shmelev's campaign")};
				if(ChosenChapter==5 && ChosenNation==4){alert("If you so wish, you can go fight for the Syndicalist cause. It will not change their fate, but might allow you to observe their workings and conflicts")};
				if(ChosenChapter==5 && ChosenNation==5){alert("The curtain has fallen over Elam. The collaborators have established a sock puppet regime and Elam shall never again rise. There are, however, a few who refuse to give up the fight. If you want to witness their final struggle, you may now play their campaign.")};

			};

	for(let eth=0; eth<MapRoster.length; eth++){MapRoster[eth].life=-1};};
function EndTurn(SubRosters,Map,Constants,Roster){
	//Map=Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map;
	//alert(Roster);
	//alert(Constants);

	Turn++;
	//alert(Turn);


	
	CurrentTurn=(Turn-1)%AttackOrder.length;

	//console.log(Roster);
	Inspection(Turn,Constants,Roster);

	for(let a=1; a<=GlassPanels; a++){
		let dudeIndex=SubRosters[(Turn-1+a)%AttackOrder.length][0].faction;
		//alert(Turn);
		//alert(dudeIndex);
		document.getElementById("Glassplatecolor"+a).style.background=Factions[dudeIndex].color;
		//if(Factions==CampaignFactions){document.getElementById("GlassplateCrest"+a).src="Assets/Emblems/Crest"+Factions[dudeIndex].Preffix+".PNG"}else{document.getElementById("GlassplateCrest"+a).src="Assets/Emblems/CrestNON.PNG"};
		document.getElementById("Glassplatename"+a).innerHTML=Factions[dudeIndex].name;
		if(document.getElementById("Glassplatecolor"+a).style.background!='black'){document.getElementById("Glassplatename"+a).style.color='black'}else{document.getElementById("Glassplatename"+a).style.color='indigo'};};


	
	TurnIndex++;



	//alert(AttackOrder[CurrentTurn]);
	if(AttackOrder[CurrentTurn]==PlayerChoiceFaction){
		//alert(SubRosters)
		PITurn(SubRosters[CurrentTurn],Map,Constants);
		//alert("PI");
	}else{
		//alert(CurrentTurn);

		if(!Resolution){AITurn(SubRosters[CurrentTurn],Map,Constants);
		//alert("AI");

		//EndTurn(SubRosters,Map,Constants,Roster)
		};
		//InterphaseBanner(AttackOrder[CurrentTurn],Turn)

	};};
function EvaluateDynamicEvent(Comutator,LastUnit){
	let TriggerKey=false;
	if(Comutator=='Locomotion'){
		//for(let a=0; a<DynamicEvents.length; a++){if()};
		for(let b=0; b<DynamicEvents.length; b++){
			if(DynamicEvents[b].Turn!=0){if(Turn==DynamicEvents[b].Turn){TriggerKey=true}};
			if(DynamicEvents[b].TilesCaptured.length>0){
				let CaptureKey=true;
				for(let c=0; c<DynamicEvents[b].TilesCaptured.length; c++){
					let indexer=DynamicEvents[b].TilesCaptured[c];
					if(rostermap[indexer.x][indexer.y]==0 || rostermap[indexer.x][indexer.y].coallition!=Factions[PlayerChoiceFaction].faction){CaptureKey=false};
				};
				//alert(CaptureKey);
				if(CaptureKey){TriggerKey=true};
			};

			if(DynamicEvents[b].LineCrossed!=null){
				let Line=DynamicEvents[b].LineCrossed;

				if(Line.gyro=='West'){if(LastUnit[1]<Line.Y){TriggerKey=true}};
				if(Line.gyro=='East'){if(LastUnit[1]>Line.Y){TriggerKey=true}};
				if(Line.gyro=='North'){if(LastUnit[0]<Line.X){TriggerKey=true}};
				if(Line.gyro=='South'){if(LastUnit[0]>Line.X){TriggerKey=true}};





				};






				if(TriggerKey&&DynamicEvents[b].selfswitch){DynamicEvents[b].selfswitch=false; RunEvent(DynamicEvents[b].Event)};
			};



	}else if(Comutator=='Action'){
		TriggerKey=false;

		for(let d=0; d<DynamicEvents.length;d++){
			if(DynamicEvents[d].Turn!=0){if(Turn==DynamicEvents[d].Turn){TriggerKey=true}};
			if(DynamicEvents[d].UnitsDead.length>0){
				let UnitKey=true;
				for(let e=0; e<DynamicEvents[d].UnitsDead.length;e++){
					let unit=DynamicEvents[d].UnitsDead[e];
					if(MapRoster[unit].life>0){UnitKey=false};
				}; 
				if(UnitKey){TriggerKey=true};
			};

			if(DynamicEvents[d].FactionDead!=0){
			let FactionKey=true;
				for(let e=0; e<MapRoster.length; e++){if(MapRoster[e].faction==DynamicEvents[d].FactionDead && MapRoster[e].life>0){FactionKey=false}};
				if(FactionKey){TriggerKey=true};

			};




		if(TriggerKey&&DynamicEvents[d].selfswitch){DynamicEvents[d].selfswitch=false; RunEvent(DynamicEvents[d].Event)};};
	}else{}};
function ExecuteSpeciation(Speciator){
	//CostFactor=1;
	if(Speciator==-2){CostFactor=0.8};
	if(Speciator==-1){CostFactor=0.9};
	if(Speciator==-0){CostFactor=1};
	if(Speciator==1){CostFactor=1.4};
	if(Speciator==2){CostFactor=2};
	Speciation=Speciator;
	for(let i=-2; i<3;i++){document.getElementById('MoraleParticulator'+i).src='Assets/Traits/Morale0.PNG'};
	document.getElementById('MoraleParticulator'+Speciator).src='Assets/Traits/Morale'+Speciator+'.PNG';
	let IndustrialLimit=40; 
	if(IndustrialBranchBrowsed!=1){IndustrialLimit=10};
	for(let m=1;m<=IndustrialLimit;m++){document.getElementById('PriceTag'+m).innerHTML='₤'+Math.round(Units[MontreIndexBasis+m].Cost*CostFactor); if(YourMoney<Math.round(Units[MontreIndexBasis+m].Cost*CostFactor)){document.getElementById("UnitFrame"+m).src="Assets/Miscellaneous/UnitUnavailableFrame.PNG"}else{document.getElementById("UnitFrame"+m).src="Assets/Miscellaneous/UnitAvailableFrame.PNG"}}


	};
function FactionInformations(Ordinal){

	//alert(AttackOrder);
	let index=AttackOrder[(Ordinal+TurnIndex-2)%AttackOrder.length];
	//alert(Turn);
	document.getElementById("FactionDetailsName").innerHTML=Factions[index].name;
	document.getElementById("FactionDetailsName").style.color=Factions[index].color;

	let RelationType="Ally";
	//alert(AttackOrder);
	if(PlayerChoiceFaction==index){RelationType="Same"};
	if(Factions[PlayerChoiceFaction].faction!=Factions[index].faction){RelationType="Enemy"};
	if(RelationType=="Same"){document.getElementById("FactionDetailsRelation").innerHTML=Language.SystemTerms[125]+": "+Language.SystemTerms[126]; document.getElementById("FactionDetailsRelation").style.color='yellow'};
	if(RelationType=="Ally"){document.getElementById("FactionDetailsRelation").innerHTML=Language.SystemTerms[125]+": "+Language.SystemTerms[127]; document.getElementById("FactionDetailsRelation").style.color='blue'};
	if(RelationType=="Enemy"){document.getElementById("FactionDetailsRelation").innerHTML=Language.SystemTerms[125]+": "+Language.SystemTerms[128]; document.getElementById("FactionDetailsRelation").style.color='orange'};
	document.getElementById("FactionDetailsLeader").innerHTML=Language.SystemTerms[138]+": "+Constants.Commanders[AttackOrder.indexOf(index,0)+1].Fullname;
	document.getElementById("FactionDetailsDao").innerHTML=Language.SystemTerms[131]+":0";
	//alert(Constants.Funds);
	document.getElementById("FactionDetailsFunds").innerHTML=Language.SystemTerms[133]+Constants.Funds[AttackOrder.indexOf(index,0)+1];
	if(index==1){document.getElementById("FactionDetailsFunds").innerHTML=Language.SystemTerms[133]+YourMoney};

	for(let a=1; a<=5; a++){
		//alert(Factions[index].SpecialInfantry);
		if(!Factions[index].SpecialInfantry[a-1]){document.getElementById("SpecInf"+a).src="Assets/Traits/SpecInf0.PNG"}else{document.getElementById("SpecInf"+a).src="Assets/Traits/SpecInf"+a+".PNG"};
		if(!Factions[index].SpecialVehicles[a-1]){document.getElementById("SpecTank"+a).src="Assets/Traits/SpecTank0.PNG"}else{document.getElementById("SpecTank"+a).src="Assets/Traits/SpecTank"+a+".PNG"};


		};

	document.getElementById("FactionDetails").style.visibility="inherit"};
//fillMap() is deprecated and has been replaced by FillMap()
function fillMap(Map){

	for(let X=StandardX;X<StandardX+Map.length;X++){
	for(let Y=StandardY;Y<StandardY+Map[0].length;Y++){
		let Tile=Map[X][Y];
		let Address="Tile "+(X+1)+"X"+(Y+1);
		let Strucdress="Structure "+(X+1)+"X"+(Y+1);

		document.getElementById(Strucdress).style.visibility="hidden";
		document.getElementById(Strucdress).style.filter="";
		/*
		let EdgeA=document.getElementById("A "+(X+1-StdX)+ " X " +(Y+1-StdY));
		let EdgeB=document.getElementById("B "+(X+1-StdX)+ " X " +(Y+1-StdY));
		let EdgeC=document.getElementById("C "+(X+1-StdX)+ " X " +(Y+1-StdY));
		let EdgeD=document.getElementById("D "+(X+1-StdX)+ " X " +(Y+1-StdY));
		if(EdgeA!=null){EdgeA.remove()};
		if(EdgeB!=null){EdgeB.remove()};
		if(EdgeC!=null){EdgeC.remove()};
		if(EdgeD!=null){EdgeD.remove()};
		*/

		document.getElementById("A "+(X+1)+"X"+(Y+1)).style.visibility="hidden";
		document.getElementById("B "+(X+1)+"X"+(Y+1)).style.visibility="hidden";
		document.getElementById("C "+(X+1)+"X"+(Y+1)).style.visibility="hidden";
		document.getElementById("D "+(X+1)+"X"+(Y+1)).style.visibility="hidden";



		switch(Tile){

		case 1:
			var type= Math.ceil(Math.random()*8);
			var offset=0;
			variant= "Assets/Tiles/Plains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 2:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Forest"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 3:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==3){offset=-4};
			if(type==4){offset=-5};
			variant= "Assets/Tiles/Hills"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 4:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-9};
			if(type==4){offset=-10};
			variant= "Assets/Tiles/Mountains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 5:
			var offset=-8;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Volcano.PNG";
			break;

		case 6:
			var offset=0;
			var variant=0;
			
			if(X>0){if(Terrain[Map[X-1][Y]].Urbanistics > 0){variant+=1}};
			if(Y+1<Map[0].length){if(Terrain[Map[X][Y+1]].Urbanistics>0){variant+=2}};
			if(X+1<Map.length){if(Terrain[Map[X+1][Y]].Urbanistics>0){variant+=4}};
			if(Y>0){if(Terrain[Map[X][Y-1]].Urbanistics > 0){variant+=8}};
			//if(X>0){if((Map[X-1][Y]>5 && Map[X-1][Y]<15) || (Map[X-1][Y]>20 && (Map[X-1][Y]<23))){variant+=1}};
			//if(Y<Map[0].length){if((Map[X][Y+1]>5 && Map[X][Y+1]<15) || (Map[X][Y+1]>20 && (Map[X][Y+1]<23))){variant+=2}};
			//if(X<Map.length){if((Map[X+1][Y]>5 && Map[X+1][Y]<15) || (Map[X+1][Y]>20 && (Map[X+1][Y]<23))){variant+=4}};
			//if(Y>0){if((Map[X][Y-1]>5 && Map[X][Y-1]<15) || (Map[X][Y-1]>20 && (Map[X][Y-1]<23))){variant+=2}};
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src="Assets/Tiles/Road"+variant+".PNG";
			break;

		case 7:
			var offset=-14;
			var type= Math.ceil(Math.random()*2);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Ruins"+type+".PNG";
			break;

		case 8:
			var offset=-14;
			var type= Math.ceil(Math.random()*4);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Urban District"+type+".PNG";
			break;

		case 9:
			var offset=-10;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Industrial District.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 10:
			var offset=-8;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Military-Industrial Complex.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 11:
			var offset=-14;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Aviation Industrial Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 12:
			var offset=-14;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Shipbuilding Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 13:
			var offset=0;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Headquarters.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 14:
			var offset=-18;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Command Center.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;

		case 15:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Taiga"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 16:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Desert"+type+".PNG";
			break;

		case 17:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			variant= "Assets/Tiles/Tundra"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 18:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Extreme Desert"+type+".PNG";
			break;

		case 19:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Arctic Hellhole"+type+".PNG";
			break;

		case 20:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>0){if(Terrain[Map[X-1][Y]].SailThrough<100){axis="H"}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].SailThrough<100){axis="V"}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].SailThrough<100){axis="H"}};
			if(Y>0){if(Terrain[Map[X][Y-1]].SailThrough<100){axis="V"}};
			if(X>0){if(Map[X-1][Y]==20 || Map[X-1][Y]==21){axis="V"}};
			if(Y<Map[0].length-1){if(Map[X][Y+1]==20 || Map[X][Y+1]==21){axis="H"}};
			if(X<Map.length-1){if(Map[X+1][Y]==20 || Map[X+1][Y]==21){axis="V"}};
			if(Y>0){if(Map[X][Y-1]==20 || Map[X][Y-1]==21){axis="H"}};

			if(axis=="V"){
			if(X>0){if(Terrain[Map[X-1][Y]].WalkThrough<100){variant+=1;}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].WalkThrough<100){variant+=2;}};};
			if(axis=="H"){if(Y>0){if(Terrain[Map[X][Y-1]].WalkThrough<100){variant+=1;}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].WalkThrough<100){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Bridge"+axis+variant+".PNG";
			break;

		case 21:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>0){if(Terrain[Map[X-1][Y]].SailThrough<100){axis="H"}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].SailThrough<100){axis="V"}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].SailThrough<100){axis="H"}};
			if(Y>0){if(Terrain[Map[X][Y-1]].SailThrough<100){axis="V"}};
			if(X>0){if(Map[X-1][Y]==20 || Map[X-1][Y]==21){axis="V"}};
			if(Y<Map[0].length-1){if(Map[X][Y+1]==20 || Map[X][Y+1]==21){axis="H"}};
			if(X<Map.length-1){if(Map[X+1][Y]==20 || Map[X+1][Y]==21){axis="V"}};
			if(Y>0){if(Map[X][Y-1]==20 || Map[X][Y-1]==21){axis="H"}};

			if(axis=="V"){
			if(X>0){if(Terrain[Map[X-1][Y]].WalkThrough<100){variant+=1;}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].WalkThrough<100){variant+=2;}};};
			if(axis=="H"){if(Y>0){if(Terrain[Map[X][Y-1]].WalkThrough<100){variant+=1;}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].WalkThrough<100){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/HighBridge"+axis+variant+".PNG";
			break;

		case 22:
			var offset=0;
			var variant=0;

			if(X>0){if(Terrain[Map[X-1][Y]].SailThrough<100){variant+=1;}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].SailThrough<100){variant+=2;}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].SailThrough<100){variant+=4;}};
			if(Y>0){if(Terrain[Map[X][Y-1]].SailThrough<100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/River"+variant+".PNG";
			break;

		case 23:
			var offset=0;
			var variant=0;
			//alert(Y);
			if(X>0){if(Terrain[Map[X-1][Y]].SailThrough<100){variant+=1;}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].SailThrough<100){variant+=2;}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].SailThrough<100){variant+=4;}};
			if(Y>0){if(Terrain[Map[X][Y-1]].SailThrough<100){variant+=8;}};
			if(X==0){variant+=1};
			if(Y==Map[0].length-1){variant+=2};
			if(X==Map.length-1){variant+=4};
			if(Y==0){variant+=8};

			if(X>0 && Y>0){if(Terrain[Map[X-1][Y-1]].SailThrough==100 && (variant==15 || variant==11 || variant==13)){document.getElementById("A "+(X+1)+"X"+(Y+1)).style.visibility="visible"}};
			if(X>0 && Y<Map[0].length-1){if(Terrain[Map[X-1][Y+1]].SailThrough==100 && (variant==15 || variant==7 || variant==11)){document.getElementById("B "+(X+1)+"X"+(Y+1)).style.visibility="visible"}};
			if(X<Map.length-1 && Y>0){if(Terrain[Map[X+1][Y-1]].SailThrough==100 && (variant==15 || variant==13 || variant==14)){document.getElementById("C "+(X+1)+"X"+(Y+1)).style.visibility="visible"}};
			if(X<Map.length-1 && Y<Map[0].length-1){if(Terrain[Map[X+1][Y+1]].SailThrough==100 && (variant==15 || variant==7 || variant==14)){document.getElementById("D "+(X+1)+"X"+(Y+1)).style.visibility="visible"}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Sea"+variant+".PNG";
			break;

		case 24:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Reef"+type+".PNG";
			break;

		case 25:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Floes"+type+".PNG";
			break;	

		case 26:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Archipelago"+type+".PNG";
			break;	

		case 27:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Rocks"+type+".PNG";
			break;	

		case 28:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Icebergs"+type+".PNG";
			break;	

		case 29:
			var offset=0;
			var variant=0;

			if(X>0){if(Terrain[Map[X-1][Y]].SailThrough==100){variant+=1;}};
			if(Y<Map[0].length-1){if(Terrain[Map[X][Y+1]].SailThrough==100){variant+=2;}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].SailThrough==100){variant+=4;}};
			if(Y>0){if(Terrain[Map[X][Y-1]].SailThrough==100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Shore"+variant+".PNG";
			break;

		case 30:
			var offset=-9;
			document.getElementById(Address).src="Assets/Tiles/Sea.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Oil Rig.PNG";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[X][Y]].ChromaCode;
			break;		

		};

	};};};
function FillMap(Map){
	//At last, I've been waiting for this moment for so long. No more provisional map generators and stopgap measures. This time it's for real.
	//-Good, because now it's personal.
	//You don't think this is personal for me too!? I'll start at 80% of my power!

	//alert("a");
	for(let a=0;a<Map.length;a++){
	for(let b=0; b<Map[0].length; b++){
	let D1=0;
	let D2=0;
	let D3=0;
	let D4=0;

	let Biome=BiomeMap[a][b];
		if((Terrain[Map[a][b]].BiomeIndex??0)!=0){Biome=1};
		if(Biome==1){Biome=""};
		if(Biome==2){Biome="Arid"};
		if(Biome==3){Biome="Boreal"};
		if(Biome==4){Biome="Barren"};
		if(Biome==5){Biome="Arctic"};
		if(Biome==6){Biome="Lunar"};
		if(Biome==7){Biome="Martian"};

	if(a>0){D1=Map[a-1][b]};
	if(b<Map[0].length-1){D2=Map[a][b+1]};
	if(a<Map.length-1){D3=Map[a+1][b]};
	if(b>0){D4=Map[a][b-1]};

	let Class=Terrain[Map[a][b]].Class;
	let TileAdress="Tile "+(a+1)+"X"+(b+1);
	let Strucdress="Structure "+(a+1)+"X"+(b+1);
	document.getElementById(Strucdress).style.visibility="hidden";

	switch(Class){

		case "LF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;
			break;

		case "LA":
			var type=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;
			break;

		case "WE":
			var type=0;

			if(Terrain[D1].Class=="WF" || Terrain[D1].Class=="WA" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="WS" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="B" || a==0){type+=1};
			if(Terrain[D2].Class=="WF" || Terrain[D2].Class=="WA" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="WS" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="B" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="WF" || Terrain[D3].Class=="WA" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="WS" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="B" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="WF" || Terrain[D4].Class=="WA" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="WS" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="B" || b==0){type+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("A "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("A "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[BiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("B "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("B "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[BiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("C "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("C "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[BiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("D "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("D "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[BiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;



			break;

		case "WA":
			var type=0;

			if(Terrain[D1].Class=="WA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="WF" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="B"){type+=1};
			if(Terrain[D2].Class=="WA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="WF" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="B"){type+=2};
			if(Terrain[D3].Class=="WA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="WF" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="B"){type+=4};
			if(Terrain[D4].Class=="WA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="WF" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="B"){type+=8};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "WF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;

			break;

		case "WS":
			var underType=0;
			if(Terrain[D1].SailThrough<100){underType+=1};
			if(Terrain[D2].SailThrough<100){underType+=2};
			if(Terrain[D3].SailThrough<100){underType+=4};
			if(Terrain[D4].SailThrough<100){underType+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("A "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("A "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[BiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("B "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("B "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[BiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("C "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("C "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[BiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("D "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("D "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[BiomeMap[a+1][b+1]].Nominator+".PNG"}};


			//EditorControlMap[a][b]=EditationColor;
			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Sea"+underType+".PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;


			break;

		case "MC":
			var type=0;
			var axis="H";
			var alttype=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S" || Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S" || Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S" || Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S" || Terrain[D4].Class=="MC"){axis="H"};

			if((Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S")&&(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S")){axis="H"};
			if((Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S")&&(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S")){axis="V"};

			if(Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="MC"){axis="H"};

			if(Terrain[D1].Class=="MC"){alttype+=1};
			if(Terrain[D2].Class=="MC"){alttype+=2};
			if(Terrain[D3].Class=="MC"){alttype+=4};
			if(Terrain[D4].Class=="MC"){alttype+=8};
	
			for(let c=0; c<4; c++){if(alttype==15-Math.pow(2,c)){axis="T"}};
			if(alttype==15){axis="O"};

			if(axis=="H"){

			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S"){type+=2};
			if(type>0){type+=Biome};


			}else if(axis=="V"){

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S"){type+=2};
			if(type>0){type+=Biome};

			}else if(axis=="T"){
				type="";
				if(alttype==14){type="A"};
				if(alttype==13){type="B"};
				if(alttype==11){type="C"};
				if(alttype==7){type="D"};


			}else if(axis=="O"){
				type="";

			};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+axis+type+".PNG";
			document.getElementById(TileAdress).style.top=Terrain[Map[a][b]].Offset+"px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "B":
			var type=0;

			/*if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || a==0){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || b==0){type+=8};*/

			if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			if(a>1 && b>1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("A "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("A "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[BiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("B "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("B "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[BiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D2].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("C "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("C "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[BiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D4].SailThrough<100){document.getElementById("D "+(a+1)+"X"+(b+1)).style.visibility="visible";document.getElementById("D "+(a+1)+"X"+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[BiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "S":
			//To do: Manipulate underlying terrain to be a proper road, not a grass tile
			let undertype=0;
			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){undertype+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){undertype+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){undertype+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){undertype+=8};



			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Road"+undertype+Biome+".PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;

			break;}














	}};};
function FillMapEditor(Tile){
	let a=Math.floor(document.getElementById("TileContainer").scrollTop/56);
	//alert(document.getElementById("TileContainer").scrollLeft-1);
	let b=Math.floor(document.getElementById("TileContainer").scrollLeft/56);
	for(let c=a; c<a+10; c++){for(let d=b; d<b+10; d++){
		EditorMap[c][d]=Tile;
		EditorEntityMap[c][d]=0;



		}};
	RefreshMapEditor();};
function FocalEditorRefresh(X,Y){
	if(EditationToggle=="Tile"){
		document.getElementById("EntityCore "+X+" X "+Y).src="";
		EditorEntityMap[X+EditorStandardX-1][Y+EditorStandardY-1]=0;
	EditorMap[X+EditorStandardX-1][Y+EditorStandardY-1]=ChosenTerrain;
	EditorControlMap[X-1][Y-1]=EditationColor;
	RefreshTile(X,Y);
	if(X>1){if(Terrain[EditorMap[X-2][Y-1]].Class!="LF" && Terrain[EditorMap[X-2][Y-1]].Class!="LE"){RefreshTile(X-1,Y)}};
	if(X<EditorMap.length){if(Terrain[EditorMap[X][Y-1]].Class!="LF" && Terrain[EditorMap[X][Y-1]].Class!="LE"){RefreshTile(X+1,Y)}};
	if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].Class!="LF" && Terrain[EditorMap[X-1][Y-2]].Class!="LE"){RefreshTile(X,Y-1)}};
	if(Y<EditorMap[0].length){if(Terrain[EditorMap[X-1][Y]].Class!="LF" && Terrain[EditorMap[X-1][Y]].Class!="LE"){RefreshTile(X,Y+1)}};
	if(X>1&&Y>1){if(Terrain[EditorMap[X-2][Y-2]].Class!="LF" && Terrain[EditorMap[X-2][Y-2]].Class!="LE"){RefreshTile(X-1,Y-1)}};
	if(X<EditorMap.length&&Y>1){if(Terrain[EditorMap[X][Y-2]].Class!="LF" && Terrain[EditorMap[X][Y-2]].Class!="LE"){RefreshTile(X+1,Y-1)}};
	if(X>1&&Y<EditorMap[0].length){if(Terrain[EditorMap[X-2][Y]].Class!="LF" && Terrain[EditorMap[X-2][Y]].Class!="LE"){RefreshTile(X-1,Y+1)}};
	if(X<EditorMap.length&&Y<EditorMap[0].length){if(Terrain[EditorMap[X][Y]].Class!="LF" && Terrain[EditorMap[X][Y]].Class!="LE"){RefreshTile(X+1,Y+1)}};

	}else{
	let Chosenunit=ChosenUnit-10+10*EditorUnitClass;
	let choka=Units[Chosenunit].Movement;
	let boka=Terrain[EditorMap[X+EditorStandardX-1][Y+EditorStandardY-1]];
	if(choka=="Foot"){boka=boka.WalkThrough}else if(choka=="Wheeled"){boka=boka.DriveThrough}else if(choka=="Tracked"){boka=boka.RollThrough}else if(choka=="Amphibious"){boka=boka.WadeThrough}else if(choka=="Flight"){boka=boka.FlyThrough}else if(choka=="Rudder"){boka=boka.SailThrough}else if(choka=="Heavy Rudder"){boka=boka.DeepSailThrough}else if(choka=="Stationary"){boka=boka.SailThrough-1}

	if(100>boka){
		if(MemoryX==X && MemoryY==Y){EditationDirection++}else{EditationDirection=1};
		if(EditationDirection>4){EditationDirection-=4};
		MemoryX=X;
		MemoryY=Y;
		document.getElementById("EntityCore "+X+" X "+Y).src="Assets/Units/Static/"+Units[Chosenunit].shortname+EditationDirection+".PNG";
		if(Units[Chosenunit].MLPR??false){document.getElementById("EntityMesh "+X+" X "+Y).src="Assets/Miscellaneous/Nothing.PNG"}else{document.getElementById("EntityMesh "+X+" X "+Y).src="Assets/Units/StaticMeshes/"+Units[Chosenunit].shortname+"Mesh"+EditationDirection+".PNG";};
		document.getElementById("Entity "+X+" X "+Y).style.visibility="inherit";
		document.getElementById("EntityCore "+X+" X "+Y).style.filter=Factions[EditationColor].ChromaCode;
		document.getElementById("Entity "+X+" X "+Y).style.left=(Units[Chosenunit].StaticOffsetX ?? [0,0,0,0,0])[EditationDirection]+"px";
		document.getElementById("Entity "+X+" X "+Y).style.top=(Units[Chosenunit].StaticOffsetY ?? [0,0,0,0,0])[EditationDirection]+"px";
		EditorEntityMap[X+EditorStandardX-1][Y+EditorStandardY-1]={id:Chosenunit, faction:EditationColor, direction:EditationDirection, x:X+EditorStandardX-1, y:Y+EditorStandardY-1,hpModifier:0,morale:0};	
	}}};
function FocalMapRefresh(X,Y){




	};
function FocalTileRefresh(X,Y){
		//let Map=Map;
		let ics=X+1;
		let igrec=Y+1;
		let TileAdress="Tile "+ics+"X"+igrec;
		let Altdress="Entity "+ics+"X"+igrec;
		let AltCoreDress="EntityCore "+ics+"X"+igrec;
		let Strucdress="Structure "+ics+"X"+igrec;
		document.getElementById(TileAdress).style.top="0px";
		let unit=rostermap[ics-1][igrec-1];
		let Biome=CampaignTerrain[Map[ics-1][igrec-1]].BiomeIndex??BiomeMap[ics-1][igrec-1];
		if(Biome!=undefined){BiomeMap[ics-1][igrec-1]=Biome;};
		if(Biome==1){Biome=""};
		if(Biome==2){Biome="Arid"};
		if(Biome==3){Biome="Boreal"};
		if(Biome==4){Biome="Barren"};
		if(Biome==5){Biome="Arctic"};
		if(Biome==6){Biome="Lunar"};
		if(Biome==7){Biome="Martian"};
		if((CampaignTerrain[Map[ics-1][igrec-1]].BiomeIndex??0)!=0){Biome=""};

		document.getElementById(Strucdress).style.visibility="hidden";
		document.getElementById("A "+(ics)+"X"+(igrec)).style.visibility="hidden";
		document.getElementById("B "+(ics)+"X"+(igrec)).style.visibility="hidden";
		document.getElementById("C "+(ics)+"X"+(igrec)).style.visibility="hidden";
		document.getElementById("D "+(ics)+"X"+(igrec)).style.visibility="hidden";

		if(rostermap[ics-1][igrec-1]!=0){
			document.getElementById(Altdress).style.visibility="inherit";
			document.getElementById(AltCoreDress).style.filter=Factions[rostermap[ics-1][igrec-1].faction].ChromaCode;
			document.getElementById(Altdress).style.top=(Units[unit.unitType].StaticOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
			document.getElementById(Altdress).style.left=(Units[unit.unitType].StaticOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";

			document.getElementById(Altdress).src="Assets/Units/Static/"+Units[rostermap[ics-1][igrec-1].unitType].shortname+rostermap[ics-1][igrec-1].direction+".PNG";
		}else{document.getElementById(Altdress).style.visibility="hidden";};


		let Class=CampaignTerrain[Map[ics-1][igrec-1]].Class;
		let a=X;
		let b=Y;
		let D1=0;
		let D2=0;
		let D3=0;
		let D4=0;

		if(a>0){D1=Map[a-1][b]};
		if(b<Map[0].length-1){D2=Map[a][b+1]};
		if(a<Map.length-1){D3=Map[a+1][b]};
		if(b>0){D4=Map[a][b-1]};
		
		document.getElementById(Strucdress).style.visibility="hidden";


	switch(Class){

		case "LF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;
			break;

		case "LA":
			var type=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			//console.log(CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex);
			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;
			break;

		case "WE":
			var type=0;

			if(Terrain[D1].Class=="WF" || Terrain[D1].Class=="WA" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="B" || Terrain[D1].Class=="WS" || a==0){type+=1};
			if(Terrain[D2].Class=="WF" || Terrain[D2].Class=="WA" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="B" || Terrain[D2].Class=="WS"|| b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="WF" || Terrain[D3].Class=="WA" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="B" || Terrain[D3].Class=="WS"|| a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="WF" || Terrain[D4].Class=="WA" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="B" || Terrain[D4].Class=="WS"|| b==0){type+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;



			break;

		case "WA":
			var type=0;

			if(Terrain[D1].Class=="WA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="WF" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="B"){type+=1};
			if(Terrain[D2].Class=="WA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="WF" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="B"){type+=2};
			if(Terrain[D3].Class=="WA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="WF" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="B"){type+=4};
			if(Terrain[D4].Class=="WA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="WF" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="B"){type+=8};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "WF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;

			break;

		case "WS":
			var underType=0;
			if(Terrain[D1].SailThrough<100){underType+=1};
			if(Terrain[D2].SailThrough<100){underType+=2};
			if(Terrain[D3].SailThrough<100){underType+=4};
			if(Terrain[D4].SailThrough<100){underType+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};


			//EditorControlMap[a][b]=EditationColor;
			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Sea"+underType+".PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;


			break;

		case "MC":
			var type=0;
			var axis="H";
			var alttype=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S" || Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S" || Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S" || Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S" || Terrain[D4].Class=="MC"){axis="H"};

			if((Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S")&&(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S")){axis="H"};
			if((Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S")&&(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S")){axis="V"};

			if(Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="MC"){axis="H"};

			if(Terrain[D1].Class=="MC"){alttype+=1};
			if(Terrain[D2].Class=="MC"){alttype+=2};
			if(Terrain[D3].Class=="MC"){alttype+=4};
			if(Terrain[D4].Class=="MC"){alttype+=8};
	
			for(let c=0; c<4; c++){if(alttype==15-Math.pow(2,c)){axis="T"}};
			if(alttype==15){axis="O"};

			if(axis=="H"){

			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S"){type+=2};
			if(type>0){type+=Biome};


			}else if(axis=="V"){

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S"){type+=2};
			if(type>0){type+=Biome};

			}else if(axis=="T"){
				type="";
				if(alttype==14){type="A"};
				if(alttype==13){type="B"};
				if(alttype==11){type="C"};
				if(alttype==7){type="D"};


			}else if(axis=="O"){
				type="";

			};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+axis+type+".PNG";
			document.getElementById(TileAdress).style.top=Terrain[Map[a][b]].Offset+"px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "B":
			var type=0;
			
			/*if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || a==0){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || b==0){type+=8};*/

			if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			if(a>1 && b>1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D2].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D4].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "S":
			//To do: Manipulate underlying terrain to be a proper road, not a grass tile
			let undertype=0;
			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){undertype+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){undertype+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){undertype+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){undertype+=8};


			//EditorControlMap[a][b]=EditationColor;
			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Road"+undertype+Biome+".PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			//console.log(Factions[ControlMap[a][b]].ChromaCode);
			document.getElementById(Strucdress).style.filter=Factions[ControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;

			break;
		}


	};
function GhostAttack(TargetInd,TargetX,TargetY,DMG,Anim){

	if((TargetInd??0)!=0){
		//alert(DMG);
		rostermap[MapRoster[TargetInd].x][MapRoster[TargetInd].y].life-=DMG;
		AttackingAnimation(Interceptor);
		HitAnimation(TargetInd,Anim);
		if(rostermap[MapRoster[TargetInd].x][MapRoster[TargetInd].y].life<=0){UnitLost(TargetInd)};

		}else{

		if(rostermap[TargetX][TargetY]!=0){
			rostermap[TargetX][TargetY].life-=DMG;
			//alert(rostermap[TargetX][TargetY].index);
			HitAnimation(rostermap[TargetX][TargetY].index,Anim);
			if(rostermap[TargetX][TargetY].life<=0){UnitLost(rostermap[TargetX][TargetY].index)};

		}else{
			HitAnimation({stt:"Temporary",x:TargetX??0,y:TargetY??0},Anim);

		};
	};};
function GeneralInitializer(){


	//This does the scaling
	let ScreenRatio=Math.round(window.innerHeight/7);
	//alert(ScreenRatio);
	//document.getElementById("BODY").style.scale=Math.round(ScreenRatio/25)/5;
	//document.getElementById("BODY").style.scale=0.8;
	document.getElementById("BODY").style.left=(window.innerHeight-700)/2+"px";

	//if(Language!=ENG){LanguageCorrecter(Language)};

	//for(let o=1; o<=70; o++){CampaignUnits[o].name=Language.UnitNames[o]};
	document.getElementById("AphorismText").innerHTML='"'+Language.InitializerAphorisms[Aphorism*2]+'"'+"<br><br>"+Language.InitializerAphorisms[Aphorism*2+1];
	document.getElementById("PreloaderSplash").innerHTML=Language.LoaderSoundbites[Math.floor(Math.random()*Language.LoaderSoundbites.length)];
 	//This pretranslates the strings
	document.getElementById("CampaignButtonP").innerHTML=Language.SystemTerms[6];
	document.getElementById("BootCampButtonP").innerHTML=Language.SystemTerms[7];
	document.getElementById("ContinueButtonP").innerHTML=Language.SystemTerms[8];
	document.getElementById("OptionsButtonP").innerHTML=Language.SystemTerms[9];
	document.getElementById("CreditsButtonP").innerHTML=Language.SystemTerms[10];
	document.getElementById("BonusLevelsButtonP").innerHTML=Language.SystemTerms[11];
	document.getElementById("ConquestButtonP").innerHTML=Language.SystemTerms[12];
	document.getElementById("LevelEditorButtonP").innerHTML=Language.SystemTerms[13];
	document.getElementById("CodexButtonP").innerHTML=Language.SystemTerms[14];

	for(let g=1; g<=10; g++){document.getElementById('Tutorial'+g+"P").innerHTML=Language.SystemTerms[53+g]};
	document.getElementById("PlayTutorialP").innerHTML=Language.SystemTerms[17];
	for(let h=1;h<=7;h++){document.getElementById("BonusP"+h).innerHTML=Language.SystemTerms[93+h]};
	document.getElementById("PlayBonusP").innerHTML=Language.SystemTerms[17];	
	document.getElementById("Special Level Name").innerHTML=Language.SystemTerms[75];
	document.getElementById("Special Level Description").innerHTML=Language.SystemTerms[76];

	document.getElementById("GenerateEditorMap").innerHTML=Language.SystemTerms[64];
	document.getElementById("TestMapP").innerHTML=Language.SystemTerms[73];
	for(let i=1;i<=8;i++){document.getElementById("EditorP"+i).innerHTML=Language.SystemTerms[64+i]};
	document.getElementById("RegionNodeOwnerP").innerHTML=Language.SystemTerms[79];
	document.getElementById("RegionNodeCapitolP").innerHTML=Language.SystemTerms[80];
	document.getElementById("RegionNodeNameP").innerHTML=Language.SystemTerms[81];
	document.getElementById("RegionApplyP").innerHTML=Language.SystemTerms[83];	
	document.getElementById("MetadataNameP").innerHTML=Language.SystemTerms[75];
	document.getElementById("MetadataDescP").innerHTML=Language.SystemTerms[76];
	document.getElementById("MetadataHealthP").innerHTML=Language.SystemTerms[77];
	document.getElementById("MetadataMoraleP").innerHTML=Language.SystemTerms[78];
	document.getElementById("MetadataApplyP").innerHTML=Language.SystemTerms[82];

	document.getElementById("NationName").innerHTML=Language.SystemTerms[30];
	document.getElementById("FactionName").innerHTML=Language.SystemTerms[31];
	document.getElementById("NationStatusName").innerHTML=Language.SystemTerms[18];
	document.getElementById("NationSynopsis").innerHTML=Language.SystemTerms[32];
	document.getElementById("CampaignSelectedText").innerHTML=Language.SystemTerms[16];

	document.getElementById("CampaignDifficultyP").innerHTML=Language.SystemTerms[40];
	for(let j=1;j<=7;j++){document.getElementById("Chp"+j+"text").innerHTML=Language.SystemTerms[32+j]};
	document.getElementById("Diff1Text").innerHTML=Language.SystemTerms[141];
	document.getElementById("Diff2Text").innerHTML=Language.SystemTerms[142];
	document.getElementById("Diff3Text").innerHTML=Language.SystemTerms[143];
	document.getElementById("BtnSuperscript").innerHTML=Language.SystemTerms[137];

	document.getElementById("HPHeader").innerHTML=Language.SystemTerms[44];
	document.getElementById("DamageHeader").innerHTML=Language.SystemTerms[45];
	document.getElementById("MovementHeader").innerHTML=Language.SystemTerms[46];
	document.getElementById("DialogueSkipP").innerHTML=Language.SystemTerms[22];

	document.getElementById("MontreArmorP").innerHTML=Language.SystemTerms[44];
	document.getElementById("MontreDamageP").innerHTML=Language.SystemTerms[45];
	document.getElementById("MontreMovementP").innerHTML=Language.SystemTerms[46];

	document.getElementById("UnitType2").innerHTML=Language.SystemTerms[117];
	document.getElementById("UnitType3").innerHTML=Language.SystemTerms[118];
	document.getElementById("UnitType4").innerHTML=Language.SystemTerms[119];

	for(let k=1;k<=5;k++){CampaignFactions[k].name=Language.NationNames[k]};};
function GenerateRevenue(Value,X,Y){
	let moola=setInterval(flashcard,20);
	let phase=0;
	let floater=document.createElement("p");
	floater.style.position="absolute";
	floater.id="Floater"+X+"X"+Y;
	floater.style.top=56*X+"px";
	floater.style.left=56*Y+"px";
	floater.style.width="56px";
	floater.style.textAlign="center";
	floater.style.color="gold";
	floater.style.zIndex=6;
	floater.style.textShadow="3px 3px 3px gold";
	//floater.style.borderStyle="groove";
	//floater.style.borderColor="blue";
	if(Value>0){floater.innerHTML="£"+Value};
	function flashcard(){phase++;
	if(phase==1){ 
		document.getElementById("UnitMap").appendChild(floater);

	};
	floater.style.top=56*X-2*phase+"px";


	if(phase==20){
		document.getElementById("UnitMap").removeChild(floater);
	clearInterval(moola);};
	};

	return Value};
function hasCertainTrait(UnitType,necessaryTrait){
	glossary=Units[UnitType]??Units[63];
	//if((glossary??0)==0){return false};
	if(glossary.tag1==necessaryTrait){return true};
	if(glossary.tag2==necessaryTrait){return true};
	if(glossary.tag3==necessaryTrait){return true};
	if(glossary.tag4==necessaryTrait){return true};

	return false;};
function HitAnimation(Target,Variant){
	let ics=0;
	let igrec=0;
	if((Target.stt??"Definitive")=="Temporary"){ics=Target.x; igrec=Target.y}else{ics=MapRoster[Target].x-StandardX;igrec=MapRoster[Target].y-StandardY;};
	if(Variant=="Standard"){src="StandardHitAnim"};
	if(Variant=="Supply"){src="SupplyHitAnim"};
	if(Variant=="Gaswave"){src="GasHitAnim"};
	if(Variant=="Neutron Wave"){src="NeutronHitAnim"};

	//alert(ics+" "+igrec);

	let HitAnim=document.createElement("img");
	HitAnim.src="Assets/Units/"+src+".gif";
	HitAnim.id="HitAnimationGFX";
	HitAnim.style.position="absolute";
	HitAnim.style.visibility="visible";
	HitAnim.style.zIndex=5;
	HitAnim.style.width="56px";
	HitAnim.style.height="56px";
	HitAnim.style.top=ics*56+"px";
	HitAnim.style.left=igrec*56+"px";
	if(Variant=="Gaswave"){
	HitAnim.style.width="168px";
	HitAnim.style.height="168px";
	HitAnim.style.top=ics*56-56+"px";
	HitAnim.style.left=igrec*56-56+"px";
	};

	let castTimee=setInterval(HitAnima,500);
	let frame=0;
	function HitAnima(){
		frame++;
		if(frame==1){document.getElementById("UnitMap").appendChild(HitAnim);

		}

		if(frame==2){
			document.getElementById("UnitMap").removeChild(HitAnim);
			clearInterval(castTimee);
		}
		}};
function hideTraitDetail(){
	document.getElementById("TraitTooltip").style.visibility="hidden";};
function HoverBuilding(Phase,Building){
	let slot="BuildingMontre"+(Building-60);
	if(Phase=="on"){
		document.getElementById(slot).style.top=7+(Units[Building].AttackOffsetY ?? [0,0,0,0,0])[3]+"px";
		document.getElementById(slot).style.left=14+(Units[Building].AttackOffsetX ?? [0,0,0,0,0])[3]+"px";
		document.getElementById(slot).src="Assets/Units/Attack/"+Units[Building].shortname+"Attack3.GIF";

	}else{

		document.getElementById(slot).style.top=7+(Units[Building].StaticOffsetY ?? [0,0,0,0,0])[3]+"px";
		document.getElementById(slot).style.left=14+(Units[Building].StaticOffsetX ?? [0,0,0,0,0])[3]+"px";
		document.getElementById(slot).src="Assets/Units/Static/"+Units[Building].shortname+"3.PNG";

	};};
function initializeBattle(Faction,Chapter,Mission){

	if(MusicChoice){MainTheme.pause();};

	//This block runs pre-functions characteristic to the specific level

	wipeMap();
	ChosenNation=Faction;
	ChosenChapter=Chapter;
	ChosenMission=Mission;
	isAITurn=false;
	BattleEnd=true;
	Resolution=false;
	FieldMode="Battle";
	Chuchu=0;

	Map=Campaigns[Faction-1][Chapter-1][Mission-1].Map;
	Roster=Campaigns[Faction-1][Chapter-1][Mission-1].Roster;
	Constants=Campaigns[Faction-1][Chapter-1][Mission-1].Constants;
	ControlMap=Campaigns[Faction-1][Chapter-1][Mission-1].ControlMap ?? [0];
	RegionMap=Campaigns[Faction-1][Chapter-1][Mission-1].RegionMap ?? [0];
	NodeMap=Campaigns[Faction-1][Chapter-1][Mission-1].NodeMap ?? [0];
	BiomeMap=Campaigns[Faction-1][Chapter-1][Mission-1].BiomeMap;

	//if(Map.length*Map[0].length>500){document.getElementById("Disclaimer2").style.visibility="visible"};

	if((BiomeMap??0)==0){BiomeMap=[]; let BiomeLine=[];for(let b=0; b<Map[0].length;b++){BiomeLine[BiomeLine.length]=1}; for(let a=0; a<Map.length;a++){BiomeMap[BiomeMap.length]=BiomeLine}};
	//alert(BiomeMap);
	sstandardX=Constants.defaultX;
	sstandardY=Constants.defaultY;
	DynamicEvents=[];
	ChosenMap=Map;
	Factions=CampaignFactions;
	YourMoney=(Campaigns[Faction-1][Chapter-1][Mission-1].Constants.Funds??[0,0])[1];
	//alert(Faction+" "+Chapter+" "+Mission);
	//alert(YourMoney);
	Prelogue=Language.Prelogues[ChosenNation][ChosenChapter-1][ChosenMission-1];
	Postlogue=Language.Postlogues[ChosenNation][ChosenChapter-1][ChosenMission-1];
	Interjection=Language.DefeatInterjections[ChosenNation][ChosenChapter-1][ChosenMission-1];


	castMap();

	KillingUnit=false;
	GlassPanels=2;
	document.getElementById('UnitMap').scrollBy(-Map.length*56,-Map[0].length*56);
	document.getElementById('UnitMap').scrollBy((sstandardX??0)*56,(sstandardY??0)*56);
	document.getElementById('Glassplate3').style.visibility='hidden';
	document.getElementById('Glassplate4').style.visibility='hidden';
	if(Constants.Commanders.length>3){GlassPanels++;document.getElementById('Glassplate3').style.visibility='inherit'};
	if(Constants.Commanders.length>4){GlassPanels++;document.getElementById('Glassplate4').style.visibility='inherit'};

	if(Map.length>10){
		document.getElementById('TopScrollBar').style.zIndex="5";
		document.getElementById('BottomScrollBar').style.zIndex="5";
		}else{
		document.getElementById('TopScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('TopScrollBar').style.zIndex="0";
		document.getElementById('BottomScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('BottomScrollBar').style.zIndex="0";
		};
	if(Map[0].length>10){
		document.getElementById('LeftScrollBar').style.zIndex="5";
		document.getElementById('RightScrollBar').style.zIndex="5";
		}else{
		document.getElementById('LeftScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('LeftScrollBar').style.zIndex="0";
		document.getElementById('RightScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('RightScrollBar').style.zIndex="0";
	};
	/*

	FlagMap=[];
	let FlagCell=[];
	for(let x=0;x<Map[0].length;x++){FlagCell[FlagCell.length]=0};
	for(let y=0;y<Map.length;y++){FlagMap[FlagMap.length]=FlagCell};
	FlagMap=JSON.parse(JSON.stringify(FlagMap));

	*/

	for(let i=1;i<=10;i++){for(let j=1;j<=10;j++){
	document.getElementById("Entity "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Structure "+i+"X"+j).style.visibility="hidden";
	}};

	document.getElementById("Battlemap").style.visibility="visible";
	FillMap(Map);
	//drawMap(Map);
	CastEntityMap(Map,Roster);
	/*
	for(let a=0;a<Constants.Capture.length;a++){FlagMap[Constants.Capture[a].x][Constants.Capture[a].y]=1};
	for(let a=0;a<Constants.Defend.length;a++){FlagMap[Constants.Defend[a].x][Constants.Defend[a].y]=2};
	for(let a=0;a<Constants.Defeat.length;a++){FlagMap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y]=3};
	for(let a=0;a<Constants.Protect.length;a++){FlagMap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y]=4};
		*/

	let OST=0;
	if(Mission==5){OST=1};
	if(Faction==1 && Mission!=5){OST=4};
	if(Faction==1 && Mission==5){OST=5};
	if(Faction==1 && Chapter>2){OST=6};
	if(Faction==1 && Chapter==3 && Mission==5){OST=3};
	if(Faction==2 && Mission!=5){OST=12};
	if(Faction==2 && Mission==5){OST=13};
	if(Faction==3){OST=18};
	if(Faction==3 && Chapter>1){OST=19};
	if(Faction==3 && Mission==5){OST=20};


	if(Faction==4){OST=23};
	if(Faction==4 && Chapter>1){OST=24};
	if(Faction==4 && Chapter==3 && Mission==5){OST=25};
	if(Faction==4 && Chapter>3){OST=26};
	if(Faction==4 && Chapter==4 && Mission==5){OST=27};
	if(Faction==4 && Chapter==5 && Mission==5){OST=28};
	if(Faction==5){OST=29};
	if(Faction==5 && Chapter>2){OST=30};
	if(Faction==5 && Chapter>2 && Mission==5){OST=31};
	if(Faction==5 && Chapter==5){OST=32};
	if(Faction==5 && Chapter==5 && Mission==5){OST=33};

	if((Constants.OST??0)!=0){OST=Constants.OST};

	if(MusicChoice){PlayBGM(OST);};
	
	if(DialogueChoice){launchDialogueBloc(Language.Prelogues[Faction][Chapter-1][Mission-1],0)};

	//This deals with the localization

	LocalizationMap=[];
	let LocLine=[];
	Localization=Campaigns[Faction-1][Chapter-1][Mission-1].Localization??{};
	for(let x=0;x<Map[0].length;x++){LocLine[LocLine.length]=0};
	for(let y=0;y<Map.length;y++){LocalizationMap[LocalizationMap.length]=JSON.parse(JSON.stringify(LocLine))};
	for(let z=0;z<Localization.length;z++){LocalizationMap[Localization[z].X][Localization[z].Y]=Localization[z]};


	//This block initializes the faction list
	PlayerChoiceFaction=Constants.YourFaction;
	//alert(PlayerChoiceFaction);
	AttackOrder=[PlayerChoiceFaction];
	SubRosters=[];
	for(let p=1;p<Roster.length;p++){
	let checker=1;
	for(let r=0;r<AttackOrder.length;r++){if(Roster[p].faction==AttackOrder[r]){checker=0;}};
	if(checker){AttackOrder[AttackOrder.length]=Roster[p].faction};};

	AliveFactionList=JSON.parse(JSON.stringify(AttackOrder));

	//alert(AttackOrder[3]);

	//This function builds up a list of subrosters
	for(x=0;x<AttackOrder.length;x++){
		SubRoster=[];
	for(y=1;y<MapRoster.length;y++){
		if(MapRoster[y].faction==AttackOrder[x]){SubRoster[SubRoster.length]=MapRoster[y]};};

	SubRosters[SubRosters.length]=SubRoster;};

	//alert(SubRosters[0]);

	//This code block generates battleflags

	let FlagMap=[];
	let FlagCell=[];
	for(let x=0;x<Map[0].length;x++){FlagCell[FlagCell.length]=0};
	for(let y=0;y<Map.length;y++){FlagMap[FlagMap.length]=FlagCell};
	TileFlagMap=JSON.parse(JSON.stringify(FlagMap));
	//let UnitFlagMap=JSON.parse(JSON.stringify(FlagMap));

	for(let a=0;a<Constants.Capture.length;a++){TileFlagMap[Constants.Capture[a].x][Constants.Capture[a].y]=1};
	for(let a=0;a<Constants.Defend.length;a++){TileFlagMap[Constants.Defend[a].x][Constants.Defend[a].y]=2};
	for(let a=0;a<Constants.Defeat.length;a++){//UnitFlagMap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y]=3;
		MapRoster[Constants.Defeat[a]].Defeat=true;rostermap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y].Defeat=true};
	for(let a=0;a<Constants.Protect.length;a++){//UnitFlagMap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y]=4;
		MapRoster[Constants.Protect[a]].Protect=true;rostermap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y].Protect=true};

		

	for (let dick=0; dick<Map.length; dick++){for(let cunt=0; cunt<Map[0].length; cunt++){
		if(TileFlagMap[dick][cunt]!=0){//alert("Chuchu");
		document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).style.visibility='inherit';
		if(TileFlagMap[dick][cunt]==1){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/CaptureFlag.PNG"};
		if(TileFlagMap[dick][cunt]==2){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/DefendFlag.PNG"};
		//if(UnitFlagMap[dick][cunt]==3){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/DestroyFlag.PNG"};
		//if(UnitFlagMap[dick][cunt]==4){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/ProtectFlag.PNG"};
	}

		}};

	Turn=0;
	TurnIndex=0;

	EndTurn(SubRosters,Map,Constants,Roster);};
function initializeSpecialBattle(Level){
	if(MusicChoice && (MainTheme??0)!=0){MainTheme.pause();};

	wipeMap();
	Map=Level.Map;
	Roster=Level.Roster;
	Constants=Level.Constants;
	ControlMap=Level.ControlMap ?? [0];
	RegionMap=Level.RegionMap;
	NodeMap=Level.NodeMap;
	Factions=Level.Factions;
	DynamicEvents=Level.DynamicEvents??[];
	sstandardX=Constants.defaultX;
	sstandardY=Constants.defaultY;
	ChosenMission=0;
	ChosenChapter=0;
	ChosenNation=0;
	ChosenMap=Map;
	isAITurn=false;
	BattleEnd=true;
	YourMoney=Constants.Funds[1];
	Resolution=false;
	Victory=false;
	if(MusicChoice){PlayBGM(0);};
	FieldMode="Battle";

	BiomeMap=Level.BiomeMap;
	if((BiomeMap??0)==0){BiomeMap=[]; let BiomeLine=[];for(let b=0; b<Map[0].length;b++){BiomeLine[BiomeLine.length]=1}; for(let a=0; a<Map.length;a++){BiomeMap[BiomeMap.length]=BiomeLine}};


	castMap();

	KillingUnit=false;
	GlassPanels=2;
	//alert(StandardX);
	//document.getElementById("UnitMap").scrollTop=(sstandardX??0)*56;
	//let Varza=0;
	//document.getElementById("UnitMap").scrollLeft=(sstandardY??0)*56;
	//alert(document.getElementById("UnitMap").scrollTop+" "+document.getElementById("UnitMap").scrollLeft+" "+sstandardX+" "+sstandardY);

	document.getElementById('UnitMap').scrollBy(-Map.length*56,-Map[0].length*56);
	document.getElementById('UnitMap').scrollBy((sstandardX??0)*56,(sstandardY??0)*56);
	document.getElementById('Glassplate3').style.visibility='hidden';
	document.getElementById('Glassplate4').style.visibility='hidden';
	if(Constants.Commanders.length>3){GlassPanels++;document.getElementById('Glassplate3').style.visibility='inherit'};
	if(Constants.Commanders.length>4){GlassPanels++;document.getElementById('Glassplate4').style.visibility='inherit'};
	//alert(Map.length+" "+Map[0].length);


	for(let i=1;i<=Map.length;i++){for(let j=1;j<=Map[0].length;j++){
	document.getElementById("Entity "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Marker "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Canceler "+i+"X"+j).style.visibility="hidden";
	document.getElementById("Structure "+i+"X"+j).style.visibility="hidden";
	}};

	if(Map.length>10){
		document.getElementById('TopScrollBar').style.zIndex="5";
		document.getElementById('BottomScrollBar').style.zIndex="5";
		}else{
		document.getElementById('TopScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('TopScrollBar').style.zIndex="0";
		document.getElementById('BottomScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('BottomScrollBar').style.zIndex="0";
		};
	if(Map[0].length>10){
		document.getElementById('LeftScrollBar').style.zIndex="5";
		document.getElementById('RightScrollBar').style.zIndex="5";
		}else{
		document.getElementById('LeftScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('LeftScrollBar').style.zIndex="0";
		document.getElementById('RightScrollBar').src="Assets/Miscellaneous/Nothing.PNG";
		document.getElementById('RightScrollBar').style.zIndex="0";
	};

	//alert(Constants.YourFaction);

	Factions=Level.Factions;
	Units=Level.Units;
	Terrain=Level.Terrain;


	if((Constants.AttackerFaction??[]).length>0){
	DaoLedger=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
	for(let a=0;a<Constants.Commanders.length;a++){Stance="Defender";
		for(let b=0;b<Constants.AttackerFaction.length;b++){if(Factions[Constants.Commanders[a].Allegiance].faction==Constants.AttackerFaction[b]){Stance="Attacker"}};
		Stance=="Defender"?DaoLedger[Constants.Commanders[a].Allegiance]=Constants.DefensiveDao[a]:DaoLedger[Constants.Commanders[a].Allegiance]=Constants.OffensiveDao[a]};

	for(let c=1;c<Roster.length;c++){Roster[c].morale=Math.min(Math.max(Roster[c].morale+Math.round(DaoLedger[Roster[c].faction]/2),-4),5)};};

	document.getElementById("Battlemap").style.visibility="visible";
	FillMap(Map);
	CastEntityMap(Map,Roster);



	//This deals with the localization

	LocalizationMap=[];
	let LocLine=[];
	Localization=Level.Localization??{};
	for(let x=0;x<Map[0].length;x++){LocLine[LocLine.length]=0};
	for(let y=0;y<Map.length;y++){LocalizationMap[LocalizationMap.length]=JSON.parse(JSON.stringify(LocLine))};
	for(let z=0;z<Localization.length;z++){LocalizationMap[Localization[z].X][Localization[z].Y]=Localization[z]};



	//if(DialogueChoice){launchDialogueBloc(Language.Prelogues[Faction][Chapter-1][Mission-1],0)};

	if(NivelElectiv??false){PlayerChoiceFaction=Level.Constants.Commanders[NivelElectiv].Allegiance}else{PlayerChoiceFaction=Constants.YourFaction};

	Prelogue=Level.Prelogue??"";
	Postlogue=Level.Postlogue??"";
	Interjection=Level.Interjection??"";
	if(DialogueChoice){launchDialogueBloc(Prelogue,0);};

	AttackOrder=[PlayerChoiceFaction];
	SubRosters=[];
	for(let p=1;p<Roster.length;p++){
	let checker=1;
	for(let r=0;r<AttackOrder.length;r++){if(Roster[p].faction==AttackOrder[r]){checker=0;}};
	if(checker){AttackOrder[AttackOrder.length]=Roster[p].faction};};

	AliveFactionList=JSON.parse(JSON.stringify(AttackOrder));

	for(x=0;x<AttackOrder.length;x++){
		SubRoster=[];
	for(y=1;y<MapRoster.length;y++){
		if(MapRoster[y].faction==AttackOrder[x]){SubRoster[SubRoster.length]=MapRoster[y]};};

	SubRosters[SubRosters.length]=SubRoster;};

	//alert(SubRosters[0][0].life);

	//This code block generates battleflags

	let FlagMap=[];
	let FlagCell=[];
	for(let x=0;x<Map[0].length;x++){FlagCell[FlagCell.length]=0};
	for(let y=0;y<Map.length;y++){FlagMap[FlagMap.length]=FlagCell};
	TileFlagMap=JSON.parse(JSON.stringify(FlagMap));
	//let UnitFlagMap=JSON.parse(JSON.stringify(FlagMap));

	for(let a=0;a<Constants.Capture.length;a++){TileFlagMap[Constants.Capture[a].x][Constants.Capture[a].y]=1};
	for(let a=0;a<Constants.Defend.length;a++){TileFlagMap[Constants.Defend[a].x][Constants.Defend[a].y]=2};
	for(let a=0;a<Constants.Defeat.length;a++){//UnitFlagMap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y]=3;
		MapRoster[Constants.Defeat[a]].Defeat=true;rostermap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y].Defeat=true};
	for(let a=0;a<Constants.Protect.length;a++){//UnitFlagMap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y]=4;
		MapRoster[Constants.Protect[a]].Protect=true;rostermap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y].Protect=true};

		

	for (let dick=0; dick<Map.length; dick++){for(let cunt=0; cunt<Map[0].length; cunt++){
		if(TileFlagMap[dick][cunt]!=0){//alert("Chuchu");
		document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).style.visibility='inherit';
		if(TileFlagMap[dick][cunt]==1){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/CaptureFlag.PNG"};
		if(TileFlagMap[dick][cunt]==2){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/DefendFlag.PNG"};
		//if(UnitFlagMap[dick][cunt]==3){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/DestroyFlag.PNG"};
		//if(UnitFlagMap[dick][cunt]==4){document.getElementById("Flag "+(dick+1)+"X"+(cunt+1)).src="Assets/Miscellaneous/ProtectFlag.PNG"};
	}

		}};

	Turn=0;
	TurnIndex=0;

	EndTurn(SubRosters,Map,Constants,Roster);
	};
function Inspection(Turn,Constants,Roster){
	let Resolution=false;
	let Survive=Constants.Survival;
	let TimeLimit=Constants.TimeLimit;
	let Factiones=[];
	let AliveFactions=[];
	let Assassinated=Constants.Defeat.length;
	let YourFaction=Factions[Constants.YourFaction].faction;
	//let chuchu=Roster[1].faction;
	//alert(Factions[1].faction);
	//alert(Roster);
	Roster=MapRoster;
	Factiones[0]=Factions[Roster[1].faction].faction;
	//alert(Factiones[0]);
	if(Turn>=TimeLimit){Resolution=true; Victory=false;};
	if(Turn>=Survive){Resolution=true; Victory=true;};

	for(let i=2;i<Roster.length;i++){
		let FactionNotIncluded=true;
	for(let j=0;j<=Factiones.length;j++){
	if(Factiones[j]==(Factions[Roster[i].faction].faction)){FactionNotIncluded=false;};
	};
	if(FactionNotIncluded){
		Factiones[Factiones.length]=Factions[Roster[i].faction].faction};
	};

	//console.log(MapRoster);
	for(let i=1;i<=Factiones.length;i++){
		let FactionIsStillAlive=false;
		for(let j=1;j<Roster.length;j++){
			//alert(Roster.length);
			//alert(MapRoster[j-1].life);
		if(Factions[Roster[j].faction].faction == Factiones[i-1] && MapRoster[j].life>0 && !hasCertainTrait(MapRoster[j].unitType,"Inertial")){
			FactionIsStillAlive=true};
		};
		if(FactionIsStillAlive){AliveFactions[AliveFactions.length]=Factiones[i-1]};};

		//alert(AliveFactions[1]);
		if(AliveFactions.length==1){Resolution=true;
		if(AliveFactions[0]==YourFaction){Victory=true}else{Victory=false;}};


	for(let i=0;i<Constants.Capture.length;i++){
		if(rostermap[Constants.Capture[i].x][Constants.Capture[i].y]!=0 && Factions[rostermap[Constants.Capture[i].x][Constants.Capture[i].y].faction].faction==Factions[Constants.YourFaction].faction){Resolution=true; Victory=true};
		};

	for(let i=0;i<Constants.Defend.length;i++){
		if(rostermap[Constants.Defend[i].x][Constants.Defend[i].y]!=0 && Factions[rostermap[Constants.Defend[i].x][Constants.Defend[i].y].faction].faction!=Factions[Constants.YourFaction].faction){Resolution=true; Victory=false};
		};


	for(let i=0;i<Constants.Defeat.length;i++){
	if(MapRoster[Constants.Defeat[i]].life<=0){Assassinated-=1;};};
	if(Assassinated==0 && Constants.Defeat.length!=0){Resolution=true;Victory=true;};

	for(let i=0;i<Constants.Protect.length;i++){
	if(MapRoster[Constants.Protect[i]].life<=0){Resolution=true;Victory=false;};};

	//alert(Resolution);
	if(Resolution && BattleEnd){if(Victory){Battle_Won()}else{Battle_Lost()}};};
function InterphaseBanner(Faction,Turn){

	let banner=setInterval(flashcard,50);
	let phase=0;
	let Blurb="Assets/SFX/Blurb.mp3";
	let BlurbSound=new Audio(Blurb);
	BlurbSound.autoplay=true;
	//alert(BlurbSound.autoplay);
	BlurbSound.play();
	document.getElementById("InterphaseBanner").style.visibility="visible";
	//alert(Factions[Faction].color);
	document.getElementById("InterphaseBanner").style.borderColor=Factions[Faction].color;
	document.getElementById("InterphaseFaction").innerHTML=Factions[Faction].name;
	document.getElementById("InterphaseTurn").innerHTML="Turn:"+Turn;

	//alert(Faction);
	document.getElementById("CommanderPortrait").src="Assets/Portraits/"+Constants.Commanders[((Turn-1)%(Constants.Commanders.length-1))+1].Name+"Portrait.PNG";

	//FactionModuloIndex updating
	let FMI=JSON.parse(JSON.stringify(AliveFactionList.length));
	//if((FMI??0)!=0){alert(FMI)};


		for(let a=1; a<=4; a++){document.getElementById("Glassplate"+a).style.visibility='hidden'};
			AliveFactionList=[];

		for(let b=0; b<AttackOrder.length; b++){
			let AOC=false;


			for(c=0;c<SubRosters[b].length;c++){
				//alert(SubRosters[b][c].life!=0);
				if(SubRosters[b][c].life>0){AOC=true};
				//alert(SubRosters[AttackOrder[a]][b].life);



		}
			if(AOC){AliveFactionList[AliveFactionList.length]=AttackOrder[b]};


		};

		if(AliveFactionList.length<FMI.length){
			let TIP=TurnIndex%FMI.length;

			for(let a=0;a<AliveFactionList.length;a++){if(AliveFactionList[a]==FMI[TIP]){TurnIndex=a+1}};
			



			FMI=AliveFactionList;

			};


		//alert(AliveFactionList);

		GlassPanels=Math.min(4,AliveFactionList.length);


		//Turnindex++;
		for(let a=1; a<=GlassPanels; a++){

		document.getElementById("Glassplate"+a).style.visibility='inherit';
		//let dudeIndex=SubRosters[(Turn-2+a)%AttackOrder.length][0].faction;
		//alert(Turn);

		//This is the backup DudeIndex value
		//let dudeIndex=AliveFactionList[(TurnIndex-2+a)%AliveFactionList.length];

		let dudeIndex=AliveFactionList[(TurnIndex-2+a)%AliveFactionList.length];
		//alert(dudeIndex);

		//alert(Turn);
		//alert(dudeIndex);
		document.getElementById("Glassplatecolor"+a).style.background=Factions[dudeIndex].color;
		document.getElementById("Glassplatename"+a).innerHTML=Factions[dudeIndex].name;
		if(Factions==CampaignFactions){document.getElementById("GlassplateCrest"+a).src="Assets/Emblems/Crest"+Factions[dudeIndex].Preffix+".PNG"}else{document.getElementById("GlassplateCrest"+a).src="Assets/Emblems/CrestNON.PNG"};
		if(document.getElementById("Glassplatecolor"+a).style.background!='black'){document.getElementById("Glassplatename"+a).style.color='black'}else{document.getElementById("Glassplatename"+a).style.color='indigo'};};

		//alert(((Turn-1)%(Constants.Commanders.length-1))+1);
		
		let TurnIndexOperator=((TurnIndex-1)%(Constants.Commanders.length-1))+1;
		Commander=Constants.Commanders[TurnIndexOperator];
		//ShowCharacterBio();
		//document.getElementById("CommanderName").innerHTML=Constants.Commanders[Turnindex].Name;
		//document.getElementById("CommanderNickname").innerHTML=Constants.Commanders[Turnindex].Nickname;
		//document.getElementById("CommanderBiography").innerHTML=Constants.Commanders[Turnindex].Description;
		//document.getElementById("CommanderNickCommentary").innerHTML=Constants.Commanders[Turnindex].NicknameCommentary;


	function flashcard(){phase++;
		if(phase<5){
			document.getElementById("InterphaseField").style.height=phase*35+"px";
			document.getElementById("InterphaseField").style.marginTop=0-phase*17.5+"px";
			document.getElementById("InterphaseBanner").style.height=phase*35+"px";
			document.getElementById("InterphaseBanner").style.marginTop=-140-phase*-17.5+"px";
			document.getElementById("InterphaseFaction").style.top=-25+"px";
			document.getElementById("InterphaseTurn").style.top=0+17.5*phase+"px";
		}

		if(phase>12){
			document.getElementById("InterphaseField").style.height=(16-phase)*35+"px";
			document.getElementById("InterphaseField").style.marginTop=0-(16-phase)*17.5+"px";
			document.getElementById("InterphaseBanner").style.height=(16-phase)*35+"px";
			document.getElementById("InterphaseBanner").style.marginTop=(16-phase)*-35/2+"px";
			document.getElementById("InterphaseFaction").style.top=-25+"px";
			document.getElementById("InterphaseTurn").style.top=80-35*(phase-12)+"px";
		};

		if(phase==16){clearInterval(banner);document.getElementById("InterphaseBanner").style.visibility="hidden";};};
		//Turn=TurnIndex;

		//This bloc runs the static events
		if((Constants.Events??0)==0){
			//this is for campaign maps, from a centralized database of events
			let a=(Constants.StaticEvents??[]).length;

			for(let b=0; b<a;b++){
				let Event=Constants.StaticEvents[b];
				let TriggerEvent=false;
				if((Event.TurnTreshold??0) == Turn){TriggerEvent=true};

				if(TriggerEvent){RunEvent(Event)};

			};





		}else{
			//this is for autonomous maps, from a local database of events



		}};
function LanguageCorrecter(Language){

	if((Language.SystemTerms??[]).length==0){Language.SystemTerms=ENG.SystemTerms};
	if((Language.LoaderSoundbites??[]).length==0){Language.LoaderSoundbites=ENG.LoaderSoundbites};
	if((Language.InitializerAphorisms??[]).length==0){Language.InitializerAphorisms=ENG.InitializerAphorisms};
	if((Language.NationNames??[]).length==0){Language.NationNames=ENG.NationNames};
	if((Language.NationDesc??[]).length==0){Language.NationDesc=ENG.NationDesc};
	if((Language.StartButtonTexts??[]).length==0){Language.StartButtonTexts=ENG.StartButtonTexts};
	if((Language.UnitSpecialNames??[]).length==0){Language.UnitSpecialNames=ENG.UnitSpecialNames};
	if((Language.UnitSpecialDesc??[]).length==0){Language.UnitSpecialDesc=ENG.UnitSpecialDesc};
	if((Language.VictoryQuotes??[]).length==0){Language.VictoryQuotes=ENG.VictoryQuotes};
	if((Language.DefeatQuotes??[]).length==0){Language.DefeatQuotes=ENG.DefeatQuotes};

	if((Language.TerrainName??[]).length==0){Language.TerrainName=ENG.TerrainName};
	if((Language.TerrainDesc??[]).length==0){Language.TerrainDesc=ENG.TerrainDesc};
	if((Language.UnitNames??[]).length==0){Language.UnitNames=ENG.UnitNames};
	if((Language.UnitDesc??[]).length==0){Language.UnitDesc=ENG.UnitDesc};
	if((Language.TraitName??[]).length==0){Language.TraitName=ENG.TraitName};
	if((Language.TraitDesc??[]).length==0){Language.TraitDesc=ENG.TraitDesc};
	if((Language.ClassTraitName??[]).length==0){Language.ClassTraitName=ENG.ClassTraitName};
	if((Language.ClassTraitDesc??[]).length==0){Language.ClassTraitDesc=ENG.ClassTraitDesc};

	if((Language.ChapterName??[]).length==0){Language.ChapterName=ENG.ChapterName};
	if((Language.MissionName??[]).length==0){Language.MissionName=ENG.MissionName};
	if((Language.MissionDesc??[]).length==0){Language.MissionDesc=ENG.MissionDesc};
	if((Language.IntraeventTranscripts??[]).length==0){Language.IntraeventTranscripts=ENG.IntraeventTranscripts};
	if((Language.Interlogues??[]).length==0){Language.Interlogues=ENG.Interlogues};

	for(let a=1;a<=2;a++){for (let b=0; b<7;b++){for(let c=0;c<5;c++){
		if(Language.Prelogues[a][b][c].length==0){Language.Prelogues[a][b][c]=ENG.Prelogues[a][b][c]}
		if(Language.Postlogues[a][b][c].length==0){Language.Postlogues[a][b][c]=ENG.Postlogues[a][b][c]}
		if(Language.DefeatInterjections[a][b][c].length==0){Language.DefeatInterjections[a][b][c]=ENG.DefeatInterjections[a][b][c]}
	}}}

	for(let a=3;a<=5;a++){for (let b=0; b<5;b++){for(let c=0;c<5;c++){
		if(Language.Prelogues[a][b][c].length==0){Language.Prelogues[a][b][c]=ENG.Prelogues[a][b][c]}
		if(Language.Postlogues[a][b][c].length==0){Language.Postlogues[a][b][c]=ENG.Postlogues[a][b][c]}
		if(Language.DefeatInterjections[a][b][c].length==0){Language.DefeatInterjections[a][b][c]=ENG.DefeatInterjections[a][b][c]}
	}}}
	/* The underlying infrastructure insufficiently developed; need to handle that first. That, and to unfuck the fact that some underdeveloped languages might not tolerate this section at all
	for(let a=6;a<=10;a++){for (let b=0; b<1;b++){for(let c=0;c<5;c++){
		if(Language.Prelogues[a][b][c].length==0){Language.Prelogues[a][b][c]=ENG.Prelogues[a][b][c]}
		if(Language.Postlogues[a][b][c].length==0){Language.Postlogues[a][b][c]=ENG.Postlogues[a][b][c]}
		if(Language.DefeatInterjections[a][b][c].length==0){Language.DefeatInterjections[a][b][c]=ENG.DefeatInterjections[a][b][c]}
	}}}*/};
function launchDialogueBloc(Bloc, Frame){
	var limit=Bloc.length;
	let Proceed=Resolution;

	document.getElementById("DialogueBox").style.visibility="visible";
	document.getElementById("DialogueSkip").style.visibility="visible";
	document.getElementById("Portrait").src=("Assets/Portraits/"+Bloc[Frame]+"Portrait.PNG")??("Assets/Portraits/DefaultPortrait.PNG");
	document.getElementById("CharacterName").innerHTML=Bloc[Frame];

	//document.getElementById("DialogueInstance").innerHTML=Bloc[Frame+1];
	document.getElementById("DialogueInstance").innerHTML="";
	DialogueBank="";
	if(Frame+2<=Bloc.length){DialogueBank=Bloc[Frame+1]};
	LetterIndex=0;
	TerminusLetter=DialogueBank.length;

	let FlowWriter=setInterval(LetterDot, 5);
	//alert(Frame);
	function LetterDot(){
		let Text="";
		let a=0;
		let b=0;
		let O=0;
		let Op=0;
		if((DialogueBank[LetterIndex]??"")=="~"){O=LetterIndex;
		Op=O;
		while(DialogueBank[Op]!="~"){Op++};
		//alert(DialogueBank.substring(0,O)+"<span style='"+DialogueBank.substring(O+1,O+8)+"'>");


		};

		if((DialogueBank[LetterIndex]??"")=="<"){a=LetterIndex;
		while(DialogueBank[a]!=">"){a++};
		LetterHopPoint=a-LetterIndex;
		Text=document.getElementById("DialogueInstance").innerHTML+(DialogueBank[LetterIndex]??"");
		let X=DialogueBank.substring(LetterIndex,a+1);
		//alert(X);
		Text+="/"+X;
		LetterIndex=a;
		//alert(X);
		}else{Text=document.getElementById("DialogueInstance").innerHTML+(DialogueBank[LetterIndex]??"")};

		if(false){TrueText=DialogueBank.substring(0,O)+"<span style='"+DialogueBank.substring(O+1,O+8)+"'>"+DialogueBank.substring(0,0);}else{TrueText=Text};
		document.getElementById("DialogueInstance").innerHTML=TrueText;
		//document.getElementById("DialogueInstance").innerHTML+=DialogueBank[LetterIndex];
		LetterIndex++;
		//alert(LetterIndex+" "+TerminusLetter);


		if(LetterIndex>=TerminusLetter){document.getElementById("DialogueInstance").innerHTML=Bloc[Frame+1]; clearInterval(FlowWriter)};

	};
	if(Frame+2<=limit){document.getElementById("DialogueBox").onclick=function(){clearInterval(FlowWriter);if(LetterIndex==TerminusLetter){launchDialogueBloc(Bloc, Frame+2);}else{document.getElementById("DialogueInstance").innerHTML=Bloc[Frame+1]; clearInterval(FlowWriter); LetterIndex=TerminusLetter}};
	}else{document.getElementById("DialogueBox").onclick="";document.getElementById("DialogueBox").style.visibility="hidden"; document.getElementById("DialogueSkip").style.visibility="hidden";
	if(Proceed){setTimeout(EndBattle,1000)}};};
function LaunchConstructorPanel(X,Y){
	document.getElementById('BuildingConstructionPanel').style.visibility="visible";
	document.getElementById('BuildingConstructionPanel').style.left=Math.max(Math.min(document.getElementById("UnitMap").scrollLeft+280, Y*56-112),document.getElementById("UnitMap").scrollLeft)+"px";
	document.getElementById('BuildingConstructionPanel').style.top=Math.max(Math.min(document.getElementById("UnitMap").scrollTop+280, X*56-112),document.getElementById("UnitMap").scrollTop)+"px";

	for(let c=1;c<=8;c++){
		document.getElementById("BuildingMontre"+c).src="Assets/Units/Static/"+Units[60+c].shortname+"3.PNG";
		document.getElementById("BuildingMontre"+c).style.filter=Factions[PlayerChoiceFaction].ChromaCode;
		document.getElementById("BuildingMontre"+c).style.top=7+(Units[60+c].StaticOffsetY ?? [0,0,0,0,0])[3]+"px";
		document.getElementById("BuildingMontre"+c).style.left=14+(Units[60+c].StaticOffsetX ?? [0,0,0,0,0])[3]+"px";
		if(!Units[60+c].MLPR??false){document.getElementById("BuildingMesh"+c).style.visibility='inherit';document.getElementById("BuildingMesh"+c).src="Assets/Units/StaticMeshes/"+Units[60+c].shortname+"Mesh3.PNG"}else{document.getElementById("BuildingMesh"+c).style.visibility='hidden'};
		document.getElementById("BuildingPrice"+c).innerHTML="₱"+Units[60+c].Cost;
		CoastalCheck=true;
		if(hasCertainTrait(60+c,"Seabound")){CoastalCheck=false;CanBuildCoastal=false
			if(X>0){if(Terrain[Map[X-1][Y]].DeepSailThrough!=100){CoastalCheck=true;CanBuildCoastal=true}};
			if(X<Map.length-1){if(Terrain[Map[X+1][Y]].DeepSailThrough!=100){CoastalCheck=true;CanBuildCoastal=true}};
			if(Y>0){if(Terrain[Map[X][Y-1]].DeepSailThrough!=100){CoastalCheck=true;CanBuildCoastal=true}};
			if(X<Map[0].length-1){if(Terrain[Map[X][Y+1]].DeepSailThrough!=100){CoastalCheck=true;CanBuildCoastal=true}};

		};
		document.getElementById("BuildingFrame"+c).src="Assets/Miscellaneous/ConstructionUnavailableFrame.PNG";
		if((YourMoney??0)>=Units[60+c].Cost && CoastalCheck){document.getElementById("BuildingFrame"+c).src="Assets/Miscellaneous/ConstructionAvailableFrame.PNG"};

	//alert("Not yet bro, we don't have enough assets")
	};};
function LaunchRecruitmentPanel(IndustrialBranch){
	IndustrialBranchBrowsed=IndustrialBranch;
	document.getElementById("UnitRecruitmentPanel").style.visibility="visible";
	let YourCurrency=(Factions[PlayerChoiceFaction].Currency??0);
	document.getElementById("MoneyIndicator").innerHTML="₤"+YourMoney;
	if((Factions[PlayerChoiceFaction].ExchangeRate??0)!=0){document.getElementById("MoneyIndicator").innerHTML+="("+YourCurrency+YourMoney*Factions[PlayerChoiceFaction].ExchangeRate+")"};

	document.getElementById("UnitMontreBkg").src="Assets/Miscellaneous/UnitMontreBkg"+IndustrialBranch+".PNG";
	document.getElementById("UnitMontre").src="Assets/Units/Static/Barricade1.PNG";
	document.getElementById("UnitMontre").style.filter=Factions[PlayerChoiceFaction].ChromaCode;;
	MontreIndexBasis=IndustrialBranch*10+20;
	if(IndustrialBranch==1){MontreIndexBasis-=30};
	Speciation=0;
	CostFactor=1;
	for(let i=-2; i<3;i++){document.getElementById("MoraleParticulator"+i).src="Assets/Traits/Morale0.PNG"};

	let InfantrySelection=Factions[PlayerChoiceFaction].SpecialInfantry;
	let VehicleSelection=Factions[PlayerChoiceFaction].SpecialVehicles;


	for(let p=1;p<=40;p++){
		
	document.getElementById("UnitMontre"+p).style.filter=Factions[PlayerChoiceFaction].ChromaCode;
	if(p<=10 || IndustrialBranch==1){
		if(!Units[MontreIndexBasis+p].MLPR??false){document.getElementById("UnitMontre"+p+"Mesh").style.visibility='inherit';document.getElementById("UnitMontre"+p+"Mesh").src="Assets/Units/StaticMeshes/"+Units[MontreIndexBasis+p].shortname+"Mesh3.PNG"}else{document.getElementById("UnitMontre"+p+"Mesh").style.visibility='hidden'}

		};
		

	//alert(MontreIndexBasis+p);
	let SpeciatorMontre=Units[Math.min(MontreIndexBasis+p,70)].shortname??false;
	if(!SpeciatorMontre){document.getElementById("Obturator"+p).style.visibility="visible"}else{document.getElementById("Obturator"+p).style.visibility="hidden"};


	if(p<11){
		//document.getElementById('Obturator'+p).style.visibility='hidden';
		document.getElementById('PriceTag'+p).style.visibility='inherit';
		document.getElementById('UnitMontre'+p).style.visibility='inherit';
		document.getElementById('UnitFrame'+p).style.visibility='inherit';
		document.getElementById('UnitUnderlayer'+p).style.visibility='inherit';

		document.getElementById("PriceTag"+p).innerHTML="₤"+Units[MontreIndexBasis+p].Cost;
		document.getElementById("UnitMontre"+p).src="Assets/Units/Static/"+Units[MontreIndexBasis+p].shortname+"3.PNG";
		document.getElementById("UnitMontre"+p).style.left=(Units[MontreIndexBasis+p].StaticOffsetX ?? [0,0,0,0,0])[3]+23+(p-1)*100+"px";
		document.getElementById("UnitMontre"+p).style.top=(Units[MontreIndexBasis+p].StaticOffsetY ?? [0,0,0,0,0])[3]+195+"px";
		if(YourMoney<Units[p+MontreIndexBasis].Cost){document.getElementById("UnitFrame"+p).src="Assets/Miscellaneous/UnitUnavailableFrame.PNG"}else{document.getElementById("UnitFrame"+p).src="Assets/Miscellaneous/UnitAvailableFrame.PNG"}


		
	

	}else{

		document.getElementById("PriceTag"+p).innerHTML="₱"+Units[p].Cost;
		if(YourMoney<Units[p].Cost){document.getElementById("UnitFrame"+p).src="Assets/Miscellaneous/UnitUnavailableFrame.PNG"}else{document.getElementById("UnitFrame"+p).src="Assets/Miscellaneous/UnitAvailableFrame.PNG"};

		//document.getElementById("UnitMontre"+p).style.left="0px";
		document.getElementById("UnitMontre"+p).style.top=(195+130*Math.floor((p-1)/10)+(Units[p].StaticOffsetY ?? [0,0,0,0,0])[3])+"px";


		if(IndustrialBranch!=1){document.getElementById("Obturator"+p).style.visibility="hidden";
		document.getElementById("UnitFrame"+p).style.visibility="hidden";
		document.getElementById("UnitUnderlayer"+p).style.visibility="hidden";
		document.getElementById("UnitMontre"+p).style.visibility="hidden";
		document.getElementById("PriceTag"+p).style.visibility="hidden"};

		if(IndustrialBranch==1){
		document.getElementById("UnitFrame"+p).style.visibility="inherit";
		document.getElementById("UnitUnderlayer"+p).style.visibility="inherit";
		document.getElementById("UnitMontre"+p).style.visibility="inherit";
		document.getElementById("PriceTag"+p).style.visibility="inherit";
		document.getElementById("UnitMontre"+p).src="Assets/Units/Static/"+Units[MontreIndexBasis+p].shortname+"3.PNG";

		}

		
		};



		};

	if(IndustrialBranch==3){document.getElementById("UnitType1").innerHTML=Language.SystemTerms[121];};
	if(IndustrialBranch==2){document.getElementById("Obturator10").style.visibility="visible"; document.getElementById("UnitType1").innerHTML=Language.SystemTerms[120];};
	if(IndustrialBranch==1){for(let j=2;j<=4;j++){document.getElementById("UnitTypeBar"+j).style.visibility="auto";document.getElementById("UnitType"+j).style.visibility="auto"};document.getElementById("UnitType1").innerHTML=Language.SystemTerms[116]};
	if(IndustrialBranch!=1){document.getElementById("Obturator1").style.visibility="visible"; for(let j=2;j<=4;j++){document.getElementById("UnitTypeBar"+j).style.visibility="hidden";document.getElementById("UnitType"+j).style.visibility="hidden"}}else{for(let j=2;j<=4;j++){document.getElementById("UnitTypeBar"+j).style.visibility="inherit";document.getElementById("UnitType"+j).style.visibility="inherit"}};


	if(IndustrialBranch==1){
		/*
		if(!InfantrySelection[0]){document.getElementById("Obturator8").style.visibility="visible"};
		if(!InfantrySelection[1]){document.getElementById("Obturator7").style.visibility="visible"};
		if(!InfantrySelection[2]){document.getElementById("Obturator4").style.visibility="visible"};
		if(!InfantrySelection[3]){document.getElementById("Obturator5").style.visibility="visible"};
		if(!InfantrySelection[4]){document.getElementById("Obturator6").style.visibility="visible"};
		if(!VehicleSelection[0]){document.getElementById("Obturator28").style.visibility="visible"};
		if(!VehicleSelection[1]){document.getElementById("Obturator27").style.visibility="visible"};
		if(!VehicleSelection[2]){document.getElementById("Obturator36").style.visibility="visible"};
		if(!VehicleSelection[3]){document.getElementById("Obturator15").style.visibility="visible"};
		if(!VehicleSelection[4]){document.getElementById("Obturator26").style.visibility="visible"};
		*/

		for(let u=1; u<=40; u++){let FS=Units[u].FactionSpecificity??0;
		if(FS!=0){if(!Factions[PlayerChoiceFaction].SpecialTechnology[Units[u].FactionSpecificity-1]){document.getElementById("Obturator"+u).style.visibility="visible"}};};
		};

	if(IndustrialBranch!=1){
		for(let u=MontreIndexBasis+1; u<=MontreIndexBasis+10; u++){let FS=Units[u].FactionSpecificity??0;

		if(FS!=0){if(!Factions[PlayerChoiceFaction].SpecialTechnology[Units[u].FactionSpecificity-1]){document.getElementById("Obturator"+(u-MontreIndexBasis)).style.visibility="visible"}};};
		document.getElementById("Obturator9").style.visibility="visible";
		document.getElementById("Obturator10").style.visibility="visible";
		};
	if(IndustrialBranch==1){
		for(let p=1; p<=40; p++){
		//This is a stopgap measure to make endgame units unconstructible for this version
		if(p%10==9 || p%10==0){document.getElementById("Obturator"+p).style.visibility="visible"}}};


		};
function LaunchSpecialOptionPanel(x,y){
	//alert(YourMoney>=Units[rostermap[X][Y].unitType].Cost/2);
	IsStork=false;
	IsConvoy=false;
	let isInFriendlyTerritory=false;
	document.getElementById("BuildStructureMask").style.visibility="inherit";

	let X=x;
	let Y=y;
	//alert(document.getElementById("UnitMap").scrollTop);

	UnitIcs=X;
	UnitIgrec=Y;
	document.getElementById("AirTransportPickupMask").src="Assets/Miscellaneous/StorkPickupMask.PNG";
	document.getElementById("NavalTransportPickupMask").src="Assets/Miscellaneous/ConvoyPickupMask.PNG";
	document.getElementById("SpecialActionPanel").style.visibility="visible";
	document.getElementById("SpecialActionPanel").style.left=Math.max(Math.min(-28+y*56,Map[0].length*56-115),0)+"px";
	document.getElementById("SpecialActionPanel").style.top=Math.max(Math.min(-15+x*56,Map.length*56-77),0)+"px";

	if(rostermap[X][Y]!=0 && hasCertainTrait(rostermap[X][Y].unitType, "Air Transport")){ IsStork=true; IsConvoy=false;};
	if(rostermap[X][Y]!=0 && hasCertainTrait(rostermap[X][Y].unitType, "Naval Transport")){ IsStork=false; IsConvoy=true;};
	if(IsStork){document.getElementById("AirTransportPickupMask").src="Assets/Miscellaneous/UnitDisembarkMask.PNG";document.getElementById("AirTransportPickup").src="Assets/Miscellaneous/UnitDisembark.PNG"}
	else{document.getElementById("AirTransportPickupMask").src="Assets/Miscellaneous/StorkPickupMask.PNG";document.getElementById("AirTransportPickup").src="Assets/Miscellaneous/StorkPickup.PNG"};
	if(IsConvoy){document.getElementById("NavalTransportPickupMask").src="Assets/Miscellaneous/UnitDisembarkMask.PNG";document.getElementById("NavalTransportPickup").src="Assets/Miscellaneous/UnitDisembark.PNG"}
	else{document.getElementById("NavalTransportPickupMask").src="Assets/Miscellaneous/ConvoyPickupMask.PNG";document.getElementById("NavalTransportPickup").src="Assets/Miscellaneous/ConvoyPickup.PNG"};

	

	if(YourMoney>=150 && rostermap[X][Y]!=0 && hasCertainTrait(rostermap[X][Y].unitType,"Airborne") && rostermap[X][Y].faction==PlayerChoiceFaction && !IsConvoy){document.getElementById("AirTransportPickupMask").style.visibility="hidden"}else{document.getElementById("AirTransportPickupMask").style.visibility="inherit"};
	if(YourMoney>=100 && rostermap[X][Y]!=0 && Terrain[Map[X][Y]].tag1=="Shallow" && rostermap[X][Y].faction==PlayerChoiceFaction && !IsStork){document.getElementById("NavalTransportPickupMask").style.visibility="hidden"}else{document.getElementById("NavalTransportPickupMask").style.visibility="inherit"};

	if(IsStork && Terrain[Map[X][Y]].WalkThrough<4){document.getElementById("AirTransportPickupMask").style.visibility="hidden"}else{};
	if(IsConvoy && (Terrain[Map[X][Y]].tag1=="Shallow" || Terrain[Map[X][Y]].tag2=="Shallow" || Terrain[Map[X][Y]].tag3=="Shallow" || Terrain[Map[X][Y]].tag4=="Shallow")){document.getElementById("NavalTransportPickupMask").style.visibility="hidden"}else{};

	if(rostermap[X][Y]!=0 && rostermap[X][Y].life<Units[rostermap[X][Y].unitType].HP && Factions[rostermap[X][Y].faction].faction==Factions[PlayerChoiceFaction].faction && YourMoney>=Units[rostermap[X][Y].unitType].Cost/2){document.getElementById("RepairUnitMask").style.visibility="hidden";document.getElementById("SpecialOptionCost").innerHTML="£"+Math.round(Units[rostermap[X][Y].unitType].Cost/2)}else{document.getElementById("RepairUnitMask").style.visibility="inherit"};

	if(rostermap[X][Y]==0 && Terrain[Map[X][Y]].Constructible){
		if(X>0){if(rostermap[X-1][Y].faction==PlayerChoiceFaction && rostermap[X-1][Y].speed>0){isInFriendlyTerritory=true}};
		if(X<Map.length-1){if(rostermap[X+1][Y].faction==PlayerChoiceFaction && rostermap[X+1][Y].speed>0){isInFriendlyTerritory=true}};
		if(Y>0){if(rostermap[X][Y-1].faction==PlayerChoiceFaction && rostermap[X][Y-1].speed>0){isInFriendlyTerritory=true}};
		if(Y<Map[0].length-1){if(rostermap[X][Y+1].faction==PlayerChoiceFaction && rostermap[X][Y+1].speed>0){isInFriendlyTerritory=true}};
		if(!isInFriendlyTerritory && (ControlMap??0)!=0){
			for(let i=Math.max(0,X-3);i<=Math.min(Map.length-1,X+3);i++){for(let j=Math.max(0,Y-3);j<=Math.min(Map[0].length-1,Y+3);j++){if(Terrain[Map[i][j]].Urbanistics>1 && ControlMap[i][j]==PlayerChoiceFaction){isInFriendlyTerritory=true}}}

		};

		if(isInFriendlyTerritory){
		document.getElementById("BuildStructureMask").style.visibility="hidden"}}else{document.getElementById("BuildStructureMask").style.visibility="inherit"};

	//Screw landmines, we ain't implementing them until RetrofitD has been done
		document.getElementById("LayMinesMask").style.visibility="inherit";

	};
function LevelLoader(){};
function LoadData(){
	 let decodedCookie = decodeURIComponent(document.cookie);
	 let Data= decodedCookie.split('|');

	 let LevelData=JSON.parse("["+Data[0]+"]");
	 let SettingsData=JSON.parse("["+Data[1]+"]");
	 for(let i=0;i<35;i++){Campaigns[0][Math.floor(i/5)][i%5].Finished=LevelData[i]};
	 for(let i=35;i<70;i++){Campaigns[1][Math.floor(i/5)-7][i%5].Finished=LevelData[i]};
	 for(let i=70;i<95;i++){Campaigns[2][Math.floor(i/5)-14][i%5].Finished=LevelData[i]};
	 for(let i=95;i<120;i++){Campaigns[3][Math.floor(i/5)-19][i%5].Finished=LevelData[i]};
	 for(let i=120;i<145;i++){Campaigns[4][Math.floor(i/5)-24][i%5].Finished=LevelData[i]};
	 for(let i=145;i<155;i++){Campaigns[5][Math.floor(i/5)-29][i%5].Finished=LevelData[i]};
	 for(let i=155;i<165;i++){Campaigns[6][Math.floor(i/5)-31][i%5].Finished=LevelData[i]};
	 for(let i=165;i<175;i++){Campaigns[7][Math.floor(i/5)-33][i%5].Finished=LevelData[i]};
	 for(let i=175;i<185;i++){Campaigns[8][Math.floor(i/5)-35][i%5].Finished=LevelData[i]};
	 for(let i=185;i<195;i++){Campaigns[9][Math.floor(i/5)-37][i%5].Finished=LevelData[i]};
	 for(let i=195;i<200;i++){Campaigns[10][0][i%5].Finished=LevelData[i]};


	 SoundChoice=SettingsData[0];
	 MusicChoice=SettingsData[1];
	 DialogueChoice=SettingsData[2];
	 IdleAnimChoice=SettingsData[3];
	 MystSettChoice=SettingsData[4];};
function moveOneTile(unit, direction){
	//alert(unit);
	let idem="Entity "+(MapRoster[unit].x-StandardX+1)+"X"+(MapRoster[unit].y-StandardY+1);
	//alert(idem);

	
	let x=(direction-2)*(direction%2);
	let y=(3-direction)*((direction-1)%2);
	let cellX=Units[MapRoster[unit].unitType].boxX ?? 56;
	let cellY=Units[MapRoster[unit].unitType].boxY ?? 56;
	//alert(cellX+" "+cellY)
	let castTime=setInterval(Act,100);
	let frame=0;
	function Act(){
	frame++;
		var top=(frame*cellY)+"px";
		var right=(direction*cellX)+"px";
		var bottom=(frame+1)*cellY+"px";
		var left=(direction-1)*cellX+"px";
		var coord="rect("+top+","+right+","+bottom+","+left+")";
		//document.getElementById(idem).style.visibility="hidden";
		document.getElementById(idem).style.clip=coord;
		document.getElementById(idem).src="Assets/Units/Move/"+Units[MapRoster[unit].unitType].shortname+"Movement.PNG";	
		document.getElementById(idem).style.top= -frame*56 + x*frame*14 + "px";
		document.getElementById(idem).style.left= 56-direction*56+y*frame*14 +"px";
		//document.getElementById(idem).style.visibility="visible";


	if(frame==4){
		//alert(idem);
		//document.getElementById(idem).style.visibility="hidden";
		let newX=MapRoster[unit].x+x;
		let newY=MapRoster[unit].y+y;
		//alert(newX+1-DefaultX);
		//alert(newY+1-DefaultY);

		//rostermap[MapRoster[unit].x+x][MapRoster[unit].y+y]=rostermap[MapRoster[unit].x][MapRoster[unit].y];
		//rostermap[MapRoster[unit].x][MapRoster[unit].y]=0;
		//MapRoster[unit].x=MapRoster[unit].x+x;
		//MapRoster[unit].y=MapRoster[unit].y+y;
		//document.getElementById("Entity "+(MapRoster[unit].x+1-StandardX)+"X"+(MapRoster[unit].y+1-StandardY)).style.visibility="hidden";
		//document.getElementById("Entity "+(MapRoster[unit].x+1-StandardX)+"X"+(MapRoster[unit].y+1-StandardY)).style.top="0px";
		//document.getElementById("Entity "+(MapRoster[unit].x+1-StandardX)+"X"+(MapRoster[unit].y+1-StandardY)).style.left="0px";

		//document.getElementById("Entity "+(newX+1-StandardX)+"X"+(newY+1-StandardY)).style.visibility="visible";
		//document.getElementById("Entity "+(newX+1-StandardX)+"X"+(newY+1-StandardY)).style.filter=Factions[MapRoster[unit].faction].ChromaCode;
		//document.getElementById("Entity "+(newX+1-StandardX)+"X"+(newY+1-StandardY)).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+direction+".PNG";
		document.getElementById(idem).style.top=(Units[MapRoster[unit].unitType].StaticOffsetX ?? [0,0,0,0,0])[direction]+"px";
		document.getElementById(idem).style.left=(Units[MapRoster[unit].unitType].StaticOffsetX ?? [0,0,0,0,0])[direction]+"px";	
		document.getElementById(idem).style.clip="auto";
		document.getElementById(idem).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+direction+".PNG";
		//document.getElementById(idem).style.visibility="visible";

		//alert("hi!");
		clearInterval(castTime);};
	
	};};
function moveUnit(unit, path){
	let considerX=MapRoster[unit].x;
	let considerY=MapRoster[unit].y;

	MoveSFX=new Audio("Assets/SFX/"+Units[MapRoster[unit].unitType].shortname+"Move.MP3");
	if(path.length>0){MoveSFX.play();};

	for (let wup=0;wup<path.length;wup++){
		let permission=true;
		let ics=MapRoster[unit].x;
		let igrec=MapRoster[unit].y;
		considerX+=(path[wup]-2)*(path[wup]%2);
		considerY+=(3-path[wup])*((path[wup]-1)%2);
		
		//moveOneTile(unit, path[wup])
		if(wup==0){moveOneTile(unit, path[wup])};
		if(wup>0){setTimeout(moveOneTile, 500, unit, path[wup]);};
		document.getElementById("Entity "+(ics+1-StandardX)+"X"+(igrec+1-StandardY)).style.visibility="hidden";
		};
		//if(rostermap[considerX][considerY]!=0){permission=false};


		let chuchu=rostermap[MapRoster[unit].x][MapRoster[unit].y];
		rostermap[MapRoster[unit].x][MapRoster[unit].y]=0;
		rostermap[considerX][considerY]=chuchu;
		

		document.getElementById("Entity "+(MapRoster[unit].x-StandardX+1)+"X"+(MapRoster[unit].y-StandardY+1)).style.visibility="hidden";
		MapRoster[unit].x=considerX;
		MapRoster[unit].y=considerY;

		let actualX=considerX-StandardX+1;
		let actualY=considerY-StandardY+1;

		//document.getElementById("Entity "+actualX+"X"+actualY).style.visibility="visible";
		//document.getElementById("Entity "+actualX+"X"+actualY).style.filter=Factions[MapRoster[unit].faction].ChromaCode;
		document.getElementById("Entity "+actualX+"X"+actualY).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+MapRoster[unit].direction+".PNG";};
function MoveUnit(unit, path){
	//alert(unit+" "+path);
	//if(MapRoster[unit].faction!=PlayerChoiceFaction){BLARG=0;};
	//Constants:

	let CanMove=true;


	if(path.length==0){CanMove=false};

	if(MapRoster[unit].faction==PlayerChoiceFaction){
	if(MapRoster[unit].faction==PlayerChoiceFaction && BLARG.length==1){CanMove=false};
	//if(rostermap[BLARG[BLARG.length-1].X][BLARG[BLARG.length-1].Y].coallition==Factions[PlayerChoiceFaction].faction){CanMove=false};
	if(rostermap[BLARG[BLARG.length-1].X][BLARG[BLARG.length-1].Y]!=0){CanMove=false};
	if(path[0]-1==BLARG[0].X && path[1]-1==BLARG[0].Y){CanMove=false};};
	//if(BLARG[BLARG.length-1].X==BLARG[0].X && BLARG[BLARG.length-1].Y==BLARG[0].Y){alert("Tottenham")};
	//alert(BLARG[BLARG.length-1].X+" "+BLARG[BLARG.length-1].Y);

	if(CanMove){
		let ExtranOrigin=false;
		let ExtranDestination=false;

	if(MapRoster[unit].faction==PlayerChoiceFaction && (LastMove.ID==0 || LastMove.ID!=unit)){
		LastMove.ID=unit;
		LastMove.HP=MapRoster[unit].life;
		LastMove.DIR=MapRoster[unit].direction;
		LastMove.X=MapRoster[unit].x;
		LastMove.Y=MapRoster[unit].y;
		LastMove.cloak=MapRoster[unit].isCloaked??false;
		LastMove.encore=MapRoster[unit].canEncore??false;
		LastMove.hasEngaged=true;

		//alert(LastMove.X+" "+LastMove.Y);
		};

		//if(MapRoster[unit].x<StandardX || MapRoster[unit].y<StandardY || MapRoster[unit].x>StandardX+9 || MapRoster[unit].y>StandardY+9){ExtranOrigin=true};
		let origX=MapRoster[unit].x;
		let origY=MapRoster[unit].y;
		MarkerMap[origX][origY]=0;
		let destX=MapRoster[unit].x;
		let destY=MapRoster[unit].y;

		let Path=[];
		//console.log(BLARG.length);
	if(MapRoster[unit].faction==PlayerChoiceFaction){
		if(BLARG.length==1){RemoveKebabIMeanBlep();};
		for(let b=1;b<BLARG.length;b++){
			if(BLARG[b].X-BLARG[b-1].X==-1){Path[Path.length]=1};
			if(BLARG[b].Y-BLARG[b-1].Y==1){Path[Path.length]=2};		
			if(BLARG[b].X-BLARG[b-1].X==1){Path[Path.length]=3};
			if(BLARG[b].Y-BLARG[b-1].Y==-1){Path[Path.length]=4};	
			};
			//alert(Path);
		if(MapRoster[unit].faction==PlayerChoiceFaction){path=Path};
		};

		for(let i=0;i<path.length;i++){
		destX+=(path[i]-2)*(path[i]%2);
		destY+=(3-path[i])*(path[i]-1)%2;};
		//if(destX==origX && destY==origY){RemoveKebabIMeanBlep(); return 0};
		//This thing is not yet proven to work properly
		rostermap[destX][destY]=rostermap[origX][origY];
		document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="hidden";

		//if(destX<StandardX || destX>StandardX+9 || destY<StandardY || destY>StandardY+9){ExtranDestination=true};

		//if(!Cloak(destX, destY, MapRoster[unit].unitType, Factions[MapRoster[unit].faction].faction)){MapRoster[unit].isCloaked=false; rostermap[destX][destY].isCloaked=false};


		//alert(MapRoster[unit].isCloaked);

		//alert(destX + " " + destY);
		//alert(rostermap[destX][destY]);


		document.getElementById("Cargo "+(origX+1)+"X"+(origY+1)).style.visibility="hidden";
		document.getElementById("Flag "+(origX+1)+"X"+(origY+1)).style.visibility="inherit";
		if(TileFlagMap[origX][origY]==0){document.getElementById("Flag "+(origX+1)+"X"+(origY+1)).style.visibility="hidden";}else if(TileFlagMap[origX][origY]==2){document.getElementById("Flag "+(origX+1)+"X"+(origY+1)).src='Assets/Miscellaneous/DefendFlag.PNG'}else if(TileFlagMap[origX][origY]==2){document.getElementById("Flag "+(origX+1)+"X"+(origY+1)).src='Assets/Miscellaneous/CaptureFlag.PNG'};
		if(rostermap[destX][destY].Defeat??false){document.getElementById("Flag "+(destX+1)+"X"+(destY+1)).style.visibility='inherit';document.getElementById("Flag "+(destX+1)+"X"+(destY+1)).src='Assets/Miscellaneous/DestroyFlag.PNG'};
		if(rostermap[destX][destY].Protect??false){document.getElementById("Flag "+(destX+1)+"X"+(destY+1)).style.visibility='inherit';document.getElementById("Flag "+(destX+1)+"X"+(destY+1)).src='Assets/Miscellaneous/ProtectFlag.PNG'};

		ExtranOrigin=false; ExtranDestination=false;

		//Moving intran

		if(!ExtranOrigin && !ExtranDestination){

			//for(let i=0;i<path.length;i++){};
			//offsetX=(Units[MapRoster[unit].unitType].StaticOffsetX ?? [0,0,0,0,0])[path[i]];
			//offsetY=(Units[MapRoster[unit].unitType].StaticOffsetY ?? [0,0,0,0,0])[path[i]];

			let activeOffsetX=Units[MapRoster[unit].unitType].MovementOffsetX ?? [0,0,0,0,0];
			let activeOffsetY=Units[MapRoster[unit].unitType].MovementOffsetY ?? [0,0,0,0,0];
			//alert(activeOffsetX);
			let offsetX=activeOffsetX[path[0]];
			let offsetY=activeOffsetY[path[0]];

			let castTime=setInterval(Act,100/path.length);
			let frame=0;
			let AudioAddress="Assets/SFX/"+Units[MapRoster[unit].unitType].shortname+"Move.MP3";
			if((MapRoster[unit].unitType==19 || MapRoster[unit].unitType==42)&&MystSettChoice){AudioAddress="Assets/SFX/HelikopterMove.MP3"}
			let MoveSFX=new Audio(AudioAddress);
			MoveSFX.play();


			function Act(){
				//frame=0;
				
				//alert(path.length);
				document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="hidden";


				if(frame%4==0 && frame<path.length*4){
					//alert(frame);
					let dir=path[Math.round(frame/4)];
					ics=(dir-2)*(dir%2);
					igrec=(3-dir)*((dir-1)%2);
					//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="hidden";

				//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="hidden";
					
				document.getElementById("EntityCore "+(origX+1)+"X"+(origY+1)).src="Assets/Units/Move/"+Units[MapRoster[unit].unitType].shortname+"Movement"+dir+".GIF";
				if(!Units[MapRoster[unit].unitType].MLPR??false){document.getElementById("EntityMesh "+(origX+1)+"X"+(origY+1)).src="Assets/Units/MoveMeshes/"+Units[MapRoster[unit].unitType].shortname+"MovementMesh"+dir+".GIF"}else{document.getElementById("EntityMesh "+(destX+1)+"X"+(destY+1)).src="Assets/Miscellaneous/Nothing.PNG"};

				};
				offsetX+=(ics*14)??0+(Units[MapRoster[unit].unitType].MovementOffsetY ?? [0,0,0,0,0])[path[path.length-1]];
				offsetY+=(igrec*14)??0+(Units[MapRoster[unit].unitType].MovementOffsetX ?? [0,0,0,0,0])[path[path.length-1]];
				document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.top=offsetX+"px";
				document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.left=offsetY+"px";




				if(frame>=4*path.length){
					//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+path[path.length-1]+".PNG";
					clearInterval(castTime);
					MapRoster[unit].x=destX;
					MapRoster[unit].y=destY;
					rostermap[destX][destY]=rostermap[origX][origY];
					rostermap[origX][origY]=0;

					document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.top="0px";
					document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.left="0px";
					document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.top=(Units[MapRoster[unit].unitType].StaticOffsetY ?? [0,0,0,0,0])[path[path.length-1]]+"px";
					document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.left=(Units[MapRoster[unit].unitType].StaticOffsetX ?? [0,0,0,0,0])[path[path.length-1]]+"px";
					

					document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.visibility="hidden";
					document.getElementById("EntityCore "+(origX+1)+"X"+(origY+1)).style.filter="";
					document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="visible";
					document.getElementById("EntityCore "+(destX+1)+"X"+(destY+1)).style.visibility="inherit";


					//if(frame>4*path.length){alert(frame +" "+ path[frame/4-1])};
					//if((path[frame/4-1]??0)==0){console.log(path[0])};
					document.getElementById("EntityCore "+(origX+1)+"X"+(origY+1)).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+path[Math.max(frame/4-1,0)]+".PNG";
					document.getElementById("EntityCore "+(destX+1)+"X"+(destY+1)).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+path[Math.max(frame/4-1,0)]+".PNG";
					document.getElementById("EntityCore "+(destX+1)+"X"+(destY+1)).style.filter=Factions[MapRoster[unit].faction].ChromaCode;
					let OpacString="opacity(0%)";
					if(Factions[MapRoster[unit].faction].faction==Factions[PlayerChoiceFaction].faction){OpacString=" opacity(50%)"};
					if(!Units[MapRoster[unit].unitType].MLPR??false){
						document.getElementById("EntityMesh "+(destX+1)+"X"+(destY+1)).src="Assets/Units/StaticMeshes/"+Units[MapRoster[unit].unitType].shortname+"Mesh"+path[Math.max(frame/4-1,0)]+".PNG";
						document.getElementById("EntityMesh "+(origX+1)+"X"+(origY+1)).src="Assets/Units/StaticMeshes/"+Units[MapRoster[unit].unitType].shortname+"Mesh"+path[Math.max(frame/4-1,0)]+".PNG";
						}else{document.getElementById("EntityMesh "+(destX+1)+"X"+(destY+1)).src="Assets/Miscellaneous/Nothing.PNG";document.getElementById("EntityMesh "+(origX+1)+"X"+(origY+1)).src="Assets/Miscellaneous/Nothing.PNG"};
					//if(MapRoster[unit].isCloaked){document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.filter=OpacString};
				};


				frame++;
			};
			
		
		

			};

		//Warping extern(Deprecated)
		if(ExtranOrigin || ExtranDestination){
		MapRoster[unit].x=destX;
		MapRoster[unit].y=destY;
		rostermap[destX][destY]=rostermap[origX][origY];
		rostermap[origX][origY]=0;};

		//Warping extran(Deprecated)

		if(!ExtranOrigin && ExtranDestination){
			//document.getElementById("Entity "+(origX+1)+"X"+(origY+1)).style.visibility="hidden";

			};

		//Warping intran(Deprecated)

		if(!ExtranDestination && ExtranOrigin){
		//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.visibility="visible";
		//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).src="Assets/Units/Static/"+Units[MapRoster[unit].unitType].shortname+MapRoster[unit].direction+".PNG";
		//document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.filter=Factions[MapRoster[unit].faction].ChromaCode;
		};

		//alert(rostermap[destX][destY-1]);
		ScoutVicinity(destX,destY);
		//AdjacentCloakers=[];
		LastMove.Uncloaked=AdjacentCloakers;
		let FadeFrame=0;
		let FadeIn=setInterval(FadeStage,100);

		function FadeStage(){
		FadeFrame++;
		//console.log(FadeFrame);

		if(FadeFrame>5){
			//alert(!rostermap[destX][destY].isCloaked);
			let StealthFactor=false;
			let CloakIndex=FadeFrame/10;
			if(MapRoster[unit].faction==PlayerChoiceFaction){CloakIndex=FadeFrame/5-1};
			if(hasCertainTrait(rostermap[destX][destY].unitType,"Stealth")??false){StealthFactor=true};
			if(hasCertainTrait(rostermap[destX][destY].unitType,"Submerged")??false){StealthFactor=true};
			if(!rostermap[destX][destY].isCloaked && StealthFactor){document.getElementById("EntityCore "+(destX+1)+"X"+(destY+1)).style.filter=Factions[MapRoster[unit].faction].ChromaCode; 
			if(Factions[MapRoster[unit].faction].faction==Factions[PlayerChoiceFaction].faction){document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.filter="opacity("+(FadeFrame/10)+")"}else{document.getElementById("Entity "+(destX+1)+"X"+(destY+1)).style.filter="opacity("+(FadeFrame/5-1)+")"};

			};
			for(let c=0;c<AdjacentCloakers.length;c++){
				//console.log(destX);
			if(AdjacentCloakers[c]==1){document.getElementById("EntityCore "+(destX)+"X"+(destY+1)).style.filter=Factions[rostermap[destX-1][destY].faction].ChromaCode;
			document.getElementById("Entity "+(destX)+"X"+(destY+1)).style.filter="opacity("+CloakIndex+")"};
			if(AdjacentCloakers[c]==2){document.getElementById("EntityCore "+(destX+1)+"X"+(destY+2)).style.filter=Factions[rostermap[destX][destY+1].faction].ChromaCode;
			document.getElementById("Entity "+(destX+1)+"X"+(destY+2)).style.filter="opacity("+CloakIndex+")"};
			if(AdjacentCloakers[c]==3){document.getElementById("EntityCore "+(destX+2)+"X"+(destY+1)).style.filter=Factions[rostermap[destX+1][destY].faction].ChromaCode;
			document.getElementById("Entity "+(destX+2)+"X"+(destY+1)).style.filter="opacity("+CloakIndex+")"};
			if(AdjacentCloakers[c]==4){document.getElementById("EntityCore "+(destX+1)+"X"+(destY)).style.filter=Factions[rostermap[destX][destY-1].faction].ChromaCode;
			document.getElementById("Entity "+(destX+1)+"X"+(destY)).style.filter="opacity("+CloakIndex+")"};
			};



			};


		if(FadeFrame==10){

			if(!rostermap[destX][destY].isCloaked){document.getElementById("EntityCore "+(destX+1)+"X"+(destY+1)).style.filter=Factions[MapRoster[unit].faction].ChromaCode;};
			for(let c=0;c<AdjacentCloakers.length;c++){
			if(AdjacentCloakers[c]==1){document.getElementById("EntityCore "+(destX)+"X"+(destY+1)).style.filter=Factions[rostermap[destX-1][destY].faction].ChromaCode; rostermap[destX-1][destY].isCloaked=false};
			if(AdjacentCloakers[c]==2){document.getElementById("EntityCore "+(destX+1)+"X"+(destY+2)).style.filter=Factions[rostermap[destX][destY+1].faction].ChromaCode; rostermap[destX][destY+1].isCloaked=false};
			if(AdjacentCloakers[c]==3){document.getElementById("EntityCore "+(destX+2)+"X"+(destY+1)).style.filter=Factions[rostermap[destX+1][destY].faction].ChromaCode; rostermap[destX+1][destY].isCloaked=false};
			if(AdjacentCloakers[c]==4){document.getElementById("EntityCore "+(destX+1)+"X"+(destY)).style.filter=Factions[rostermap[destX][destY-1].faction].ChromaCode; rostermap[destX][destY-1].isCloaked=false};
			};






			clearInterval(FadeIn);




		};

		};


		
		//LastUnit=rostermap[MapRoster[unit].x][MapRoster[unit].y];
		if(DynamicEvents.length>0){EvaluateDynamicEvent('Locomotion',[destX,destY]);};

		let mustCheck=false;
		for(let l=0; l<Constants.Capture.length; l++){if(destX==Constants.Capture[l].x&&destY==Constants.Capture[l].y){mustCheck=true}};
		for(let l=0; l<Constants.Defend.length; l++){if(destX==Constants.Defend[l].x&&destY==Constants.Defend[l].y){mustCheck=true}};
		if(mustCheck){Inspection(Turn,Constants,Roster)};

			}else{
		if(MapRoster[unit].faction==PlayerChoiceFaction){document.getElementById("Marker "+(MapRoster[unit].x+1)+"X"+(MapRoster[unit].y+1)).style.visibility="visible"};

		};

		//alert(MapRoster[unit].isVized);
	};
function MontreUnit(Class){
	document.getElementById("UnitMontre").src="Assets/Units/Move/"+Units[Class].shortname+"Movement2.GIF";
	document.getElementById("UnitMontre").style.left=Units[Class].MovementOffsetX+"px";
	document.getElementById("UnitMontre").style.top=Units[Class].MovementOffsetY+"px";
	if(!Units[Class].MLPR??false){document.getElementById("UnitMontre"+Class+"Mesh").src="Assets/Units/MoveMeshes/"+Units[Class].shortname+"MovementMesh3.GIF"; document.getElementById("UnitMontreMesh").src="Assets/Units/MoveMeshes/"+Units[Class].shortname+"MovementMesh2.GIF"}else{document.getElementById("UnitMontre"+Class+"Mesh").src="Assets/Miscellaneous/Nothing.PNG";document.getElementById("UnitMontreMesh").src="Assets/Miscellaneous/Nothing.PNG"};
	document.getElementById("MontreArmor").src="Assets/Traits/"+Units[Class].Armor+"Armor.PNG";
	document.getElementById("MontreAttack").src="Assets/Traits/"+Units[Class].Weapon+"Weapon.PNG";
	document.getElementById("MontreLocomotion").src="Assets/Traits/"+Units[Class].Movement+".PNG";
	document.getElementById("MontreArmorText").innerHTML=Units[Class].HP+"/"+Units[Class].HP;
	document.getElementById("MontreAttackText").innerHTML=Units[Class].Attack+"("+Units[Class].MinRange+"-"+Units[Class].MaxRange+")";
	document.getElementById("MontreLocomotionText").innerHTML=Units[Class].Speed;
	document.getElementById("MontreTrait1").src="Assets/Traits/"+Units[Class].tag1+".PNG";
	document.getElementById("MontreTrait2").src="Assets/Traits/"+Units[Class].tag2+".PNG";
	document.getElementById("MontreTrait3").src="Assets/Traits/"+Units[Class].tag3+".PNG";
	document.getElementById("MontreTrait4").src="Assets/Traits/"+Units[Class].tag4+".PNG";
	document.getElementById("MontreName").innerHTML=Language.UnitNames[Class];
	document.getElementById("MontreDescription").innerHTML=Language.UnitDesc[Class];
	HighlightedEntity=Units[Class];

	//there was an attempt
	//let UMTI=Class;
	//if(IndustrialBranchBrowsed==2){UMTI-=40};
	//if(IndustrialBranchBrowsed==3){UMTI-=50};
	//document.getElementById("UnitMontre"+UMTI).style.left=(Units[Class].MovementOffsetX??[0,0,0,0,0])[3]+"px";

	};
function NationDetails(Nation){

	if(Factions[Nation].Access){
	ChosenNation=Nation;
	ChosenChapter=1;
	document.getElementById("NationColor").style.filter=Factions[Nation].ChromaCode;
	document.getElementById("NationDetails").style.visibility="visible";
	document.getElementById("NationNameSpecific").innerHTML=Factions[Nation].name;
	document.getElementById("FactionNameSpecific").innerHTML=Factions[Nation].faction;
	let PR=0;
	if(Factions[Nation].powerRanking=="Major Power"){PR=1};
	if(Factions[Nation].powerRanking=="Regional Power"){PR=2};
	if(Factions[Nation].powerRanking=="Minor Power"){PR=3};
	document.getElementById("NationStatus").innerHTML=Language.SystemTerms[40+PR];
	document.getElementById("NationSynopsisSpecific").innerHTML="";
	let ND=Language.NationDesc[Nation-1];
	for(let I=0; I<ND.length; I++){document.getElementById("NationSynopsisSpecific").innerHTML+=ND[I]+"<br><br>"};
	//document.getElementById("CampaignSelectedText").innerHTML="Proceed";
	}else{alert("Halt! None may see the secret nations until they have unlocked them. Go back to playing the regular campaigns!")};};
function NudgeMap(Direction){
	//alert(MarkerMap[0]);
	Map=ChosenMap;
	let ics=(Direction-2)*(Direction%2);
	let igrec=(3-Direction)*((Direction-1)%2);
	
	checky=false;
	ChosenUnit.definite=false;
	if(StandardX+ics>=0 && StandardX+ics+9<Map.length && StandardY+igrec>=0 && StandardY+igrec+9<Map[0].length){checky=true;};
	//alert(checky);
	if(checky){StandardX+=ics;
		StandardY+=igrec;
		//FillMap(Map);
		//let MarkerMap=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];

	for(let X=StandardX;X<StandardX+10;X++){
	for(let Y=StandardY;Y<StandardY+10;Y++){
		document.getElementById("Canceler "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";
		//alert(rostermap[X][Y]);
		//if(rostermap[X][Y].faction==2){alert("Sonda!")};
		if(MarkerMap[X][Y]){
			//alert((X+1-StandardX) + " " + (Y+1-StandardY));
			if(rostermap[X][Y].life>0){document.getElementById("Marker "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible";}};
		if(rostermap[X][Y]!=0){
		//alert(rostermap[X][Y].faction);
		document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.top=(Units[rostermap[X][Y].unitType].StaticOffsetY ?? [0,0,0,0,0])[rostermap[X][Y].direction] + "px";
		document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.left=(Units[rostermap[X][Y].unitType].StaticOffsetX ?? [0,0,0,0,0])[rostermap[X][Y].direction] + "px";
		document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).src="Assets/Units/Static/"+(Units[rostermap[X][Y].unitType].shortname)+rostermap[X][Y].direction+".PNG";
		let Filter=Factions[rostermap[X][Y].faction].ChromaCode;
		//if(rostermap[X][Y].isCloaked){Filter+=" opacity(50%)"};
		//document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.filter=Filter;
		document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible";
		};
		//Entity=rostermap[X][Y];
		//if(MarkerMap[X][Y]){document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";
		if(rostermap[X][Y]==0){document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";};
		if(!MarkerMap[X][Y]){
			//alert(rostermap[X][Y]);
			document.getElementById("Marker "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";
			//document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";
		};
		/*
		let marka=false;
		
		document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";
		if(document.getElementById("Marker "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility=="visible" || document.getElementById("Canceler "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility=="visible"){
			marka=true;
			markaX=X+1-StandardX-ics;
			markaY=Y+1-StandardY-igrec;*/
			//alert(markaX + " X " + markaY);
			//document.getElementById("Marker "+markaX+"X"+markaY).style.visibility="visible";
			//MarkerMap[markaX][markaY]=true;
			
			};
		//document.getElementById("Marker "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";

		//if(document.getElementById("Canceler "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility=="visible"){alert("Hello!")};
		//document.getElementById("Canceler "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="hidden";


	/*
		if(Entity!=0){
	
	document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible";
	document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.top=(Units[Entity.unitType].StaticOffsetY ?? [0,0,0,0,0])[Entity.direction] + "px";
	document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.left=(Units[Entity.unitType].StaticOffsetX ?? [0,0,0,0,0])[Entity.direction] + "px";
	document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).src="Assets/Units/Static/"+Units[Entity.unitType].shortname+Entity.direction+".PNG";
	document.getElementById("Entity "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.filter=Factions[Entity.faction].ChromaCode;};};
	*/
		};
		/*
		for(let X=0;X<10;X++){
			for(let Y=0;Y<10;Y++){
			if(MarkerMap[X][Y]){document.getElementById("Marker "+X+"X"+Y).style.visibility="visible";};
			if(MarkerMap[X][Y]){document.getElementById("Canceler "+X+"X"+Y).style.visibility="hidden";};
			};};
		*/
		RefreshMap();
	};};
function NudgeMapEditor(X,Y){
	let checker=false;
	let x=X+EditorStandardX;
	let y=Y+EditorStandardY;
	if(x>=0 && x<=EditorMap.length-10 && y>=0 && y<=EditorMap[0].length-10){checker=true};
	//if(!checker){alert("Flubbed!")};
	if(checker){
		/*
		for(let i=0;i<10;i++){for(let j=0;j<10;j++){
			document.getElementById("Tile "+(i+1)+" X "+(j+1)).src="Assets/Tiles/"+Terrain[EditorMap[x+i][y+j]].name+".PNG";

		}};
		*/

		EditorStandardX=x;

		EditorStandardY=y;
		//alert(EditorStandardY);

		RefreshMapEditor();
		}else{let clank= new Audio("Assets/SFX/Clank.MP3"); 
		clank.play()};};
function OpenSpecialBloc(Bloc){
	BlocVizat=Bloc;
	//alert(Bloc[0].Name);
	for(let B=0;B<9;B++){document.getElementById("Special Level "+(B+1)).src="Assets/SpecialLevels/"+(Bloc[B] ?? {Name:""}).Name+".PNG";

	};};
function PickNation(Index){



	};
function PlayBGM(PlaylistVariant,SongIndex){

	//this bloc chooses the playlist
	//let PlaylistVariant=0;

	//if(ChosenMission==5){PlaylistVariant=1};

	let t=SongIndex??0;
	//if(t==MusicBank[PlaylistVariant].length){t=0};
	//console.log(t);
	if(t==0){RawPlaylist=JSON.parse(JSON.stringify(MusicBank[PlaylistVariant].List));
	Playlist=[];
	while(RawPlaylist.length>0){let f=Math.floor(Math.random()*RawPlaylist.length);Playlist[Playlist.length]=JSON.parse(JSON.stringify(RawPlaylist[f]));let Rep=RawPlaylist.splice(f,1)}};
	//alert(Playlist);
	//if(t>0){};

		BattleBGM=new Audio("Assets/BGM/"+Playlist[t]);
		BattleBGM.preload="auto";
		BattleBGM.load();
		BattleBGM.play();

	/*
	for(let i=1;i<Playlist.length;i++){
		let BGMDuration=BattleBGM.duration;
		BGMLoop=setTimeout(PlayBGM,BGMDuration)
		};*/


	/*
	BattleBGM=new Audio("Assets/BGM/"+Playlist[Math.floor(Math.random()*Playlist.length)]);
	BattleBGM.preload="auto";
	BattleBGM.load();
	BattleBGM.play();*/

	BattleBGM.onloadeddata= function(){
		let BGMDuration=BattleBGM.duration;
		//alert(Duration);
		if(t<Playlist.length-1){BGMLoop=setTimeout(PlayBGM,BGMDuration*1000,PlaylistVariant,t+1)}else{BGMLoop=setTimeout(PlayBGM,BGMDuration*1000,PlaylistVariant,0)};
	};

};
function PI_Scouter(Unit,Map){

	//Prerequisites
	var Speed=Unit.speed;
	var Type=Unit.movementType;
	var Faction=Unit.faction;
	var Coallition=Unit.coallition;
	var Lat=Unit.x;
	var Long=Unit.y;
	var SPD=Unit.speed;
	var X=Lat;
	var Y=Long;
	let unitIndex=Unit.index;
	let Path=[1];
	BLARG=[{X:Lat,Y:Long}];
	//SBLARG(X,Y);
	Pizdamatii=[];
	TargetList=[];
	//alert(Unit);

	MapClone=JSON.parse(JSON.stringify(Map));
	//alert(MapClone[0][0]);


	//Stepmap and Targetmap initializer. Is this comment still necessary?
	//IDC, leave it here in case players want to explore the script
	//I wonder how many of them there will be
	//I'd say probably 5% of them in the beginning. Then about 20%. Maybe?
	//Shouldn't we prank them or something?
	//Oh hell yes. Any idea?
	//We could say 'Dicks out for Harambe!'
	//We'll get innocent YouTubers demonetized. Better something inocuous
	//Will this game even be played by YouTubers? And besides, they can just put a nice little censor bar over it. Done. Problem solved.
	//Eh, probably some minor YouTuber will. Not the big shots like Pewds. Pewdiepie won't be caught dead playing this game.
	//Let's see if this game doesn't get blammed from the get-go. *cough* SCADP *cough*.
	//Blammed?
	//Yeah, blammed. Are you a zoomer or something?
	//Nothing, just wondering how many will get that reference.
	//I don't think zoomers will play it. Maybe it'll get some age restriction on Steam so only 17+ people can play.
	//Why would they? This game only sporadically uses profanity.
	//WHY WOULD THEY!? I WONDER! It's not like it makes TNO look like MLP when there's a profanity every seven words and an allusion to dark shit every 3 missions.
	//Yeah, but other stuff got the greenlight despite that.
	//Because they got $$. We don't! We're a fucking indie team who's not even a studio, where we have 5 plums between ourselves and probably living off of ramen.
	//I beg to differ. I live off of omelette and Coke Zero.
	//I'm starting to regret making this game free.
	//STFU, we're not a soulless corporation. Let it be free.
	//Yeah... the cost will be having to listen to our brainfarts.
	//Silix, Wisp, Luna! Cut it out and get back to work.
	let mapWidth=Map[0].length;
	let mapHeight=Map.length;
	var Stepmap=JSON.parse(JSON.stringify(Map));
	var Targetmap=JSON.parse(JSON.stringify(Map));	

	AddressMap=[];
	AddressMapLine=[];
	for(let i=0;i<Map[0].length;i++){AddressMapLine[AddressMapLine.length]=0};
	for(let j=0;j<Map.length;j++){AddressMap[AddressMap.length]=AddressMapLine};
	AddressMap=JSON.parse(JSON.stringify(AddressMap));
	Thing=JSON.parse(JSON.stringify(AddressMap));

	
	//Here lies the switch to get the stepmap.	
	switch(Type){
		case "Foot":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].WalkThrough;}};
		break;

		case "Wheeled":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].DriveThrough}};
		break;

		case "Tracked":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].RollThrough}};
		break;

		case "Amphibious":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].WadeThrough}};
		break;

		case "Flight":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].FlyThrough}};
		break;

		case "Rudder":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].SailThrough}};
		break;

		case "Heavy Rudder":
		for(let P=0;P<mapHeight;P++){for(Q=0;Q<mapWidth;Q++){Stepmap[P][Q]=Terrain[MapClone[P][Q]].DeepSailThrough}};
		break;

		};
		

	//Standard-Issue Pathing Loop
	while(Path.length>0){
			CollisionCheck=false;
			let x=(Path[Path.length-1]-2)*(Path[Path.length-1])%2;
			let y=(3-Path[Path.length-1])*(Path[Path.length-1]-1)%2;

		if(X+x<0 || Y+y<0){Path[Path.length-1]+=1};
		if(X+x>=Map.length || Y+y>=Map[0].length){Path[Path.length-1]++;};
		if(X+x<Map.length && X+x>=0 && Y+y<Map[0].length && Y+y>=0){
		if(rostermap[X+x][Y+y]!=0){
			if((rostermap[X+x][Y+y].coallition!=Coallition && !hasCertainTrait(Unit.unitType,"Supply Distribution")) || (rostermap[X+x][Y+y].coallition==Coallition && hasCertainTrait(Unit.unitType,"Supply Distribution"))){
			CollisionCheck=true;
			if(rostermap[X+x][Y+y]!=0 && rostermap[X+x][Y+y].coallition==Coallition){Thing[X+x][Y+y]=1000};
			};
			};};

	//The block that checks whether advancing is possible and advances


		if(SPD>0 && Path[Path.length-1]<5 && X+x<Map.length && Y+y<Map[0].length){
			let x=(Path[Path.length-1]-2)*(Path[Path.length-1])%2;
			let y=(3-Path[Path.length-1])*(Path[Path.length-1]-1)%2;

			//alert(Stepmap[X][Y]);
			if(SPD>=Stepmap[X+x][Y+y] && CollisionCheck==false){
			X=X+x;
			Y=Y+y;
			//alert(Path);
			Pizdamatii[Pizdamatii.length]={x:X-StandardX,y:Y-StandardY,z:[]};
			Path[Path.length]=1;
			for(let p=0;p<Path.length;p++){Pizdamatii[Pizdamatii.length-1].z[p]=Path[p]};
			//Pizdamatii[Pizdamatii.length-1].z=Path;
			
			SPD=SPD-Stepmap[X][Y];}else{Path[Path.length-1]+=1;};
			}
	//The block that checks if backtracking is needed and does so

		else if(SPD==0 || Path[Path.length-1]>=5){
			//alert(Path[Path.length-1]);
			if(Path.length>=2){reverse=Path[Path.length-2];}else{break;};
			SPD=SPD+Stepmap[X][Y];

			X=X-(reverse-2)*(reverse%2);
			Y=Y-(3-reverse)*(reverse-1)%2;

			

			Path.length-=1;
			Path[Path.length-1]+=1;

			
			}
			//else if(Path[Path.length-1]>=5){alert("Please don't fuck up the script")};
		//alert("Path length: "+Path.length+ "; SPD= "+SPD+ "; X= "+X+"; Y= "+Y+"; direction: "+Path[Path.length-1]+" Path: "+Path+ "CollChek: "+ CollisionCheck);
		
		};
	

	//AddressMap=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];
	
	//Ctepmap=JSON.parse(JSON.stringify(AddressMap));
	

	//This does the ctep pathing

	for(let h=0;h<Pizdamatii.length;h++){
		//alert(Pizdamatii[h].x);
		let canAdd=true;
		if(rostermap[Pizdamatii[h].x][Pizdamatii[h].y]!=0){canAdd=false;AddressMap[Pizdamatii[h].x][Pizdamatii[h].y]=1};
		//if(rostermap[Pizdamatii[h].x+StandardX][Pizdamatii[h].y+StandardY].coallition==Coallition){canAdd=true};
		//if(Pizdamatii[h].x>9 || Pizdamatii[h].x<0 || Pizdamatii[h].y>9 || Pizdamatii[h].y<0){canAdd=false};
		if(canAdd){Thing[Pizdamatii[h].x][Pizdamatii[h].y]=1000;};
		
		if(canAdd){
			if(Thing[Pizdamatii[h].x][Pizdamatii[h].y]==1000){
			pathway=Pizdamatii[h].z;
			alt=AddressMap[Pizdamatii[h].x][Pizdamatii[h].y];
			if(alt!=0 && alt.length<pathway.length){pathway=alt;};
			AddressMap[Pizdamatii[h].x][Pizdamatii[h].y]=pathway;};};
		};
	

	//This draws the bleps
	Thing[Lat][Long]=0;
	//if(rostermap[Lat][Long].coallition!=Coallition){Thing[Lat-StandardX][Long-StandardY]=1000};
	for(let r=Math.max(Unit.x-10,0);r<Math.min(Unit.x+10,Thing.length);r++){
	for(let t=Math.max(Unit.y-10,0);t<Math.min(Unit.y+10,Thing[0].length);t++){
		//if(rostermap[r][t].coallition==Coallition){Thing[r][t]=1000; AddressMap[r][t]=[0,0]};
		let coincidenter=false;
		if(rostermap[r][t].coallition==Coallition){coincidenter=true};
		//if(AddressMap[r][t]==0){coincidenter=false};
		if(r || t){coincidenter=false};
		//if(r>StandardX+9 || t>StandardY+9){coincidenter=false};

		if((Thing[r][t]!=0 || rostermap[r][t].coallition==Coallition) && AddressMap[r][t]!=0){
			//alert(AddressMap[r][t]);
		//if(rostermap[r][t]!=0){alert("Check!")};
	type="Assets/Miscellaneous/Blep.png";
	let newPic=document.createElement("img");
	newPic.src=type;
	newPic.id="Blep-"+r+"-"+t;
	newPic.style.position="absolute";
	newPic.style.visibility="visible";
	//newPic.style.top=Math.min(r,10)*56+"px";
	//newPic.style.left=Math.min(t,10)*56+"px";
	newPic.style.top=r*56+"px";
	newPic.style.left=t*56+"px";
	newPic.style.zIndex=4;

	let pip=AddressMap[r][t]??[0,0];
	//pip.pop();
	//alert(Pizdamatii[Pizdamatii.length-1].z);

	//newPic.addEventListener("click", function(){alert(pip);});
	newPic.addEventListener("mouseover",function(){
		SBLARG(r,t,pip);
		return 0});
	newPic.addEventListener("click", function(){
		if(rostermap[r][t]==0){
			//alert((ChosenUnit.ics-StandardX) + " " + (ChosenUnit.igrec-StandardY));
			
		//MarkerMap[ChosenUnit.ics][ChosenUnit.igrec]=0;
		//alert(pip);
		MoveUnit(unitIndex , pip);
		//alert(ChosenUnit.ics+" "+ChosenUnit.igrec);
		
		document.getElementById("Canceler "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).style.visibility="hidden";
		document.getElementById("Canceler "+(ChosenUnit.ics)+"X"+(ChosenUnit.igrec)).style.filter="";
		
		RemoveKebabIMeanBlep();
		ChosenUnit.definite=false;
		return 0;};
		});
	document.getElementById("UnitMap").appendChild(newPic);
	};

	//this is a bit of a hail-Mary solution
	//WHAT DOES THIS PIECE OF CRAP EVEN DO!?
	if(coincidenter==true && Thing[r][t]==0){
		//alert(AddressMap[r][t]);
		type="Assets/Miscellaneous/Blep.png";
		var newPic=document.createElement("img");
		newPic.src=type;
		newPic.id="Blep-"+(r-StandardX)+"-"+(t-StandardY);
		newPic.style.position="absolute";
		newPic.style.visibility="visible";
		newPic.style.top=r*56+"px";
		newPic.style.left=t*56+"px";
		newPic.style.zIndex=4;
		newPic.addEventListener("mouseover",function(){ SBLARG(r,t); return 0});
		//document.getElementById("UnitMap").appendChild(newPic);

		};




	};
	};

	if(Units[Unit.unitType].MaxRange>1){AttackType='Ranged'}else{AttackType='Melee'};
	//This draws the speps

	

	if(AttackType=="Ranged"){//alert("Fire in the hole!")
		minDist=Units[Unit.unitType].MinRange;
		maxDist=Units[Unit.unitType].MaxRange;
		let TerrainCheck=Terrain[Map[Unit.x][Unit.y]];
		if(TerrainCheck.tag1=="Vantage" || TerrainCheck.tag2=="Vantage" || TerrainCheck.tag3=="Vantage" || TerrainCheck.tag4=="Vantage"){maxDist+=1};
		for(let r=Math.max(0,Unit.x-10);r<Math.min(Map.length,Unit.x+10);r++){for(let t=Math.max(0,Unit.y-10);t<Math.min(Map[0].length,Unit.y+10);t++){
			let checker=false;
			//alert(Unit.x);
			//alert(Unit.y);
			let UnitPythX=Unit.x;
			let UnitPythY=Unit.y;
			PythagoraX=(UnitPythX-r);
			PythagoraY=(UnitPythY-t);
			let dist=(PythagoraX*PythagoraX)+(PythagoraY*PythagoraY);
			//alert(PythagoraX + " " + PythagoraY);
			//alert(dist);
			if(dist>=minDist*minDist && dist<=maxDist*maxDist && rostermap[r][t]!=0){checker=true};
			if(!hasCertainTrait(MapRoster[unitIndex].unitType,"Skysweeper") && rostermap[r][t].movementType=="Flight"){checker=false};
			if(!hasCertainTrait(MapRoster[unitIndex].unitType,"Depth Charge") && hasCertainTrait(rostermap[r][t].unitType??1,"Submerged")){checker=false};
			if(hasCertainTrait(MapRoster[unitIndex].unitType,"Seabound") && (rostermap[r][t].movementType!="Rudder" && rostermap[r][t].movementType!="Heavy Rudder")){checker=false};
			if(rostermap[r][t].coallition==Coallition && !hasCertainTrait(MapRoster[unitIndex].unitType,"Supply Distribution")){checker=false};
			if(hasCertainTrait(Unit.unitType,"Streamblast") && r!=X && t!=Y){checker=false}

			//alert(rostermap[r][t]);
			
			if(checker){
				//alert(PythagoraX+" "+PythagoraY);
				let spep=document.createElement("img");
				//alert(hasCertainTrait(Unit.unitType,"Supply Distribution"));
				if(hasCertainTrait(Unit.unitType,"Supply Distribution")){spep.src="Assets/Miscellaneous/Hlep.png";}else{spep.src="Assets/Miscellaneous/Spep.png";}		
				spep.id="Spep-"+r+"-"+t;
				spep.style.position="absolute";
				spep.style.top=r*56+"px";
				spep.style.left=t*56+"px";
				spep.style.zIndex=5;
				spep.style.cursor="url(Assets/Traits/RangedCursor.png) 25 25,auto";
				if(hasCertainTrait(Unit.unitType,"Dispersion")){spep.style.cursor="url(Assets/Traits/ChemicalCursor.png) 25 25,auto"};
				if(hasCertainTrait(Unit.unitType,"Streamblast")){spep.style.cursor="url(Assets/Traits/LaserCursor.png) 25 25,auto"};
				if(hasCertainTrait(Unit.unitType,"Supply Distribution")){spep.style.cursor="url(Assets/Traits/SupplyCursor.png) 25 25,auto"};
				if(!hasCertainTrait(Unit.unitType,"Supply Distribution")){spep.style.zIndex=5;}else{spep.style.zIndex=5;};
				spep.addEventListener("click", function(){
					canAttack=true;
					if(!rostermap[r][t]){canAttack=false;}

					if(canAttack){if(Factions[rostermap[r][t].faction].faction == Factions[Faction].faction && !hasCertainTrait(Unit.unitType,"Supply Distribution")){canAttack=false}

					};

				if(canAttack){setTimeout(Attack,500,unitIndex,rostermap[r][t].index);
				document.getElementById("Canceler "+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="hidden";
				RemoveKebabIMeanBlep();
				//alert(ChosenUnit.ics);
				MarkerMap[ChosenUnit.ics-1][ChosenUnit.igrec-1]=false;
				
				ChosenUnit.definite=false;
				};
				});
				document.getElementById("UnitMap").appendChild(spep);
			};

		}};

		};

	//This draws the cteps
	if(AttackType=="Melee"){
		//alert("Pummel the bitches!")
	Thing[X][Y]=1000;

	for(let r=Math.max(Unit.x-10,0);r<Math.min(Unit.x+10,Thing.length);r++){
	for(let t=Math.max(Unit.y-10,0);t<Math.min(Unit.y+10,Thing[0].length);t++){
		let checker=0;
		if(rostermap[r][t]==0){checker=0};
		let cep=[];
		if(Thing[r][t]==0){
			if(r<Thing.length-1){if(Thing[r+1][t]!=0){checker=1; 
				cep=AddressMap[r+1][t];}};
			if(r>0){if(Thing[r-1][t]!=0){checker=1;
				cep=AddressMap[r-1][t];}};
			if(t<Thing[0].length-1){if(Thing[r][t+1]!=0){checker=1; 
				cep=AddressMap[r][t+1];}};
			if(t>0){if(Thing[r][t-1]!=0){checker=1;
				cep=AddressMap[r][t-1];}};

				//if(r>0){if(rostermap[r-1][t]!=0 && ){checker=1;cep=[]}};

			if(r==X-1 && t==Y){checker=1;cep=[]};
			if(r==X+1 && t==Y){checker=1;cep=[]};
			if(r==X && t==Y-1){checker=1;cep=[]};
			if(r==X && t==Y+1){checker=1;cep=[]};
			
			let finalX=ChosenUnit.ics-1;
			let finalY=ChosenUnit.igrec-1;
			//alert(puc);
			for(let pw=0;pw<cep.length;pw++){finalX+=(cep[pw]-2)*(cep[pw]%2); finalY+=(3-cep[pw])*(cep[pw]-1)%2;};
				//if(rostermap[finalX][finalY]!=0 && cep.length>0){checker=0};

			if(rostermap[Math.min(r,Thing.length-1)][Math.min(t,Thing[0].length-1)].coallition==Coallition){checker=0};
			// && rostermap[finalX][finalY].coallition==Coallition
		
			
			//(Path[Path.length-1]-2)*(Path[Path.length-1])%2;
			//(3-Path[Path.length-1])*(Path[Path.length-1]-1)%2;
			//alert(MapRoster[unitIndex].name);
			if(!hasCertainTrait(MapRoster[unitIndex].unitType,"Skysweeper") && rostermap[r][t].movementType=="Flight"){checker=0};
			if(!hasCertainTrait(MapRoster[unitIndex].unitType,"Depth Charge") && hasCertainTrait(rostermap[r][t].unitType??1,"Submerged")){checker=0};
			if(hasCertainTrait(MapRoster[unitIndex].unitType,"Seabound") && (rostermap[r][t].movementType!="Rudder" && rostermap[r][t].movementType!="Heavy Rudder")){checker=0};
			if(rostermap[r][t].coallition == Coallition){checker=0};
			//alert(rostermap[r+StandardX][t+StandardY].movementType);

			if(checker==1){
				//alert(cep);
				let puc=cep;
				let newPic=document.createElement("img");
				if(hasCertainTrait(Unit.unitType,"Supply Distribution")){newPic.src="Assets/Miscellaneous/Hlep.png";}else{newPic.src="Assets/Miscellaneous/Ctep.png";}				
				newPic.id="Ctep-"+r+"-"+t;
				newPic.style.position="absolute";
				newPic.style.visibility="visible";
				newPic.style.top=r*56+"px";
				newPic.style.left=t*56+"px";
				newPic.style.zIndex=5;
				if(rostermap[r][t]==0){newPic.style.filter="saturate(350%)"};
				if(rostermap[r][t]!=0){newPic.style.cursor="url(Assets/Traits/ContactCursor.png) 25 25, auto"};
				if(hasCertainTrait(Unit.unitType,"JUDGEMENT")){newPic.style.cursor="url(Assets/Traits/ALEPHCursor.png) 25 25,auto"};
				if(!hasCertainTrait(Unit.unitType,"Supply Distribution")){newPic.style.zIndex=5;}else{newPic.style.zIndex=4;};

				let churro=document.getElementById("Blep-"+r+"-"+t) ?? 0;
				if(churro!=0){churro.style.visibility="hidden"};

				newPic.addEventListener("mouseover",function(){
					CBLARG(r,t);
					});

				newPic.addEventListener("mouseout",function(){

					let canBlarg=false;
					let xdif=Math.abs(r-BLARG[BLARG.length-1].X);
					let ydif=Math.abs(t-BLARG[BLARG.length-1].Y);
					if(xdif+ydif==1){canBlarg=true};



					if(canBlarg){document.getElementById("Ctep-"+r+"-"+t).src="Assets/Miscellaneous/Ctep.PNG"};
					if(BLARG.length<2){document.getElementById('BLARG '+(BLARG[0].X+1)+"X"+(BLARG[0].Y+1)).src="Assets/BLARG/Singularity.PNG"}else{
						let or=0;



						
					if(BLARG[BLARG.length-2].X>BLARG[BLARG.length-1].X){or=1};
					if(BLARG[BLARG.length-2].Y<BLARG[BLARG.length-1].Y){or=2};
					if(BLARG[BLARG.length-2].X<BLARG[BLARG.length-1].X){or=3};
					if(BLARG[BLARG.length-2].Y>BLARG[BLARG.length-1].Y){or=4};
					if(or==0){BLARG.pop()};
					document.getElementById('BLARG '+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/Target"+or+".PNG";


					};


			});
				newPic.addEventListener("click", function(){//alert(r+" "+t);
				canAttack=true;
				let xdif=Math.abs(r-BLARG[BLARG.length-1].X);
				let ydif=Math.abs(t-BLARG[BLARG.length-1].Y);
				if(rostermap[BLARG[BLARG.length-1].X][BLARG[BLARG.length-1].Y]!=0 && BLARG.length>1){canAttack=false};
				if(rostermap[BLARG[BLARG.length-1].X][BLARG[BLARG.length-1].Y]!=0){document.getElementById("Marker "+(Lat-StandardX+1)+"X"+(Long-StandardY+1)).style.visibility="visible"};
				if(xdif+ydif>1){canAttack=false};
				
				//alert(MapRoster[unitIndex].isCloaked);
				let pip=AddressMap[r][t]??[0,0];
				if(canAttack){
					//alert('tuturuu!');
					//alert("crap");
					MoveUnit(unitIndex , pip);
					//alert(LastMove.X+" "+LastMove.Y);
					//LastMove.ID=Unit.index;
					//LastMove.X=Unit.x;
					//LastMove.Y=Unit.y;
					//alert(LastMove.X+" "+LastMove.Y);
				//alert((r+StandardX)+" "+(t+StandardY));
				//alert(rostermap[finalX][finalY].isCloaked);
					if(finalX<0){finalX=0};
				if(rostermap[r][t+StandardY]){setTimeout(Attack,1000,unitIndex,rostermap[r][t+StandardY].index);}}else{document.getElementById("Marker "+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="visible";};
				//alert(finalX+" "+finalY);
				//if(!Cloak(Math.max(finalX,0),Math.max(finalY,0),Unit.unitType,Coallition)){MapRoster[unitIndex].isCloaked=false; rostermap[finalX][finalY].isCloaked=false}else{MapRoster[unitIndex].isCloaked=true; rostermap[finalX][finalY].isCloaked=true};
				document.getElementById("Canceler "+ChosenUnit.ics+"X"+ChosenUnit.igrec).style.visibility="hidden";
				RemoveKebabIMeanBlep();

				ChosenUnit.definite=false;
				return 0;});

				document.getElementById("UnitMap").appendChild(newPic);
				

				};


			};


		};};
	};};
function PITurn(Roster,Map,Constants){
	//Map=Campaigns[ChosenNation-1][ChosenChapter-1][ChosenMission-1].Map;
	//alert(Roster.length);
	RemoveKebabIMeanBlep();

			for(let i=0; i<MapRoster.length;i++){
			if(MapRoster[i].unitType==0 && MapRoster[i].faction==PlayerChoiceFaction){
			//alert(i);
			MapRoster[i].constructionTime-=1;
			if(MapRoster[i].constructionTime<1){BuildingComplete(i)};
			};};


	LastMove={ID:0};

	MarkerMap=[];
	let line=[];
	for(let i=0;i<Map[0].length;i++){line[line.length]=false};
	for(let j=0;j<Map.length;j++){MarkerMap[MarkerMap.length]=line};
	MarkerMap=JSON.parse(JSON.stringify(MarkerMap));
	//alert(Roster);

	if(Constants.Commanders??false){Commander=Constants.Commanders[1]};
	for(let x=0;x<Map.length;x++){for(y=0;y<Map[0].length;y++){
		//if((ControlMap??0) !=0 && ControlMap[x][y]==PlayerChoiceFaction){YourMoney+=(Terrain[Map[x][y]].revenue??0)};
		if((ControlMap??0) !=0 && ControlMap[x][y]==PlayerChoiceFaction){YourMoney+=GenerateRevenue(Terrain[Map[x][y]].revenue??0,x,y)};
		if(hasCertainTrait(rostermap[x][y].unitType??0,"Financial Center") && rostermap[x][y].faction==PlayerChoiceFaction){GenerateRevenue(100,x,y)}

		}};

		//alert(Turn);
		setTimeout(function(){

		for(let i=0;i<Map.length;i++){
			for(let j=0;j<Map[0].length;j++){
			//alert(rostermap[i][j].index);

			if(MarkerMap[i][j] && rostermap[i][j].life>0){document.getElementById("Marker "+(i+1)+"X"+(j+1)).style.visibility="visible";};};};



		for(let a=1; a<=GlassPanels; a++){
			let dudeIndex=AttackOrder[(Turn+a-2)%AttackOrder.length];
			document.getElementById("Glassplatecolor"+a).style.background=Factions[dudeIndex].color;
			document.getElementById("Glassplatename"+a).innerHTML=Factions[dudeIndex].name;
			if(document.getElementById("Glassplatecolor"+a).style.background!='black'){document.getElementById("Glassplatename"+a).style.color='black'}else{document.getElementById("Glassplatename"+a).style.color='indigo'};};

		},GlobalDelayerConstant);

	

	for(let i=0;i<Roster.length;i++){let CanAct=true;
		let Stealth=false;
		//alert(Roster[i].unitType);
		if(hasCertainTrait(Roster[i].unitType,"Inertial")){CanAct=false};
		if(CanAct){MarkerMap[Roster[i].x][Roster[i].y]=true}
		//alert(Roster[i].index);
		MapRoster[Roster[i].index].canEncore=false;
		MapRoster[Roster[i].index].willAmbush=false
		MapRoster[Roster[i].index].isVized=true;
		if(hasCertainTrait(Roster[i].unitType,"Bewegungskrieg")){MapRoster[Roster[i].index].canEncore=true};
		if(hasCertainTrait(Roster[i].unitType,"Stealth")){Stealth=true};

		//alert(Roster[i].faction);

		if(Stealth){Stealth=Cloak(Roster[i].x,Roster[i].y,Roster[i].unitType,Factions[Roster[i].faction].faction);};
		//alert(Stealth);
		//document.getElementById("Entity "+(i+1-StandardX)+"X"+(j+1-StandardY)).style.filter="";
		//if(Stealth){document.getElementById("Entity "+(Roster[i].x+1-StandardX)+"X"+(Roster[i].y+1-StandardY)).style.filter+=" opacity(50%)"};

		refreshMap();

		//alert(Turn);

		/*
		if(Roster[i].x>0){
			if(Factions[rostermap[Roster[i].x-1][Roster[i].y].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x-1][Roster[i].y].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		if(Roster[i].x<Map.length-1){
			if(Factions[rostermap[Roster[i].x+1][Roster[i].y].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x+1][Roster[i].y].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};

		if(Roster[i].y>0){
			if(Factions[rostermap[Roster[i].x][Roster[i].y-1].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x][Roster[i].y-1].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		if(Roster[i].y<Map[0].length-1){
			if(Factions[rostermap[Roster[i].x][Roster[i].y+1].faction??0].faction!=Roster[i].coallition && Factions[rostermap[Roster[i].x][Roster[i].y+1].faction??0].faction!=Factions[0].faction)
				{Stealth=false};
		};
		
		if(Stealth){rostermap[Roster[i].x][Roster[i].y].isCloaked=Stealth;	
		if(Roster[i].x>=StandardX && Roster[i].y>=StandardY && Roster[i].x<StandardX+10 && Roster[i].y<StandardY+10){document.getElementById("Entity "+(Roster[i].x+StandardX+1)+"X"+(Roster[i].y+StandardY+1)).style.filter+=" opacity(50%)"};

		//alert(rostermap[Roster[i].x][Roster[i].y].isCloaked);
		//NudgeMap(2);NudgeMap(4);
		//alert(Stealth);
		};*/


	};

		
		//alert(Roster[i].x+" "+Roster[i].y);
	//alert(MarkerMap[0]);

	/*for(let i=0;i<Roster.length;i++){
		let checker=true;
		if((Roster[i].x+1-StandardY)>10 || (Roster[i].x+1-StandardY)<1 || (Roster[i].y+1-StandardY)>10 || (Roster[i].y+1-StandardY)<1){checker=false;}
		//alert((Roster[i].x+1-StandardY) + " " + (Roster[i].y+1-StandardY));

		if(checker){document.getElementById("Marker "+(Roster[i].x+1-StandardY)+"X"+(Roster[i].y+1-StandardY)).style.visibility="visible"};
	};
	*/
	//alert(StandardX +" "+ StandardY);
	
	
	setTimeout(InterphaseBanner,GlobalDelayerConstant,AttackOrder[CurrentTurn],Turn);
	if(ControlMap??false){setTimeout(CaptureProperty,GlobalDelayerConstant,ControlMap,PlayerChoiceFaction);};
	GlobalDelayerConstant=0;};
function PostDialogueFrame(Portrait, Name, Text){

	document.getElementById("Portrait").id=Portrait;
	document.getElementById("CharacterName").innerHTML=Name;

	//let TextBlock=setInterval(WriteText,10);
	let TextPhase=0;
	let TextTerminus=Text.length;
	alert(TextTerminus);
	document.getElementById("DialogueInstance").innerHTML=Text;
	//function WriteText(){TextPhase++;if(TextPhase==TextTerminus){clearInterval(TextBlock)}};
	document.getElementById("DialogueBox").style.visibility="visible";};
function RazeFaction(Faction){};
function RecruitUnit(Class){
	//alert(ActiveIndustrialNode.X+"X"+ActiveIndustrialNode.Y);
	for(let x=1;x<Map.length;x++){for(let y=1;y<Map[0].length;y++){let crep=document.getElementById("Crep-"+x+"-"+y) ?? 0; if(crep!=0){crep.remove()};}};
	let RecC=document.getElementById("CloseRecruiterX")??0;if(RecC!=0){RecC.remove()};
	if(YourMoney>=Units[Class].Cost*CostFactor){
		document.getElementById("UnitRecruitmentPanel").style.visibility="hidden";
		for(let i=1;i<41;i++){document.getElementById("Obturator"+i).style.visibility="hidden"};


			if(!hasCertainTrait(Class,"Streamlined")){DeploymentIndex=2}else{DeploymentIndex=5};


		for(let i=Math.max(ActiveIndustrialNode.X+1-DeploymentIndex,1);i<=Math.min(ActiveIndustrialNode.X+1+DeploymentIndex,10);i++){
			for(let j=Math.max(ActiveIndustrialNode.Y+1-DeploymentIndex,1);j<=Math.min(ActiveIndustrialNode.Y+1+DeploymentIndex,10);j++){
				let CanDeploy=true;
				//alert(i);
				if(rostermap[i-1+StandardX][j-1+StandardY]!=0){CanDeploy=false};
				if(Terrain[Map[i-1+StandardX][j-1+StandardY]].WalkThrough>=5 && IndustrialBranchBrowsed==1){CanDeploy=false};
				if(Terrain[Map[i-1+StandardX][j-1+StandardY]].FlyThrough>=5 && IndustrialBranchBrowsed==2){CanDeploy=false};
				if(Terrain[Map[i-1+StandardX][j-1+StandardY]].SailThrough>=5 && IndustrialBranchBrowsed==3){CanDeploy=false};
				if((ActiveIndustrialNode.X+1-i)*(ActiveIndustrialNode.X+1-i)+(ActiveIndustrialNode.Y+1-j)*(ActiveIndustrialNode.Y+1-j)<DeploymentIndex*DeploymentIndex && CanDeploy){
				let Crep=document.createElement("img");
				Crep.src="Assets/Miscellaneous/Crep.PNG";
				Crep.id="Crep-"+i+"-"+j;
				Crep.style.position="absolute";
				//Crep.style.top=i*56+"px";
				//Crep.style.left=j*56+"px";
				Crep.style.zIndex=4;
				Crep.addEventListener("click",function(){
					if(YourMoney>=Units[Class].Cost*CostFactor){
					DeployUnit(i,j,Class,PlayerChoiceFaction);
					let pos=document.getElementById("Crep-"+i+"-"+j);
					pos.remove();
					}else{RemoveKebabIMeanBlep();
					let Closer=document.getElementById("CloseRecruiterX");
					Closer.remove();};
				});

				
				//alert(i+"X"+j);
				document.getElementById("Slot "+i+"X"+j).appendChild(Crep);
					};

			};
		};

				let Close=document.createElement("img");
				Close.src="Assets/Miscellaneous/SelectionCanceller.PNG";
				Close.id="CloseRecruiterX";
				Close.style.position="absolute";
				Close.style.zIndex=5;
				Close.style.left="14px";
				Close.style.top="14px";
				Close.style.width="28px";
				Close.style.height="28px";

				Close.addEventListener("click",function(){					
					RemoveKebabIMeanBlep();
					let Closer=document.getElementById("CloseRecruiterX");
					Closer.remove();
				});

				document.getElementById("Slot "+(ActiveIndustrialNode.X+1)+"X"+(ActiveIndustrialNode.Y+1)).appendChild(Close);

	};};
function refreshMap(){

	//if((RT??0)==0){RT=false};
	
	for(let x=1; x<=Map.length; x++){
		for(let y=1; y<=Map[0].length; y++){
			let unit=rostermap[x-1][y-1];
			if((rostermap[x-1][y-1]??0) !=0){
			
			document.getElementById('EntityCore '+x+'X'+y).src="Assets/Units/Static/"+Units[unit.unitType].shortname+unit.direction+".PNG";
			document.getElementById('Entity '+x+'X'+y).style.visibility="visible";
			if(unit.isCloaked??false){let isSameFaction=unit.coallition==Factions[PlayerChoiceFaction].faction;document.getElementById('EntityCore '+x+'X'+y).style.filter=Factions[unit.faction].ChromaCode;
			document.getElementById('Entity '+x+'X'+y).style.filter=(isSameFaction?"opacity(50%)":"opacity(0%)");
			//alert(document.getElementById('Entity '+x+'X'+y).style.filter);
		}else{document.getElementById('EntityCore '+x+'X'+y).style.filter=Factions[unit.faction].ChromaCode};
			document.getElementById('Entity '+x+'X'+y).style.top=(Units[unit.unitType].StaticOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
			document.getElementById('Entity '+x+'X'+y).style.left=(Units[unit.unitType].StaticOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";

			if((rostermap[x-1][y-1].Defeat??false)){document.getElementById('Flag '+x+'X'+y).src="Assets/Miscellaneous/DestroyFlag.PNG";document.getElementById('Flag '+x+'X'+y).style.visibility='inherit'}else{document.getElementById('Flag '+x+'X'+y).style.visibility='hidden'};
			if((rostermap[x-1][y-1].Protect??false)){document.getElementById('Flag '+x+'X'+y).src="Assets/Miscellaneous/ProtectFlag.PNG";document.getElementById('Flag '+x+'X'+y).style.visibility='inherit'}else if(!(rostermap[x-1][y-1].Defeat??false)){document.getElementById('Flag '+x+'X'+y).style.visibility='hidden'};

			}else{
	
			document.getElementById('EntityCore '+x+'X'+y).style.visibility="inherit";
			document.getElementById('EntityCore '+x+'X'+y).style.filter="";
			document.getElementById('Entity '+x+'X'+y).style.filter="";
			document.getElementById('Entity '+x+'X'+y).style.top="0px";
			document.getElementById('Entity '+x+'X'+y).style.left="0px";


			if(TileFlagMap[x-1][y-1]==0){document.getElementById('Flag '+x+'X'+y).style.visibility='hidden'}else{document.getElementById('Flag '+x+'X'+y).style.visibility='inherit'};
			if(TileFlagMap[x-1][y-1]==1){document.getElementById('Flag '+x+'X'+y).src="Assets/Miscellaneous/CaptureFlag.PNG"};
			if(TileFlagMap[x-1][y-1]==2){document.getElementById('Flag '+x+'X'+y).src="Assets/Miscellaneous/DefendFlag.PNG"};


			};

	};};};
function RefreshMap(){};
//refreshTile() is DEPRECATED
function refreshTile(X,Y){

	//alert(EditorMap[X][Y]);
	if(EditationToggle=='Tile'){document.getElementById("Entity "+X+" X "+Y).src="";
	EditorMap[X+EditorStandardX-1][Y+EditorStandardY-1]=ChosenTerrain;
	EditorEntityMap[X+EditorStandardX-1][Y+EditorStandardY-1]=0;

	//for(let ics=1;ics<=10;ics++){for(let igrec=1;igrec<=10;igrec++){}};

	let Address="Tile "+X+" X "+Y;
	let Strucdress="Structure "+X+" X "+Y;
	document.getElementById(Strucdress).style.visibility="hidden";

	switch(ChosenTerrain){
		case 1:
			var type= Math.ceil(Math.random()*8);
			var offset=0;
			variant= "Assets/Tiles/Plains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			//document.getElementById(Address).style.filter="hue-rotate(0deg) saturate(100%) brightness(100%)";
			document.getElementById(Address).src=variant;
			break;

		case 2:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Forest"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

			case 3:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==3){offset=-4};
			if(type==4){offset=-5};
			variant= "Assets/Tiles/Hills"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 4:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-9};
			if(type==4){offset=-10};
			variant= "Assets/Tiles/Mountains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 5:
			var offset=-8;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Volcano.PNG";
			break;

		case 6:
			var offset=0;
			var variant=0;
			//alert(X+" "+Y);
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].Urbanistics > 0){variant+=1}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].Urbanistics>0){variant+=2}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].Urbanistics>0){variant+=4}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].Urbanistics > 0){variant+=8}};
			//if(X>0){if((Map[X-1][Y]>5 && Map[X-1][Y]<15) || (Map[X-1][Y]>20 && (Map[X-1][Y]<23))){variant+=1}};
			//if(Y<Map[0].length){if((Map[X][Y+1]>5 && Map[X][Y+1]<15) || (Map[X][Y+1]>20 && (Map[X][Y+1]<23))){variant+=2}};
			//if(X<Map.length){if((Map[X+1][Y]>5 && Map[X+1][Y]<15) || (Map[X+1][Y]>20 && (Map[X+1][Y]<23))){variant+=4}};
			//if(Y>0){if((Map[X][Y-1]>5 && Map[X][Y-1]<15) || (Map[X][Y-1]>20 && (Map[X][Y-1]<23))){variant+=2}};
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src="Assets/Tiles/Road"+variant+".PNG";
			break;

		case 7:
			var offset=-0;
			var type= Math.ceil(Math.random()*2);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Ruins"+type+".PNG";
			break;

		case 8:
			var offset=-0;
			var type= Math.ceil(Math.random()*3);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Urban District"+type+".PNG";
			break;

		case 9:
			var offset=-10;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Industrial District.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 10:
			var offset=-8;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Military-Industrial Complex.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 11:
			var offset=-14;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Aviation Industrial Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 12:
			var offset=-14;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Shipbuilding Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 13:
			var offset=0;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Headquarters.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 14:
			var offset=-18;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Command Center.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditationColor].ChromaCode;
			break;

		case 15:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Taiga"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 16:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Desert"+type+".PNG";
			break;

		case 17:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			variant= "Assets/Tiles/Tundra"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 18:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Extreme Desert"+type+".PNG";
			break;

		case 19:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Arctic Hellhole"+type+".PNG";
			break;

		case 20:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].SailThrough<100){axis="H"}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].SailThrough<100){axis="V"}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].SailThrough<100){axis="H"}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].SailThrough<100){axis="V"}};
			if(X>1){if(EditorMap[X-2][Y-1]==20 || EditorMap[X-2][Y-1]==21){axis="V"}};
			if(Y<10){if(EditorMap[X-1][Y]==20 || EditorMap[X-1][Y]==21){axis="V"}};
			if(X<10){if(EditorMap[X][Y-1]==20 || EditorMap[X][Y-1]==21){axis="V"}};
			if(Y>1){if(EditorMap[X-1][Y-2]==20 || EditorMap[X-1][Y-2]==21){axis="V"}};

			if(axis=="V"){
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].WalkThrough<100){variant+=1;}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].WalkThrough<100){variant+=2;}};};
			if(axis=="H"){if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].WalkThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].WalkThrough<100){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Bridge"+axis+variant+".PNG";
			break;

		case 21:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].SailThrough<100){axis="H"}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].SailThrough<100){axis="V"}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].SailThrough<100){axis="H"}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].SailThrough<100){axis="V"}};
			if(X>1){if(EditorMap[X-2][Y-1]==20 || EditorMap[X-2][Y-1]==21){axis="V"}};
			if(Y<10){if(EditorMap[X-1][Y]==20 || EditorMap[X-1][Y]==21){axis="V"}};
			if(X<10){if(EditorMap[X][Y-1]==20 || EditorMap[X][Y-1]==21){axis="V"}};
			if(Y>1){if(EditorMap[X-1][Y-2]==20 || EditorMap[X-1][Y-2]==21){axis="V"}};

			if(axis=="V"){
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].WalkThrough<100){variant+=1;}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].WalkThrough<100){variant+=2;}};};
			if(axis=="H"){if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].WalkThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].WalkThrough<100){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/HighBridge"+axis+variant+".PNG";
			break;

		case 22:
			var offset=0;
			var variant=0;

			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].SailThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].SailThrough<100){variant+=2;}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].SailThrough<100){variant+=4;}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].SailThrough<100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/River"+variant+".PNG";
			break;

		case 23:
			var offset=0;
			var variant=0;
			//alert(Y);
			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].SailThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].SailThrough<100){variant+=2;}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].SailThrough<100){variant+=4;}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].SailThrough<100){variant+=8;}};
			if(X==1){variant+=1};
			if(Y==10){variant+=2};
			if(X==10){variant+=4};
			if(Y==1){variant+=8};

			if(X>1 && Y>1){if(Terrain[EditorMap[X-2][Y-2]].SailThrough==100 && variant==15){document.getElementById("A "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible"}};
			if(X>1 && Y<10){if(Terrain[EditorMap[X-2][Y]].SailThrough==100 && variant==15){document.getElementById("B "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible"}};
			if(X<10 && Y>1){if(Terrain[EditorMap[X][Y-2]].SailThrough==100 && variant==15){document.getElementById("C "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible"}};
			if(X<10 && Y<10){if(Terrain[EditorMap[X][Y]].SailThrough==100 && variant==15){document.getElementById("D "+(X+1-StandardX)+"X"+(Y+1-StandardY)).style.visibility="visible"}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Sea"+variant+".PNG";
			break;

		case 24:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Reef"+type+".PNG";
			break;

		case 25:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Floes"+type+".PNG";
			break;	

		case 26:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Archipelago"+type+".PNG";
			break;	

		case 27:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Rocks"+type+".PNG";
			break;	

		case 28:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Icebergs"+type+".PNG";
			break;	

		case 29:
			var offset=0;
			var variant=0;

			if(X>1){if(Terrain[EditorMap[X-2][Y-1]].SailThrough==100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1][Y]].SailThrough==100){variant+=2;}};
			if(X<10){if(Terrain[EditorMap[X][Y-1]].SailThrough==100){variant+=4;}};
			if(Y>1){if(Terrain[EditorMap[X-1][Y-2]].SailThrough==100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Shore"+variant+".PNG";
			break;

		case 30:
			//var offset=-9;
			EditorControlMap[X+EditorStandardX-1][Y+EditorStandardY-1]=EditationColor;
			//document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Oil Rig"+".PNG";
			break;

		default:break;
		}
	}else{
	let Chosenunit=ChosenUnit-10+10*EditorUnitClass;
	let choka=Units[Chosenunit].Movement;
	let boka=Terrain[EditorMap[X+EditorStandardX-1][Y+EditorStandardY-1]];
	if(choka=="Foot"){boka=boka.WalkThrough}else if(choka=="Wheeled"){boka=boka.DriveThrough}else if(choka=="Tracked"){boka=boka.RollThrough}else if(choka=="Amphibious"){boka=boka.WadeThrough}else if(choka=="Flight"){boka=boka.FlyThrough}else if(choka=="Rudder"){boka=boka.SailThrough}else if(choka=="Heavy Rudder"){boka=boka.DeepSailThrough}else if(choka=="Stationary"){boka=boka.SailThrough-1}

	if(100>boka){
		if(MemoryX==X && MemoryY==Y){EditationDirection++}else{EditationDirection=1};
		if(EditationDirection>4){EditationDirection-=4};
		MemoryX=X;
		MemoryY=Y;
		document.getElementById("Entity "+X+" X "+Y).src="Assets/Units/Static/"+Units[Chosenunit].shortname+EditationDirection+".PNG";
		//document.getElementById("Entity "+X+" X "+Y).style.filter=Factions[EditationColor].ChromaCode;
		document.getElementById("Entity "+X+" X "+Y).style.left=(Units[Chosenunit].StaticOffsetX ?? [0,0,0,0,0])[EditationDirection]+"px";
		document.getElementById("Entity "+X+" X "+Y).style.top=(Units[Chosenunit].StaticOffsetY ?? [0,0,0,0,0])[EditationDirection]+"px";
		EditorEntityMap[X+EditorStandardX-1][Y+EditorStandardY-1]={id:Chosenunit, faction:EditationColor, direction:EditationDirection, x:X+EditorStandardX-1, y:Y+EditorStandardY-1,hpModifier:0,morale:0};	
	}};};
function RefreshTile(X,Y){

	if(EditationToggle=="Tile"){
		let ics=X;
		let igrec=Y;
		let TileAdress="Tile "+X+" X "+Y;
		let Altdress="Entity "+ics+" X "+igrec;
		let AltCoreDress="EntityCore "+ics+" X "+igrec;
		let Strucdress="Structure "+X+" X "+Y;
		document.getElementById(TileAdress).style.top="0px";
		let unit=EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1];
		let Biome=CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex??EditorBiomeMap[X-1][Y-1];
		if(Biome!=undefined){EditorBiomeMap[X-1][Y-1]=Biome;};
		if(Biome==1){Biome=""};
		if(Biome==2){Biome="Arid"};
		if(Biome==3){Biome="Boreal"};
		if(Biome==4){Biome="Barren"};
		if(Biome==5){Biome="Arctic"};
		if(Biome==6){Biome="Lunar"};
		if(Biome==7){Biome="Martian"};
		if((CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex??0)!=0){Biome=""};

		document.getElementById(Strucdress).style.visibility="hidden";
		//alert("a "+(X-EditorStandardX)+" X "+(Y-EditorStandardY));
		document.getElementById("a "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("b "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("c "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("d "+(X)+" X "+(Y)).style.visibility="hidden";

		if(EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]!=0){
			document.getElementById(Altdress).style.visibility="inherit";
			document.getElementById(AltCoreDress).style.filter=Factions[EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].faction].ChromaCode;
			document.getElementById(Altdress).style.top=(Units[unit.id].StaticOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
			document.getElementById(Altdress).style.left=(Units[unit.id].StaticOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";

			document.getElementById(Altdress).src="Assets/Units/Static/"+Units[EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].id].shortname+EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].direction+".PNG";
		}else{document.getElementById(Altdress).style.visibility="hidden";};



		let Class=CampaignTerrain[EditorMap[ics-1][igrec-1]].Class;
		//alert(ics+" "+igrec);
		//let TileAdress="Tile "+(ics+1)+" X "+(igrec+1);
		//let Strucdress="Structure "+(ics+1)+" X "+(igrec+1);
		let a=ics-1;
		let b=igrec-1;
		let D1=0;
		let D2=0;
		let D3=0;
		let D4=0;

		if(a>0){D1=EditorMap[a-1][b]};
		if(b<EditorMap[0].length-1){D2=EditorMap[a][b+1]};
		if(a<EditorMap.length-1){D3=EditorMap[a+1][b]};
		if(b>0){D4=EditorMap[a][b-1]};
		let Map=EditorMap;
		document.getElementById(Strucdress).style.visibility="hidden";

	switch(Class){

		case "LF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;
			break;

		case "LA":
			var type=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			//console.log(CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex);
			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;
			break;

		case "WE":
			var type=0;

			if(Terrain[D1].Class=="WF" || Terrain[D1].Class=="WA" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="B" || Terrain[D1].Class=="WS" || a==0){type+=1};
			if(Terrain[D2].Class=="WF" || Terrain[D2].Class=="WA" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="B" || Terrain[D2].Class=="WS"|| b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="WF" || Terrain[D3].Class=="WA" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="B" || Terrain[D3].Class=="WS"|| a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="WF" || Terrain[D4].Class=="WA" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="B" || Terrain[D4].Class=="WS"|| b==0){type+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;



			break;

		case "WA":
			var type=0;

			if(Terrain[D1].Class=="WA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="WF" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="B"){type+=1};
			if(Terrain[D2].Class=="WA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="WF" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="B"){type+=2};
			if(Terrain[D3].Class=="WA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="WF" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="B"){type+=4};
			if(Terrain[D4].Class=="WA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="WF" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="B"){type+=8};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "WF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;

			break;

		case "WS":
			var underType=0;
			if(Terrain[D1].SailThrough<100){underType+=1};
			if(Terrain[D2].SailThrough<100){underType+=2};
			if(Terrain[D3].SailThrough<100){underType+=4};
			if(Terrain[D4].SailThrough<100){underType+=8};

			if(a>=1 && b>=1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>=1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>=1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};


			//EditorControlMap[a][b]=EditationColor;
			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Sea"+underType+".PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;


			break;

		case "MC":
			var type=0;
			var axis="H";
			var alttype=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S" || Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S" || Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S" || Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S" || Terrain[D4].Class=="MC"){axis="H"};

			if((Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S")&&(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S")){axis="H"};
			if((Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S")&&(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S")){axis="V"};

			if(Terrain[D1].Class=="MC"){axis="V"};
			if(Terrain[D2].Class=="MC"){axis="H"};
			if(Terrain[D3].Class=="MC"){axis="V"};
			if(Terrain[D4].Class=="MC"){axis="H"};

			if(Terrain[D1].Class=="MC"){alttype+=1};
			if(Terrain[D2].Class=="MC"){alttype+=2};
			if(Terrain[D3].Class=="MC"){alttype+=4};
			if(Terrain[D4].Class=="MC"){alttype+=8};
	
			for(let c=0; c<4; c++){if(alttype==15-Math.pow(2,c)){axis="T"}};
			if(alttype==15){axis="O"};

			if(axis=="H"){

			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S"){type+=2};
			if(type>0){type+=Biome};


			}else if(axis=="V"){

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S"){type+=2};
			if(type>0){type+=Biome};

			}else if(axis=="T"){
				type="";
				if(alttype==14){type="A"};
				if(alttype==13){type="B"};
				if(alttype==11){type="C"};
				if(alttype==7){type="D"};


			}else if(axis=="O"){
				type="";

			};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+axis+type+".PNG";
			document.getElementById(TileAdress).style.top=Terrain[Map[a][b]].Offset+"px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "B":
			var type=0;
			
			/*if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || a==0){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || b==0){type+=8};*/

			if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			if(a>1 && b>1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("a "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeA"+BiomeRegistry[EditorBiomeMap[a-1][b-1]].Nominator+".PNG"}};
			if(a>1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("b "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeB"+BiomeRegistry[EditorBiomeMap[a-1][b+1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b>1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D2].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("c "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeC"+BiomeRegistry[EditorBiomeMap[a+1][b-1]].Nominator+".PNG"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D4].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="inherit";document.getElementById("d "+(a+1)+" X "+(b+1)).src="Assets/Tiles/EdgeD"+BiomeRegistry[EditorBiomeMap[a+1][b+1]].Nominator+".PNG"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "S":
			//To do: Manipulate underlying terrain to be a proper road, not a grass tile
			let undertype=0;
			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){undertype+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){undertype+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){undertype+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){undertype+=8};


			//EditorControlMap[a][b]=EditationColor;
			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Road"+undertype+Biome+".PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;

			break;
		}

	}else{};};
function RefreshMapEditor(){

	for(let ics=1;ics<=x;ics++){for(let igrec=1;igrec<=y;igrec++){

		let X=ics;
		let Y=igrec;
		let TileAdress="Tile "+X+" X "+Y;
		let Altdress="Entity "+ics+" X "+igrec;
		let Strucdress="Structure "+X+" X "+Y;
		let unit=EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1];

		document.getElementById(Strucdress).style.visibility="hidden";
		//alert("a "+(X-EditorStandardX)+" X "+(Y-EditorStandardY));
		document.getElementById("a "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("b "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("c "+(X)+" X "+(Y)).style.visibility="hidden";
		document.getElementById("d "+(X)+" X "+(Y)).style.visibility="hidden";

		if(EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]!=0){
			document.getElementById(Altdress).style.visibility="inherit";
			document.getElementById(Altdress).style.filter=Factions[EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].faction].ChromaCode;
			document.getElementById(Altdress).style.top=(Units[unit.id].StaticOffsetY ?? [0,0,0,0,0])[unit.direction]+"px";
			document.getElementById(Altdress).style.left=(Units[unit.id].StaticOffsetX ?? [0,0,0,0,0])[unit.direction]+"px";

			document.getElementById(Altdress).src="Assets/Units/Static/"+Units[EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].id].shortname+EditorEntityMap[ics+EditorStandardX-1][igrec+EditorStandardY-1].direction+".PNG";
		}else{document.getElementById(Altdress).style.visibility="hidden";};



		let Class=CampaignTerrain[EditorMap[ics-1][igrec-1]].Class;
		//alert(ics+" "+igrec);
		//let TileAdress="Tile "+(ics+1)+" X "+(igrec+1);
		//let Strucdress="Structure "+(ics+1)+" X "+(igrec+1);
		let a=ics-1;
		let b=igrec-1;
		let D1=0;
		let D2=0;
		let D3=0;
		let D4=0;

		let BiomeIndicator=CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex??1;
		if(BiomeIndicator!=1){EditorBiomeMap[ics-1][igrec-1]=BiomeIndicator};
		let Biome=EditorBiomeMap[ics-1][igrec-1]??1;

		//console.log(Biome);
		//if(Biome!=undefined){EditorBiomeMap[X-1][Y-1]=Biome;};
		if(Biome==1){Biome=""};
		if(Biome==2){Biome="Arid"};
		if(Biome==3){Biome="Boreal"};
		if(Biome==4){Biome="Barren"};
		if(Biome==5){Biome="Arctic"};
		if(Biome==6){Biome="Lunar"};
		if(Biome==7){Biome="Martian"};

		if((CampaignTerrain[EditorMap[ics-1][igrec-1]].BiomeIndex??0)!=0){Biome=""};


		if(a>0){D1=EditorMap[a-1][b]};
		if(b<EditorMap[0].length-1){D2=EditorMap[a][b+1]};
		if(a<EditorMap.length-1){D3=EditorMap[a+1][b]};
		if(b>0){D4=EditorMap[a][b-1]};
		let Map=EditorMap;
	document.getElementById(Strucdress).style.visibility="hidden";

	switch(Class){

		case "LF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;
			break;

		case "LA":
			var type=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){type+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){type+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){type+=8};

			//console.log(Biome);
			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;
			break;

		case "WE":
			var type=0;

			if(Terrain[D1].Class=="WF" || Terrain[D1].Class=="WA" || Terrain[D1].Class=="WE" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="B" || a==0){type+=1};
			if(Terrain[D2].Class=="WF" || Terrain[D2].Class=="WA" || Terrain[D2].Class=="WE" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="B" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="WF" || Terrain[D3].Class=="WA" || Terrain[D3].Class=="WE" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="B" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="WF" || Terrain[D4].Class=="WA" || Terrain[D4].Class=="WE" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="B" || b==0){type+=8};

			if(a>1 && b>1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a>1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a<Map.length-1 && b>1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D2].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D4].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="visible"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;



			break;

		case "WA":
			var type=0;

			if(Terrain[D1].Class=="WA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="WF" || Terrain[D1].Class=="WE"){type+=1};
			if(Terrain[D2].Class=="WA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="WF" || Terrain[D2].Class=="WE"){type+=2};
			if(Terrain[D3].Class=="WA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="WF" || Terrain[D3].Class=="WE"){type+=4};
			if(Terrain[D4].Class=="WA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="WF" || Terrain[D4].Class=="WE"){type+=8};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "WF":
			var type= Math.ceil(Math.random()*Terrain[Map[a][b]].Variants);
			var offset=Terrain[Map[a][b]].Offsets[type-1];
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+type+".PNG";
			document.getElementById(TileAdress).style.top=offset+"px";
			document.getElementById(TileAdress).src=variant;

			break;

		case "WS":

			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Sea15"+undertype+Biome+".PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;

			break;

		case "MC":
			var type=0;
			var axis="H";
			var alttype=0;

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S"){axis="V"};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S"){axis="H"};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S"){axis="V"};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S"){axis="H"};

			if((Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S")&&(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S")){axis="H"};
			if((Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S")&&(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S")){axis="V"};

			if(Terrain[D1].Class=="MC"){alttype+=1};
			if(Terrain[D2].Class=="MC"){alttype+=2};
			if(Terrain[D3].Class=="MC"){alttype+=4};
			if(Terrain[D4].Class=="MC"){alttype+=8};
	
			for(let c=0; c<4; c++){if(alttype==15-Math.pow(2,c)){axis="T"}};
			if(alttype==15){axis="O"};

			if(axis=="H"){

			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="LF" || Terrain[D4].Class=="S"){type+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="LF" || Terrain[D2].Class=="S"){type+=2};
			type+=Biome;


			}else if(axis=="V"){

			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="LF" || Terrain[D1].Class=="S"){type+=1};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="LF" || Terrain[D3].Class=="S"){type+=2};
			type+=Biome

			}else if(axis=="T"){
				type="";
				if(alttype==14){type="A"};
				if(alttype==13){type="B"};
				if(alttype==11){type="C"};
				if(alttype==7){type="D"};


			}else if(axis=="O"){
				type="";

			};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+axis+type+".PNG";
			document.getElementById(TileAdress).style.top=Terrain[Map[a][b]].Offset+"px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "B":
			var type=0;

			if(Terrain[D1].Class=="LF" || Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S" || a==0){type+=1};
			if(Terrain[D2].Class=="LF" || Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S" || b==Map[0].length-1){type+=2};
			if(Terrain[D3].Class=="LF" || Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S" || a==Map.length-1){type+=4};
			if(Terrain[D4].Class=="LF" || Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S" || b==0){type+=8};

			if(a>1 && b>1){if(Terrain[Map[a-1][b-1]].SailThrough>=100 && Terrain[D4].SailThrough<100 && Terrain[D1].SailThrough<100){document.getElementById("a "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a>1 && b<Map[0].length-1){if(Terrain[Map[a-1][b+1]].SailThrough>=100 && Terrain[D1].SailThrough<100 && Terrain[D2].SailThrough<100){document.getElementById("b "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a<Map.length-1 && b>1){if(Terrain[Map[a+1][b-1]].SailThrough>=100 && Terrain[D2].SailThrough<100 && Terrain[D3].SailThrough<100){document.getElementById("c "+(a+1)+" X "+(b+1)).style.visibility="visible"}};
			if(a<Map.length-1 && b<Map[0].length-1){if(Terrain[Map[a+1][b+1]].SailThrough>=100 && Terrain[D3].SailThrough<100 && Terrain[D4].SailThrough<100){document.getElementById("d "+(a+1)+" X "+(b+1)).style.visibility="visible"}};

			var Var="Assets/Tiles/"+Terrain[Map[a][b]].name+type+Biome+".PNG";
			document.getElementById(TileAdress).style.top="0px";
			document.getElementById(TileAdress).src=Var;

			break;

		case "S":
			//To do: Manipulate underlying terrain to be a proper road, not a grass tile
			let undertype=0;
			if(Terrain[D1].Class=="LA" || Terrain[D1].Class=="MC" || Terrain[D1].Class=="S"){undertype+=1};
			if(Terrain[D2].Class=="LA" || Terrain[D2].Class=="MC" || Terrain[D2].Class=="S"){undertype+=2};
			if(Terrain[D3].Class=="LA" || Terrain[D3].Class=="MC" || Terrain[D3].Class=="S"){undertype+=4};
			if(Terrain[D4].Class=="LA" || Terrain[D4].Class=="MC" || Terrain[D4].Class=="S"){undertype+=8};



			var offset=Terrain[Map[a][b]].Offset;
			var variant="Assets/Tiles/"+Terrain[Map[a][b]].name+".PNG";
			var undervar="Assets/Tiles/Road"+undertype+Biome+".PNG";
			document.getElementById(Strucdress).style.visibility="visible";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[a][b]].ChromaCode;
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src=variant;
			document.getElementById(TileAdress).src=undervar;

			break;
		}


		/*
		switch(EditorMap[ics-1+EditorStandardX][igrec-1+EditorStandardY]){
		case 1:
			var type= Math.ceil(Math.random()*8);
			var offset=0;
			variant= "Assets/Tiles/Plains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			//document.getElementById(Address).style.filter="hue-rotate(0deg) saturate(100%) brightness(100%)";
			document.getElementById(Address).src=variant;
			break;

		case 2:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Forest"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

			case 3:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==3){offset=-4};
			if(type==4){offset=-5};
			variant= "Assets/Tiles/Hills"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 4:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-9};
			if(type==4){offset=-10};
			variant= "Assets/Tiles/Mountains"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 5:
			var offset=-8;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Volcano.PNG";
			break;

		case 6:
			var offset=0;
			var variant=0;
			//alert(X+" "+Y);
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].Urbanistics > 0){variant+=1}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].Urbanistics>0){variant+=2}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].Urbanistics>0){variant+=4}};
			if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].Urbanistics > 0){variant+=8}};
			//if(X>0){if((Map[X-1][Y]>5 && Map[X-1][Y]<15) || (Map[X-1][Y]>20 && (Map[X-1][Y]<23))){variant+=1}};
			//if(Y<Map[0].length){if((Map[X][Y+1]>5 && Map[X][Y+1]<15) || (Map[X][Y+1]>20 && (Map[X][Y+1]<23))){variant+=2}};
			//if(X<Map.length){if((Map[X+1][Y]>5 && Map[X+1][Y]<15) || (Map[X+1][Y]>20 && (Map[X+1][Y]<23))){variant+=4}};
			//if(Y>0){if((Map[X][Y-1]>5 && Map[X][Y-1]<15) || (Map[X][Y-1]>20 && (Map[X][Y-1]<23))){variant+=2}};
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src="Assets/Tiles/Road"+variant+".PNG";
			break;

		case 7:
			var offset=-14;
			var type= Math.ceil(Math.random()*2);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Ruins"+type+".PNG";
			break;

		case 8:
			var offset=-14;
			var type= Math.ceil(Math.random()*4);
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Urban District"+type+".PNG";
			break;

		case 9:
			var offset=-10;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Industrial District.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;

		case 10:
			var offset=-8;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Military-Industrial Complex.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;

		case 11:
			var offset=-14;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Aviation Industrial Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;

		case 12:
			var offset=-14;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Shipbuilding Facility.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;

		case 13:
			var offset=0;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Headquarters.PNG";
			//alert(EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]);
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;

			break;

		case 14:
			var offset=-18;
			document.getElementById(Address).style.top="0px";
			document.getElementById(Address).src="Assets/Tiles/Plains.PNG";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Command Center.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;

		case 15:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			if(type==2){offset=-4};
			if(type==3){offset=-3};
			if(type==4){offset=-12}
			variant= "Assets/Tiles/Taiga"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 16:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Desert"+type+".PNG";
			break;

		case 17:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			variant= "Assets/Tiles/Tundra"+type+".PNG";
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src=variant;
			break;

		case 18:
			var type= Math.ceil(Math.random()*3);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Extreme Desert"+type+".PNG";
			break;

		case 19:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Arctic Hellhole"+type+".PNG";
			break;

		case 20:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){axis="H"}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].SailThrough<100){axis="V"}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){axis="H"}};
			if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].SailThrough<100){axis="V"}};
			if(X>1){if(EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]==20 || EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]==21){axis="V"}};
			if(Y<10){if(EditorMap[X-1+EditorStandardX][Y+EditorStandardY]==20 || EditorMap[X-1+EditorStandardX][Y+EditorStandardY]==21){axis="H"}};
			if(X<10){if(EditorMap[X+EditorStandardX][Y-1+EditorStandardY]==20 || EditorMap[X+EditorStandardX][Y-1+EditorStandardY]==21){axis="V"}};
			if(Y>1){if(EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]==20 || EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]==21){axis="H"}};

			if(axis=="V"){
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].WalkThrough<100 && EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]!=20 && EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]!=21){variant+=1;}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].WalkThrough<100 &&EditorMap[X+EditorStandardX][Y-1+EditorStandardY]!=20&&EditorMap[X+EditorStandardX][Y-1+EditorStandardY]!=21){variant+=2;}};};
			if(axis=="H"){if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].WalkThrough<100&&EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]!=20&&EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]!=21){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].WalkThrough<100&&EditorMap[X-1+EditorStandardX][Y+EditorStandardY]!=20&&EditorMap[X-1+EditorStandardX][Y+EditorStandardY]!=21){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Bridge"+axis+variant+".PNG";
			break;

		case 21:
			var offset=0;
			var axis="V";
			var variant=0;
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){axis="H"}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].SailThrough<100){axis="V"}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){axis="H"}};
			if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].SailThrough<100){axis="V"}};
			if(X>1){if(EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]==20 || EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]==21){axis="V"}};
			if(Y<10){if(EditorMap[X-1+EditorStandardX][Y+EditorStandardY]==20 || EditorMap[X-1+EditorStandardX][Y+EditorStandardY]==21){axis="H"}};
			if(X<10){if(EditorMap[X+EditorStandardX][Y-1+EditorStandardY]==20 || EditorMap[X+EditorStandardX][Y-1+EditorStandardY]==21){axis="V"}};
			if(Y>1){if(EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]==20 || EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]==21){axis="H"}};

			if(axis=="V"){
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].WalkThrough<100 && EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]!=20 && EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]!=21){variant+=1;}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].WalkThrough<100 &&EditorMap[X+EditorStandardX][Y-1+EditorStandardY]!=20&&EditorMap[X+EditorStandardX][Y-1+EditorStandardY]!=21){variant+=2;}};};
			if(axis=="H"){if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].WalkThrough<100&&EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]!=20&&EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]!=21){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].WalkThrough<100&&EditorMap[X-1+EditorStandardX][Y+EditorStandardY]!=20&&EditorMap[X-1+EditorStandardX][Y+EditorStandardY]!=21){variant+=2;}};};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/HighBridge"+axis+variant+".PNG";
			break;

		case 22:
			var offset=0;
			var variant=0;

			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].SailThrough<100){variant+=2;}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){variant+=4;}};
			if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].SailThrough<100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/River"+variant+".PNG";
			break;

		case 23:
			var offset=0;
			var variant=0;
			//alert(Y);
			if(X>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){variant+=1;}};
			if(Y<10){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].SailThrough<100){variant+=2;}};
			if(X<10){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].SailThrough<100){variant+=4;}};
			if(Y>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].SailThrough<100){variant+=8;}};
			if(X==1){variant+=1};
			if(Y==10){variant+=2};
			if(X==10){variant+=4};
			if(Y==1){variant+=8};
			//alert(Y-EditorStandardY);
			if(X>1 && Y>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-2+EditorStandardY]].SailThrough==100 && (variant==15 || variant==9 || variant==11 || variant==13)){document.getElementById("a "+(X)+" X "+(Y)).style.visibility="inherit"}};
			if(X>1 && Y<10){if(Terrain[EditorMap[X-2+EditorStandardX][Y+EditorStandardY]].SailThrough==100 && (variant==15 || variant==3 || variant==7 || variant==11)){document.getElementById("b "+(X)+" X "+(Y)).style.visibility="inherit"}};
			if(X<10 && Y>1){if(Terrain[EditorMap[X+EditorStandardX][Y-2+EditorStandardY]].SailThrough==100 && (variant==15 || variant==12 || variant==13 || variant==14)){document.getElementById("c "+(X)+" X "+(Y)).style.visibility="inherit"}};
			if(X<10 && Y<10){if(Terrain[EditorMap[X+EditorStandardX][Y+EditorStandardY]].SailThrough==100 && (variant==15 || variant==6 || variant==7 || variant==15)){document.getElementById("d "+(X)+" X "+(Y)).style.visibility="inherit"}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Sea"+variant+".PNG";
			break;

		case 24:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Reef"+type+".PNG";
			break;

		case 25:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Floes"+type+".PNG";
			break;	

		case 26:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Archipelago"+type+".PNG";
			break;	

		case 27:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Rocks"+type+".PNG";
			break;	

		case 28:
			var type= Math.ceil(Math.random()*4);
			var offset=0;
			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Icebergs"+type+".PNG";
			break;	

		case 29:
			var offset=0;
			var variant=0;

			if(X+EditorStandardX>1){if(Terrain[EditorMap[X-2+EditorStandardX][Y-1+EditorStandardY]].SailThrough==100){variant+=1;}};
			if(Y+EditorStandardY<EditorMap[0].length){if(Terrain[EditorMap[X-1+EditorStandardX][Y+EditorStandardY]].SailThrough==100){variant+=2;}};
			if(X+EditorStandardX<EditorMap.length){if(Terrain[EditorMap[X+EditorStandardX][Y-1+EditorStandardY]].SailThrough==100){variant+=4;}};
			if(Y+EditorStandardY>1){if(Terrain[EditorMap[X-1+EditorStandardX][Y-2+EditorStandardY]].SailThrough==100){variant+=8;}};

			document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Address).src= "Assets/Tiles/Shore"+variant+".PNG";
			break;

		case 30:
			var offset=-9;
			document.getElementById(Address).src="Assets/Tiles/Sea.PNG";
			//document.getElementById(Address).style.top=offset+"px";
			document.getElementById(Strucdress).style.visibility="inherit";
			document.getElementById(Strucdress).style.top=offset+"px";
			document.getElementById(Strucdress).src= "Assets/Tiles/Oil Rig.PNG";
			document.getElementById(Strucdress).style.filter=Factions[EditorControlMap[ics+EditorStandardX-1][igrec+EditorStandardY-1]].ChromaCode;
			break;




			default:break;
		};*/
		


	}};};
function RegionalizeTile(X,Y){
	//alert(X);
	let adr=EditorMap[Y+EditorStandardX][X+EditorStandardY];
	if(adr==13 || adr==14 || adr==30){SelectedNode=CapitolNodeRegistry[Y+EditorStandardX][X+EditorStandardY]??{Name:"null"};EditorRegionMap[Y+EditorStandardX][X+EditorStandardY]=SelectedNode.Name;}

	else{document.getElementById("regional Color "+X+" "+Y).style.background=(Factions[SelectedNode.Owner]??{color:"Grey"}).color;
	EditorRegionMap[Y+EditorStandardX][X+EditorStandardY]=SelectedNode.Name;


	};

	for(let x=1;x<=10;x++){for(let y=1;y<=10;y++){
		let SpReg=EditorRegionMap[x+EditorStandardX-1][y+EditorStandardY-1];
		//alert(SpReg);
		//alert(EditorRegionMap[Math.max(0,x+EditorStandardX-1)][y+EditorStandardY-1]);
		if(EditorRegionMap[Math.max(0,x+EditorStandardX-2)][y+EditorStandardY-1] != SpReg){document.getElementById('Nborder '+(y-1)+" "+(x-1)).style.visibility="inherit"}else{document.getElementById('Nborder '+(y-1)+" "+(x-1)).style.visibility="hidden"};
		if(EditorRegionMap[x+EditorStandardX-1][Math.max(0,y+EditorStandardY-2)] != SpReg){document.getElementById('Wborder '+(y-1)+" "+(x-1)).style.visibility="inherit"}else{document.getElementById('Wborder '+(y-1)+" "+(x-1)).style.visibility="hidden"};
		if(EditorRegionMap[Math.min(9,x+EditorStandardX)][y+EditorStandardY-1] != SpReg){document.getElementById('Sborder '+(y-1)+" "+(x-1)).style.visibility="inherit"}else{document.getElementById('Sborder '+(y-1)+" "+(x-1)).style.visibility="hidden"};
		if(EditorRegionMap[x+EditorStandardX-1][Math.min(9,y+EditorStandardY)] != SpReg){document.getElementById('Eborder '+(y-1)+" "+(x-1)).style.visibility="inherit"}else{document.getElementById('Eborder '+(y-1)+" "+(x-1)).style.visibility="hidden"};
		}};};
function RemoveKebabIMeanBlep(){
	for(let Me_Go=0;Me_Go<=Map.length;Me_Go++){for(let It_Be=0;It_Be<=Map[0].length;It_Be++){

		thingy=document.getElementById("Blep-"+Me_Go+"-"+It_Be) ?? 0;
		if(thingy!=0){thingy.remove();};
		second_thingy=document.getElementById("Ctep-"+Me_Go+"-"+It_Be) ?? 0;
		if(second_thingy!=0){second_thingy.remove();};
		third_thingy=document.getElementById("Spep-"+Me_Go+"-"+It_Be) ?? 0;
		if(third_thingy!=0){third_thingy.remove();};
		fourth_thingy=document.getElementById("Hlep-"+Me_Go+"-"+It_Be) ?? 0;
		if(fourth_thingy!=0){fourth_thingy.remove();};
		fifth_thingy=document.getElementById("Crep-"+Me_Go+"-"+It_Be) ?? 0;
		if(fifth_thingy!=0){fifth_thingy.remove();};
		let blarg_thingy=document.getElementById("BLARG "+Me_Go+"X"+It_Be) ?? 0;
		if(blarg_thingy!=0){blarg_thingy.src="Assets/Miscellaneous/Nothing.PNG";};}};
	function ToggleTargetMarker(Type){};};
function RemoveMarker(index){
	marker=document.getElementById("Marker"+index);
	marker.remove();};
function RetrieveAllMapData(){
	//console.log("Protocol={");
	let TotalKey="Protocol={\n";

	TotalKey+='Name:"",\n';
	TotalKey+='Desc:"",\n';

	let GeneralsList=[Nobody,WhiteGeneral,BlackGeneral,GreyGeneral,IndigoGeneral,GreenGeneral,GrayGeneral,YellowGeneral,BrownGeneral,RedGeneral,BlueGeneral];
	let GeneralsListAlter=["Nobody","WhiteGeneral","BlackGeneral","GreyGeneral","IndigoGeneral","GreenGeneral","GrayGeneral","YellowGeneral","BrownGeneral","RedGeneral","BlueGeneral"];
	let CommanderList=[Nobody];
	CommanderList[1]=GeneralsList[EditationColor];



	

	let MapKey="Map:[";
	for(let i=0;i<x;i++){MapKey+="["+EditorMap[i]+"]";
	if(i<x-1){MapKey+=",\n";};};
	MapKey+="],\n";
	//console.log(MapKey);

	let RosterKey='Roster:[{index:0, id:"null", faction:"null", direction:"null", x:"null", y:"null", morale:0, hpModifier:0, defaultX:0,defaultY:0}\n';

	for(let i=0; i<x;i++){for(let j=0; j<y;j++){
		if(EditorEntityMap[i][j]!=0){
			UnitEntry=',{id:'+EditorEntityMap[i][j].id+' , faction:'+EditorEntityMap[i][j].faction+' , direction:'+EditorEntityMap[i][j].direction+', x:'+EditorEntityMap[i][j].x+', y:'+EditorEntityMap[i][j].y+', morale:'+Math.min(2,Math.max(-4,EditorEntityMap[i][j].morale??0))+', hpModifier:'+Math.min(4,Math.max(-0.99, EditorEntityMap[i][j].HPI??0));
			//let hek=typeof(JSON.parse(EditorEntityMap[i][j].CustomName));
			//alert(hek);
			let canAdd=true;
			for(let k=1; k<CommanderList.length; k++){if(EditorEntityMap[i][j].faction==CommanderList[k].Allegiance){canAdd=false}};
			if(canAdd){CommanderList[CommanderList.length]=GeneralsList[EditorEntityMap[i][j].faction]};

			NumeSpecial=false;
			DescriereSpeciala=false;
			if((EditorEntityMap[i][j].CustomName??[false])[0]=='#'){NumeSpecial=true};
			if((EditorEntityMap[i][j].CustomDescription??[false])[0]=='#'){DescriereSpeciala=true};
			if(EditorEntityMap[i][j].CustomName??0 !=0){if(!NumeSpecial){UnitEntry+=', CustomName:'+"'"+EditorEntityMap[i][j].CustomName+"'"}else{
				let CheieNume=EditorEntityMap[i][j].CustomName;
				CheieNume=CheieNume.substring(1);
				//CheieNume=JSON.parse(CheieNume);
				//alert(CheieNume);
				//alert(Language.UnitSpecialNames[CheieNume]);
				UnitEntry+=', SpecialName:'+JSON.parse(CheieNume);
			}};

			if(EditorEntityMap[i][j].CustomDescription??0 !=0){if(!DescriereSpeciala){UnitEntry+=', CustomDescription:'+"'"+EditorEntityMap[i][j].CustomDescription+"'"}else{
				let CheieDescriere=EditorEntityMap[i][j].CustomName;
				CheieDescriere=CheieDescriere.substring(1);
				UnitEntry+=', SpecialDescription:'+JSON.parse(CheieDescriere);
			}};
			UnitEntry+='}\n';
			RosterKey+=UnitEntry;
		};
	}};
	//console.log(RosterKey);
	RosterKey+="],\n"
	let ControlKey="ControlMap:[";
	for(let i=0;i<x;i++){ControlKey+="["+EditorControlMap[i]+"]";
	if(i<x-1){ControlKey+=",\n";};};
	ControlKey+="],\n";

	let BiomeKey="BiomeMap:[";
	for(let i=0;i<x;i++){BiomeKey+="["+EditorBiomeMap[i]+"]";
	if(i<x-1){BiomeKey+=",\n";};};
	BiomeKey+="],\n";

	let LocKey="LocKey:[";
	for(let i=0;i<Localization.length;i++){
		let LK="{X:"+(Localization[i].X-1)+",Y:"+(Localization[i].Y-1)+",name:'"+Localization[i].name+"',Description:'"+Localization[i].description+"}, \n";
	LocKey+=LK;
	};
	LocKey+="],";

	let SurviveTimer=parseInt(document.getElementById("SurviveInput").value??77777)??77777;
	let TimeLimit=parseInt(document.getElementById("TimeLimitInput").value??77777)??77777;

	let StringCom="[Nobody";
	for(let d=1; d<CommanderList.length; d++){StringCom+=","+GeneralsListAlter[d]};
	StringCom+="]";
	CommanderList=StringCom;
	//CommanderList=JSON.stringify(CommanderList);
	let ConstantsKey="Constants:{YourFaction:"+EditationColor+",defaultX:0,defaultY:0,Survival:"+SurviveTimer+",TimeLimit:"+TimeLimit+",Capture:[],Defend:[],Defeat:[],Protect:[],Funds:[0,0,0],Commanders:"+CommanderList+"},\n";
	TotalKey+=ConstantsKey;

	TotalKey+=MapKey+RosterKey+ControlKey+BiomeKey;
	if(Localization.length>0){TotalKey+=LocKey};


	TotalKey+="\nFactions:GenericFactions,";
	TotalKey+="\nUnits:CampaignUnits,";
	TotalKey+="\nTerrain:CampaignTerrain";

	TotalKey+="};";

	console.log(TotalKey)};
function RetrieveControlCode(){
	let ControlKey="[";
	for(let i=0;i<x;i++){ControlKey+="["+EditorControlMap[i]+"]";
	if(i<x-1){ControlKey+=",\n";};};
	ControlKey+="]";
	alert(ControlKey);};
function RetrieveLocalization(){
	let LocKey="[";
	for(let i=0;i<Localization.length;i++){
		let LK="{X:"+(Localization[i].X-1)+",Y:"+(Localization[i].Y-1)+",name:'"+Localization[i].name+"',Description:'"+Localization[i].description+"'}, \n";
	LocKey+=LK;
	};
	//LocKey.pop();
	LocKey+="],";
	alert(LocKey);};
function RetrieveMapCode(){
	let MapKey="[";
	for(let i=0;i<x;i++){MapKey+="["+EditorMap[i]+"]";
	if(i<x-1){MapKey+=",\n";};};
	MapKey+="]";
	console.log(MapKey);};
function RetrieveRegionCode(){
	let RegionKey="[";
	for(let i=0;i<x;i++){RegionKey+="["+EditorRegionMap[i]+"]";
	if(i<x-1){RegionKey+=",\n";};};
	RegionKey+="]";

	let NodeKey="[";
	//for(let i=0;i<x;i++){NodeKey+="["+CapitolNodeRegistry[i]+"]";
	//if(i<x-1){NodeKey+=",\n";};};
	for(let i=0;i<x;i++){for(j=0;j<y;j++){
		if(CapitolNodeRegistry[i][j]!=1){
		NodeEntry='{Owner:'+CapitolNodeRegistry[i][j].Owner+',Capitol:"'+CapitolNodeRegistry[i][j].Capitol+'",CapitolX:'+CapitolNodeRegistry[i][j].CapitolX+',CapitolY:'+CapitolNodeRegistry[i][j].CapitolY+',Name:'+CapitolNodeRegistry[i][j].Name+'},\n';
		NodeKey+=NodeEntry;
		};
	}}
	NodeKey+="]";
	console.log(RegionKey);
	alert(NodeKey)};
function RetrieveRosterCode(){
	let RosterKey='[{index:0, id:"null", faction:"null", direction:"null", x:"null", y:"null", morale:0, hpModifier:0, defaultX:0,defaultY:0},\n';

	for(let i=0; i<x;i++){for(let j=0; j<y;j++){
		if(EditorEntityMap[i][j]!=0){
			UnitEntry='{id:'+EditorEntityMap[i][j].id+' , faction:'+EditorEntityMap[i][j].faction+' , direction:'+EditorEntityMap[i][j].direction+', x:'+EditorEntityMap[i][j].x+', y:'+EditorEntityMap[i][j].y+', morale:'+Math.min(2,Math.max(-4,EditorEntityMap[i][j].morale??0))+', hpModifier:'+Math.min(4,Math.max(-0.99, EditorEntityMap[i][j].HPI??0));
			//let hek=typeof(JSON.parse(EditorEntityMap[i][j].CustomName));
			//alert(hek);
			NumeSpecial=false;
			DescriereSpeciala=false;
			if((EditorEntityMap[i][j].CustomName??[false])[0]=='#'){NumeSpecial=true};
			if((EditorEntityMap[i][j].CustomDescription??[false])[0]=='#'){DescriereSpeciala=true};
			if(EditorEntityMap[i][j].CustomName??0 !=0){if(!NumeSpecial){UnitEntry+=', CustomName:'+"'"+EditorEntityMap[i][j].CustomName+"'"}else{
				let CheieNume=EditorEntityMap[i][j].CustomName;
				CheieNume=CheieNume.substring(1);
				//CheieNume=JSON.parse(CheieNume);
				//alert(CheieNume);
				//alert(Language.UnitSpecialNames[CheieNume]);
				UnitEntry+=', SpecialName:'+JSON.parse(CheieNume);
			}};

			if(EditorEntityMap[i][j].CustomDescription??0 !=0){if(!DescriereSpeciala){UnitEntry+=', CustomDescription:'+"'"+EditorEntityMap[i][j].CustomDescription+"'"}else{
				let CheieDescriere=EditorEntityMap[i][j].CustomName;
				CheieDescriere=CheieDescriere.substring(1);
				UnitEntry+=', SpecialDescription:'+JSON.parse(CheieDescriere);
			}};
			UnitEntry+='},\n';
			RosterKey+=UnitEntry;
		};
	}};
	alert(RosterKey);};
function RollMap(Direction){
	if(Direction==1){document.getElementById('UnitMap').scrollBy(0,-56);document.getElementById('RegionMap').scrollBy(0,-56)};
	if(Direction==2){document.getElementById('UnitMap').scrollBy(56,0);document.getElementById('RegionMap').scrollBy(56,0)};
	if(Direction==3){document.getElementById('UnitMap').scrollBy(0,56);document.getElementById('RegionMap').scrollBy(0,56)};
	if(Direction==4){document.getElementById('UnitMap').scrollBy(-56,0);document.getElementById('RegionMap').scrollBy(-56,0)};};
function RollMapEditor(Direction){
	if(Direction==1){document.getElementById('TileContainer').scrollBy(0,-280)};
	if(Direction==2){document.getElementById('TileContainer').scrollBy(280,0)};
	if(Direction==3){document.getElementById('TileContainer').scrollBy(0,280)};
	if(Direction==4){document.getElementById('TileContainer').scrollBy(-280,0)};};
function RunEvent(Event){

	if(Event.Intralogue!=0){if(DialogueChoice && Event.FactionTarget==PlayerChoiceFaction){launchDialogueBloc(Language.IntraeventTranscripts[Event.Intralogue],0)}};

					if(Event.SummonUnits.length>0){for(let c=0;c<Event.SummonUnits.length;c++){
						let newunit=Event.SummonUnits[c];
						if(rostermap[newunit.x-1][newunit.y-1]!=0){let SpilloverFraction=[];
						if(newunit.x>1 && rostermap[newunit.x-2][newunit.y-1]==0){SpilloverFraction[SpilloverFraction.length]=1};
						if(newunit.x<Map.length && rostermap[newunit.x][newunit.y-1]==0){SpilloverFraction[SpilloverFraction.length]=3};
						if(newunit.y<Map[0].length && rostermap[newunit.x-1][newunit.y]==0){SpilloverFraction[SpilloverFraction.length]=2};
						if(newunit.y>1 && rostermap[newunit.x-1][newunit.y-2]==0){SpilloverFraction[SpilloverFraction.length]=4};
						//alert(SpilloverFraction);
						let RelocationFraction=SpilloverFraction[Math.floor(Math.random()*SpilloverFraction.length)];
						if(RelocationFraction==1){rostermap[newunit.x-2][newunit.y-1]=rostermap[newunit.x-1][newunit.y-1]; rostermap[newunit.x-1][newunit.y-1]=0};
						if(RelocationFraction==2){rostermap[newunit.x-1][newunit.y]=rostermap[newunit.x-1][newunit.y-1]; rostermap[newunit.x-1][newunit.y-1]=0};
						if(RelocationFraction==3){rostermap[newunit.x][newunit.y-1]=rostermap[newunit.x-1][newunit.y-1]; rostermap[newunit.x-1][newunit.y-1]=0};
						if(RelocationFraction==4){rostermap[newunit.x-1][newunit.y-2]=rostermap[newunit.x-1][newunit.y-1]; rostermap[newunit.x-1][newunit.y-1]=0};
						refreshMap();
						//alert(rostermap[newunit.x-1][newunit.y-1].index+" "+[newunit.x-1,newunit.y-1]);

							if(SpilloverFraction.length==0){MapRoster[rostermap[newunit.x-1][newunit.y-1].index].life=0; rostermap[newunit.x-1][newunit.y-1].life=0; UnitLost(rostermap[newunit.x-1][newunit.y-1].index)}};
						DeployUnit(newunit.x,newunit.y,newunit.id,newunit.all,newunit.dir,newunit.hpi,newunit.mor,Language.UnitSpecialNames[newunit.cun??0],newunit.spn,Language.UnitSpecialDesc[newunit.cud??0],newunit.spd);
						for(let d=0;d<AttackOrder.length;d++){if(newunit.all==AttackOrder[d]){Constants.Funds[d+1]+=Units[newunit.id].Cost/2}; YourMoney=Constants.Funds[1]};
						setTimeout(function(){document.getElementById("Entity "+newunit.x+"X"+newunit.y).style.visibility='visible';
							document.getElementById("Entity "+newunit.x+"X"+newunit.y).style.top=(Units[newunit.id].StaticOffsetY??[0,0,0,0,0])[newunit.dir]+"px";
							document.getElementById("Entity "+newunit.x+"X"+newunit.y).style.left=(Units[newunit.id].StaticOffsetX??[0,0,0,0,0])[newunit.dir]+"px";
						document.getElementById("Entity "+newunit.x+"X"+newunit.y).src="Assets/Units/Static/"+Units[newunit.id].shortname+newunit.dir+".PNG";},1050)
						if(Event.SummonUnits[c].all==PlayerChoiceFaction){document.getElementById("Marker "+newunit.x+"X"+newunit.y).style.visibility="inherit"}
						//refreshMap(Map);
						//document.getElementById;

					}}
					if(Event.AlterCredits!=0){let orderindex=0;
					for(let d=0;d<AttackOrder.length;d++){if(Event.FactionTarget==AttackOrder[d]){Constants.Funds[d+1]+=Event.AlterCredits; if(d==0){YourMoney+=Event.AlterCredits}}};
					};

					if(Event.TerrainImpact.length>0){
						for(let e=0;e<Event.TerrainImpact.length;e++){
							Map[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y]=Event.TerrainImpact[e].id;
							if(rostermap[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y]!=0){
								let Key=false;
								let Speed=rostermap[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y].speed;
								let UnitKey=rostermap[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y];
								let TileKey=Terrain[Map[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y]];

								if(UnitKey.movementType=="Foot" && TileKey.WalkThrough>Speed){Key=true};
								if(UnitKey.movementType=="Wheeled" && TileKey.DriveThrough>Speed){Key=true};
								if(UnitKey.movementType=="Tracked" && TileKey.RollThrough>Speed){Key=true};
								if(UnitKey.movementType=="Flight" && TileKey.FlyThrough>Speed){Key=true};
								if(UnitKey.movementType=="Rudder" && TileKey.SailThrough>Speed){Key=true};
								if(UnitKey.movementType=="Heavy Rudder" && TileKey.DeepSailThrough>Speed){Key=true};
								if(UnitKey.movementType=="Amphibious" && TileKey.WadeThrough>Speed){Key=true};

								//Fix this too
								//if(Key){rostermap[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y].life=1; MapRoster[rostermap[Event.TerrainImpact[e].x][Event.TerrainImpact[e].y].index].life=1};
								if(Key){MapRoster[UnitKey.index].life=0;UnitLost(UnitKey.index)};
							};



						};
							//RefreshMap(Map);
					};
					if(Event.Inspire!=null){
						for(let h=0;h<MapRoster.length;h++){if(MapRoster[h].faction==Event.Inspire.fct){MapRoster[h].morale+=Event.Inspire.value}};

						};
					if(Event.Strike.length>0){
						for(let f=0;f<Event.Strike.length;f++){
							let target=Event.Strike[f];
							GhostAttack(target.id??0,target.x??0,target.y??0,target.dmg??0,target.anim??"Standard");
						};
					};
					if(Event.Display!=null){document.getElementById("Illustration").style.visibility='visible';document.getElementById("MidBattleIllustration").src=Event.Display};

					if(Event.Purge!=0){for(let g=0; g<MapRoster.length;g++){if(MapRoster[g].faction==Event.Purge){MapRoster[g].life=0;UnitLost(g)}}};

					if(Event.ChangeTune!=null){if(MusicChoice){BattleBGM.pause();BattleBGM.currentTime=0;BattleBGM.onloadeddata=null;clearTimeout(BGMLoop);PlayBGM(Event.ChangeTune)}};};
function SaveGame(){
	//let expires="expires= 31 Dec 9999 23:59:59 UTC";


	let LevelData=[[],[],[],[],[],[],[],[],[],[],[]];
	for (let i=0;i<35;i++){LevelData[0][LevelData[0].length]=Campaigns[0][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<35;i++){LevelData[1][LevelData[1].length]=Campaigns[1][Math.floor(i/5)][i%5].Finished};	
	for (let i=0;i<25;i++){LevelData[2][LevelData[2].length]=Campaigns[2][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<25;i++){LevelData[3][LevelData[3].length]=Campaigns[3][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<25;i++){LevelData[4][LevelData[4].length]=Campaigns[4][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<10;i++){LevelData[5][LevelData[5].length]=Campaigns[5][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<10;i++){LevelData[6][LevelData[6].length]=Campaigns[6][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<10;i++){LevelData[7][LevelData[7].length]=Campaigns[7][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<10;i++){LevelData[8][LevelData[8].length]=Campaigns[8][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<10;i++){LevelData[9][LevelData[9].length]=Campaigns[9][Math.floor(i/5)][i%5].Finished};
	for (let i=0;i<5;i++){LevelData[10][LevelData[10].length]=Campaigns[10][0][i].Finished};

	let SettingsData=[SoundChoice,MusicChoice,DialogueChoice,IdleAnimChoice,MystSettChoice];

	let Data=LevelData+"|"+SettingsData;

	let d = new Date();
  	d.setTime(d.getTime() + (1000*24*60*60*1000));
 	let expires = "expires="+ d.toUTCString();

	document.cookie=Data+";"+expires+"; path:/; SameSite=Lax";};
function SBLARG(X,Y,pip){
	//alert(X+" "+Y);

	//alert(BLARG.length);
	//console.log(pip);
	
	let Pip=pip??[0,0];
	let ics=X;
	let igrec=Y;
	let ChsSpd=rostermap[BLARG[0].X][BLARG[0].Y].speed;
	let hor=Math.abs(ics-BLARG[BLARG.length-1].X);
	let ver=Math.abs(igrec-BLARG[BLARG.length-1].Y);
	let DeviationFactor=hor+ver;
	//Pip.pop();
	//console.log(Pip);
	//console.log(hor+""+ ver + DeviationFactor);
	//console.log(DeviationFactor);
	
	document.getElementById("BLARG "+(X+1)+"X"+(Y+1)).src="Assets/BLARG/Singularity.PNG";

	if(X==BLARG[BLARG.length-1].X && Y==BLARG[BLARG.length-1].Y){if(BLARG.length>1){


		//document.getElementById("BLARG "+(BLARG[BLARG.length-1].X-StandardX+1)+"X"+(BLARG[BLARG.length-1].Y-StandardY+1)).style.visibility="hidden"
		}
		}else{
			//console.log('sonda confirmata');
			if(DeviationFactor<2 && BLARG.length<=ChsSpd){BLARG[BLARG.length]={X:X,Y:Y};

				}else{//Here is where we must forge the new appendage of the function
					//Segment that empties the current arrow
					for(let B=0; B<BLARG.length; B++){document.getElementById("BLARG "+(BLARG[B].X+1)+"X"+(BLARG[B].Y+1)).src="Assets/Miscellaneous/Nothing.PNG";};
					
					//Segment that resequences the new path
						let DeviatedBLARG=[{X:ChosenUnit.ics-1,Y:ChosenUnit.igrec-1}];
						let ix=ChosenUnit.ics-1;
						let ig=ChosenUnit.igrec-1;

						//for(let C=Pip.length-1;C>=0;C--){
						
						for(let C=0; C<Pip.length;C++){
							if(Pip[C]==1){ix--};
							if(Pip[C]==2){ig++};
							if(Pip[C]==3){ix++};
							if(Pip[C]==4){ig--};
							let AxialPurifier=true;
							if(C>0){if((Pip[C])%2==(Pip[C-1])%2 && Pip[C-1]!=Pip[C]){AxialPurifier=false}};
							if(AxialPurifier){DeviatedBLARG[DeviatedBLARG.length]={X:ix,Y:ig}};};
							//Segment that purifies the deviated arrow from 1-3/2-4 recurrences - ignore, it may be pointless
							//let PurifiedBLARG=[];
							//PurifiedBLARG[0]=DeviatedBLARG[0];
							//for(let P=1;P<DeviatedBLARG.length;P++){};
							BLARG=DeviatedBLARG;
							console.log(BLARG);
					//Segment that redraws arrow

					document.getElementById("BLARG "+(X+1)+"X"+(Y+1)).src="Assets/Miscellaneous/Nothing.PNG";





					};




			};
		//else{document.getElementById("BLARG "+(X+1-StandardX)+"X"+(Y+1-StandardY)).src="Assets/Miscellaneous/Nothing.PNG"};
		//alert(BLARG.length);
	//alert(BLARG.length);
	for(let B=0; B<BLARG.length; B++){
		if(B==0 && BLARG.length>1){
			let Blavar=0;
			//alert(BLARG[0].X+" "+BLARG[1].X+" "+BLARG[0].Y+" "+BLARG[1].Y);
			if(BLARG[0].X>BLARG[1].X){Blavar=1};
			if(BLARG[0].Y<BLARG[1].Y){Blavar=2};
			if(BLARG[0].X<BLARG[1].X){Blavar=3};
			if(BLARG[0].Y>BLARG[1].Y){Blavar=4};
			//alert(BLARG[1].X+" "+BLARG[1].Y);
			document.getElementById("BLARG "+(BLARG[0].X+1)+"X"+(BLARG[0].Y+1)).src="Assets/BLARG/Emission"+Blavar+".PNG";
		}else if(B==BLARG.length-1 && BLARG.length>1){
		//(BLARG.length==1){document.getElementById("BLARG "+(BLARG[0].X+1-StandardX)+"X"+(BLARG[0].Y+1-StandardY)).src="Assets/BLARG/Singularity.PNG";};
			let Blavar=0;
			if(BLARG[BLARG.length-2].X>BLARG[BLARG.length-1].X){Blavar=1};
			if(BLARG[BLARG.length-2].Y<BLARG[BLARG.length-1].Y){Blavar=2};
			if(BLARG[BLARG.length-2].X<BLARG[BLARG.length-1].X){Blavar=3};
			if(BLARG[BLARG.length-2].Y>BLARG[BLARG.length-1].Y){Blavar=4};

			document.getElementById("BLARG "+(BLARG[BLARG.length-1].X+1)+"X"+(BLARG[BLARG.length-1].Y+1)).src="Assets/BLARG/Target"+Blavar+".PNG";
		//}else if(B==BLARG.length-1 && BLARG.length==2){


			//let Blavar=0;
			//if(BLARG[BLARG.length-1].X>X){Blavar=1};
			//if(BLARG[BLARG.length-1].Y<Y){Blavar=2};
			//if(BLARG[BLARG.length-1].X<X){Blavar=3};
			//if(BLARG[BLARG.length-1].Y>Y){Blavar=4};

			//document.getElementById("BLARG "+(BLARG[BLARG.length-1].X)+"X"+(BLARG[BLARG.length].Y+1)).src="Assets/BLARG/Target"+Blavar+".PNG";


		}else if(BLARG.length>2){
			let Blavar=0;
			if(BLARG[B+1].X-BLARG[B].X==BLARG[B].X-BLARG[B-1].X){
				if(BLARG[B+1].X-BLARG[B].X==0){Blavar="StreakH"}else{Blavar="StreakV"};

			}else{
				let ConvX=0;
				let ConvY=0;
				if(BLARG[B+1].X!=BLARG[B].X){ConvX=BLARG[B+1].X};
				if(BLARG[B-1].X!=BLARG[B].X){ConvX=BLARG[B-1].X};
				if(BLARG[B+1].Y!=BLARG[B].Y){ConvY=BLARG[B+1].Y};
				if(BLARG[B-1].Y!=BLARG[B].Y){ConvY=BLARG[B-1].Y};
				if(ConvX<BLARG[B].X && ConvY>BLARG[B].Y){Blavar="ElbowA"};
				if(ConvX>BLARG[B].X && ConvY>BLARG[B].Y){Blavar="ElbowB"};
				if(ConvX>BLARG[B].X && ConvY<BLARG[B].Y){Blavar="ElbowC"};
				if(ConvX<BLARG[B].X && ConvY<BLARG[B].Y){Blavar="ElbowD"};
				//if(BLARG[B+1].X>BLARG[B-1].X && BLARG[B+1].Y>BLARG[B-1].Y){Blavar="ElbowA"};
				//if(BLARG[B+1].X>BLARG[B-1].X && BLARG[B+1].Y<BLARG[B-1].Y){Blavar="ElbowB"};
				//if(BLARG[B+1].X<BLARG[B-1].X && BLARG[B+1].Y<BLARG[B-1].Y){Blavar="ElbowC"};
				//if(BLARG[B+1].X<BLARG[B-1].X && BLARG[B+1].Y>BLARG[B-1].Y){Blavar="ElbowD"};
			};
			//alert(Standard);
			document.getElementById("BLARG "+(BLARG[B].X+1)+"X"+(BLARG[B].Y+1)).src="Assets/BLARG/"+Blavar+".PNG";

		};

	};};
function scrapMap(){
	//This will probably, actually most likely, not be necessary, Silver
	//Keep it around until I order you to scrap it
	//Scrapping a scrapping function XD
	//The irony is not lost on me XD

	//EDIT: no longer useless HAHAHA
	for(let i=X;i<X+10;i++){
		for(let j=Y;j<Y+10;j++){
			document.getElementById("Slot "+(i+1)+" X "+(j+1)).remove();};};};
function ScoutVicinity(X,Y){
	AdjacentCloakers=[];
	if(X>0){if(rostermap[X-1][Y]!=0 && rostermap[X-1][Y].coallition!=Factions[rostermap[X][Y].faction].faction){rostermap[X][Y].isCloaked=false; rostermap[X][Y].willAmbush=true; if(hasCertainTrait(rostermap[X-1][Y].unitType,"Stealth")){if(rostermap[X-1][Y].isCloaked??false){AdjacentCloakers[AdjacentCloakers.length]=1}}}};
	if(X<Map.length-1){if(rostermap[X+1][Y]!=0 && rostermap[X+1][Y].coallition!=Factions[rostermap[X][Y].faction].faction){rostermap[X][Y].isCloaked=false; rostermap[X][Y].willAmbush=true; if(hasCertainTrait(rostermap[X+1][Y].unitType,"Stealth")){if(rostermap[X+1][Y].isCloaked??false){AdjacentCloakers[AdjacentCloakers.length]=3}}}};
	if(Y>0){if(rostermap[X][Y-1]!=0 && rostermap[X][Y-1].coallition!=Factions[rostermap[X][Y].faction].faction){rostermap[X][Y].isCloaked=false; rostermap[X][Y].willAmbush=true; if( hasCertainTrait(rostermap[X][Y-1].unitType,"Stealth")){if(rostermap[X][Y-1].isCloaked){AdjacentCloakers[AdjacentCloakers.length]=4}}}};
	if(Y<Map[0].length-1){if(rostermap[X][Y+1]!=0 && rostermap[X][Y+1].coallition!=Factions[rostermap[X][Y].faction].faction){rostermap[X][Y].isCloaked=false; rostermap[X][Y].willAmbush=true; if(hasCertainTrait(rostermap[X][Y+1].unitType,"Stealth")){if(rostermap[X][Y+1].isCloaked??false){AdjacentCloakers[AdjacentCloakers.length]=2}}}};

	if(AdjacentCloakers.length>0 && SoundChoice){let UncloakNoise=new Audio("Assets/SFX/Uncloak.MP3"); UncloakNoise.play()};
	//console.log(AdjacentCloakers);

	//alert(rostermap[X][Y].isCloaked);
	//document.getElementById("Entity "+(X+1)+"X"+(Y+1)).filter="opacity(100%)";
	
	};
function SelectSpecialLevel(Level){
	//if(Level.typeOf!=undefined){Level={Name:"???????",Description:"This level doesn't exist, you know? Maybe you can give us an idea of what to add here tho"}};
	NivelVizat=Level;
	NivelElectiv=0;
	for(let x=1;x<=14;x++){document.getElementById("NatOp"+x).style.visibility='hidden'};
	document.getElementById("Special Level Name").innerHTML=Level.Name;
	document.getElementById("Special Level Description").innerHTML=Level.Desc??"Idk what to say about this one";
	document.getElementById("NatOpP").style.visibility="hidden";
	if(NivelVizat.Constants.ElectiveNation??false==true){
		document.getElementById("NatOpP").style.visibility="inherit";
		document.getElementById("NatOpP").innerHTML=Language.SystemTerms[30];
		let MaxFactions=NivelVizat.Constants.Commanders.length-1;
		for(let x=1;x<=MaxFactions;x++){document.getElementById("NatOp"+x).style.visibility='inherit';document.getElementById("NatOp"+x).style.filter=NivelVizat.Factions[NivelVizat.Constants.Commanders[x].Allegiance].ChromaCode};


		};


	};
function ShowcaseUnitCategory(Category){
	EditorUnitClass=Category;
	for(let a=1; a<=10; a++){document.getElementById('EditorUnitShowcase'+a).src='Assets/Units/Static/'+Units[Category*10-10+a].shortname+'2.PNG';
	if(!Units[Category*10-10+a].MLPR??false){document.getElementById("EditorUnitMesh"+a).src="Assets/Units/StaticMeshes/"+Units[Category*10-10+a].shortname+"Mesh2.PNG"}else{document.getElementById("EditorUnitMesh"+a).src="Assets/Miscellaneous/Nothing.PNG"}};};
function ShowCharacterBio(){
	document.getElementById("CommanderBio").style.visibility="visible";
	document.getElementById("CommanderBio").style.border="3px solid "+GenericFactions[Commander.Allegiance].color;

	document.getElementById("CommanderName").innerHTML=Commander.Fullname;
	document.getElementById("CommanderNickname").innerHTML=Commander.Nickname;
	//document.getElementById("CommanderNickCommentary").innerHTML=Commander.NicknameCommentary[0];
	document.getElementById("CommanderNickCommentary").innerHTML="";

	let Biography="";
	for(let b=0; b<Commander.Description.length; b++){Biography+=Commander.Description[b]+"<br>"};
	document.getElementById("CommanderBiography").innerHTML=Biography+"<br><br>"+("<span style='color:orange'>"+Commander.NicknameCommentary[0]+"</span>");};
function SplashAttack(Atk,X,Y){

	if(rostermap[X][Y]!=0){
		
		let Def=rostermap[X][Y];
		let DefenderTile=Terrain[Map[Def.x][Def.y]];
		let DamageModifier=Atk.life/Units[Atk.unitType].HP;

		if(hasCertainTrait(Atk.unitType,"Indomitable")){DamageModifier=1;};

		if(Atk.damageType==Def.armor&&Atk.damageType!="Medium"){DamageModifier=DamageModifier*1.5;};
		if(Atk.damageType=="Light"&&Def.armor=="Heavy"){DamageModifier=DamageModifier*0.5;};
		if(Atk.damageType=="Heavy"&&Def.armor=="Light"){DamageModifier=DamageModifier*0.5;};

		DamageModifier=DamageModifier*DefenderTile.protectionFactor;
		DamageModifier*=(5+Atk.morale)/5;
		if(Def.unitType<12 && hasCertainTrait(Atk.unitType,"Anti-Infantry")){DamageModifier*=3};
		let Damage=Math.ceil(Atk.damage*DamageModifier);
		Damage=Math.max(Damage,0);
		//alert(DamageModifier);
		Def.life-=Damage;
		if(Def.life<=0){setTimeout(UnitLost,700,Def.index);};
	};};
function StorkPickup(Unit){
	//alert(IsStork);
	if(IsStork){
		let HPIndex=rostermap[Unit.x][Unit.y].life/30;
		let Cargo=rostermap[Unit.x][Unit.y].cargo;
		MapRoster[Unit.index].id=Cargo;
		rostermap[Unit.x][Unit.y].cargo=0;
		rostermap[Unit.x][Unit.y].unitType=Cargo;
		rostermap[Unit.x][Unit.y].life=Math.round(Units[Cargo].HP*HPIndex);
		rostermap[Unit.x][Unit.y].armor=Units[Cargo].Armor;
		rostermap[Unit.x][Unit.y].damage=Units[Cargo].Attack;
		rostermap[Unit.x][Unit.y].damageType=Units[Cargo].Weapon;
		rostermap[Unit.x][Unit.y].minR=Units[Cargo].MinRange;
		rostermap[Unit.x][Unit.y].maxR=Units[Cargo].MaxRange;
		rostermap[Unit.x][Unit.y].speed=Units[Cargo].Speed;
		rostermap[Unit.x][Unit.y].movementType=Units[Cargo].Movement;
		if((MapRoster[Unit.index].CustomName ?? true) || (MapRoster[Unit.index].SpecialName ?? true)){rostermap[Unit.x][Unit.y].name=Language.UnitNames[Cargo];};
		if((MapRoster[Unit.index].CustomDescription ?? true) || (MapRoster[Unit.index].SpecialDescription ?? true)){rostermap[Unit.x][Unit.y].description=Language.UnitDesc[Cargo];};
		document.getElementById("Entity "+(Unit.x-StandardX+1)+"X"+(Unit.y-StandardY+1)).src="Assets/Units/Static/"+Units[Cargo].shortname+rostermap[Unit.x][Unit.y].direction+".PNG";

	}else{
		YourMoney-=150;
		//alert(Unit.index);
		//alert(rostermap[Unit.x][Unit.y].HP);
		//alert(HPIndex);
		let HPIndex=rostermap[Unit.x][Unit.y].life/Units[rostermap[Unit.x][Unit.y].unitType].HP;
		
		MapRoster[Unit.index].id=41;
		rostermap[Unit.x][Unit.y].cargo=rostermap[Unit.x][Unit.y].unitType;
		rostermap[Unit.x][Unit.y].unitType=41;
		rostermap[Unit.x][Unit.y].armor="Light";
		rostermap[Unit.x][Unit.y].life=Math.round(30*HPIndex);
		rostermap[Unit.x][Unit.y].damage=0;
		rostermap[Unit.x][Unit.y].damageType="None";
		rostermap[Unit.x][Unit.y].minR=1;
		rostermap[Unit.x][Unit.y].maxR=1;
		rostermap[Unit.x][Unit.y].speed=7;
		rostermap[Unit.x][Unit.y].movementType="Flight";
		if((MapRoster[Unit.index].CustomName ?? true) || (MapRoster[Unit.index].SpecialName ?? true)){rostermap[Unit.x][Unit.y].name=Language.UnitNames[41];};
		if((MapRoster[Unit.index].CustomDescription ?? true) || (MapRoster[Unit.index].SpecialDescription ?? true)){rostermap[Unit.x][Unit.y].description=Language.UnitDesc[41];};
		document.getElementById("Entity "+(Unit.x-StandardX+1)+"X"+(Unit.y-StandardY+1)).src="Assets/Units/Static/Stork"+rostermap[Unit.x][Unit.y].direction+".PNG";
		//rostermap[Unit.x][Unit.y].name="";

		//alert(rostermap[Unit.x][Unit.y].unitType);
	};};
function TestMap(){
	//alert(EditorMap[0]);
	//let MapKey="[";
	//for(let i=0;i<x;i++){MapKey+="["+EditorMap[i]+"]";
	//if(i<x-1){MapKey+=",\n";};};
	//MapKey+="]";

	/*
	let RosterKey='[{"index":0, "id":null, "faction":null, "direction":null, "x":null, "y":null, "morale":0, "hpModifier":0, "defaultX":0,"defaultY":0},\n';

	for(let i=0; i<x;i++){for(let j=0; j<y;j++){
		if(EditorEntityMap[i][j]!=0){
			UnitEntry='{"id":'+EditorEntityMap[i][j].id+' , "faction":'+EditorEntityMap[i][j].faction+' , "direction":'+EditorEntityMap[i][j].direction+', "x":'+(EditorEntityMap[i][j].x-1)+', "y":'+(EditorEntityMap[i][j].y-1)+', "morale":0, "hpModifier":0},\n';
			RosterKey+=UnitEntry;
		};
	}};
	RosterKey=RosterKey.slice(0,-2);
	RosterKey+="]";
	*/
	FieldMode="Battle";
	let RosterKey=[{index:0, id:"null", faction:"null", direction:"null", x:"null", y:"null", morale:0, hpModifier:0, defaultX:0,defaultY:0}];
	for(let x=0;x<EditorEntityMap.length;x++){for (let y=0;y<EditorEntityMap[0].length;y++){if(EditorEntityMap[x][y]!=0){RosterKey[RosterKey.length]=EditorEntityMap[x][y]}}};

	//alert(RosterKey);
	let ControlKey="[";
	for(let i=0;i<x;i++){ControlKey+="["+EditorControlMap[i]+"]";
	if(i<x-1){ControlKey+=",\n";};};
	ControlKey+="]";
	MapKey=EditorMap;
	BiomeKey=EditorBiomeMap;
	//alert(RosterKey.length);
	//alert(EditationColor);
	ControlKey=JSON.parse(ControlKey);
	let GeneralsList=[Nobody,WhiteGeneral,BlackGeneral,GreyGeneral,IndigoGeneral,GreenGeneral,GrayGeneral,YellowGeneral,BrownGeneral,RedGeneral,BlueGeneral];
	let CommanderList=[Nobody];
	CommanderList[1]=GeneralsList[EditationColor];

	for(let a=1;a<RosterKey.length;a++){
		let canAdd=true; 

		for(b=1;b<CommanderList.length;b++){
			if(RosterKey[a].faction==CommanderList[b].Allegiance){canAdd=false}}; 
			if(canAdd){CommanderList[CommanderList.length]=GeneralsList[RosterKey[a].faction]}
				//alert(CommanderList.length+" "+b);
		};
	let SurviveTimer=parseInt(document.getElementById("SurviveInput").value??77777)??77777;
	let TimeLimit=parseInt(document.getElementById("TimeLimitInput").value??77777)??77777;
	let ConstantsKey={YourFaction:EditationColor,defaultX:0,defaultY:0,Survival:SurviveTimer,TimeLimit:TimeLimit,Capture:[],Defend:[],Defeat:[],Protect:[],Funds:[0,0,0,0,0,0,0,0,0,0,0],Commanders:CommanderList};
	let RegionKey=EditorRegionMap;
	let NodeKeyT=CapitolNodeRegistry;
	let NodeKey=[];
	for(let N=0;N<NodeKeyT.length;N++){for(let R=0;R<NodeKeyT[0].length;R++){if(NodeKeyT[N][R]!=1){NodeKey[NodeKey.length]=NodeKeyT[N][R]}}};
	//alert(typeof(NodeKeyT[0][0]));

	EditorLevel={Map:MapKey, Roster:RosterKey, Constants:ConstantsKey, ControlMap:ControlKey,BiomeMap:BiomeKey,RegionMap:RegionKey,NodeMap:NodeKey,Factions:GenericFactions,Units:CampaignUnits,Terrain:CampaignTerrain};
	
	let canBattle=true;




	if(canBattle){
	document.getElementById('EditorMap').style.visibility='hidden';
	document.getElementById('FactionChosenIndicator').style.visibility='hidden';

		/*
		for(let i=1;i<10;i++){
		for(let j=1;j<10;j++){
			key=document.getElementById("Slot "+i+" X "+j)??0;
			document.getElementById(key).style.visibility="hidden";
			//alert("Slot "+i+" X "+j);
			//if(key!=0){key.remove()};
		}};*/
		



	for(let x=1;x<=10;x++){for(let y=1;y<=10;y++){document.getElementById("Entity "+x+" X "+y).style.visibility='hidden'; document.getElementById("Tile "+x+" X "+y).style.visibility='hidden';document.getElementById("Structure "+x+" X "+y).style.visibility='hidden';document.getElementById("a "+x+" X "+y).style.visibility='hidden';document.getElementById("b "+x+" X "+y).style.visibility='hidden';document.getElementById("c "+x+" X "+y).style.visibility='hidden';document.getElementById("d "+x+" X "+y).style.visibility='hidden';}};
	initializeSpecialBattle(EditorLevel);


	};};
function ToggleBattleflags(){

	FlagMap=[];
	let FlagCell=[];
	for(let x=0;x<Map[0].length;x++){FlagCell[FlagCell.length]=0};
	for(let y=0;y<Map.length;y++){FlagMap[FlagMap.length]=FlagCell};
	FlagMap=JSON.parse(JSON.stringify(FlagMap));

	for(let a=0;a<Constants.Capture.length;a++){FlagMap[Constants.Capture[a].x][Constants.Capture[a].y]=1};
	for(let a=0;a<Constants.Defend.length;a++){FlagMap[Constants.Defend[a].x][Constants.Defend[a].y]=2};
	for(let a=0;a<Constants.Defeat.length;a++){FlagMap[MapRoster[Constants.Defeat[a]].x][MapRoster[Constants.Defeat[a]].y]=3};
	for(let a=0;a<Constants.Protect.length;a++){FlagMap[MapRoster[Constants.Protect[a]].x][MapRoster[Constants.Protect[a]].y]=4};




	if(!FlagsToggled){
	for(let i=StandardX;i<StandardX+10;i++){for(let j=StandardY;j<StandardY+10;j++){
	if(FlagMap[i+StandardX][j+StandardY]!=0){//alert("Chuchu");
	document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).style.visibility='visible';
	if(FlagMap[i][j]==1){document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).src="Assets/Miscellaneous/CaptureFlag.PNG"};
	if(FlagMap[i][j]==2){document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).src="Assets/Miscellaneous/DefendFlag.PNG"};
	if(FlagMap[i][j]==3){document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).src="Assets/Miscellaneous/DestroyFlag.PNG"};
	if(FlagMap[i][j]==4){document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).src="Assets/Miscellaneous/ProtectFlag.PNG"};
	}

	}};

	};

	if(FlagsToggled){for(let i=StandardX;i<StandardX+10;i++){for(let j=StandardY;j<StandardY+10;j++){document.getElementById("Flag "+(i-StandardX+1)+"X"+(j-StandardY+1)).style.visibility='hidden';}};};

	if(FlagsToggled){FlagsToggled=false}else{FlagsToggled=true};};
//This function is OBSOLETE
function ToggleMoraleBadges(){

				alert("ma-ta");
	BadgeMap=[];
	let BadgeCell=[];
	for(let x=0;x<Map[0].length;x++){BadgeCell[BadgeCell.length]=0};
	for(let y=0;y<Map.length;y++){BadgeMap[BadgeMap.length]=BadgeCell};
	BadgeMap=JSON.parse(JSON.stringify(BadgeMap));

	for(let a=StandardX;a<StandardX+10;a++){for(let b=StandardY;b<StandardY+10;b++){BadgeMap[a-StandardX][b-StandardY]=rostermap[a][b]}};


	if(!BadgesToggled){for(let i=0;i<10;i++){for(let j=0;j<10;j++){
			if(BadgeMap[i][j]!=0){
				let isBewegungskrieg=false;
				let isStealth=false;
				let isCargo=false;
				if(hasCertainTrait(BadgeMap[i][j].unitType,"Bewegungskrieg")){isBewegungskrieg=true};
				if(hasCertainTrait(BadgeMap[i][j].unitType,"Stealth")){isStealth=true};
				if(hasCertainTrait(BadgeMap[i][j].unitType,"Naval Transport") || hasCertainTrait(BadgeMap[i][j].unitType,"Air Transport")){isCargo=true};
				
			document.getElementById("Badge "+(i+1)+"X"+(j+1)).style.visibility="visible";
			document.getElementById("Badge "+(i+1)+"X"+(j+1)).src="Assets/Traits/Morale"+rostermap[i+StandardX][j+StandardY].morale+".PNG";

			if(isBewegungskrieg && !isStealth && !isCargo){
				let Chuchu=document.createElement("img");
				Chuchu.style.position="absolute";
				Chuchu.style.top="21px";
				Chuchu.style.left="21px";
				Chuchu.style.zIndex=5;
				Chuchu.style.width="35px";
				Chuchu.style.height="35px";
				Chuchu.src="Assets/Traits/Bewegungskrieg.PNG";
				Chuchu.id="CargoChuchu "+i+"X"+j;
				Chuchu.style.filter=Factions[0].ChromaCode;
				document.getElementById("Slot "+(i+1)+"X"+(j+1)).appendChild(Chuchu);
				
			};

			if(isStealth && !isCargo){};

			if(isCargo){
				let Chuchu=document.createElement("img");
				Chuchu.style.position="absolute";
				Chuchu.style.top="21px";
				Chuchu.style.left="21px";
				Chuchu.style.zIndex=5;
				Chuchu.style.width="35px";
				Chuchu.style.height="35px";
				Chuchu.src="Assets/Units/Static/"+Units[BadgeMap[i][j].cargo].shortname+"2.PNG";
				Chuchu.id="CargoChuchu "+i+"X"+j;
				Chuchu.style.filter=Factions[PlayerChoiceFaction].ChromaCode;
				document.getElementById("Slot "+(i+1)+"X"+(j+1)).appendChild(Chuchu);


			};

			}}}};

	if(BadgesToggled){for(let i=StandardX;i<StandardX+10;i++){for(let j=StandardY;j<StandardY+10;j++){document.getElementById("Badge "+(i-StandardX+1)+"X"+(j-StandardY+1)).style.visibility='hidden';let cargo=document.getElementById("CargoChuchu "+(i-StandardX+1)+"X"+(j-StandardY+1)); if(cargo??false){cargo.remove()}}};};

	if(BadgesToggled){BadgesToggled=false}else{BadgesToggled=true};};
function ToggleHealthBars(){

	BarMap=[];
	let BarCell=[];
	for(let x=0;x<Map[0].length;x++){BarCell[BarCell.length]=0};
	for(let y=0;y<Map.length;y++){BarMap[BarMap.length]=BarCell};
	BarMap=JSON.parse(JSON.stringify(BarMap));

	for(let a=StandardX;a<StandardX+10;a++){for(let b=StandardY;b<StandardY+10;b++){BarMap[a-StandardX][b-StandardY]=rostermap[a][b]}};

	if(!BarsToggled){
		for(let i=0;i<10;i++){for(let j=0;j<10;j++){
			if(BarMap[i][j]!=0){
				document.getElementById("HPContainer "+(i+1)+"X"+(j+1)).style.visibility="visible";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.visibility="visible";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.height="8px";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.width=39*(rostermap[i+StandardX][j+StandardY].life/Units[rostermap[i+StandardX][j+StandardY].unitType].HP)+"px";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.filter="brightness("+rostermap[i+StandardX][j+StandardY].life/Units[rostermap[i+StandardX][j+StandardY].unitType].HP+")";
			};
		};
	};
	};





	if(BarsToggled){for(let i=0;i<10;i++){for(let j=0;j<10;j++){
			document.getElementById("HPContainer "+(i+1)+"X"+(j+1)).style.visibility="hidden";
			document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.visibility="hidden";

		};};


	};

	if(BarsToggled){BarsToggled=false}else{BarsToggled=true};};
function ToggleHealthBar(X,Y){
		let i=X-1;
		let j=Y-1;
			if(rostermap[i][j]!=0){
				document.getElementById("HPContainer "+(i+1)+"X"+(j+1)).style.visibility="visible";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.visibility="visible";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.height="8px";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.width=39*(rostermap[i][j].life/Units[rostermap[i][j].unitType].HP)+"px";
				document.getElementById("HPBar "+(i+1)+"X"+(j+1)).style.filter="brightness("+rostermap[i][j].life/Units[rostermap[i][j].unitType].HP+")";
			};};
function ToggleMoraleBadge(X,Y){
	let i=X-1;
	let j=Y-1;
	if(rostermap[i][j]!=0){
				let isBewegungskrieg=false;
				let isStealth=false;
				let isCargo=false;
				if(hasCertainTrait(rostermap[i][j].unitType,"Bewegungskrieg") && rostermap[i][j].canEncore){isBewegungskrieg=true};
				if(hasCertainTrait(rostermap[i][j].unitType,"Stealth") && rostermap[i][j].isCloaked){isStealth=true};
				if(hasCertainTrait(rostermap[i][j].unitType,"Naval Transport") || hasCertainTrait(rostermap[i][j].unitType,"Air Transport")){isCargo=true};
			if(rostermap[i][j].morale!=0){document.getElementById("Badge "+(i+1)+"X"+(j+1)).style.visibility="visible"};
			document.getElementById("Badge "+(i+1)+"X"+(j+1)).src="Assets/Traits/Morale"+rostermap[i][j].morale+".PNG";

			if(isBewegungskrieg){
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.visibility='visible';
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).src="Assets/Traits/Bewegungskrieg.PNG";
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.filter="";
			};

			if(isStealth){
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.visibility='visible';
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).src="Assets/Traits/Stealth.PNG";
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.filter="";
			};

			if(isCargo){
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.visibility='visible';
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).src="Assets/Units/Static/"+Units[rostermap[i][j].cargo].shortname+"2.PNG";
				document.getElementById("Cargo "+(i+1)+"X"+(j+1)).style.filter=Factions[rostermap[i][j].faction].ChromaCode;

				/*
				let Chuchu=document.createElement("img");
				Chuchu.style.position="absolute";
				Chuchu.style.top="21px";
				Chuchu.style.left="21px";
				Chuchu.style.zIndex=5;
				Chuchu.style.width="35px";
				Chuchu.style.height="35px";
				Chuchu.src="Assets/Units/Static/"+Units[rostermap[i][j].cargo].shortname+"2.PNG";
				Chuchu.id="CargoChuchu "+i+"X"+j;
				Chuchu.style.filter=Factions[PlayerChoiceFaction].ChromaCode;
				document.getElementById("Slot "+(i+1)+"X"+(j+1)).appendChild(Chuchu);*/


			};

			}};
function ToggleOption(Button){
	switch(Button){
		case "Sound":
			SoundChoice= !SoundChoice;
			if(SoundChoice){document.getElementById("ToggleSound").src="Assets/Miscellaneous/SoundOn.PNG"}else{document.getElementById("ToggleSound").src="Assets/Miscellaneous/SoundOff.PNG"};
			break;
		case "Music":
			MusicChoice= !MusicChoice;
			if(MusicChoice){document.getElementById("ToggleMusic").src="Assets/Miscellaneous/MusicOn.PNG"}else{document.getElementById("ToggleMusic").src="Assets/Miscellaneous/MusicOff.PNG";
			MainTheme.pause();
			BattleBGM.pause();BattleBGM.currentTime=0;BattleBGM.onloadeddata=null;clearTimeout(BGMLoop);
		};
			break;
		case "Dialogue":
			DialogueChoice= !DialogueChoice;
			if(DialogueChoice){document.getElementById("ToggleDialogue").src="Assets/Miscellaneous/DialogueOn.PNG"}else{document.getElementById("ToggleDialogue").src="Assets/Miscellaneous/DialogueOff.PNG"
			document.getElementById("DialogueBox").style.visibility="hidden";
		};
			break;
		case "IdleAnim":
			IdleAnimChoice= !IdleAnimChoice;
			if(IdleAnimChoice){document.getElementById("ToggleIdleAnimations").src="Assets/Miscellaneous/IdleAnimOn.PNG"}else{document.getElementById("ToggleIdleAnimations").src="Assets/Miscellaneous/IdleAnimOff.PNG"};
			break;
		case "MystSett":
			MystSettChoice= !MystSettChoice;
			let zappy=0;
			if(MystSettChoice){zappy=5; for(let o=61;o<69;o++){CampaignUnits[o].Speed=zappy};document.getElementById("ToggleMysteriousSetting").src="Assets/Miscellaneous/MysteriousSettingOn.PNG";
			document.getElementById("Diff1Text").style.top="30px";
			document.getElementById("Diff2Text").style.top="67px";
			document.getElementById("Diff3Text").style.top="104px";
			document.getElementById("Diff1Text").innerHTML="Justin Bieber";
			document.getElementById("Diff2Text").innerHTML="Keanu Reeves";
			document.getElementById("Diff3Text").innerHTML="Chuck Norris";





		}else{document.getElementById("ToggleMysteriousSetting").src="Assets/Miscellaneous/MysteriousSettingOff.PNG";
			document.getElementById("Diff1Text").style.top="41px";
			document.getElementById("Diff2Text").style.top="78px";
			document.getElementById("Diff3Text").style.top="115px";
			document.getElementById("Diff1Text").innerHTML=Language.SystemTerms[141];
			document.getElementById("Diff2Text").innerHTML=Language.SystemTerms[142];
			document.getElementById("Diff3Text").innerHTML=Language.SystemTerms[143];




				};
			break;

		};};
function ToggleTileBlock(Block){

	if(Block==1){TerrainLedger=TerrainLedger_Biomes};
	if(Block==2){TerrainLedger=TerrainLedger_LandFeatures};
	if(Block==3){TerrainLedger=TerrainLedger_UrbanFeatures};
	if(Block==4){TerrainLedger=TerrainLedger_WaterFeatures};
	if(Block==5){TerrainLedger=TerrainLedger_Connectors};
	if(Block==6){TerrainLedger=TerrainLedger_Structures};
	if(Block==7){TerrainLedger=TerrainLedger_Other};

	for(let t=1; t<=10; t++){document.getElementById("EditorTile"+t).src="Assets/Miscellaneous/Nothing.PNG"};
	for(let e=0; e<TerrainLedger.length; e++){document.getElementById("EditorTile"+(e+1)).src="Assets/Tiles/"+Terrain[TerrainLedger[e]].name+".PNG"; document.getElementById("EditorTile"+(e+1)).style.top=14+e*61+(Terrain[TerrainLedger[e]].StD??0)+"px"};


	};
function Tooltip(Tooltip){
	
	let TooltipFrame=0;
	let TooltipFloat=setInterval(Float,100);
	function Float(){
		TooltipFrame++;

		if(TooltipFrame==5){document.getElementById("GeneralTooltipText").innerHTML=Language.Tooltips[Tooltip]};

		if(TooltipFrame==10){document.getElementById("GeneralTooltip").style.visibility="inherit";};

		if(TooltipFrame==20){document.getElementById("GeneralTooltip").style.visibility="hidden"; clearInterval(TooltipFloat)};
	}};
	
	
function traitDetail(traitIndex,UnitCase){
	//Bag pula-n curul lui Dincă
	document.getElementById("TraitTooltip").style.visibility="visible";

	//alert(document.getElementById("TraitTooltip").style.visibility);
	if(traitIndex==1){traitIndex=HighlightedEntity.tag1};
	if(traitIndex==2){traitIndex=HighlightedEntity.tag2};
	if(traitIndex==3){traitIndex=HighlightedEntity.tag3};
	if(traitIndex==4){traitIndex=HighlightedEntity.tag4};
	switch(traitIndex){
		case "Uneven":
			trait=1;
			break;
		case "Rugged":
			trait=2;
			break;
		case "Precipitous":
			trait=3;
			break;
		case "Impassable":
			trait=4;
			break;
		case "Tricky Waters":
			trait=5;
			break;
		case "Concealment":
			trait=6;
			break;
		case "Naval Concealment":
			trait=7;
			break;		
		case "Bunker":
			trait=8;
			break;
		case "Shallow":
			trait=9;
			break;
		case "Vantage":
			trait=10;
			break;		
		case "Dangerous":
			trait=11;
			break;
		case "Logistic Challenge":
			trait=12;
			break;
		case "Logistic Nightmare":
			trait=13;
			break;
		case "Financial Center":
			trait=14;
			break;
		case "Fiscal Center":
			trait=15;		
			break;
		case "Fiduciary Center":
			trait=16;
			break;




		case "Conqueror":
			trait=17;
			break;
		case "Skysweeper":
			trait=18;
			break;			
		case "Depth Charge":
			trait=19;
			break;
		case "Sonar":
			trait=20;
			break;
		case "Radar":
			trait=21;
			break;
		case "Anti-Infantry":
			trait=22;
			break;
		case "Anti-Tank":
			trait=23;
			break;			
		case "Anti-Air":
			trait=24;
			break;
		case "Anti-Ship":
			trait=25;
			break;
		case "Anti-Structure":
			trait=26;
			break;
		case "Stealth":
			trait=27;
			break;
		case "Submerged":
			trait=28;
			break;			
		case "Commando":
			trait=29;
			break;
		case "Crab":
			trait=30;
			break;
		case "Steer":
			trait=31;
			break;
		case "Indomitable":
			trait=32;
			break;
		case "Schwerpunkt":
			trait=33;
			break;			
		case "Bewegungskrieg":
			trait=34;
			break;
		case "Mobile Battery":
			trait=35;
			break;
		case "Streamlined":
			trait=36;
			break;
		case "Cemented Steel Armor":
			trait=37;
			break;
		case "Cavitation Explosion":
			trait=38;
			break;			
		case "Seabound":
			trait=39;
			break;
		case "Self-Destruct":
			trait=40;
			break;
		case "Dispersion":
			trait=41;
			break;
		case "JUDGEMENT":
			trait=42;
			break;
		case "Supply Distribution":
			trait=43;
			break;
		case "Inertial":
			trait=44;
			break;
		case "Streamblast":
			trait=45;
			break;
		case "Airborne":
			trait=46;
			break;
		case "Heroic":
			trait=47;
			break;
		case "Tank-Hunter":
			trait=48;
			break;
		case "Naval Transport":
			trait=49;
			break;
		case "Air Transport":
			trait=50;
			break;
		case "Unbuilt":
			trait=51;
			break;
		case "Tank Pooper":
			trait=52;
			break;
		case "Absorber":
			trait=53;
			break;			
		case "Terrifying":
			trait=54;
			break;
		case "Lynchpin":
			trait=55;
			break;
		case "Inflaming":
			trait=56;
			break;
		default:
		trait=0;	
	};
	//document.getElementById("TraitTooltip").style.left="400px"; document.getElementById("TraitTooltip").style.top="0px";
	if(UnitCase=='Details'){document.getElementById("TraitTooltip").style.left="400px"; document.getElementById("TraitTooltip").style.top="-35px"};
	if(UnitCase=='Constructor'){document.getElementById("TraitTooltip").style.left="200px"; document.getElementById("TraitTooltip").style.top="-525px"};
	if(Language.TraitDesc[trait].length>65){document.getElementById("TraitTooltipImage").src="Assets/Miscellaneous/TraitTooltipPlus.PNG"}else{document.getElementById("TraitTooltipImage").src="Assets/Miscellaneous/TraitTooltip.PNG"};
	document.getElementById("TraitName").innerHTML=Language.TraitName[trait];
	document.getElementById("TraitDescription").innerHTML=Language.TraitDesc[trait];};
function UndoMove(){
	if((LastMove.ID ?? 0!=0) && !(KillingUnit??false)){
		//alert(LastMove.DIR);
		let exX=MapRoster[LastMove.ID].x;
		let exY=MapRoster[LastMove.ID].y;
		//alert(exX+" "+exY);
		
		MapRoster[LastMove.ID].x=LastMove.X;
		MapRoster[LastMove.ID].y=LastMove.Y;

		let temp="Entity "+(LastMove.X+1)+"X"+(LastMove.Y+1);
		let tempcore="EntityCore "+(LastMove.X+1)+"X"+(LastMove.Y+1);
		let tempmesh="EntityMesh "+(LastMove.X+1)+"X"+(LastMove.Y+1);;
		//console.log(document.getElementById(temp).style.visibility);
		document.getElementById("Marker "+(LastMove.X+1)+"X"+(LastMove.Y+1)).style.visibility="visible";
		document.getElementById(temp).style.visibility="visible";
		document.getElementById(tempcore).style.filter=Factions[MapRoster[LastMove.ID].faction].ChromaCode;
		if(LastMove.cloak??false){document.getElementById(temp).style.filter="opacity(50%)";MapRoster[LastMove.ID].isCloaked=true};
		if(LastMove.encore??false){MapRoster[LastMove.ID].canEncore=true};
		//alert(rostermap[exX][exY]);
		//alert(AdjacentCloakers);
		if(Units[MapRoster[LastMove.ID].unitType].MaxRange==1 && (LastMove.encore??false)){document.getElementById("Marker "+(exX+1)+"X"+(exY+1)).style.visibility="hidden"};
		for(let a=0;a<AdjacentCloakers.length;a++){
			//the last part of the 1-directional might have something to do with uncloaking allies, but that never happens. Maybe it was once an issue but not anymore?
			if(AdjacentCloakers[a]==1){document.getElementById("Entity "+(exX)+"X"+(exY+1)).style.filter="opacity(0%)"; MapRoster[rostermap[exX-1][exY].index].isCloaked=true; if(rostermap[exX-1][exY].coallition==Factions[PlayerChoiceFaction].faction){document.getElementById("Entity "+(exX)+"X"+(exY+1)).style.filter="opacity(50%)"}};
			if(AdjacentCloakers[a]==2){document.getElementById("Entity "+(exX+1)+"X"+(exY+2)).style.filter="opacity(0%)"; MapRoster[rostermap[exX][exY+1].index].isCloaked=true};
			if(AdjacentCloakers[a]==3){document.getElementById("Entity "+(exX+2)+"X"+(exY+1)).style.filter="opacity(0%)"; MapRoster[rostermap[exX+1][exY].index].isCloaked=true};
			if(AdjacentCloakers[a]==4){document.getElementById("Entity "+(exX+1)+"X"+(exY)).style.filter="opacity(0%)"; MapRoster[rostermap[exX][exY-1].index].isCloaked=true};

		};
		//document.getElementById(temp).src="Assets/Units/Static/"+Units[MapRoster[LastMove.ID].unitType].shortname+MapRoster[LastMove.ID].direction+".PNG";
		//document.getElementById(temp).style.top=(Units[MapRoster[LastMove.ID].unitType].StaticOffsetY ?? [0,0,0,0,0])[MapRoster[LastMove.ID].direction]+"px";
		//document.getElementById(temp).style.left=(Units[MapRoster[LastMove.ID].unitType].StaticOffsetX ?? [0,0,0,0,0])[MapRoster[LastMove.ID].direction]+"px";
		document.getElementById(temp).src="Assets/Units/Static/"+Units[MapRoster[LastMove.ID].unitType].shortname+LastMove.DIR+".PNG";
		document.getElementById(temp).style.top=(Units[MapRoster[LastMove.ID].unitType].StaticOffsetY ?? [0,0,0,0,0])[LastMove.DIR]+"px";
		document.getElementById(temp).style.left=(Units[MapRoster[LastMove.ID].unitType].StaticOffsetX ?? [0,0,0,0,0])[LastMove.DIR]+"px";
		if(!Units[MapRoster[LastMove.ID].unitType].MLPR??false){document.getElementById(tempmesh).src="Assets/Units/StaticMeshes/"+Units[MapRoster[LastMove.ID].unitType].shortname+"Mesh"+LastMove.DIR+".PNG"}else{document.getElementById(tempmesh).style.visibility="hidden";};
		rostermap[LastMove.X][LastMove.Y]=MapRoster[LastMove.ID];
		rostermap[LastMove.X][LastMove.Y].x=LastMove.X;
		rostermap[LastMove.X][LastMove.Y].y=LastMove.Y;
		rostermap[LastMove.X][LastMove.Y].direction=LastMove.DIR;

		//rostermap[LastMove.X][LastMove.Y]=rostermap[exX][exY];
		//console.log(rostermap[LastMove.X][LastMove.Y]);
		//console.log(MapRoster[LastMove.ID]);
		if(LastMove.X!=exX || LastMove.Y!=exY){rostermap[exX][exY]=0;
		document.getElementById("Entity "+(exX+1)+"X"+(exY+1)).style.visibility="hidden";
		};
		
		//alert(MapRoster[LastMove.ID].x+" "+MapRoster[LastMove.ID].y);
		//MapRoster[LastMove.EID].x=LastMove.EX;
		//MapRoster[LastMove.EID].y=LastMove.EY;
		if(LastMove.EID ?? 0!=0){
		rostermap[LastMove.EX][LastMove.EY]=LastMove.GRV;		
		MapRoster[LastMove.ID].life=LastMove.HP;
		MapRoster[LastMove.EID].life=LastMove.EHP;
		if(LastMove.E2ID??0!=0){MapRoster[LastMove.E2ID].life=LastMove.E2HP};
		rostermap[LastMove.EX][LastMove.EY].x=LastMove.EX;
		rostermap[LastMove.EX][LastMove.EY].y=LastMove.EY;
		if(LastMove.E2ID??0!=0){rostermap[LastMove.E2X][LastMove.E2Y]=LastMove.GRV2;rostermap[LastMove.E2X][LastMove.E2Y].x=LastMove.E2X; rostermap[LastMove.E2X][LastMove.E2Y].y=LastMove.E2Y};
		//alert(LastMove.E2ID);
		document.getElementById("EntityCore "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).src="Assets/Units/Static/"+Units[LastMove.GRV.unitType].shortname+LastMove.GRV.direction+".PNG";
		document.getElementById("EntityCore "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.visibility="inherit";
		document.getElementById("EntityCore "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.top="0px";
		if(!Units[LastMove.GRV.unitType].MLPR??false){document.getElementById("EntityMesh "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).src="Assets/Units/StaticMeshes/"+Units[LastMove.GRV.unitType].shortname+"Mesh"+LastMove.GRV.direction+".PNG"}else{document.getElementById("EntityMesh "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.visibility="hidden";};
		document.getElementById("Entity "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.top=(Units[LastMove.GRV.unitType].StaticOffsetY ?? [0,0,0,0,0])[LastMove.GRV.direction]+"px";
		document.getElementById("Entity "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.left=(Units[LastMove.GRV.unitType].StaticOffsetX ?? [0,0,0,0,0])[LastMove.GRV.direction]+"px";
		document.getElementById("Entity "+(LastMove.EX+1)+"X"+(LastMove.EY+1)).style.visibility="visible"

		if(LastMove.E2ID??0!=0){document.getElementById("EntityCore "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).src="Assets/Units/Static/"+Units[LastMove.GRV2.unitType].shortname+LastMove.GRV2.direction+".PNG";
		document.getElementById("EntityCore "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.visibility="inherit";
		document.getElementById("EntityCore "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.top="0px";
		if(!Units[LastMove.GRV2.unitType].MLPR??false){document.getElementById("EntityMesh "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).src="Assets/Units/StaticMeshes/"+Units[LastMove.GRV.unitType].shortname+"Mesh"+LastMove.GRV2.direction+".PNG"}else{document.getElementById("EntityMesh "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.visibility="hidden";};
		document.getElementById("Entity "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.top=(Units[LastMove.GRV2.unitType].StaticOffsetY ?? [0,0,0,0,0])[LastMove.GRV2.direction]+"px";
		document.getElementById("Entity "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.left=(Units[LastMove.GRV2.unitType].StaticOffsetX ?? [0,0,0,0,0])[LastMove.GRV2.direction]+"px";
		document.getElementById("Entity "+(LastMove.E2X+1)+"X"+(LastMove.E2Y+1)).style.visibility="visible"
		};};

		LastMove={ID:0, X:0, Y:0, HP:0, MOR:0, EID:0, EX:0, EY:0, EHP:0, EMOR:0, GRV:0, E2ID:0, E2X:0, E2Y:0, E2HP:0, E2MOR:0, GRV2:0, hasEngaged:false};

		
		refreshMap();


	}else{
		let KillMessage="Undo button only records one unit's action";
		if(KillingUnit??false){KillMessage="Cannot undo yet. Wait a bit"};
		alert(KillMessage);


	};};
function UnitLost(index){
	var UnitLostSound = new Audio('Assets/SFX/Unit_Lost.mp3');
	UnitLostSound.play();
	KillingUnit=true;

	let castTime=setInterval(Act,35);
	let frame=0;
	let animation=true;
	//if(MapRoster[index].x<StandardX || MapRoster[index].y<StandardY || MapRoster[index].x>StandardX+9 || MapRoster[index].y>StandardY+9){animation=false};
	//alert(unit.x);
	//alert(MapRoster[index].x);
	document.getElementById("EntityMesh "+(MapRoster[index].x+1)+"X"+(MapRoster[index].y+1)).style.visibility="hidden";
	let UnitID="EntityCore "+(MapRoster[index].x+1)+"X"+(MapRoster[index].y+1);
	let MarkerID="Marker "+(MapRoster[index].x+1)+"X"+(MapRoster[index].y+1);
	let FlagID="Flag "+(MapRoster[index].x+1)+"X"+(MapRoster[index].y+1);
	rostermap[MapRoster[index].x][MapRoster[index].y]=0;


	function Act(){

	//var top="0px";
	//var right=frame*56+"px";
	//var bottom="96px";
	//var left=(frame-1)*56+"px";
	//var offsetlat=MapRoster[index].x*56-40+"px";
	//var offsetlong=(MapRoster[index].y-frame+1)*56+"px";
	//coord="rect("+top+","+right+","+bottom+","+left+")";
	
	
	
	//document.getElementById(UnitID).style.clip=coord;
	if(frame==0 && animation){
	document.getElementById(UnitID).src="Assets/Units/UnitLost.GIF";
	document.getElementById(UnitID).style.top="-40px";
	document.getElementById(UnitID).style.left="0px";
	document.getElementById(UnitID).style.zIndex=3;};
	
	frame++;

	


	if(frame==13 && animation){clearInterval(castTime);
	document.getElementById(UnitID).src="";
	KillingUnit=false;
	//document.getElementById(UnitID).style.top=MapRoster[index].x*56+"px";	
	//document.getElementById(UnitID).style.left=MapRoster[index].y*56+"px";
	//document.getElementById(UnitID).style.clip="auto";
	document.getElementById(UnitID).style.visibility="hidden";
	document.getElementById(MarkerID).style.visibility="hidden";
	let localFlag=0;
	if(TileFlagMap[MapRoster[index].x][MapRoster[index].y]==1){localFlag=1};
	if(TileFlagMap[MapRoster[index].x][MapRoster[index].y]==2){localFlag=2};
	if(localFlag==0){document.getElementById(FlagID).style.visibility="hidden";};
	if(localFlag==1){document.getElementById(FlagID).src="Assets/Miscellaneous/CaptureFlag.PNG"};
	if(localFlag==2){document.getElementById(FlagID).src="Assets/Miscellaneous/DefendFlag.PNG"};
	//document.getElementById(UnitID).parentNode.removeChild(document.getElementById(UnitID));
	
	//MapRoster.splice(index,1);
	};
	};};
function UnitTarget(UnitType,X,Y){};
function UnmontreUnit(Index){
		document.getElementById('UnitMontre'+Index).src='Assets/Units/Static/'+Units[Index].shortname+'3.PNG'; 
		if(!Units[Index].MLPR??false){document.getElementById('UnitMontre'+Index+'Mesh').src='Assets/Units/StaticMeshes/'+Units[Index].shortname+'Mesh3.PNG'}else{document.getElementById('UnitMontre'+Index+'Mesh').src='Assets/Miscellaneous/Nothing.PNG'};

	};
function WBLARG(X,Y){

	//alert(X+" "+Y);
	//alert(ChosenUnit.ics+" "+ChosenUnit.igrec);
	if(BLARG.length>1){if(BLARG[BLARG.length-2].X==X+StandardX-1 && BLARG[BLARG.length-2].Y==Y+StandardY-1){
		document.getElementById("BLARG "+(BLARG[BLARG.length-1].X-StandardX+1)+"X"+(BLARG[BLARG.length-1].Y-StandardY+1)).src="Assets/Miscellaneous/Nothing.PNG";
		BLARG.pop();
		let type="";
		let axel=BLARG[BLARG.length-1];
		let aXel=BLARG[BLARG.length-2]??null;
		let axelX=axel.X-StandardX+1;
		let axelY=axel.Y-StandardY+1;
		let BLARGlet="";

		//alert(BLARG.length);
		if(BLARG.length>1){
		if(aXel.X>axel.X){type=1};
		if(aXel.Y<axel.Y){type=2};
		if(aXel.X<axel.X){type=3};
		if(aXel.Y>axel.Y){type=4};

		BLARGlet="Target"+type;
			}else{BLARGlet="Singularity"};


		//if(BLARG[BLARG.length-1].X-StandardX+1==ChosenUnit.X && BLARG[BLARG.length-1].Y-StandardY+1==ChosenUnit.Y){BLARGlet="Singularity"};
		document.getElementById("BLARG "+axelX+"X"+axelY).src="Assets/BLARG/"+BLARGlet+".PNG";

	//console.log(BLARG.length);
	}};};
function wipeMap(){
	for(let i=1;i<=Map.length;i++){
		for(let j=1;j<=Map[0].length;j++){
		//document.getElementById("A "+i+ " X " +j).remove();
		//document.getElementById("B "+i+ " X " +j).remove();
		//document.getElementById("C "+i+ " X " +j).remove();
		//document.getElementById("D "+i+ " X " +j).remove();
		//document.getElementById("Tile"+i+"X"+j).src="Assets/Miscellaneous/Nothing.PNG";
		//document.getElementById("Entity"+i+"X"+j).src="Assets/Miscellaneous/Nothing.PNG";
			let Voider=document.getElementById("Slot "+i+"X"+j);
			if(Voider!=null){Voider.remove();};
		}}};

/*function drawMap(Map)
	{

	for(i=0;i<Map.length;i++){
	for(j=0;j<Map.length;j++){

	if(Map[i][j]==1){
		var type= Math.ceil(Math.random()*8);
		variant= "Assets/Tiles/Plains"+type+".png";
		drawTile('Battlemap', variant, i*56, j*56, 1);};

	if(Map[i][j]==2){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		if(type==2){offset = 4;};
		if(type==3){offset = 3;};
		if(type==4){offset = 12;};
		variant= "Assets/Tiles/Forest"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 2);}

	if(Map[i][j]==3){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		if(type==3){offset = 4;};
		if(type==4){offset = 5;};
		variant= "Assets/Tiles/Hills"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 3);}

	if(Map[i][j]==4){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		if(type==2){offset = 4;};
		if(type==3){offset = 9;};
		if(type==4){offset = 10;};
		variant= "Assets/Tiles/Mountains"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 4);}

	if(Map[i][j]==5){
		var offset=8
		drawTile('Battlemap', "Assets/Tiles/Volcano.png", i*56-offset, j*56, 5);}

	if(Map[i][j]==6){};

	if(Map[i][j]==7){
		var index= 0;
		if(Map[i-1][j]==7 || Map[i-1][j]==8 || Map[i-1][j]==9){index+=1};
		if(Map[i][j+1]==7 || Map[i][j+1]==8 || Map[i][j+1]==9){index+=2};
		if(Map[i+1][j]==7 || Map[i+1][j]==8 || Map[i+1][j]==9){index+=4};
		if(Map[i][j-1]==7 || Map[i][j-1]==8 || Map[i][j-1]==9){index+=8};
		var source = "Assets/Tiles/Road"+index+".png";
		drawTile('Battlemap', source , i*56, j*56, 7);};

	if(Map[i][j]==8){
		var stature ="V";
		if(Map[i-1][j]==10 || Map[i-1][j]==16) {if(Map[i+1][j]==10 || Map[i+1][j]==16){stature="H"};};
		var standard=0;
		if(stature=="V"){
		if(Map[i][j-1]==10 || Map[i][j-1]==16){standard+=1};
		if(Map[i][j-1]==10 || Map[i][j-1]==16){standard+=2};
		}else{
		if(Map[i-1][j]==10 || Map[i-1][j]==16){standard+=1};
		if(Map[i+1][j]==10 || Map[i+1][j]==16){standard+=2};
		};
		var source = "Assets/Tiles/Bridge"+stature+standard+".png";
		drawTile('Battlemap', source , i*56, j*56, 8);};

	if(Map[i][j]==9){
		var stature ="V";
		if(Map[i-1][j]==10 || Map[i-1][j]==16) {if(Map[i+1][j]==10 || Map[i+1][j]==16){stature="H"};};
		var standard=0;
		if(stature=="V"){
		if(Map[i][j-1]==10 || Map[i][j-1]==16){standard+=1};
		if(Map[i][j-1]==10 || Map[i][j-1]==16){standard+=2};
		}else{
		if(Map[i-1][j]==10 || Map[i-1][j]==16){standard+=1};
		if(Map[i+1][j]==10 || Map[i+1][j]==16){standard+=2};};

		var source = "Assets/Tiles/HighBridge"+stature+standard+".png";
		drawTile('Battlemap', source , i*56, j*56, 9);};

	if(Map[i][j]==10){
		var index= 0;
		if(Map[i-1][j]>=8){index+=1};
		if(Map[i][j+1]>=8){index+=2};
		if(Map[i+1][j]>=8){index+=4};
		if(Map[i][j-1]>=8){index+=8};
		var source = "Assets/Tiles/River"+index+".png";
		drawTile('Battlemap', source , i*56, j*56, 10);};

	if(Map[i][j]==11){

		minI=Math.max(i,1);
		minJ=Math.max(j,1);
		maxI=Math.min(Map.length-2,i);
		maxJ=Math.min(Map[0].length-2,j);
		var index= 0;


		if(Map[minI-1][j]>=8){index+=1};
		if(Map[i][maxJ+1]>=8){index+=2};
		if(Map[maxI+1][j]>=8){index+=4};
		if(Map[i][minJ-1]>=8){index+=8};

		var source = "Assets/Tiles/Sea"+index+".png";
		drawTile('Battlemap', source , i*56, j*56, 11);
		if(index==3 && Map[minI-1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeB.png" , i*56, j*56+39);};
		if(index==6 && Map[maxI+1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeD.png" , i*56+51, j*56+42);};
		if(index==9 && Map[minI-1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeA.png" , i*56, j*56);};
		if(index==12 && Map[maxI+1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeC.png" , i*56+49, j*56);};
		if(index==7 && Map[minI-1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeB.png" , i*56, j*56+39);};
		if(index==7 && Map[maxI+1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeD.png" , i*56+51, j*56+42);};
		if(index==11 && Map[minI-1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeB.png" , i*56, j*56+39);};
		if(index==11 && Map[minI-1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeA.png" , i*56, j*56);};
		if(index==13 && Map[minI-1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeA.png" , i*56, j*56);};
		if(index==13 && Map[maxI+1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeC.png" , i*56+49, j*56);};
		if(index==14 && Map[maxI+1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeD.png" , i*56+51, j*56+42);};
		if(index==14 && Map[maxI+1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeC.png" , i*56+49, j*56);};
		if(index==15 && Map[minI-1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeB.png" , i*56, j*56+39);};
		if(index==15 && Map[maxI+1][maxJ+1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeD.png" , i*56+51, j*56+42);};
		if(index==15 && Map[minI-1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeA.png" , i*56, j*56);};
		if(index==15 && Map[maxI+1][minJ-1]<8){drawTile('Battlemap', "Assets/Tiles/EdgeC.png" , i*56+49, j*56);};




		};

	if(Map[i][j]==12){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		variant= "Assets/Tiles/Reef"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 12);};

	if(Map[i][j]==13){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		variant= "Assets/Tiles/Archipelago"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 13);};

	if(Map[i][j]==14){
		var type= Math.ceil(Math.random()*4);
		var offset=0
		variant= "Assets/Tiles/Rocks"+type+".png";
		drawTile('Battlemap', variant, i*56-offset, j*56, 14);};

	if(Map[i][j]==15){
		var index= 0;
		if(Map[i-1][j]<8){index+=1};
		if(Map[i][j+1]<8){index+=2};
		if(Map[i+1][j]<8){index+=4};
		if(Map[i][j-1]<8){index+=8};
		var source = "Assets/Tiles/Shore"+index+".png";
		drawTile('Battlemap', source , i*56, j*56, 15);};

	if(Map[i][j]==16){
		var index=0;

		if(i==0 || i==Map.length-1){index=5;};
		if(j==0 || j==Map.length-1){index=10;};
		var source = "Assets/Tiles/River"+index+".png";
		drawTile('Battlemap', source , i*56, j*56, 16);};

	if(Map[i][j]==17){};



	};
	};};*/

function ClearEndScreen(){};
function InterfaceFuck(){};
function InterfaceUnfuck(){};

SoundChoice=true;
MusicChoice=false;
DialogueChoice=false;
IdleAnimChoice=false;
MystSettChoice=false;

//CallPreloader();
//GeneralInitializer();

//castMap();


//document.getElementById('EditorP1').oncontextmenu=function(){EditorMap=Kaula;RefreshMapEditor()};
//document.getElementById("Main Menu").style.visibility="hidden";initializeBattle(1,1,1);
//document.getElementById("Main Menu").style.visibility="hidden";initializeSpecialBattle(TutorialLevel3);
//document.getElementById("Main Menu").style.visibility="hidden";initializeSpecialBattle(Samara); 
//MusicChoice=true;PlayBGM(33);

//This protocol shall disable MapEditor paraphernalia and allow the pilfering of a giant(14000*5600) map, later to be shrunk to 1400*560.

/*
Mainscreen=Math.ceil(Math.random()*9);
if(Mainscreen==1){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Relampago.JPG"};
if(Mainscreen==2){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Backdrop ETHA.JPG"};
if(Mainscreen==3){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Vladov's Last Charge.PNG"};
if(Mainscreen==4){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/BackdropProvisory.PNG"};
if(Mainscreen==5){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Continental Security League.PNG"};
if(Mainscreen==6){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Battle of Vardar.JPG"};
if(Mainscreen==7){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Battle of Burluk.JPG"};
if(Mainscreen==8){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Stulpikan Pandur.PNG"};
if(Mainscreen==9){document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Coloured Tanks.JPG"};*/
document.getElementById("Main Menu Picture").src="Assets/MainMenuScreens/Coloured Tanks.JPG";

//SaveGame();

//Inspection(0,MohConstants,MohRoster);


</script>

</body>

</html>